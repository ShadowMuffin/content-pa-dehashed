category: Data Enrichment & Threat Intelligence
commonfields:
  id: Aella Star Light
  version: -1
configuration:
- defaultvalue: ''
  display: Server URL (e.g. https://starlight.companyname.com:8889)
  name: url
  required: true
  type: 0
- defaultvalue: ''
  display: User name
  name: credentials
  required: true
  type: 9
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- defaultvalue: '15'
  display: Fetching interval in minutes (default is 15, minimum is 15 )
  name: fetch_interval
  required: false
  type: 0
- defaultvalue: ''
  display: The specific security event to look for. Default is all events
  name: event_name
  required: false
  type: 0
- defaultvalue: '50'
  display: Security event severity threshold, between 0-100
  name: severity
  required: false
  type: 0
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: 'false'
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Aella Star Light Integration
display: Aella Star Light
image: data:image/png;base64,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
name: Aella Star Light
script:
  commands:
  - arguments:
    - description: event id from the Star Light incident
      name: event_id
      required: true
    description: Query the details for a specific Start Light event
    name: aella-get-event
    outputs:
    - contextPath: Aella.Event.event_name
      description: The event name
      type: string
    - contextPath: Aella.Event.severity
      description: The severity score
      type: string
    - contextPath: Aella.Event.dstip
      description: The Destination IP
      type: string
    - contextPath: Aella.Event.srcip
      description: The source IP
      type: string
    - contextPath: Aella.Event.tenantid
      description: The tenant ID
      type: string
    - contextPath: Aella.Event.srcip_reputation
      description: The source IP reputation
      type: string
    - contextPath: Aella.Event.dstip_reputation
      description: The destination IP reputation
      type: string
    - contextPath: Aella.Event.dstip_geo
      description: The destination IP geo location
    - contextPath: Aella.Event.srcip_geo
      description: The source  IP geo location
  isfetch: true
  runonce: false
  script: "import requests\nimport json\nimport time\nimport datetime\nimport os\n\
    \nimport urllib3\nurllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)\n\
    \nfrom requests.packages.urllib3.exceptions import InsecureRequestWarning\nrequests.packages.urllib3.disable_warnings(InsecureRequestWarning)\n\
    \nif not demisto.params()['proxy']:\n    del os.environ['HTTP_PROXY']\n    del\
    \ os.environ['HTTPS_PROXY']\n    del os.environ['http_proxy']\n    del os.environ['https_proxy']\n\
    \n''' GLOBAL VARS '''\nURL = demisto.getParam('url') + '/aellaelastic'\nUSERNAME\
    \ = demisto.getParam('credentials')['identifier']\nPASSWORD = demisto.getParam('credentials')['password']\n\
    FETCH_INTERVAL = demisto.getParam('fetch_interval')\nVALIDATE_CERT = not demisto.params().get('insecure',\
    \ True)\n\n''' HELPER FUNCTIONS '''\ndef make_rest_call(end_point, username, password,\
    \ action_result,\n    headers={}, params=None,\n    data=None, method='get'):\n\
    \    headers.update({'Accept': 'application/json'})\n    headers.update({'Content-Type':\
    \ 'application/json'})\n\n    resp_json = None\n    request_func = getattr(requests,\
    \ method)\n    if (not request_func):\n        action_result['status']='Unsupported\
    \ method {}'.format(method)\n        return\n    try:\n        r = request_func(end_point,\
    \ auth=(username, password),\n            data=json.dumps(data) if data else None,\n\
    \            headers=headers,\n            verify=VALIDATE_CERT,params=params)\n\
    \    except Exception as e:\n        action_result['status']='Server REST API\
    \ exception {}'.format(e)\n        return\n\n    if r is not None:\n        action_result['r_text']=r.text\n\
    \        action_result['headers']=r.headers\n        action_result['r_status_code']=r.status_code\n\
    \n    try:\n        resp_json = r.json()\n    except Exception as e:\n       \
    \ action_result['status']='Json parse error {}'.format(\n            r.text.replace('{',\
    \ ' ').replace('}', ' '))\n        return\n\n    if (200 <= r.status_code <= 399):\n\
    \        action_result['status'] = 'Success'\n    else:\n        action_result['status']\
    \ = 'Failed'\n\n    action_result['data'] = resp_json\n    return\n\n''' FUNCTIONS\
    \ '''\ndef fetch_incidents_command():\n    fetch_interval = demisto.getParam('fetch_interval')\n\
    \    if fetch_interval is None:\n        fetch_interval = 15 * 60 # 15 minutes\n\
    \    else:\n        try:\n            fetch_interval = int(fetch_interval) * 60\n\
    \            if fetch_interval < 15 * 60:\n                # Min is 15 minutes\n\
    \                fetch_interval = 15 * 60\n        except:\n            fetch_interval\
    \ = 15 * 60\n\n    cur_t = time.time()\n\n    checkTime = cur_t - fetch_interval\n\
    \n    event = demisto.getParam('event_name')\n    if event is None:\n        event\
    \ = '*'\n\n    score = demisto.getParam('severity')\n    if score:\n        try:\n\
    \            score = int(score)\n            if score < 0 or score > 100:\n  \
    \              score = 50\n        except:\n            score = 50\n    else:\n\
    \        # Default score\n        score = 50\n\n    index_str = 'aella-ser*'\n\
    \n    query_str = 'event_name:{}  AND severity:>{}'.format(event, score)\n\n \
    \   ts_str = str(long(checkTime * 1000))\n\n    query_json = { 'query':\n    \
    \    { 'bool':\n            { 'must':\n                [ { 'query_string':\n \
    \                   {\n                      'query': query_str,\n           \
    \           'analyze_wildcard': True\n                    }\n                \
    \  },\n                  { 'range':\n                     { 'timestamp':\n   \
    \                      { 'gt': ts_str }\n                     }\n            \
    \      }\n                ]\n            }\n        }\n    }\n    end_point =\
    \ URL + '/{0}/{1}/_search'.format(index_str, 'amsg')\n\n    action_result = {}\n\
    \    make_rest_call(end_point,\n        USERNAME, PASSWORD, action_result, data=query_json\n\
    \    )\n\n    if action_result['status'] == 'Success':\n        demisto.info('Poll\
    \ incidents ok')\n        data = action_result.get('data')\n        if not isinstance(data,\
    \ dict):\n            demisto.error('Data returned in wrong format {}'.format(data))\n\
    \            demisto.incidents([])\n            return\n        hits = data.get('hits',\
    \ {}).get('hits', [])\n        incidents = []\n\n        try:\n            cached_event\
    \ = demisto.getLastRun().get(\"cached_event\", {})\n        except:\n        \
    \    cached_event = {}\n\n        new_cached_event = {}\n\n        for hit in\
    \ hits:\n            source = hit.get('_source', None)\n            if not source:\n\
    \                continue\n            event_name = source.get('event_name', None)\n\
    \            try:\n                event_severity = int(source.get('severity',\
    \ None))\n                if event_severity > 75:\n                    severity\
    \ = 3\n                elif event_severity > 50:\n                    severity\
    \ = 2\n                else:\n                    severity = 1\n            except:\n\
    \                severity = 0\n\n            if not event_name:\n            \
    \    continue\n            eid = hit['_id']\n\n            new_cached_event[eid]\
    \ = True\n            if cached_event.get(eid, False):\n                continue\n\
    \n            sdi = '{}_{}'.format(event_name, eid)\n            incident = {\n\
    \                'name' : sdi,\n                'severity' : severity,\n     \
    \           'rawJSON':json.dumps({  'name':sdi,\n                            \
    \            'label':'Starlight event',\n                                    \
    \    'aella_eid': eid,\n                                        'aella_event':event_name,\n\
    \                                        'event_severity': event_severity\n  \
    \                                  })\n            }\n            incidents.append(incident)\n\
    \        demisto.info('Incidents is {}'.format(incidents))\n        demisto.setLastRun({'cached_event':\
    \ new_cached_event})\n        demisto.incidents(incidents)\n\n    else:\n    \
    \    demisto.info('Poll incidents failed {}'.format(action_result))\n        demisto.incidents([])\n\
    \ndef aella_get_event_command():\n    demisto.info('Aella started get-event with\
    \ {}'.format(demisto.args()['event_id']))\n    event_id = demisto.args()['event_id']\n\
    \    query_json = { 'query': { 'match': { '_id': event_id } } }\n    end_point\
    \ = URL + '/{0}/{1}/_search'.format('aella-ser*', 'amsg')\n\n    action_result\
    \ = {}\n    make_rest_call(end_point,\n        USERNAME, PASSWORD, action_result,\
    \ data=query_json\n    )\n    if action_result['status'] == 'Success':\n     \
    \   demisto.info('Run Query is successful')\n        response = action_result.get('data')\n\
    \        timed_out = response.get('timed_out', False)\n        hits = response.get('hits',\
    \ {}).get('hits', [])\n        source = {}\n        dbot_scores = []\n       \
    \ if len(hits) == 0:\n            demisto.info('Get event got empty result')\n\
    \        for item in hits:\n            index = item.get('_index', '')\n     \
    \       source = item.get('_source', {})\n            if index:\n            \
    \    source['_index'] = index\n                source['timed_out'] = timed_out\n\
    \                demisto.debug('This is my run_query result aellaEvent {}'.format(source))\n\
    \n                # Check url reputation\n                url_str = source.get('url',\
    \ '')\n                if url_str:\n                    url_reputation = source.get('url_reputation',\
    \ '')\n                    if url_reputation and url_reputation != 'Good':\n \
    \                       dbot_score = {\n                            'Vendor' :\
    \ 'Aella Data',\n                            'Indicator' : url_str,\n        \
    \                    'Type' : 'url',\n                            'Score' : 3,\n\
    \                            'Malicious' : {\n                               \
    \ 'Vendor' : 'Aella Data',\n                                'Detections' : 'URL\
    \ reputation {0}'.format(url_reputation),\n                                'URL'\
    \ : url_str\n                            }\n                        }\n      \
    \              else:\n                        dbot_score = {\n               \
    \             'Vendor' : 'Aella Data',\n                            'Indicator'\
    \ : url_str,\n                            'Type' : 'url',\n                  \
    \          'Malicious' : None\n                        }\n                   \
    \     if url_reputation is None:\n                            # Unknonw\n    \
    \                        dbot_score['Score'] = 0\n                        else:\n\
    \                            # Good\n                            dbot_score['Score']\
    \ = 1\n                    dbot_scores.append(dbot_score)\n\n                #\
    \ Check src ip reputation\n                srcip_str = source.get('srcip', '')\n\
    \                if srcip_str:\n                    srcip_reputation = source.get('srcip_reputation',\
    \ '')\n                    if srcip_reputation and srcip_reputation != 'Good':\n\
    \                        dbot_score = {\n                            'Vendor'\
    \ : 'Aella Data',\n                            'Indicator' : srcip_str,\n    \
    \                        'Type' : 'ip',\n                            'Score' :\
    \ 3,\n                            'Malicious' : {\n                          \
    \      'Vendor' : 'Aella Data',\n                                'Detections'\
    \ : 'Source IP reputation {0}'.format(srcip_reputation),\n                   \
    \             'IP' : srcip_str\n                            }\n              \
    \          }\n                    else:\n                        dbot_score =\
    \ {\n                            'Vendor' : 'Aella Data',\n                  \
    \          'Indicator' : srcip_str,\n                            'Type' : 'ip',\n\
    \                            'Malicious' : None\n                        }\n \
    \                       if srcip_reputation is None:\n                       \
    \     # Unknonw\n                            dbot_score['Score'] = 0\n       \
    \                 else:\n                            # Good\n                \
    \            dbot_score['Score'] = 1\n                    dbot_scores.append(dbot_score)\n\
    \n                # Check dst ip reputation\n                dstip_str = source.get('dstip',\
    \ '')\n                if dstip_str:\n                    dstip_reputation = source.get('dstip_reputation',\
    \ '')\n                    if dstip_reputation and dstip_reputation != 'Good':\n\
    \                        dbot_score = {\n                            'Vendor'\
    \ : 'Aella Data',\n                            'Indicator' : dstip_str,\n    \
    \                        'Type' : 'ip',\n                            'Score' :\
    \ 3,\n                            'Malicious' : {\n                          \
    \      'Vendor' : 'Aella Data',\n                                'Detections'\
    \ : 'Destination IP reputation {0}'.format(dstip_reputation),\n              \
    \                  'IP' : dstip_str\n                            }\n         \
    \               }\n                    else:\n                        dbot_score\
    \ = {\n                            'Vendor' : 'Aella Data',\n                \
    \            'Indicator' : dstip_str,\n                            'Type' : 'ip',\n\
    \                            'Malicious' : None\n                        }\n \
    \                       if dstip_reputation is None:\n                       \
    \     # Unknonw\n                            dbot_score['Score'] = 0\n       \
    \                 else:\n                            # Good\n                \
    \            dbot_score['Score'] = 1\n                    dbot_scores.append(dbot_score)\n\
    \n            break\n        demisto.results({\n            'Type': entryTypes['note'],\n\
    \            'ContentsFormat': formats['json'],\n            'Contents': source,\n\
    \            'HumanReadable': tableToMarkdown('Aella Star Light Event <{0}>'.format(event_id),\
    \ source),\n            'EntryContext': {\n                'Aella.Event(val._id==obj._id)':\
    \ source,\n                'DBotScore' : createContext(dbot_scores, removeNull=True),\n\
    \            }\n        })\n    else:\n        demisto.info('Get event failed\
    \ {}'.format(action_result))\n        demisto.results(return_error('Failed to\
    \ get event'))\n\n''' EXECUTION CODE '''\ndemisto.info('Command is {}'.format(demisto.command()))\n\
    \nif demisto.command() == 'test-module':\n    # This is the call made when pressing\
    \ the integration test button.\n    action_result = {}\n    make_rest_call(URL\
    \ + '/_cluster/health',\n        USERNAME, PASSWORD, action_result\n        )\n\
    \n    if action_result['status'] == 'Success':\n        demisto.results('ok')\n\
    \    else:\n        demisto.results('failed')\n\nif demisto.command() == 'fetch-incidents':\n\
    \    fetch_incidents_command()\n\nif demisto.command() == 'aella-get-event':\n\
    \    aella_get_event_command()"
  subtype: python2
  type: python
tests:
- No test
toversion: 4.1.9
