category: Endpoint
commonfields:
  id: Carbon Black Defense
  version: -1
configuration:
- defaultvalue: ''
  display: Server URL (e.g. https://192.168.0.1)
  name: url
  required: true
  type: 0
- defaultvalue: ''
  display: API Key
  name: key
  required: true
  type: 4
- defaultvalue: v3
  display: API Version
  name: version
  required: true
  type: 0
- defaultvalue: ''
  display: Connector ID
  name: connectorId
  required: true
  type: 0
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- defaultvalue: ''
  display: SIEM key. Use to fetch incidents.
  name: siemKey
  required: false
  type: 4
- defaultvalue: ''
  display: SIEM Connector ID. Use to fetch incidents.
  name: siemConnector
  required: false
  type: 0
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Next-generation antivirus + EDR in one cloud-delivered platform that
  stops commodity malware, advanced malware, non-malware attacks and ransomware.
detaileddescription: 'To get SIEM ID and SIEM Key in order to fetch incidents.

  Login to: https://defense.conferdeploy.net/

  Select the SETTING tab

  Go to API Keys and click on Add API Key'
display: Carbon Black Defense
image: data:image/png;base64,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
name: Carbon Black Defense
script:
  commands:
  - arguments:
    - description: Query parameter. Filter on hostnames based on a case insensitive
        token search.
      name: hostName
    - description: Query parameter. Filter on the exact hostname
      name: hostNameExact
    - description: Query parameter. Filter on owner name case insensitively.
      name: ownerName
    - description: Query parameter. Same as ownerName but with case sensitivity
      name: ownerNameExact
    - description: Query parameter. Filter on devices with a given external or internal
        IP address
      name: ipAddress
    - description: Wanted first row number from the result (starting from 1).
      name: start
    - description: Wanted maximum number of rows from the result. This parameter can
        be limited on the Cb Defense server side.
      name: rows
    description: "Get a status of all devices. Optionally you can include a query\
      \ parameter to filter the results. Combining these query parameters is an implicit\
      \ \u201CAND\u201D. "
    name: cbd-get-devices-status
    outputs:
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.ActivationCodeExpiryTime
      description: Activation Code Expiry Time
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.LastExternalIpAddress
      description: Last External IpAddress
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.LastLocation
      description: Last Location
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.LastReportedTime
      description: Last Reported Time
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.LastShutdownTime
      description: Last Shutdown Time
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.OsVersion
      description: Os Version
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.PolicyId
      description: Policy Id
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.RegisteredTime
      description: Registered Time
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.Status
      description: Status
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.DeviceId
      description: Device Id
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.DeviceOwnerId
      description: Device Owner Id
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.DeviceType
      description: Device Type
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.OrganizationId
      description: Organization Id
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.SensorVersion
      description: Sensor Version
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.TargetPriorityType
      description: Target Priority Type
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.Email
      description: Email
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.LastContact
      description: Last Contact
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.OrganizationName
      description: Organization Name
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.SensorStates
      description: SensorStates
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.AvStatus
      description: AvStatus
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.LastInternalIpAddress
      description: Last Internal IpAddress
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.Name
      description: Name
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.PolicyName
      description: Policy Name
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.SensorOutOfDate
      description: Sensor Out OfDate
    - contextPath: CarbonBlackDefense.GetDevicesStatus.Results.TestId
      description: Test Id
  - arguments:
    - description: Individual device id.
      name: deviceId
      required: true
    description: Retrieve details for an individual device given the device ID.
    name: cbd-get-device-status
    outputs:
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.TargetPriorityType
      description: Target Priority Type
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.OrganizationId
      description: Organization Id
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.CreateTime
      description: Create Time
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.DeviceId
      description: Device Id
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.Email
      description: Email
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.LastInternalIpAddress
      description: Last Internal IpAddress
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.LastLocation
      description: Last Location
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.OsVersion
      description: Os Version
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.AvStatus
      description: AvStatus
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.LastExternalIpAddress
      description: Last External IpAddress
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.RegisteredTime
      description: Registered Time
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.LastContact
      description: Last Contact
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.Status
      description: Status
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.TestId
      description: Test Id
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.PolicyId
      description: Policy Id
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.UpdateVersion
      description: Update Version
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.OrganizationName
      description: Organization Name
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.RootedByAnalytics
      description: Rooted ByAnalytics
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.SensorVersion
      description: Sensor Version
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.DeviceType
      description: Device Type
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.PolicyName
      description: Policy Name
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.RootedByAnalyticsTime
      description: Rooted ByAnalytics Time
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.SensorOutOfDate
      description: Sensor Out OfDate
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.SensorStates
      description: SensorStates
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.Name
      description: Name
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.Id
      description: Id
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.LastReportedTime
      description: Last Reported Time
    - contextPath: CarbonBlackDefense.GetDeviceStatus.DeviceInfo.DeviceOwnerId
      description: Device Owner Id
  - arguments:
    - description: The device id.
      name: deviceId
      required: true
    - description: Policy id.
      name: policyId
    - description: Policy name.
      name: policyName
    description: 'Change status of an individual device by its device ID. The requested
      security policy can be indicated either as a policy ID (policyId) or policy
      name (policyName).The current revision of the Cb Defense backend only allows
      one element to be changed with this call: the security policy assigned to the
      device. For example policyName=Restrictive_Windows_Workstation'
    name: cbd-change-device-status
  - arguments:
    - description: 'Query parameter. Filter on hostnames case insensitive. '
      name: hostName
    - description: Query parameter. Filter on the exact hostname
      name: hostNameExact
    - description: Query parameter. Filter on owner name case insensitive.
      name: ownerName
    - description: Query parameter. Same as ownerName but with case sensitivity
      name: ownerNameExact
    - description: Query parameter. Filter on events generated by a device with a
        given external or internal IP address
      name: ipAddress
    - description: Query parameter. Filter on events generated by a process with the
        given SHA-256 hash. Note that this hash must be lowercase.
      name: sha256Hash
    - description: Query parameter. Filter on events generated by a process with the
        given application name. Note that this name must be lowercase
      name: applicationName
    - auto: PREDEFINED
      description: Query parameter. Filter on events with a given event type.
      name: eventType
      predefined:
      - NETWORK
      - FILE_CREATE
      - REGISTRY_ACCESS
      - SYSTEM_API_CALL
      - CREATE_PROCESS
      - DATA_ACCESS
      - INJECT_CODE
    - description: 'Query parameter. Filter on events generated within a given relative
        time frame. Note that the default is one day if a searchWindow is not specified.
        Note that events may not be available past 30 days due to retention policies. '
      name: searchWindow
    - description: Wanted first row number from the result (starting from 1).
      name: start
    - description: Wanted maximum number of rows from the result. This parameter can
        be limited on the Cb Defense server side.
      name: rows
    description: Retrieves all events matching the input search criteria.
    name: cbd-find-events
    outputs:
    - contextPath: CarbonBlackDefense.FindEvents.Results.EventType
      description: Event Type
    - contextPath: CarbonBlackDefense.FindEvents.Results.ProcessDetails.MilisSinceProcessStart
      description: Milis Since Process Start
    - contextPath: CarbonBlackDefense.FindEvents.Results.ProcessDetails.Name
      description: Name
    - contextPath: CarbonBlackDefense.FindEvents.Results.ProcessDetails.PrivatePid
      description: Private Pid
    - contextPath: CarbonBlackDefense.FindEvents.Results.ProcessDetails.ProcessId
      description: Process Id
    - contextPath: CarbonBlackDefense.FindEvents.Results.ShortDescription
      description: Short Description
    - contextPath: CarbonBlackDefense.FindEvents.Results.CreateTime
      description: Create Time
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.DeviceName
      description: Device Name
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.DeviceVersion
      description: Device Version
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.PolicyName
      description: Policy Name
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.TargetPriorityType
      description: Target Priority Type
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.AgentLocation
      description: Agent Location
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.DeviceId
      description: Device Id
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.DeviceIpV4Address
      description: Device IpV4Address
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.DeviceLocation.AreaCode
      description: Area Code
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.DeviceLocation.CountryCode
      description: Country Code
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.DeviceLocation.Latitude
      description: Latitude
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.DeviceLocation.Longitude
      description: Longitude
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.DeviceLocation.City
      description: City
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.DeviceLocation.CountryName
      description: Country Name
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.DeviceLocation.DmaCode
      description: Dma Code
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.DeviceLocation.MetroCode
      description: Metro Code
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.DeviceLocation.PostalCode
      description: Postal Code
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.DeviceLocation.Region
      description: Region
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.DeviceIpAddress
      description: Device IpAddress
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.DeviceType
      description: Device Type
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.Email
      description: Email
    - contextPath: CarbonBlackDefense.FindEvents.Results.DeviceDetails.TargetPriorityCode
      description: Target Priority Code
    - contextPath: CarbonBlackDefense.FindEvents.Results.EventId
      description: Event Id
    - contextPath: CarbonBlackDefense.FindEvents.Results.EventTime
      description: Event Time
    - contextPath: CarbonBlackDefense.FindEvents.Results.LongDescription
      description: Long Description
    - contextPath: CarbonBlackDefense.FindEvents.Results.NetFlow.DestAddress
      description: Dest Address
    - contextPath: CarbonBlackDefense.FindEvents.Results.NetFlow.DestPort
      description: Dest Port
    - contextPath: CarbonBlackDefense.FindEvents.Results.NetFlow.PeerFqdn
      description: Peer Fqdn
    - contextPath: CarbonBlackDefense.FindEvents.Results.NetFlow.PeerIpAddress
      description: Peer IpAddress
    - contextPath: CarbonBlackDefense.FindEvents.Results.NetFlow.PeerIpV4Address
      description: Peer IpV4Address
    - contextPath: CarbonBlackDefense.FindEvents.Results.NetFlow.Service
      description: Service
    - contextPath: CarbonBlackDefense.FindEvents.Results.NetFlow.SourceAddress
      description: Source Address
    - contextPath: CarbonBlackDefense.FindEvents.Results.NetFlow.SourcePort
      description: Source Port
    - contextPath: CarbonBlackDefense.FindEvents.Results.SelectedApp.ApplicationName
      description: Application Name
    - contextPath: CarbonBlackDefense.FindEvents.Results.SelectedApp.ApplicationPath
      description: Application Path
    - contextPath: CarbonBlackDefense.FindEvents.Results.SelectedApp.Md5Hash
      description: Md5Hash
    - contextPath: CarbonBlackDefense.FindEvents.Results.SelectedApp.Sha256Hash
      description: Sha256Hash
    - contextPath: CarbonBlackDefense.FindEvents.Results.ThreatIndicators
      description: Threat Indicators
  - arguments:
    - description: The event id.
      name: eventId
      required: true
    description: 'Retrieve details for an individual event given the event ID '
    name: cbd-find-event
    outputs:
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ShortDescription
      description: Short Description
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.TargetHash.ApplicationName
      description: Application Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.TargetHash.ReputationProperty
      description: Reputation Property
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.TargetHash.Sha256Hash
      description: Sha256Hash
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.EventType
      description: Event Type
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessHash.Md5Hash
      description: Md5Hash
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessHash.Sha256Hash
      description: Sha256Hash
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessHash.ApplicationPath
      description: Application Path
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessHash.ReputationProperty
      description: Reputation Property
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessHash.ApplicationName
      description: Application Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.OrgDetails.OrganizationId
      description: Organization Id
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.OrgDetails.OrganizationName
      description: Organization Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.OrgDetails.OrganizationType
      description: Organization Type
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ParentHash.ApplicationName
      description: Application Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ParentHash.Sha256Hash
      description: Sha256Hash
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.EventId
      description: Event Id
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.LongDescription
      description: Long Description
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceIpV4Address
      description: Device IpV4Address
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceType
      description: Device Type
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.Email
      description: Email
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.TargetPriorityCode
      description: Target Priority Code
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.AgentLocation
      description: Agent Location
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceHostName
      description: Device Host Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceId
      description: Device Id
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.GroupName
      description: Group Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceVersion
      description: Device Version
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.TargetPriorityType
      description: Target Priority Type
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceIpAddress
      description: Device IpAddress
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceLocation.Latitude
      description: Latitude
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceLocation.City
      description: City
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceLocation.CountryCode
      description: Country Code
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceLocation.DmaCode
      description: Dma Code
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceLocation.Longitude
      description: Longitude
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceLocation.MetroCode
      description: Metro Code
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceLocation.PostalCode
      description: Postal Code
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceLocation.Region
      description: Region
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceLocation.AreaCode
      description: Area Code
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceLocation.CountryName
      description: Country Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.DeviceDetails.DeviceName
      description: Device Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.CreateTime
      description: Create Time
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.EventTime
      description: Event Time
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessDetails.FullUserName
      description: Full User Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessDetails.Name
      description: Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessDetails.ParentCommandLine
      description: Parent Command Line
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessDetails.ParentName
      description: Parent Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessDetails.ParentPid
      description: Parent Pid
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessDetails.ProcessId
      description: Process Id
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessDetails.CommandLine
      description: Command Line
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessDetails.MilisSinceProcessStart
      description: Milis Since Process Start
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessDetails.TargetCommandLine
      description: Target Command Line
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessDetails.TargetPid
      description: Target Pid
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessDetails.UserName
      description: User Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessDetails.ParentPrivatePid
      description: Parent Private Pid
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessDetails.PrivatePid
      description: Private Pid
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessDetails.TargetName
      description: Target Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ProcessDetails.TargetPrivatePid
      description: Target Private Pid
    - contextPath: CarbonBlackDefense.GetAlertDetails.EventInfo.ThreatIndicators
      description: Threat Indicators
  - arguments:
    - description: 'Query parameter. Filter on hostnames case insensitive. '
      name: hostNameExact
    - description: Query parameter. Filter on owner name case insensitive.
      name: ownerName
    - description: Query parameter. Same as ownerName but with case sensitivity
      name: ownerNameExact
    - description: Query parameter. Filter on events generated by a device with a
        given external or internal IP address
      name: ipAddress
    - description: 'Query parameter. Filter on events generated within a given relative
        time frame. Note that the default is one day if a searchWindow is not specified.
        Note that events may not be available past 30 days due to retention policies. '
      name: searchWindow
    - description: Wanted first row number from the result (starting from 1).
      name: start
    - description: Wanted maximum number of rows from the result. This parameter can
        be limited on the Cb Defense server side.
      name: rows
    description: "Find processes associated with a specific indicator or IP address\
      \ filter. Only API keys of type \u201CAPI\u201D can call the processes API."
    name: cbd-find-processes
    outputs:
    - contextPath: CarbonBlackDefense.GetProcesses.ApplicationName
      description: Application name
    - contextPath: CarbonBlackDefense.GetProcesses.ProcessId
      description: Process id
    - contextPath: CarbonBlackDefense.GetProcesses.NumEvents
      description: Number of events
    - contextPath: CarbonBlackDefense.GetProcesses.ApplicationPath
      description: Application path
    - contextPath: CarbonBlackDefense.GetProcesses.PrivatePid
      description: Private pid
    - contextPath: CarbonBlackDefense.GetProcesses.Sha256Hash
      description: sha256Hash
    - contextPath: CarbonBlackDefense.GetProcesses.TotalResults
      description: Total results
  - arguments:
    - description: The alert id
      name: alertId
      required: true
    description: "Get details on the events that led to an alert. This includes retrieving\
      \ metadata around the alert as well as a list of all the events associated with\
      \ the alert. Only API keys of type \u201CAPI\u201D can call the alerts API."
    name: cbd-get-alert-details
    outputs:
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.DeviceInfo.DeviceType
      description: Device Type
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.DeviceInfo.Group
      description: Group
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.DeviceInfo.GroupId
      description: Group Id
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.DeviceInfo.RegisteredTime
      description: Registered Time
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.DeviceInfo.DeviceId
      description: Device Id
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.DeviceInfo.DeviceName
      description: Device Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.DeviceInfo.Status
      description: Status
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.DeviceInfo.OsVersion
      description: Os Version
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.DeviceInfo.SensorVersion
      description: Sensor Version
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.DeviceInfo.UserName
      description: User Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.DeviceInfo.Importance
      description: Importance
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.DeviceInfo.Message
      description: Message
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.DeviceInfo.Success
      description: Success
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.ParentHash
      description: Parent Hash
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.PolicyState
      description: Policy State
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.LongDescription
      description: Long Description
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.CommandLine
      description: Command Line
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.ParentPid
      description: Parent Pid
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.ProcessId
      description: Process Id
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.ThreatIndicators
      description: Threat Indicators
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.ApplicationPath
      description: Application Path
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.ProcessHash
      description: Process Hash
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.ProcessMd5Hash
      description: Process Md5Hash
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.EventId
      description: Event Id
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.EventTime
      description: Event Time
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.EventType
      description: Event Type
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.KillChainStatus
      description: Kill Chain Status
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.ParentName
      description: Parent Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.ParentPPid
      description: ParentP Pid
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.Events.ProcessPPid
      description: ProcessP Pid
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.ThreatInfo.IncidentId
      description: Incident Id
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.ThreatInfo.Indicators.ApplicationName
      description: Application Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.ThreatInfo.Indicators.IndicatorName
      description: Indicator Name
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.ThreatInfo.Indicators.Sha256Hash
      description: Sha256Hash
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.ThreatInfo.Summary
      description: Summary
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.ThreatInfo.ThreatId
      description: Threat Id
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.ThreatInfo.ThreatScore
      description: Threat Score
    - contextPath: CarbonBlackDefense.GetAlertDetails.DeviceInfo.ThreatInfo.Time
      description: Time
  - arguments: []
    description: Get the list of policies available in your organization.
    name: cbd-get-policies
    outputs:
    - contextPath: CarbonBlackDefense.GetPolicies.Id
      description: The policy id.
    - contextPath: CarbonBlackDefense.GetPolicies.PriorityLevel
      description: The policy priority level.
    - contextPath: CarbonBlackDefense.GetPolicies.SystemPolicy
      description: Is system policy (boolean).
    - contextPath: CarbonBlackDefense.GetPolicies.LatestRevision
      description: Policy latest revision.
    - contextPath: CarbonBlackDefense.GetPolicies.Policy
      description: The policy object.
  - arguments:
    - description: The policy id.
      name: policyId
      required: true
    description: Retrieve a policy object by ID.
    name: cbd-get-policy
    outputs:
    - contextPath: CarbonBlackDefense.GetPolicy.Id
      description: The policy id.
    - contextPath: CarbonBlackDefense.GetPolicy.PriorityLevel
      description: The policy priority level.
    - contextPath: CarbonBlackDefense.GetPolicy.SystemPolicy
      description: Is system policy (boolean).
    - contextPath: CarbonBlackDefense.GetPolicy.LatestRevision
      description: Policy latest revision.
    - contextPath: CarbonBlackDefense.GetPolicy.Policy
      description: The policy object.
  - arguments:
    - description: A description of the policy
      name: description
      required: true
    - description: A one-line name for the policy
      name: name
      required: true
    - auto: PREDEFINED
      description: The priority score associated with sensors assigned to this policy.
      name: priorityLevel
      predefined:
      - HIGH
      - MEDIUM
      - LOW
      required: true
    - description: The JSON object containing the policy details. Make sure a valid
        policy object is passed. You may use 'get-policy' in order to receive a similar
        policy object, then re-set some of the policy's fields with 'set-policy'.
        Finally pass the mutated object.
      name: policy
      required: true
    description: Create a new Policy on the Cb Defense backend.
    name: cbd-create-policy
    outputs:
    - contextPath: CarbonBlackDefense.CreatePolicy.PolicyId
      description: The new policy id.
  - arguments:
    - description: A description of the policy.
      name: description
      required: true
    - description: A one-line name for the policy.
      name: name
      required: true
    - auto: PREDEFINED
      description: The priority score associated with sensors assigned to this policy.
      name: priorityLevel
      predefined:
      - HIGH
      - MEDIUM
      - LOW
      required: true
    - description: The ID of the policy to replace.
      name: id
      required: true
    - description: The JSON object containing the policy details. The JSON object
        containing the policy details. Make sure a valid policy object is passed.
        You may use 'get-policy' in order to receive the policy object you wish to
        update, then re-set some of the policy's fields with 'set-policy'. Finally
        pass the mutated object.
      name: policy
      required: true
    description: Update an existing policy with a new policy. Please note that system
      policies cannot be modified.
    name: cbd-update-policy
  - arguments:
    - description: The policy id.
      name: policyId
      required: true
    description: Delete a policy from the Cb Defense backend. This may return an error
      if devices are actively assigned to the policy id requested for deletion. Please
      note that system policies cannot be deleted.
    name: cbd-delete-policy
  - arguments:
    - description: Rule action.
      name: action
      required: true
    - description: Rule operation.
      name: operation
      required: true
    - auto: PREDEFINED
      description: Rule required
      name: required
      predefined:
      - 'false'
      - 'true'
      required: true
    - description: Rule id.
      name: id
      required: true
    - description: Application type.
      name: type
      required: true
    - description: Application value.
      name: value
      required: true
    - description: The policy id.
      name: policyId
      required: true
    description: Add a new rule to an existing policy. Please note that system policies
      cannot be modified.
    name: cbd-add-rule-to-policy
  - arguments:
    - description: The policy id.
      name: policyId
      required: true
    - description: The rule id.
      name: ruleId
      required: true
    description: Removes a rule from an existing policy. Please note that system policies
      cannot be modified.
    name: cbd-delete-rule-from-policy
  - arguments:
    - description: Rule action.
      name: action
      required: true
    - description: Rule operation.
      name: operation
      required: true
    - auto: PREDEFINED
      description: Rule required
      name: required
      predefined:
      - 'true'
      - 'false'
      required: true
    - description: Rule id.
      name: id
      required: true
    - description: Application type.
      name: type
      required: true
    - description: Application value.
      name: value
      required: true
    - description: The policy id.
      name: policyId
      required: true
    description: Update an existing rule with a new rule. Please note that system
      policies cannot be modified.
    name: cbd-update-rule-in-policy
  - arguments:
    - description: 'A json object that holds key/value pairs. Key is the field path
        in the policy object you wish to update with value.  '
      name: keyValue
      required: true
    - description: 'The policy to be set. '
      name: policy
      required: true
    description: Re-set policy fields.
    name: cbd-set-policy
    outputs:
    - contextPath: CarbonBlackDefense.SetPolicy.Policy
      description: The modified policy
  isfetch: true
  runonce: false
  script: "var CBDefence = function() {\n    var client = (function() {\n        var\
    \ urlTemplae = '%url%/integrationServices/%version%/';\n        var authTemplate\
    \ = '%key%/%connectorId%';\n        var authSiemTemplate = '%siemKey%/%siemConnector%';\n\
    \        var urlFull = replaceInTemplates(urlTemplae, params);\n        var AuthToken\
    \ = replaceInTemplates(authTemplate, params);\n        var SiemToken = replaceInTemplates(authSiemTemplate,\
    \ params);\n        function addAuthToHeaders(headerObj, token) {\n          \
    \   if (headerObj === 'undefined') {\n                return { 'X-Auth-Token':\
    \ [token] };\n            }\n            headerObj['X-Auth-Token'] = [token];\n\
    \            return headerObj;\n        }\n        var addClientAuthToHeaders\
    \ = function(headerObj) {\n            return addAuthToHeaders(headerObj, AuthToken);\n\
    \        };\n        var addSiemKeyToHeaders = function(headerObj) {\n       \
    \     return addAuthToHeaders(headerObj, SiemToken);\n        };\n        return\
    \ {\n            url: urlFull,\n            addClientAuthToHeaders: addClientAuthToHeaders,\n\
    \            addSiemKeyToHeaders: addSiemKeyToHeaders\n        };\n    })();\n\
    \    var policyData = [\n        {to: 'Id', from: 'id'},\n        {to: 'PriorityLevel',\
    \ from: 'priorityLevel'},\n        {to: 'SystemPolicy',from: 'systemPolicy'},\n\
    \        {to: 'LatestRevision',from: 'latestRevision'},\n        {to: 'Policy',from:\
    \ 'policy'}\n    ];\n    var commands = {\n        'cbd-get-devices-status': {\n\
    \            path: 'device',\n            method: 'GET',\n            queryParams:\
    \ {\n                start: true,\n                rows: true,\n             \
    \   hostName: true,\n                hostNameExact: true,\n                ownerName:\
    \ true,\n                ownerNameExact: true,\n                ipAddress: true\n\
    \            },\n            extended: true,\n            translator:[\n     \
    \           {\n                    contextPath: 'CarbonBlackDefense.GetDevicesStatus.Results(val.DeviceId==obj.DeviceId)',\n\
    \                    title: 'Carbon Black Defense Get Devices Status',\n     \
    \               innerPath: 'results',\n                    data: [\n         \
    \               { to: 'Name', from: 'name'},\n                        { to: 'LastReportedTime',\
    \ from: 'lastReportedTime'},\n                        { to: 'PolicyId', from:\
    \ 'policyId'},\n                        { to: 'LastShutdownTime', from: 'lastShutdownTime'},\n\
    \                        { to: 'LastContact', from: 'lastContact'},\n        \
    \                { to: 'LastExternalIpAddress', from: 'lastExternalIpAddress'},\n\
    \                        { to: 'AvStatus', from: 'avStatus'},\n              \
    \          { to: 'RegisteredTime', from: 'registeredTime'},\n                \
    \        { to: 'TargetPriorityType', from: 'targetPriorityType'},\n          \
    \              { to: 'OrganizationId', from: 'organizationId'},\n            \
    \            { to: 'DeviceOwnerId', from: 'deviceOwnerId'},\n                \
    \        { to: 'Email', from: 'email'},\n                        { to: 'ActivationCodeExpiryTime',\
    \ from: 'activationCodeExpiryTime'},\n                        { to: 'SensorVersion',\
    \ from: 'sensorVersion'},\n                        { to: 'Status', from: 'status'},\n\
    \                        { to: 'TestId', from: 'testId'},\n                  \
    \      { to: 'DeviceId', from: 'deviceId'},\n                        { to: 'SensorStates',\
    \ from: 'sensorStates'},\n                        { to: 'PolicyName', from: 'policyName'},\n\
    \                        { to: 'SensorOutOfDate', from: 'sensorOutOfDate'},\n\
    \                        { to: 'LastLocation', from: 'lastLocation'},\n      \
    \                  { to: 'DeviceType', from: 'deviceType'},\n                \
    \        { to: 'OsVersion', from: 'osVersion'},\n                        { to:\
    \ 'LastInternalIpAddress', from: 'lastInternalIpAddress'},\n                 \
    \       { to: 'OrganizationName', from: 'organizationName'}\n                \
    \    ]\n                }\n            ]\n        },\n        'cbd-get-device-status':\
    \ {\n            path: 'device/%deviceId%',\n            method: 'GET',\n    \
    \        extended: true,\n            translator:[\n                {\n      \
    \              contextPath: 'CarbonBlackDefense.GetDeviceStatus.DeviceInfo(val.DeviceId==obj.DeviceId)',\n\
    \                    title: 'Carbon Black Defense Get Device Status',\n      \
    \              innerPath: 'deviceInfo',\n                    data: [\n       \
    \                 { to: 'Name', from: 'name'},\n                        { to:\
    \ 'LastReportedTime', from: 'lastReportedTime'},\n                        { to:\
    \ 'PolicyId', from: 'policyId'},\n                        { to: 'LastShutdownTime',\
    \ from: 'lastShutdownTime'},\n                        { to: 'LastContact', from:\
    \ 'lastContact'},\n                        { to: 'LastExternalIpAddress', from:\
    \ 'lastExternalIpAddress'},\n                        { to: 'AvStatus', from: 'avStatus'},\n\
    \                        { to: 'RegisteredTime', from: 'registeredTime'},\n  \
    \                      { to: 'TargetPriorityType', from: 'targetPriorityType'},\n\
    \                        { to: 'OrganizationId', from: 'organizationId'},\n  \
    \                      { to: 'DeviceOwnerId', from: 'deviceOwnerId'},\n      \
    \                  { to: 'Email', from: 'email'},\n                        { to:\
    \ 'ActivationCodeExpiryTime', from: 'activationCodeExpiryTime'},\n           \
    \             { to: 'SensorVersion', from: 'sensorVersion'},\n               \
    \         { to: 'Status', from: 'status'},\n                        { to: 'TestId',\
    \ from: 'testId'},\n                        { to: 'DeviceId', from: 'deviceId'},\n\
    \                        { to: 'SensorStates', from: 'sensorStates'},\n      \
    \                  { to: 'PolicyName', from: 'policyName'},\n                \
    \        { to: 'SensorOutOfDate', from: 'sensorOutOfDate'},\n                \
    \        { to: 'LastLocation', from: 'lastLocation'},\n                      \
    \  { to: 'DeviceType', from: 'deviceType'},\n                        { to: 'OsVersion',\
    \ from: 'osVersion'},\n                        { to: 'LastInternalIpAddress',\
    \ from: 'lastInternalIpAddress'},\n                        { to: 'OrganizationName',\
    \ from: 'organizationName'}\n                    ]\n                }\n      \
    \      ]\n        },\n        'cbd-change-device-status': {\n            path:\
    \ 'device/%deviceId%',\n            method: 'PATCH',\n            content: {'policyName'\
    \ : null},\n            extended: true,\n            translator:[\n          \
    \      {\n                    contextPath: 'CarbonBlackDefense.ChangeDeviceStatus.DeviceInfo(val.DeviceId==obj.DeviceId)',\n\
    \                    title: 'Carbon Black Defense Change Device Status',\n   \
    \                 innerPath: 'deviceInfo',\n                    data: [\n    \
    \                    { to: 'Name', from: 'name'},\n                        { to:\
    \ 'LastReportedTime', from: 'lastReportedTime'},\n                        { to:\
    \ 'PolicyId', from: 'policyId'},\n                        { to: 'LastShutdownTime',\
    \ from: 'lastShutdownTime'},\n                        { to: 'LastContact', from:\
    \ 'lastContact'},\n                        { to: 'LastExternalIpAddress', from:\
    \ 'lastExternalIpAddress'},\n                        { to: 'AvStatus', from: 'avStatus'},\n\
    \                        { to: 'RegisteredTime', from: 'registeredTime'},\n  \
    \                      { to: 'TargetPriorityType', from: 'targetPriorityType'},\n\
    \                        { to: 'OrganizationId', from: 'organizationId'},\n  \
    \                      { to: 'DeviceOwnerId', from: 'deviceOwnerId'},\n      \
    \                  { to: 'Email', from: 'email'},\n                        { to:\
    \ 'SensorVersion', from: 'sensorVersion'},\n                        { to: 'Status',\
    \ from: 'status'},\n                        { to: 'TestId', from: 'testId'},\n\
    \                        { to: 'DeviceId', from: 'deviceId'},\n              \
    \          { to: 'SensorStates', from: 'sensorStates'},\n                    \
    \    { to: 'PolicyName', from: 'policyName'},\n                        { to: 'SensorOutOfDate',\
    \ from: 'sensorOutOfDate'},\n                        { to: 'LastLocation', from:\
    \ 'lastLocation'},\n                        { to: 'DeviceType', from: 'deviceType'},\n\
    \                        { to: 'OsVersion', from: 'osVersion'},\n            \
    \            { to: 'LastInternalIpAddress', from: 'lastInternalIpAddress'},\n\
    \                        { to: 'OrganizationName', from: 'organizationName'}\n\
    \                    ]\n                }\n                ]\n        },\n   \
    \     'cbd-find-events': {\n            path: 'event',\n            method: 'GET',\n\
    \            queryParams: {\n                start: true,\n                rows:\
    \ true,\n                hostName: true,\n                hostNameExact: true,\n\
    \                ownerName: true,\n                ownerNameExact: true,\n   \
    \             ipAddress: true,\n                sha256Hash: true,\n          \
    \      applicationName: true,\n                eventType: true,\n            \
    \    searchWindow: true\n            },\n            extended: true,\n       \
    \     translator: [\n                {\n                    contextPath: 'CarbonBlackDefense.FindEvents.Results(val.EventId==obj.EventId)',\n\
    \                    innerPath: 'results',\n                    title: 'Carbon\
    \ Black Defense Find Events',\n                    data: [\n                 \
    \       { to: 'EventTime', from: 'eventTime'},\n                        { to:\
    \ 'LongDescription', from: 'longDescription'},\n                        { to:\
    \ 'EventId', from: 'eventId'},\n                        { to: 'EventType', from:\
    \ 'eventType'},\n                        { to: 'SelectedApp.EffectiveReputationSource',\
    \ from: 'selectedApp.effectiveReputationSource'},\n                        { to:\
    \ 'SelectedApp.ReputationProperty', from: 'selectedApp.reputationProperty'},\n\
    \                        { to: 'SelectedApp.Sha256Hash', from: 'selectedApp.sha256Hash'},\n\
    \                        { to: 'SelectedApp.ApplicationName', from: 'selectedApp.applicationName'},\n\
    \                        { to: 'SelectedApp.ApplicationPath', from: 'selectedApp.applicationPath'},\n\
    \                        { to: 'SelectedApp.EffectiveReputation', from: 'selectedApp.effectiveReputation'},\n\
    \                        { to: 'SelectedApp.Md5Hash', from: 'selectedApp.md5Hash'},\n\
    \                        { to: 'ProcessDetails.UserName', from: 'processDetails.userName'},\n\
    \                        { to: 'ProcessDetails.MilisSinceProcessStart', from:\
    \ 'processDetails.milisSinceProcessStart'},\n                        { to: 'ProcessDetails.Name',\
    \ from: 'processDetails.name'},\n                        { to: 'ProcessDetails.TargetCommandLine',\
    \ from: 'processDetails.targetCommandLine'},\n                        { to: 'ProcessDetails.TargetName',\
    \ from: 'processDetails.targetName'},\n                        { to: 'ProcessDetails.TargetPid',\
    \ from: 'processDetails.targetPid'},\n                        { to: 'ProcessDetails.FullUserName',\
    \ from: 'processDetails.fullUserName'},\n                        { to: 'ProcessDetails.TargetPrivatePid',\
    \ from: 'processDetails.targetPrivatePid'},\n                        { to: 'ProcessDetails.CommandLine',\
    \ from: 'processDetails.commandLine'},\n                        { to: 'ProcessDetails.PrivatePid',\
    \ from: 'processDetails.privatePid'},\n                        { to: 'ProcessDetails.ProcessId',\
    \ from: 'processDetails.processId'},\n                        { to: 'CreateTime',\
    \ from: 'createTime'},\n                        { to: 'DeviceDetails.Email', from:\
    \ 'deviceDetails.email'},\n                        { to: 'DeviceDetails.DeviceLocation.Region',\
    \ from: 'deviceDetails.deviceLocation.region'},\n                        { to:\
    \ 'DeviceDetails.DeviceLocation.City', from: 'deviceDetails.deviceLocation.city'},\n\
    \                        { to: 'DeviceDetails.DeviceLocation.Latitude', from:\
    \ 'deviceDetails.deviceLocation.latitude'},\n                        { to: 'DeviceDetails.DeviceLocation.CountryCode',\
    \ from: 'deviceDetails.deviceLocation.countryCode'},\n                       \
    \ { to: 'DeviceDetails.DeviceLocation.CountryName', from: 'deviceDetails.deviceLocation.countryName'},\n\
    \                        { to: 'DeviceDetails.DeviceLocation.Longitude', from:\
    \ 'deviceDetails.deviceLocation.longitude'},\n                        { to: 'DeviceDetails.DeviceType',\
    \ from: 'deviceDetails.deviceType'},\n                        { to: 'DeviceDetails.TargetPriorityType',\
    \ from: 'deviceDetails.targetPriorityType'},\n                        { to: 'DeviceDetails.PolicyName',\
    \ from: 'deviceDetails.policyName'},\n                        { to: 'DeviceDetails.DeviceId',\
    \ from: 'deviceDetails.deviceId'},\n                        { to: 'DeviceDetails.DeviceIpAddress',\
    \ from: 'deviceDetails.deviceIpAddress'},\n                        { to: 'DeviceDetails.DeviceIpV4Address',\
    \ from: 'deviceDetails.deviceIpV4Address'},\n                        { to: 'DeviceDetails.DeviceVersion',\
    \ from: 'deviceDetails.deviceVersion'},\n                        { to: 'DeviceDetails.AgentLocation',\
    \ from: 'deviceDetails.agentLocation'},\n                        { to: 'DeviceDetails.DeviceName',\
    \ from: 'deviceDetails.deviceName'},\n                        { to: 'DeviceDetails.TargetPriorityCode',\
    \ from: 'deviceDetails.targetPriorityCode'},\n                        { to: 'ShortDescription',\
    \ from: 'shortDescription'},\n                        { to: 'TargetApp.EffectiveReputation',\
    \ from: 'targetApp.effectiveReputation'},\n                        { to: 'TargetApp.ReputationProperty',\
    \ from: 'targetApp.reputationProperty'},\n                        { to: 'TargetApp.Sha256Hash',\
    \ from: 'targetApp.sha256Hash'},\n                        { to: 'TargetApp.ApplicationName',\
    \ from: 'targetApp.applicationName'},\n                        { to: 'TargetApp.EffectiveReputationSource',\
    \ from: 'targetApp.effectiveReputationSource'}\n                    ],\n     \
    \               contextTranslator : [\n                        {\n           \
    \                 contextPath: 'Endpoint(val.Hostname==obj.Hostname)',\n     \
    \                       innerPath: 'results',\n                            data:\
    \ [\n                                {to: 'Hostname', from: 'deviceDetails.deviceName'},\n\
    \                                {to: 'Domain', from: 'deviceDetails.deviceHostName'},\n\
    \                                {to: 'OS', from: 'deviceDetails.deviceType'},\n\
    \                                {to: 'IPAddress', from: 'deviceDetails.deviceIpV4Address'},\n\
    \                            ]\n                        },\n                 \
    \       {\n                            contextPath: 'Process(val.PID==obj.PID)',\n\
    \                            innerPath: 'results',\n                         \
    \   data: [\n                                {to: 'PID', from: 'processDetails.processId'},\n\
    \                                {to: 'Name', from: 'processDetails.name'},\n\
    \                                {to: 'Endpoint', from: 'processDetails.deviceName'},\n\
    \                                {to: 'CommandLine', from: 'processDetails.commandLine'},\n\
    \                                {to: 'MD5', from: 'processDetails.md5Hash'},\n\
    \                                {to: 'SHA1', from: 'processDetails.sha256Hash'},\n\
    \                                {to: 'Path', from: 'processDetails.applicationPath'},\n\
    \                                {to: 'ParentName', from: 'processDetails.parentName'},\n\
    \                                {to: 'ParentID', from: 'processDetails.parentPid'}\n\
    \                            ]\n                        }\n                  \
    \  ]\n                },\n                {\n                    contextPath:\
    \ 'CarbonBlackDefense.FindEvents.TotalResults(val.TotalResults==obj.TotalResults)',\n\
    \                    title: 'Carbon Black Defense Find Events - Total Results',\n\
    \                    data: [{to:'TotalResults', from: 'totalResults'}]\n     \
    \           }\n            ]\n        },\n        'cbd-find-event': {\n      \
    \      path: 'event/%eventId%',\n            method: 'GET',\n            extended:\
    \ true,\n            translator: [\n                {\n                    contextPath:\
    \ 'CarbonBlackDefense.FindEvent.EventInfo(val.EventId==obj.EventId)',\n      \
    \              innerPath: 'eventInfo',\n                    title: 'Carbon Black\
    \ Defense Find Events',\n                    data: [\n                      {\
    \ to: 'ShortDescription', from: 'shortDescription'},\n                      {\
    \ to: 'TargetHash.ApplicationName', from: 'targetHash.applicationName'},\n   \
    \                   { to: 'TargetHash.ReputationProperty', from: 'targetHash.reputationProperty'},\n\
    \                      { to: 'TargetHash.Sha256Hash', from: 'targetHash.sha256Hash'},\n\
    \                      { to: 'EventType', from: 'eventType'},\n              \
    \        { to: 'ProcessHash.Md5Hash', from: 'processHash.md5Hash'},\n        \
    \              { to: 'ProcessHash.Sha256Hash', from: 'processHash.sha256Hash'},\n\
    \                      { to: 'ProcessHash.ApplicationPath', from: 'processHash.applicationPath'},\n\
    \                      { to: 'ProcessHash.ReputationProperty', from: 'processHash.reputationProperty'},\n\
    \                      { to: 'ProcessHash.ApplicationName', from: 'processHash.applicationName'},\n\
    \                      { to: 'OrgDetails.OrganizationId', from: 'orgDetails.organizationId'},\n\
    \                      { to: 'OrgDetails.OrganizationName', from: 'orgDetails.organizationName'},\n\
    \                      { to: 'OrgDetails.OrganizationType', from: 'orgDetails.organizationType'},\n\
    \                      { to: 'ParentHash.ApplicationName', from: 'parentHash.applicationName'},\n\
    \                      { to: 'ParentHash.Sha256Hash', from: 'parentHash.sha256Hash'},\n\
    \                      { to: 'ThreatIndicators', from: 'threatIndicators'},\n\
    \                      { to: 'EventId', from: 'eventId'},\n                  \
    \    { to: 'LongDescription', from: 'longDescription'},\n                    \
    \  { to: 'DeviceDetails.DeviceIpV4Address', from: 'deviceDetails.deviceIpV4Address'},\n\
    \                      { to: 'DeviceDetails.DeviceType', from: 'deviceDetails.deviceType'},\n\
    \                      { to: 'DeviceDetails.Email', from: 'deviceDetails.email'},\n\
    \                      { to: 'DeviceDetails.TargetPriorityCode', from: 'deviceDetails.targetPriorityCode'},\n\
    \                      { to: 'DeviceDetails.AgentLocation', from: 'deviceDetails.agentLocation'},\n\
    \                      { to: 'DeviceDetails.DeviceHostName', from: 'deviceDetails.deviceHostName'},\n\
    \                      { to: 'DeviceDetails.DeviceId', from: 'deviceDetails.deviceId'},\n\
    \                      { to: 'DeviceDetails.GroupName', from: 'deviceDetails.groupName'},\n\
    \                      { to: 'DeviceDetails.DeviceVersion', from: 'deviceDetails.deviceVersion'},\n\
    \                      { to: 'DeviceDetails.TargetPriorityType', from: 'deviceDetails.targetPriorityType'},\n\
    \                      { to: 'DeviceDetails.DeviceIpAddress', from: 'deviceDetails.deviceIpAddress'},\n\
    \                      { to: 'DeviceDetails.DeviceLocation.Latitude', from: 'deviceDetails.deviceLocation.latitude'},\n\
    \                      { to: 'DeviceDetails.DeviceLocation.City', from: 'deviceDetails.deviceLocation.city'},\n\
    \                      { to: 'DeviceDetails.DeviceLocation.CountryCode', from:\
    \ 'deviceDetails.deviceLocation.countryCode'},\n                      { to: 'DeviceDetails.DeviceLocation.DmaCode',\
    \ from: 'deviceDetails.deviceLocation.dmaCode'},\n                      { to:\
    \ 'DeviceDetails.DeviceLocation.Longitude', from: 'deviceDetails.deviceLocation.longitude'},\n\
    \                      { to: 'DeviceDetails.DeviceLocation.MetroCode', from: 'deviceDetails.deviceLocation.metroCode'},\n\
    \                      { to: 'DeviceDetails.DeviceLocation.PostalCode', from:\
    \ 'deviceDetails.deviceLocation.postalCode'},\n                      { to: 'DeviceDetails.DeviceLocation.Region',\
    \ from: 'deviceDetails.deviceLocation.region'},\n                      { to: 'DeviceDetails.DeviceLocation.AreaCode',\
    \ from: 'deviceDetails.deviceLocation.areaCode'},\n                      { to:\
    \ 'DeviceDetails.DeviceLocation.CountryName', from: 'deviceDetails.deviceLocation.countryName'},\n\
    \                      { to: 'DeviceDetails.DeviceName', from: 'deviceDetails.deviceName'},\n\
    \                      { to: 'CreateTime', from: 'createTime'},\n            \
    \          { to: 'EventTime', from: 'eventTime'},\n                      { to:\
    \ 'ProcessDetails.FullUserName', from: 'processDetails.fullUserName'},\n     \
    \                 { to: 'ProcessDetails.Name', from: 'processDetails.name'},\n\
    \                      { to: 'ProcessDetails.ParentCommandLine', from: 'processDetails.parentCommandLine'},\n\
    \                      { to: 'ProcessDetails.ParentName', from: 'processDetails.parentName'},\n\
    \                      { to: 'ProcessDetails.ParentPid', from: 'processDetails.parentPid'},\n\
    \                      { to: 'ProcessDetails.ProcessId', from: 'processDetails.processId'},\n\
    \                      { to: 'ProcessDetails.CommandLine', from: 'processDetails.commandLine'},\n\
    \                      { to: 'ProcessDetails.MilisSinceProcessStart', from: 'processDetails.milisSinceProcessStart'},\n\
    \                      { to: 'ProcessDetails.TargetCommandLine', from: 'processDetails.targetCommandLine'},\n\
    \                      { to: 'ProcessDetails.TargetPid', from: 'processDetails.targetPid'},\n\
    \                      { to: 'ProcessDetails.UserName', from: 'processDetails.userName'},\n\
    \                      { to: 'ProcessDetails.ParentPrivatePid', from: 'processDetails.parentPrivatePid'},\n\
    \                      { to: 'ProcessDetails.PrivatePid', from: 'processDetails.privatePid'},\n\
    \                      { to: 'ProcessDetails.TargetName', from: 'processDetails.targetName'},\n\
    \                      { to: 'ProcessDetails.TargetPrivatePid', from: 'processDetails.targetPrivatePid'}\n\
    \                    ],\n                    contextTranslator: [\n          \
    \              {\n                            contextPath: 'Endpoint',\n     \
    \                       innerPath: 'deviceDetails',\n                        \
    \    data: [\n                                {to: 'Hostname', from: 'deviceName'},\n\
    \                                {to: 'Domain', from: 'deviceHostName'},\n   \
    \                             {to: 'OS', from: 'deviceType'},\n              \
    \                  {to: 'IPAddress', from: 'deviceIpV4Address'},\n           \
    \                 ]\n                        },\n                        {\n \
    \                           contextPath: 'Process',\n                        \
    \    innerPath: 'processDetails',\n                            data: [\n     \
    \                           {to: 'PID', from: 'processId'},\n                \
    \                {to: 'Name', from: 'name'},\n                               \
    \ {to: 'Endpoint', from: 'deviceName'},\n                                {to:\
    \ 'CommandLine', from: 'commandLine'},\n                                {to: 'MD5',\
    \ from: 'md5Hash'},\n                                {to: 'SHA1', from: 'sha256Hash'},\n\
    \                                {to: 'Path', from: 'applicationPath'},\n    \
    \                            {to: 'ParentName', from: 'parentName'},\n       \
    \                         {to: 'ParentID', from: 'parentPid'}\n              \
    \              ]\n                        }\n                    ]\n         \
    \       }\n            ]\n        },\n        'cbd-find-processes': {\n      \
    \      path: 'process',\n            method: 'GET',\n            queryParams:\
    \ {\n                start: true,\n                rows: true,\n             \
    \   hostNameExact: true,\n                ownerName: true,\n                ownerNameExact:\
    \ true,\n                ipAddress: true,\n                searchWindow: true\n\
    \            },\n            extended: true,\n            translator: [\n    \
    \            {\n                    title: 'Carbon Black Defense Get Processes.Results',\n\
    \                    contextPath:'CarbonBlackDefense.GetProcesses(val.ProcessId==obj.ProcessId)',\n\
    \                    innerPath: 'results',\n                    data: [\n    \
    \                    {to: 'ApplicationName',from: 'applicationName'},\n      \
    \                  {to: 'ProcessId', from: 'processId'},\n                   \
    \     {to: 'NumEvents', from: 'numEvents'},\n                        {to: 'ApplicationPath',\
    \ from: 'applicationPath'},\n                        {to: 'PrivatePid', from:\
    \  'privatePid'},\n                        {to: 'Sha256Hash', from: 'sha256Hash'}\n\
    \                    ]\n                },\n                {\n              \
    \      title: 'Carbon Black Defense Get Processes - Total Results',\n        \
    \            contextPath:'CarbonBlackDefense.GetProcesses',\n                \
    \    data: [{to: 'TotalResults',from: 'totalResults'}],\n                }\n \
    \           ]\n        },\n        'cbd-get-alert-details': {\n            path:\
    \ 'alert/%alertId%',\n            method: 'GET',\n            extended: true,\n\
    \            translator : [\n                {\n                    contextPath:\
    \ 'CarbonBlackDefense.GetAlertDetails.DeviceInfo(val.DeviceId==obj.DeviceId)',\n\
    \                    title: 'Carbon Black Defense Get Alert Details',\n      \
    \              data: [\n                        { to: 'DeviceInfo.DeviceType',\
    \ from: 'deviceInfo.deviceType'},\n                        { to: 'DeviceInfo.Group',\
    \ from: 'deviceInfo.adGroupName'},\n                        { to: 'DeviceInfo.GroupId',\
    \ from: 'deviceInfo.adGroupId'},\n                        { to: 'DeviceInfo.RegisteredTime',\
    \ from: 'deviceInfo.registeredTime'},\n                        { to: 'DeviceInfo.DeviceId',\
    \ from: 'deviceInfo.deviceId'},\n                        { to: 'DeviceInfo.DeviceName',\
    \ from: 'deviceInfo.deviceName'},\n                        { to: 'DeviceInfo.Status',\
    \ from: 'deviceInfo.status'},\n                        { to: 'DeviceInfo.OsVersion',\
    \ from: 'deviceInfo.osVersion'},\n                        { to: 'DeviceInfo.SensorVersion',\
    \ from: 'deviceInfo.sensorVersion'},\n                        { to: 'DeviceInfo.UserName',\
    \ from: 'deviceInfo.userName'},\n                        { to: 'DeviceInfo.Importance',\
    \ from: 'deviceInfo.importance'},\n                        { to: 'DeviceInfo.Message',\
    \ from: 'deviceInfo.message'},\n                        { to: 'DeviceInfo.Success',\
    \ from: 'deviceInfo.success'},\n                        { to: 'Events.ParentHash',\
    \ from: 'events.parentHash'},\n                        { to: 'Events.PolicyState',\
    \ from: 'events.policyState'},\n                        { to: 'Events.LongDescription',\
    \ from: 'events.longDescription'},\n                        { to: 'Events.CommandLine',\
    \ from: 'events.commandLine'},\n                        { to: 'Events.ParentPid',\
    \ from: 'events.parentPid'},\n                        { to: 'Events.ProcessId',\
    \ from: 'events.processId'},\n                        { to: 'Events.ThreatIndicators',\
    \ from: 'events.threatIndicators'},\n                        { to: 'Events.ApplicationPath',\
    \ from: 'events.applicationPath'},\n                        { to: 'Events.ProcessHash',\
    \ from: 'events.processHash'},\n                        { to: 'Events.ProcessMd5Hash',\
    \ from: 'events.processMd5Hash'},\n                        { to: 'Events.EventId',\
    \ from: 'events.eventId'},\n                        { to: 'Events.EventTime',\
    \ from: 'events.eventTime'},\n                        { to: 'Events.EventType',\
    \ from: 'events.eventType'},\n                        { to: 'Events.KillChainStatus',\
    \ from: 'events.killChainStatus'},\n                        { to: 'Events.ParentName',\
    \ from: 'events.parentName'},\n                        { to: 'Events.ParentPPid',\
    \ from: 'events.parentPPid'},\n                        { to: 'Events.ProcessPPid',\
    \ from: 'events.processPPid'},\n                        { to: 'OrgId', from: 'orgId'},\n\
    \                        { to: 'ThreatInfo.IncidentId', from: 'threatInfo.incidentId'},\n\
    \                        { to: 'ThreatInfo.Indicators.ApplicationName', from:\
    \ 'threatInfo.indicators.applicationName'},\n                        { to: 'ThreatInfo.Indicators.IndicatorName',\
    \ from: 'threatInfo.indicators.indicatorName'},\n                        { to:\
    \ 'ThreatInfo.Indicators.Sha256Hash', from: 'threatInfo.indicators.sha256Hash'},\n\
    \                        { to: 'ThreatInfo.Summary', from: 'threatInfo.summary'},\n\
    \                        { to: 'ThreatInfo.ThreatId', from: 'threatInfo.threatId'},\n\
    \                        { to: 'ThreatInfo.ThreatScore', from: 'threatInfo.threatScore'},\n\
    \                        { to: 'ThreatInfo.Time', from: 'threatInfo.time'}\n \
    \                   ],\n                    contextTranslator: [\n           \
    \             {\n                            contextPath: 'Endpoint(val.deviceName==obj.deviceName)',\n\
    \                            innerPath: 'deviceInfo',\n                      \
    \      data: [\n                                {to: 'Hostname', from: 'deviceName'},\n\
    \                                {to: 'OS', from: 'deviceType'}\n            \
    \                ]\n                        },\n                        {\n  \
    \                          contextPath: 'Process(val.processId==obj.processId)',\n\
    \                            innerPath: 'events',\n                          \
    \  data: [\n                                {to: 'PID', from: 'processId'},\n\
    \                                {to: 'CommandLine', from: 'commandLine'},\n \
    \                               {to: 'MD5', from: 'processMd5Hash'},\n       \
    \                         {to: 'Path', from: 'applicationPath'},\n           \
    \                     {to: 'ParentName', from: 'parentName'},\n              \
    \                  {to: 'ParentID', from: 'parentPid'}\n                     \
    \       ]\n                        },\n                        {\n           \
    \                 contextPath: 'Process(val.deviceName==obj.deviceName)',\n  \
    \                          innerPath: 'deviceInfo',\n                        \
    \    data: [{to: 'Endpoint', from: 'deviceName'}]\n                        },\n\
    \                        {\n                            contextPath: 'Account(val.Email==obj.Email)',\n\
    \                            innerPath: 'deviceInfo',\n                      \
    \      data: [\n                                {to: 'Email', from: 'userName'},\n\
    \                                {to: 'Groups', from: 'group'}\n             \
    \               ]\n                        }\n                    ]\n        \
    \        }\n            ]\n        },\n        \"cbd-get-notifications\": {\n\
    \            path: 'notification',\n            method: 'GET',\n            siemKey:\
    \ true\n        },\n        'cbd-get-policies': {\n            path: 'policy',\n\
    \            method: 'GET',\n            queryParams: {\n                start:\
    \ true,\n                rows: true\n            },\n            extended: true,\n\
    \            translator : [\n                {\n                    title: 'Carbon\
    \ Black Defense Get Policies',\n                    contextPath: 'CarbonBlackDefense.GetPolicies(val.Id==obj.Id)',\n\
    \                    innerPath: 'results',\n                    data: policyData\n\
    \                }\n            ]\n        },\n        'cbd-get-policy': {\n \
    \           path: 'policy/%policyId%',\n            method: 'GET',\n         \
    \   extended: true,\n            translator: [\n                {\n          \
    \          title: 'Carbon Black Defense Get Policy',\n                    contextPath:\
    \ 'CarbonBlackDefense.GetPolicy(val.Id==obj.Id)',\n                    innerPath:\
    \ 'policyInfo',\n                    data: policyData\n                }\n   \
    \         ]\n        },\n        'cbd-create-policy': {\n            path: 'policy',\n\
    \            method: 'POST',\n            content: {\n                'policyInfo'\
    \ : {\n                    'description': null,\n                    'name': null,\n\
    \                    'version': 2,\n                    'priorityLevel': null,\n\
    \                    'policy': null\n                }\n            },\n     \
    \       extended: true,\n            translator: [\n                {\n      \
    \              title: 'Carbon Black Defense Create New Policy',\n            \
    \        contextPath:'CarbonBlackDefense.CreatePolicy(val.PolicyId==obj.PolicyId)',\n\
    \                    data:[{to: 'PolicyId', from: 'policyId'}]\n             \
    \   }\n            ]\n        },\n        'cbd-update-policy': {\n           \
    \ path: 'policy/%id%',\n            method: 'PUT',\n            content: {\n \
    \               'policyInfo' : {\n                    'description': null,\n \
    \                   'name': null,\n                    'version': 2,\n       \
    \             'priorityLevel': null,\n                    'policy': null,\n  \
    \                  'id': null\n                }\n            }\n        },\n\
    \        'cbd-delete-policy': {\n            path: 'policy/%policyId%',\n    \
    \        method: 'DELETE'\n        },\n        'cbd-add-rule-to-policy': {\n \
    \           path: 'policy/%policyId%/rule',\n            method: 'POST',\n   \
    \         content: {\n                'ruleInfo': {\n                    'action':\
    \ null,\n                    'application': {\n                        'type':\
    \ null,\n                        'value': null\n                    },\n     \
    \               'operation': null,\n                    'required': null,\n  \
    \                  'id': null\n                }\n            }\n        },\n\
    \        'cbd-delete-rule-from-policy': {\n            path: 'policy/%policyId%/rule/%ruleId%',\n\
    \            method: 'DELETE'\n        },\n        'cbd-update-rule-in-policy':\
    \ {\n            path: 'policy/%policyId%/rule/%id%',\n            method: 'PUT',\n\
    \            content: {\n                'ruleInfo': {\n                    'action':\
    \ null,\n                    'application': {\n                        'type':\
    \ null,\n                        'value': null\n                    },\n     \
    \               'operation': null,\n                    'required': null,\n  \
    \                  'id': null\n                    }\n                }\n    \
    \        }\n    };\n    //Taken from common server- with modifications\n    var\
    \ createEntry = function(result, translator, headerTransform) {\n        /* filters\
    \ out all fields where humanReadable is false */\n        var filter = function(obj)\
    \ {\n          if(obj.humanReadable !== false) {\n              return true;\n\
    \          }\n          return false;\n        };\n        var entry = {\n   \
    \       Type: entryTypes.note,\n          Contents: result,\n          ContentsType:\
    \ formats.json,\n          ReadableContentsFormat: formats.markdown,\n       \
    \   EntryContext: {}\n        };\n        var content = translator.innerPath ?\
    \ dq(result, translator.innerPath) : result;\n        var translatedContext =\
    \ mapObjFunction(translator.data) (content);\n        var translatedMD = mapObjFunction(translator.data,\
    \ filter) (content);\n        var context = createContext(translatedContext);\n\
    \        entry.EntryContext[translator.contextPath] = context;\n        entry.HumanReadable\
    \ = tableToMarkdown(translator.title, translatedMD, undefined, undefined, headerTransform\
    \ || dotToSpace);\n        if (translator.contextTranslator) {\n            var\
    \ conTranslator = translator.contextTranslator;\n            for (var i = 0; i\
    \ < conTranslator.length; i++ ) {\n                addContextToEntry(result, entry,\
    \ conTranslator[i]);\n            }\n        }\n        return entry;\n    };\n\
    \    function addContextToEntry(result, entry, translator) {\n        var content\
    \ = translator.innerPath ? dq(result, translator.innerPath) : result;\n      \
    \  var translatedContext = mapObjFunction(translator.data) (content);\n      \
    \  var context = createContext(translatedContext);\n        entry.EntryContext[translator.contextPath]\
    \ = context;\n    }\n    var generateQuery = function(cmd) {\n        var seperateQueryParams\
    \ = (function() {\n            var seperated = {};\n            if (cmd.queryParams)\
    \ {\n                for (var arg in args) {\n                    if (cmd.queryParams[arg])\
    \ {\n                       seperated[arg] = args[arg];\n                    }\n\
    \                }\n            }\n            return seperated;\n        })();\n\
    \        var queryString = (function() {\n            return encodeToURLQuery(seperateQueryParams);\n\
    \        })();\n        return {\n            str: queryString,\n            parameters:\
    \ seperateQueryParams\n        };\n    };\n    function sendRequest(fullurl, method,\
    \ headers, body) {\n        var req = {\n                Method: method,\n   \
    \             Headers: headers\n            };\n        if (body !== 'undifiend')\
    \ {\n            req.Body = body;\n        }\n        var res = http(fullurl,\
    \ req, params.insecure, params.proxy);\n        return res;\n    }\n    function\
    \ pathify(cmd) {\n        return replaceInTemplates(cmd.path,args);\n    }\n \
    \   function buildBody(cmd) {\n        content = cmd.content;\n        assignContentFromArgs(content);\n\
    \        return JSON.stringify(content);\n    }\n    function assignContentFromArgs(obj)\
    \ {\n        for (var key in obj) {\n            if (obj[key] === null) {\n  \
    \              if (args[key]) {\n                    if (args[key] === 'true'\
    \ || args[key] === 'false') {\n                        obj[key] = (args[key] ===\
    \ 'true');\n                    } else if (!isNaN(args[key])) {\n            \
    \            obj[key] = parseInt(args[key]);\n                    }\n        \
    \            else {\n                        obj[key] = args[key];\n         \
    \           }\n                }\n            } else if(typeof obj[key] === 'object'\
    \ ) {\n                assignContentFromArgs(obj[key]);\n            }\n     \
    \   }\n    }\n    var setPolicy = function() {\n        var setter;\n        var\
    \ policy = args.policy;\n        try {\n            setter = JSON.parse(args.keyValue);\n\
    \        } catch(err) {\n            throw err;\n        }\n        for (var path\
    \ in setter) {\n            var val = setter[path];\n            var keysArr =\
    \ path.split('.');\n            var obj = policy;\n            var i = 0;\n  \
    \          while (obj && i < keysArr.length - 1) {\n                obj = obj[keysArr[i]];\n\
    \                i++;\n            }\n            if (!(obj && obj[keysArr[i]]))\
    \ {\n                throw 'field path ' + path + ' is not defined in the policy\
    \ object';\n            }\n            obj[keysArr[i]] = val;\n        }\n   \
    \     return {\n            Type: entryTypes.note,\n            Contents: policy,\n\
    \            ContentsFormat: formats.json,\n            EntryContext : {'CarbonBlackDefense.SetPolicy.Policy':\
    \ policy }\n        };\n    };\n    function executeCommand(cmd) {\n        var\
    \ query = generateQuery(cmd);\n        var uniquePath = pathify(cmd);\n      \
    \  var url = client.url + uniquePath + query.str;\n        var headers = {};\n\
    \        var body;\n        if (cmd.content) {\n            body = buildBody(cmd);\n\
    \        }\n        headers = {\n            'Content-Type': ['application/json'],\n\
    \            'Accept': ['application/json']\n        };\n        if (cmd.siemKey)\
    \ {\n            client.addSiemKeyToHeaders(headers);\n        } else {\n    \
    \        client.addClientAuthToHeaders(headers);\n        }\n        var res =\
    \ sendRequest(url, cmd.method, headers, body);\n        return res;\n    }\n \
    \   var executeAndShowResult = function (cmdName) {\n        var cmd = commands[cmdName];\n\
    \        var res = executeCommand(cmd);\n        var body = parseBody(res);\n\
    \        if (!cmd.extended) {\n            return {\n                Type: entryTypes.note,\n\
    \                ContentsFormat: formats.text,\n                Contents: 'Request\
    \ Success'\n            };\n        }\n        var entries = [];\n        for\
    \ (var i = 0; i < cmd.translator.length; i++) {\n            entries.push(createEntry(body,\
    \ cmd.translator[i]));\n        }\n        return entries;\n    };\n    function\
    \ parseBody(httpResponse) {\n        var body = JSON.parse(httpResponse.Body);\n\
    \        if (httpResponse.StatusCode !== 200) {\n            throw 'Request failed:\
    \ ' + httpResponse.Status + \".\\n\" + body.message\n        }\n        return\
    \ body;\n    }\n    var runTest = function() {\n        args = { rows: '0' };\n\
    \        var res = executeCommand(commands['cbd-get-devices-status']);\n     \
    \   if (res.StatusCode === 200) {\n            return 'ok';\n        }\n     \
    \   if (res.StatusCode === 401) {\n            throw 'Test failed. Make sure that\
    \ the Connector ID and API key are valid.';\n        }\n        throw 'Test failed\
    \ for unknown reason';\n    };\n    function createIncidentsFromNotification(notification)\
    \ {\n        return {\n            'name': 'event ' + notification.eventId + ',\
    \ ' + notification.eventDescription,\n            'rawJson': JSON.stringify(notification)\n\
    \        };\n    }\n    var getNotifications = function() {\n        if (!params.siemKey\
    \ || !params.siemConnector) {\n            throw 'SIEM key and SIEM connector\
    \ are mandatory parameters to fetch incidents.';\n        }\n        var res =\
    \ executeCommand(commands['cbd-get-notifications']);\n        if (res.StatusCode\
    \ !== 200 ) {\n            throw 'Request failed with status code: ' + res.StatusCode;\n\
    \        }\n        var body = JSON.parse(res.Body);\n        if (!body.notifications)\
    \ {\n            return;\n        }\n        var notifications = body.notifications;\n\
    \        var incidents = [];\n        for (var i = 0; i < notifications.length;\
    \ i++) {\n            var incident = createIncidentsFromNotification(notifications[i]);\n\
    \            incidents.push(incident);\n        }\n        return JSON.stringify(incidents);\n\
    \    };\n    return {\n        execute: executeAndShowResult,\n        runTest:\
    \ runTest,\n        getNotifications: getNotifications,\n        setPolicy: setPolicy\n\
    \    };\n};\nvar cbd = CBDefence();\nswitch (command) {\n    case 'test-module':\n\
    \        return cbd.runTest();\n    case 'fetch-incidents':\n        return cbd.getNotifications();\n\
    \    case 'cbd-set-policy':\n        return cbd.setPolicy();\n    default:\n \
    \       if (args.policy && typeof args.policy === 'string') {\n            try\
    \ {\n                var p = JSON.parse(args.policy);\n                args.policy\
    \ = p;\n            } catch (err) {\n                return \"Failed to parse\
    \ policy into a JSON object.\\n\" + err;\n            }\n        }\n        return\
    \ cbd.execute(command);\n}"
  type: javascript
tests:
- No test
toversion: 4.1.9
