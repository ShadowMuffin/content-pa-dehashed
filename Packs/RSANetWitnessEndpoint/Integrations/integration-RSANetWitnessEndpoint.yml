category: Endpoint
commonfields:
  id: RSA NetWitness Endpoint
  version: -1
configuration:
- defaultvalue: ''
  display: Server URL (e.g. https://192.168.0.1:30022)
  name: server
  required: true
  type: 0
- defaultvalue: ''
  display: Username
  name: credentials
  required: false
  type: 9
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: 'RSA NetWitness Endpoint provides deep visibility beyond basic endpoint
  security solutions by monitoring and collecting activity across all of your endpoints
  on and off your network. The RSA Demisto integration provides access to information
  about endpoints, modules and indicators. '
display: RSA NetWitness Endpoint
image: data:image/png;base64,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
name: RSA NetWitness Endpoint
script:
  commands:
  - arguments:
    - description: Hostname to filter result. Case insensitive.
      name: machineName
    - description: Filter all machines whose IOC score is greater than or equal to
        this value. Default = 0.
      name: iocScoreGreaterThan
    - description: Filter all machines whose IOC score is less than or equal to this
        value. Default = 1024. Cant be zero.
      name: iocScoreLessThan
    - description: Filter all machines based on IP address.
      name: ipAddress
    - description: Filter all machines based on MAC address.
      name: macAddress
    - defaultValue: '100'
      description: Limit the results. Default 100.
      name: limit
    - auto: PREDEFINED
      defaultValue: 'no'
      description: Include Full Machine Data
      name: includeMachineData
      predefined:
      - 'no'
      - 'yes'
    - auto: PREDEFINED
      defaultValue: 'no'
      description: Include machine IOC's
      name: includeMachineIOCs
      predefined:
      - 'yes'
      - 'no'
    - auto: PREDEFINED
      defaultValue: 'no'
      description: Include machine moduls
      name: includeMachineModules
      predefined:
      - 'yes'
      - 'no'
    description: Get machine GUID. Search by machine name and more.
    name: netwitness-get-machines
    outputs:
    - contextPath: NetWitness.Machines.MachineGUID
      description: Machine GUID
    - contextPath: NetWitness.Machines.AgentID
      description: Agent ID
    - contextPath: NetWitness.Machines.MachineName
      description: Machine Name
    - contextPath: NetWitness.Machines.LocalIP
      description: Local IP
    - contextPath: NetWitness.Machines.RemoteIP
      description: Remote IP
    - contextPath: NetWitness.Machines.MAC
      description: MAC
    - contextPath: NetWitness.Machines.MachineStatus
      description: Machine Status
    - contextPath: NetWitness.Machines.IIOCScore
      description: IIOC Score
    - contextPath: NetWitness.Machines.IIOCLevel0
      description: IIOC Level0
    - contextPath: NetWitness.Machines.IIOCLevel1
      description: IIOC Level1
    - contextPath: NetWitness.Machines.IIOCLevel2
      description: IIOC Level2
    - contextPath: NetWitness.Machine.IIOCLevel3
      description: IIOC Level3
    - contextPath: NetWitness.Machines.AntiVirusDisabled
      description: Anti Virus Disabled
    - contextPath: NetWitness.Machines.Comment
      description: Comment
    - contextPath: NetWitness.Machines.ContainmentStatus
      description: Containment Status
    - contextPath: NetWitness.Machines.ContainmentSupported
      description: Containment Supported
    - contextPath: NetWitness.Machines.Country
      description: Country
    - contextPath: NetWitness.Machines.DNS
      description: DNS
    - contextPath: NetWitness.Machines.DomainName
      description: Domain Name
    - contextPath: NetWitness.Machines.FirewallDisabled
      description: Firewall Disabled
    - contextPath: NetWitness.Machines.Gateway
      description: Gateway
    - contextPath: NetWitness.Machines.Group
      description: Group
    - contextPath: NetWitness.Machines.Idle
      description: Idle
    - contextPath: NetWitness.Machines.InstallTime
      description: Install Time
    - contextPath: NetWitness.Machines.InstallationFailed
      description: Installation Failed
    - contextPath: NetWitness.Machines.LastScan
      description: Last Scan
    - contextPath: NetWitness.Machines.LastSeen
      description: Last Seen
    - contextPath: NetWitness.Machines.NetworkSegment
      description: Network Segment
    - contextPath: NetWitness.Machines.OperatingSystem
      description: Operating System
    - contextPath: NetWitness.Machines.OrganizationUnit
      description: Organization Unit
    - contextPath: NetWitness.Machines.Platform
      description: Platform
    - contextPath: NetWitness.Machines.Scanning
      description: Scanning
    - contextPath: NetWitness.Machines.UserName
      description: User Name
    - contextPath: NetWitness.Machine.VersionInfo
      description: Version Info
    - contextPath: NetWitness.IOCs.Description
      description: Description
    - contextPath: NetWitness.IOCs.Type
      description: Type
    - contextPath: NetWitness.IOCs.MachineCount
      description: Machine Count
    - contextPath: NetWitness.IOCs.ModuleCount
      description: Module Count
    - contextPath: NetWitness.IOCs.IOCLevel
      description: IOC Level
    - contextPath: NetWitness.IOCs.Priority
      description: Priority
    - contextPath: NetWitness.IOCs.Active
      description: Active
    - contextPath: NetWitness.IOCs.LastExecuted
      description: Last Executed
    - contextPath: NetWitness.IOCs.Alertable
      description: Alertable
    - contextPath: NetWitness.IOCs.IOCTriggeredOnMachine
      description: IOC Triggered On Machine
    - contextPath: NetWitness.Machines.MachineGUID
      description: Machine GUID
    - contextPath: NetWitness.Modules.ModuleName
      description: Module Name
    - contextPath: NetWitness.Modules.ModuleID
      description: Module ID
    - contextPath: NetWitness.Modules.Description
      description: Description
    - contextPath: NetWitness.Modules.IOCScore
      description: IOC Score
    - contextPath: NetWitness.Modules.AnalyticsScore
      description: Analytics Score
    - contextPath: NetWitness.Modules.GlobalMachineCount
      description: Global Machine Count
    - contextPath: NetWitness.Modules.MD5
      description: MD5
    - contextPath: NetWitness.Modules.SHA256
      description: SHA256
  - arguments:
    - default: true
      description: The machine GUID.
      name: machineGUID
      required: true
    description: Get information on a specific machine.
    name: netwitness-get-machine
    outputs:
    - contextPath: NetWitness.Machines.AgentID
      description: Agent ID
    - contextPath: NetWitness.Machines.MachineName
      description: Machine Name
    - contextPath: NetWitness.Machines.LocalIP
      description: Local IP
    - contextPath: NetWitness.Machines.RemoteIP
      description: Remote IP
    - contextPath: NetWitness.Machines.MAC
      description: MAC
    - contextPath: NetWitness.Machines.MachineStatus
      description: Machine Status
    - contextPath: NetWitness.Machines.IIOCScore
      description: IIOC Score
    - contextPath: NetWitness.Machines.IIOCLevel0
      description: IIOC Level0
    - contextPath: NetWitness.Machines.IIOCLevel1
      description: IIOC Level1
    - contextPath: NetWitness.Machines.IIOCLevel2
      description: IIOC Level2
    - contextPath: NetWitness.Machine.IIOCLevel3
      description: IIOC Level3
    - contextPath: NetWitness.Machines.AntiVirusDisabled
      description: Anti Virus Disabled
    - contextPath: NetWitness.Machines.Comment
      description: Comment
    - contextPath: NetWitness.Machines.ContainmentStatus
      description: Containment Status
    - contextPath: NetWitness.Machines.ContainmentSupported
      description: Containment Supported
    - contextPath: NetWitness.Machines.Country
      description: Country
    - contextPath: NetWitness.Machines.DNS
      description: DNS
    - contextPath: NetWitness.Machines.DomainName
      description: Domain Name
    - contextPath: NetWitness.Machines.FirewallDisabled
      description: Firewall Disabled
    - contextPath: NetWitness.Machines.Gateway
      description: Gateway
    - contextPath: NetWitness.Machines.Group
      description: Group
    - contextPath: NetWitness.Machines.Idle
      description: Idle
    - contextPath: NetWitness.Machines.InstallTime
      description: Install Time
    - contextPath: NetWitness.Machines.InstallationFailed
      description: Installation Failed
    - contextPath: NetWitness.Machines.LastScan
      description: Last Scan
    - contextPath: NetWitness.Machines.LastSeen
      description: Last Seen
    - contextPath: NetWitness.Machines.NetworkSegment
      description: Network Segment
    - contextPath: NetWitness.Machines.OperatingSystem
      description: Operating System
    - contextPath: NetWitness.Machines.OrganizationUnit
      description: Organization Unit
    - contextPath: NetWitness.Machines.Platform
      description: Platform
    - contextPath: NetWitness.Machines.Scanning
      description: Scanning
    - contextPath: NetWitness.Machines.UserName
      description: User Name
    - contextPath: NetWitness.Machine.VersionInfo
      description: Version Info
  - arguments:
    - default: true
      description: The machine GUID
      name: machineGUID
      required: true
    - defaultValue: '100'
      description: Limit the results. Default 100.
      name: limit
    description: List IOC's for a specific machine.
    name: netwitness-get-machine-iocs
    outputs:
    - contextPath: NetWitness.Machines.MachineGUID
      description: Machine GUID
    - contextPath: NetWitness.IOCs.Description
      description: Description
    - contextPath: NetWitness.IOCs.Type
      description: Type
    - contextPath: NetWitness.IOCs.MachineCount
      description: Machine Count
    - contextPath: NetWitness.IOCs.ModuleCount
      description: Module Count
    - contextPath: NetWitness.IOCs.IOCLevel
      description: IOC Level
    - contextPath: NetWitness.IOCs.Priority
      description: Priority
    - contextPath: NetWitness.IOCs.Active
      description: Active
    - contextPath: NetWitness.IOCs.LastExecuted
      description: Last Executed
    - contextPath: NetWitness.IOCs.Alertable
      description: Alertable
    - contextPath: NetWitness.IOCs.IOCTriggeredOnMachine
      description: IOC Triggered On Machine
  - arguments:
    - description: The machine GUID
      name: machineGUID
      required: true
    - description: 'Module name to filter result. Case insesitive. Example: ModuleName=".exe
        "will match all machines which have the word ".exe" in their module name.'
      name: moduleName
    - description: "\t Filter all modules whose IOC score is greater than or equal\
        \ to this value. Default = 0."
      name: iocScoreGreaterThan
    - description: "\t Filter all modules whose IOC score is less than or equal to\
        \ this value. Default = 1024. Cant be zero."
      name: iocScoreLessThan
    - defaultValue: '50'
      description: limit the results. Default 50.
      name: limit
    description: Get Names and ID's of modules of the machine. Filter by name or IOC
      score.
    name: netwitness-get-machine-modules
    outputs:
    - contextPath: NetWitness.Machines.MachineGUID
      description: Machine GUID
    - contextPath: NetWitness.Modules.ModuleName
      description: Module Name
    - contextPath: NetWitness.Modules.ModuleID
      description: Module ID
    - contextPath: NetWitness.Modules.Description
      description: Description
    - contextPath: NetWitness.Modules.IOCScore
      description: IOC Score
    - contextPath: NetWitness.Modules.AnalyticsScore
      description: Analytics Score
    - contextPath: NetWitness.Modules.GlobalMachineCount
      description: Global Machine Count
    - contextPath: NetWitness.Modules.MD5
      description: MD5
    - contextPath: NetWitness.Modules.SHA256
      description: SHA256
  - arguments:
    - description: The machine GUID.
      name: machineGUID
      required: true
    - description: The module ID.
      name: moduleID
      required: true
    description: Get information on a specific machine module.
    name: netwitness-get-machine-module
    outputs:
    - contextPath: NetWitness.Modules.MachineGUID
      description: Machine GUID
    - contextPath: NetWitness.Modules.ModuleID
      description: Module ID
    - contextPath: NetWitness.Modules.FileName
      description: File Name
    - contextPath: NetWitness.Modules.FullPath
      description: Full Path
    - contextPath: NetWitness.Modules.MD5
      description: MD5
    - contextPath: NetWitness.Modules.RiskScore
      description: Risk Score
    - contextPath: NetWitness.Modules.SHA1
      description: SHA1
    - contextPath: NetWitness.Modules.SHA256
      description: SHA256
    - contextPath: NetWitness.Modules.IIOCScore
      description: IIOC Score
    - contextPath: NetWitness.Modules.Blacklisted
      description: Blacklisted
    - contextPath: NetWitness.Modules.Graylisted
      description: Graylisted
    - contextPath: NetWitness.Modules.Whitelisted
      description: Whitelisted
    - contextPath: NetWitness.Modules.MachineCount
      description: Machine Count
    - contextPath: NetWitness.Modules.IIOCLevel0
      description: IIOC Level0
    - contextPath: NetWitness.Modules.IIOCLevel1
      description: IIOC Level1
    - contextPath: NetWitness.Modules.IIOCLevel2
      description: IIOC Level2
    - contextPath: NetWitness.Modules.IIOCLevel3
      description: IIOC Level3
    - contextPath: NetWitness.Modules.FirstSeenName
      description: First Seen Name
    - contextPath: NetWitness.Modules.FirstSeenDate
      description: First Seen Date
    - contextPath: File.Name
      description: The file name
    - contextPath: File.MD5
      description: File MD5
    - contextPath: File.SHA1
      description: File SHA1
    - contextPath: File.Path
      description: File full path
  - arguments:
    - default: true
      description: 'Comma separated IP addresses '
      name: ips
      required: true
    description: Add a list of IP addresses to blacklist
    name: netwitness-blacklist-ips
    outputs:
    - contextPath: NetWitness.Blacklist.IPs
      description: IPs blacklisted successfully
  - arguments:
    - default: true
      description: Comma separated list of domains
      name: domains
      required: true
    description: 'Add a list of domains to blacklist '
    name: netwitness-blacklist-domains
    outputs:
    - contextPath: NetWitness.Blacklist.Domains
      description: Domains blacklisted successfully
  script: "\"\"\"\n\nIMPORTS\n\n\"\"\"\nimport requests\nimport os\nimport math\n\n\
    # disable insecure warnings\nrequests.packages.urllib3.disable_warnings()\n\n\"\
    \"\"\n\nHANDLE PROXY\n\n\"\"\"\n\n\ndef set_proxies():\n    if demisto.params()['proxy']:\n\
    \        http = os.environ['http_proxy'] or os.environ['HTTP_PROXY']\n       \
    \ https = os.environ['https_proxy'] or os.environ['HTTPS_PROXY']\n        proxies\
    \ = {\n            'http': http,\n            'https': https\n        }\n    \
    \    return proxies\n    return None\n\n\n\"\"\"\n\nGLOBAL VARS\n\n\"\"\"\n\n\
    SERVER_URL = demisto.params()['server']\nBASE_PATH = '{}/api/v2'.format(SERVER_URL)\
    \ if SERVER_URL.endswith('/') else '{}/api/v2'.format(SERVER_URL)\nUSERNAME =\
    \ demisto.params()['credentials']['identifier']\nPASSWORD = demisto.params()['credentials']['password']\n\
    USE_SSL = not demisto.params()['insecure']\nPROXIES = set_proxies()\n\nMACHINE_DATA_EXTENDED\
    \ = [\n    \"AgentID\",\n    \"MachineName\",\n    \"LocalIP\",\n    \"RemoteIP\"\
    ,\n    \"MAC\",\n    \"MachineStatus\",\n    \"IIOCScore\",\n    \"IIOCLevel0\"\
    ,\n    \"IIOCLevel1\",\n    \"IIOCLevel2\",\n    \"IIOCLevel3\",\n    \"AntiVirusDisabled\"\
    ,\n    \"Comment\",\n    \"ContainmentStatus\",\n    \"ContainmentSupported\"\
    ,\n    \"Country\",\n    \"DNS\",\n    \"DomainName\",\n    \"FirewallDisabled\"\
    ,\n    \"Gateway\",\n    \"Group\",\n    \"Idle\",\n    \"InstallTime\",\n   \
    \ \"InstallationFailed\",\n    \"LastScan\",\n    \"LastSeen\",\n    \"NetworkSegment\"\
    ,\n    \"OperatingSystem\",\n    \"OrganizationUnit\",\n    \"Platform\",\n  \
    \  \"Scanning\",\n    \"UserName\",\n    \"VersionInfo\"\n]\n\nMACHINE_DATA =\
    \ [\n    'MachineName',\n    'MachineGUID',\n    'Online',\n    'OperatingSystem',\n\
    \    'LastScan',\n    'IOCScore',\n    'MacAddress',\n    'LocalIp'\n]\n\nIOC_DATA\
    \ = [\n    \"Description\",\n    \"Type\",\n    \"MachineCount\",\n    \"ModuleCount\"\
    ,\n    \"IOCLevel\",\n    \"Priority\",\n    \"Active\",\n    \"LastExecuted\"\
    ,\n    \"Alertable\",\n    \"IOCTriggeredOnMachine\"\n]\n\nMODULE_DATA = [\n \
    \   'ModuleName',\n    'ModuleID',\n    'Description',\n    'IOCScore',\n    'AnalyticsScore',\n\
    \    'GlobalMachineCount',\n    'MD5',\n    'SHA256'\n]\n\nMODULE_DATA_EXTENDED\
    \ = [\n    \"ModuleID\",\n    \"ModuleName\",\n    \"FullPath\",\n    \"FirstSeenName\"\
    ,\n    \"FirstSeenDate\",\n    \"MD5\",\n    \"SHA1\",\n    \"SHA256\",\n    \"\
    IIOCLevel0\",\n    \"IIOCLevel1\",\n    \"IIOCLevel2\",\n    \"IIOCLevel3\",\n\
    \    \"IIOCScore\",\n    \"Blacklisted\",\n    \"Graylisted\",\n    \"Whitelisted\"\
    ,\n    \"MachineCount\",\n    \"RiskScore\",\n    \"AVDefinitionHash\",\n    \"\
    AVDescription\",\n    \"AVFirstThreat\",\n    \"AVScanResult\",\n    \"AccessNetwork\"\
    ,\n    \"AnalysisTime\",\n    \"AppDataLocal\",\n    \"AppDataRoaming\",\n   \
    \ \"AutoStartCategory\",\n    \"Autorun\",\n    \"BlacklistCategory\",\n    \"\
    BlockingStatus\",\n    \"Desktop\",\n    \"Downloaded\",\n    \"DownloadedTime\"\
    ,\n    \"FakeStartAddress\",\n    \"FileAccessDenied\",\n    \"FileAccessTime\"\
    ,\n    \"FileCreationTime\",\n    \"FileEncrypted\",\n    \"FileHiddenAttributes\"\
    ,\n    \"FileModificationTime\",\n    \"FileName\",\n    \"FileOccurrences\",\n\
    \    \"Floating\",\n    \"HashLookup\",\n    \"Hooking\",\n    \"ImportedDLLCount\"\
    ,\n    \"ImportedDLLs\",\n    \"LiveConnectRiskEnum\",\n    \"LiveConnectRiskReason\"\
    ,\n    \"Loaded\",\n    \"OriginalFileName\",\n    \"Packed\",\n    \"Platform\"\
    ,\n    \"RelativeFileName\",\n    \"RelativePath\",\n    \"RemoteFileName\",\n\
    \    \"RemotePath\",\n    \"Signature\",\n    \"SignatureTimeStamp\",\n    \"\
    SizeInBytes\",\n    \"Status\",\n    \"YaraDefinitionHash\",\n    \"YaraScanDescription\"\
    ,\n    \"YaraScanFirstThreat\",\n    \"YaraScanresult\",\n    \"Windows\",\n \
    \   \"WritetoExecutable\",\n    \"SysWOW64\",\n    \"System32\",\n    \"Temporary\"\
    ,\n    \"TooManyConnections\",\n    \"User\",\n    \"SignatureValid\",\n    \"\
    SignedbyMicrosoft\",\n    \"SignatureExpired\",\n    \"SignaturePresent\",\n \
    \   \"RenametoExecutable\",\n    \"ReservedName\",\n    \"ProcessAccessDenied\"\
    ,\n    \"ProgramData\",\n    \"ProgramFiles\",\n    \"ReadDocument\",\n    \"\
    MD5Collision\",\n    \"InstallerDirectory\",\n    \"LikelyPacked\",\n    \"Listen\"\
    ,\n    \"ImageHidden\",\n    \"ImageMismatch\",\n    \"FirewallAuthorized\",\n\
    \    \"AutorunScheduledTask\",\n    \"Beacon\"\n]\n\nMODULE_DATA_EXTENDED_CONTEXT\
    \ = [\n    \"ModuleID\",\n    \"FileName\",\n    \"FullPath\",\n    \"MD5\",\n\
    \    \"RiskScore\",\n    \"SHA1\",\n    \"SHA256\",\n    \"IIOCScore\",\n    \"\
    Blacklisted\",\n    \"Graylisted\",\n    \"Whitelisted\",\n    \"MachineCount\"\
    ,\n    \"IIOCLevel0\",\n    \"IIOCLevel1\",\n    \"IIOCLevel2\",\n    \"IIOCLevel3\"\
    ,\n    \"FirstSeenName\",\n    \"FirstSeenDate\"\n]\n\n\ndef is_html_response(response):\n\
    \    if 'text\\html' in response.headers.get('Content-Type', ''):\n        return\
    \ True\n    # look for an html tag in the response text\n    # if re.search(\"\
    <[^>]+>\", response.text):\n    #     return True\n    return False\n\n\ndef get_html_from_response(response):\n\
    \    text = response.text\n    open_tag = text.find('<html')\n    close_tag =\
    \ text.find('</html>')\n    return text[open_tag: close_tag + len('</html>')]\n\
    \n\ndef html_error_entry(html):\n    return {\n        'Type': entryTypes['error'],\n\
    \        'Contents': html,\n        'ContentsFormat': formats['html']\n    }\n\
    \n\ndef parse_error_response(error_response):\n    # NetWitness has fixed structure\
    \ for\n    try:\n        error = error_response.json()\n        return 'Request\
    \ failed with status code: {}\\nReason: {}\\n{}'.format(error_response.status_code,\
    \ error.ResponseStatus.ErrorCode, error.ResponseStatus.Message)\n    except Exception\
    \ as e:\n        return 'Request failed with status code: {}\\n{}'.format(error_response.status_code,\
    \ error_response.content)\n\n\ndef http_request(method, url, data=None, headers={'Accept':\
    \ 'application/json'}, url_params=None):\n    # send http request using user settings\
    \ for unsecure and proxy parameters\n    # uses basic auth\n    # returns the\
    \ http response\n\n    LOG('Attempting {} request to {}'.format(method, url))\n\
    \    try:\n        response = requests.request(\n            method,\n       \
    \     url,\n            headers=headers,\n            data=data,\n           \
    \ auth=(USERNAME, PASSWORD),\n            params=url_params,\n            verify=USE_SSL,\n\
    \            proxies=PROXIES\n        )\n    except requests.exceptions.SSLError\
    \ as e:\n        LOG(e.message)\n        raise ValueError('An SSL error occurred.\
    \ Consider to set unsecure')\n\n    if is_html_response(response):\n        html_body\
    \ = get_html_from_response(response)\n        demisto.results(html_error_entry(html_body))\n\
    \        raise ValueError('Caught HTML response, please verify server url.')\n\
    \n    if response.status_code != 200:\n        msg = parse_error_response(response)\n\
    \        raise ValueError(msg)\n\n    try:\n        return response.json()\n \
    \   except Exception as e:\n        LOG(e.message)\n        return {}\n\n\ndef\
    \ login():\n    url = '{}/auth'.format(BASE_PATH)\n    # this call will raise\
    \ an exception on wrong credential\n    http_request('GET', url)\n\n\ndef get_machines(query,\
    \ limit):\n    # GET /machines\n\n    # specify additional data to be returned\n\
    \    query['Properties'] = 'Online,OperatingSystem,LastScanUTCTime,IOCScore,MacAddress,LocalIp'\n\
    \    # add paging to query\n    query['page'] = 1\n    # set per_page parameter\
    \ only if 'limit' is under 50\n    if limit < 50:\n        query['per_page'] =\
    \ limit  # int\n\n    machines = []\n    # loop on page number\n    while True:\n\
    \        res = http_request(\n            'GET',\n            '{}/machines'.format(BASE_PATH),\n\
    \            url_params=query\n        )\n        items = res.get('Items')\n \
    \       if not items:\n            # no results\n            break\n        machines.extend(items)\n\
    \        if len(machines) >= limit:\n            # reached/exceeded limit\n  \
    \          break\n        # get next page\n        query['page'] = query['page']\
    \ + 1\n\n    if len(machines) > limit:\n        # results exceeded limit\n   \
    \     machines[limit - 1:-1] = []\n\n    return machines\n\n\ndef get_machines_command():\n\
    \n    args = demisto.args()\n\n    # prepare query\n    query = {\n        'MachineName':\
    \ args.get('machineName'),  # string\n        'iocscore_gte': int(args.get('iocScoreGreaterThan'))\
    \ if args.get('iocScoreGreaterThan') else None,  # int\n        'iocscore_lte':\
    \ int(args.get('iocScoreLessThan')) if args.get('iocScoreLessThan') else None,\
    \  # int\n        'IpAddress': args.get('ipAddress'),  # string\n        'macAddress':\
    \ args.get('macAddress'),  # string\n    }\n    limit = int(args.get('limit'))\
    \ if args.get('limit') else math.inf\n    if limit < 1:\n        raise ValueError(\"\
    Please input valid limit number\")\n\n    machines = get_machines(query, limit)\n\
    \n    context = []\n    for machine in machines:\n        properties = machine['Properties']\n\
    \        context.append(\n            {\n                'MachineGUID': machine.get('Id'),\n\
    \                'MachineName': machine.get('Name'),\n                'Online':\
    \ properties.get('Online'),\n                'OperatingSystem': properties.get('OperatingSystem'),\n\
    \                'LastScan': properties.get('LastScanUTCTime'),\n            \
    \    'IOCScore': properties.get('IOCScore'),\n                'MacAddress': properties.get('MacAddress'),\n\
    \                'LocalIp': properties.get('LocalIp')\n            }\n       \
    \ )\n\n    entry = {\n        'Type': entryTypes['note'],\n        'Contents':\
    \ {\n            \"Machines\": machines,\n            \"Machine\": [],\n     \
    \       \"IOCs\": [],\n            \"Modules\": []\n        },\n        'ContentsFormat':\
    \ formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n \
    \       'HumanReadable': tableToMarkdown('NetWitness Endpoint - Get Machines',\
    \ context, MACHINE_DATA),\n        'EntryContext': {\n            \"NetWitness.Machines(obj.MachineGUID==val.MachineGUID)\"\
    : context\n        }\n    }\n\n    # get additional machine data\n    for id in\
    \ [machine[\"Id\"] for machine in machines]:\n\n        if args.get('includeMachineData')\
    \ == 'yes':\n\n            machine_entry = create_machine_entry(id)\n\n      \
    \      entry[\"Contents\"][\"Machine\"].append(machine_entry[\"Contents\"])\n\
    \            entry[\"HumanReadable\"] += '\\n{}'.format(machine_entry[\"HumanReadable\"\
    ])\n            entry[\"EntryContext\"].update(machine_entry[\"EntryContext\"\
    ])\n\n        if args.get('includeMachineIOCs') == 'yes':\n\n            iocs_entry\
    \ = create_iocs_entry(id, 50)\n\n            entry[\"Contents\"][\"IOCs\"].extend(iocs_entry[\"\
    Contents\"])\n            entry[\"HumanReadable\"] += '\\n{}'.format(iocs_entry[\"\
    HumanReadable\"])\n            entry[\"EntryContext\"].update(iocs_entry[\"EntryContext\"\
    ])\n\n        if args.get('includeMachineModules') == 'yes':\n\n            modules_entry\
    \ = create_modules_entry(id, {}, 30)\n\n            entry[\"Contents\"][\"Modules\"\
    ].extend(modules_entry[\"Contents\"])\n            entry[\"HumanReadable\"] +=\
    \ '\\n{}'.format(modules_entry[\"HumanReadable\"])\n            entry[\"EntryContext\"\
    ].update(modules_entry[\"EntryContext\"])\n\n    demisto.results(entry)\n\n\n\
    def get_machine(machine_id):\n    # GET /machines/{Guid}\n    response = http_request(\n\
    \        'GET',\n        '{}/machines/{}'.format(BASE_PATH, machine_id)\n    )\n\
    \    return response.get('Machine')\n\n\ndef create_machine_entry(machine_id):\n\
    \    machine = get_machine(machine_id)\n    machine_name = machine.get('MachineName')\n\
    \n    machine_data = {k: v for k, v in machine.items() if k in MACHINE_DATA_EXTENDED}\n\
    \    machine_data[\"MachineGUID\"] = machine_id\n\n    entry = {\n        'Type':\
    \ entryTypes['note'],\n        'Contents': machine,\n        'ContentsFormat':\
    \ formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n \
    \       'HumanReadable': tableToMarkdown('NetWitness Endpoint - Machine {} Full\
    \ Data'.format(machine_name), machine_data, MACHINE_DATA_EXTENDED),\n        'EntryContext':\
    \ {\n            \"NetWitness.Machines(obj.MachineGUID==val.MachineGUID)\": machine_data\n\
    \        }\n    }\n    return entry\n\n\ndef get_machine_command():\n    entry\
    \ = create_machine_entry(demisto.args().get('machineGUID'))\n    demisto.results(entry)\n\
    \n\ndef list_iocs(machine_id, limit):\n    # GET /machines/{Guid}/instantiocs\n\
    \n    paging_params = {\n        'page': 1\n    }\n    # set per_page parameter\
    \ only if 'limit' is under 50\n    if limit < 50:\n        paging_params['per_page']\
    \ = limit\n\n    iocs = []\n    # loop on page number\n    while True:\n     \
    \   res = http_request(\n            'GET',\n            '{}/machines/{}/instantiocs'.format(BASE_PATH,\
    \ machine_id),\n            url_params=paging_params\n        )\n        items\
    \ = res.get('Iocs')\n        if not items:\n            # no results\n       \
    \     break\n        iocs.extend(items)\n        if len(iocs) >= limit:\n    \
    \        # reached/exceeded limit\n            break\n        # get next page\n\
    \        paging_params['page'] = paging_params['page'] + 1\n\n    if len(iocs)\
    \ > limit:\n        # results exceeded limit\n        iocs[limit - 1:-1] = []\n\
    \n    return iocs\n\n\ndef create_iocs_entry(machine_id, limit):\n\n    iocs =\
    \ list_iocs(machine_id, limit)\n\n    context = []\n    for ioc in iocs:\n   \
    \     data = {k: v for k, v in ioc.items() if k in IOC_DATA}\n        data['MachineGUID']\
    \ = machine_id\n        context.append(data)\n\n    entry = {\n        'Type':\
    \ entryTypes['note'],\n        'Contents': iocs,\n        'ContentsFormat': formats['json'],\n\
    \        'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable':\
    \ tableToMarkdown(\"NetWitness Endpoint - Machine IOC's\", context, IOC_DATA),\n\
    \        'EntryContext': {\n            \"NetWitness.IOCS(obj.Description==val.Description)\"\
    : context,\n        }\n    }\n    return entry\n\n\ndef list_iocs_command():\n\
    \n    args = demisto.args()\n    machine_id = args.get('machineGUID')\n    limit\
    \ = int(args.get('limit')) if args.get('limit') else math.inf\n\n    if limit\
    \ < 1:\n        raise ValueError(\"Please input valid limit number\")\n\n    entry\
    \ = create_iocs_entry(machine_id, limit)\n    demisto.results(entry)\n\n\ndef\
    \ get_machine_modules(machine_id, query, limit):\n    # GET /machines/{Guid}/modules\n\
    \n    # specify additional data to be returned\n    query['Properties'] = 'Description,IOCScore,AnalyticsScore,GlobalMachineCount,HashMD5,HashSHA256'\n\
    \    # add paging to query\n    query['page'] = 1\n    # set per_page parameter\
    \ only if 'limit' is under 50\n    if limit < 50:\n        query['per_page'] =\
    \ limit\n\n    modules = []\n    # loop on page number\n    while True:\n    \
    \    res = http_request(\n            'GET',\n            '{}/machines/{}/modules'.format(BASE_PATH,\
    \ machine_id),\n            url_params=query\n        )\n        items = res.get('Items')\n\
    \        if not items:\n            # no results\n            break\n        modules.extend(items)\n\
    \        if len(modules) >= limit:\n            # reached/exceeded limit\n   \
    \         break\n        # get next page\n        query['page'] = query['page']\
    \ + 1\n\n    if len(modules) > limit:\n        # results exceeded limit\n    \
    \    modules[limit - 1:-1] = []\n\n    return modules\n\n\ndef create_modules_entry(machine_id,\
    \ query, limit):\n\n    modules = get_machine_modules(\n        machine_id,\n\
    \        query,\n        limit\n    )\n\n    context = []\n    files =[]\n   \
    \ for module in modules:\n        properties = module['Properties']\n        context.append(\n\
    \            {\n                'ModuleID': module.get('Id'),\n              \
    \  'ModuleName': module.get('Name'),\n                'Description': properties.get('Description'),\n\
    \                'IOCScore': properties.get('IOCScore'),\n                'AnalyticsScore':\
    \ properties.get('AnalyticsScore'),\n                'GlobalMachineCount': properties.get('GlobalMachineCount'),\n\
    \                'MD5': properties.get('HashMD5'),\n                'SHA256':\
    \ properties.get('HashSHA256'),\n                'MachineGUID': machine_id\n \
    \           }\n        )\n        files.append(\n            {\n             \
    \   'Name': module.get('Name'),\n                'MD5': properties.get('HashMD5'),\n\
    \            }\n        )\n\n    entry = {\n        'Type': entryTypes['note'],\n\
    \        'Contents': modules,\n        'ContentsFormat': formats['json'],\n  \
    \      'ReadableContentsFormat': formats['markdown'],\n        'HumanReadable':\
    \ tableToMarkdown('NetWitness Endpoint - Get Modules', context, MODULE_DATA),\n\
    \        'EntryContext': {\n            \"NetWitness.Modules(obj.ModuleID==val.ModuleID)\"\
    : context,\n            \"File(obj.MD5==val.MD5)\": files\n        }\n    }\n\
    \    return entry\n\n\ndef get_machine_modules_command():\n\n    args = demisto.args()\n\
    \n    machine_id = args.get('machineGUID')\n    limit = int(args.get('limit'))\
    \ if args.get('limit') else math.inf\n    if limit < 1:\n        raise ValueError(\"\
    Please input valid limit number\")\n    # prepare query\n    query = {\n     \
    \   'ModuleName': args.get('moduleName'),  # string\n        'iocscore_gte': int(args.get('iocScoreGreaterThan'))\
    \ if args.get('iocScoreGreaterThan') else None,  # int\n        'iocscore_lte':\
    \ int(args.get('iocScoreLessThan')) if args.get('iocScoreLessThan') else None\
    \  # int\n    }\n\n    entry = create_modules_entry(\n        machine_id,\n  \
    \      query,\n        limit\n    )\n    demisto.results(entry)\n\n\ndef get_machine_module(machine_guid,\
    \ moudule_id):\n    # GET machines/{Guid}/modules/{Id}\n    response = http_request(\n\
    \        'GET',\n        '{}/machines/{}/modules/{}'.format(BASE_PATH, machine_guid,\
    \ moudule_id),\n    )\n    return response.get('MachineModulePath')\n\n\ndef get_machine_module_command():\n\
    \n    args = demisto.args()\n    machine_id = args.get('machineGUID')\n\n    module\
    \ = get_machine_module(\n        machine_id,\n        args.get('moduleID')\n \
    \   )\n\n    readable = {k: v for k, v in module.items() if k in MODULE_DATA_EXTENDED}\n\
    \    context = {k: v for k, v in module.items() if k in MODULE_DATA_EXTENDED_CONTEXT}\n\
    \    context['MachineGUID'] = machine_id\n    file = {\n        'Name': module.get('Name'),\n\
    \        'MD5': module.get('HashMD5'),\n        'SHA1': module.get('SHA1'),\n\
    \        'Path': module.get('FullPath')\n    }\n    entry = {\n        'Type':\
    \ entryTypes['note'],\n        'Contents': module,\n        'ContentsFormat':\
    \ formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n \
    \       'HumanReadable': tableToMarkdown('NetWitness Endpoint - Get Module', readable,\
    \ MODULE_DATA_EXTENDED),\n        'EntryContext': {\n            \"NetWitness.Modules(obj.ModuleID==val.ModuleID)\"\
    : context,\n            \"File(obj.MD5==val.MD5)\": file\n        }\n    }\n \
    \   demisto.results(entry)\n\n\ndef blacklist_ips(ips):\n    # POST /blacklist/ip\n\
    \    body = {\n        'Ips': ips\n    }\n    response = http_request(\n     \
    \   'POST',\n        '{}/blacklist/ip'.format(BASE_PATH),\n        data=body\n\
    \n    )\n    return response.get('Ips')\n\n\ndef blacklist_domains(domains):\n\
    \    # POST /blacklist/domain\n    body = {\n        'Domains': domains\n    }\n\
    \    response = http_request(\n        'POST',\n        '{}/blacklist/domain'.format(BASE_PATH),\n\
    \        data=body\n\n    )\n    return response.get('Domains')\n\n\ndef blacklist_ips_command():\n\
    \n    ips = demisto.args().get('ips').split(',')\n\n    ips_successfully_blacklisted\
    \ = blacklist_ips(ips)\n\n    ips_failed = [ip for ip in ips if ip not in ips_successfully_blacklisted]\n\
    \    readable = tableToMarkdown('IPs Successfully Blacklisted', ips_successfully_blacklisted,\
    \ headers=[\"IP\"])\n    if len(ips_failed) > 0:\n        readable += tableToMarkdown('The\
    \ following IPs could not be processed', ips_failed, headers=[\"IP\"])\n\n   \
    \ entry = {\n        'Type': entryTypes['note'],\n        'Contents': ips_successfully_blacklisted,\n\
    \        'ContentsFormat': formats['json'],\n        'ReadableContentsFormat':\
    \ formats['markdown'],\n        'HumanReadable': readable,\n        'EntryContext':\
    \ {\n            \"NetWitness.Blacklist.IPs\": ips_successfully_blacklisted,\n\
    \        }\n    }\n    demisto.results(entry)\n\n\ndef blacklist_domains_command():\n\
    \n    args = demisto.args()\n    domains = args.get('domains').split(',')\n\n\
    \    domains_successfully_blacklisted = blacklist_domains(domains)\n\n    domains_failed\
    \ = [domain for domain in domains if domain not in domains_successfully_blacklisted]\n\
    \    readable = tableToMarkdown('Domains Successfully Blacklisted', domains_successfully_blacklisted,\
    \ headers=[\"Domain\"])\n    if len(domains_failed) > 0:\n        readable +=\
    \ tableToMarkdown('The following domains could not be processed', domains_failed,\
    \ headers=[\"Domain\"])\n\n    entry = {\n        'Type': entryTypes['note'],\n\
    \        'Contents': domains_successfully_blacklisted,\n        'ContentsFormat':\
    \ formats['json'],\n        'ReadableContentsFormat': formats['markdown'],\n \
    \       'HumanReadable': readable,\n        'EntryContext': {\n            \"\
    NetWitness.Blacklist.Domains\": domains_successfully_blacklisted,\n        }\n\
    \    }\n    demisto.results(entry)\n\n\n\"\"\"\n\nEXECUTION\n\n\"\"\"\n\ntry:\n\
    \n    login()\n    command = demisto.command()\n\n    if command == 'test-module':\n\
    \        # validated credentials with login call\n        # test permission -\
    \ call get_machines\n        get_machines({}, 1)\n        demisto.results('ok')\n\
    \    elif command == 'netwitness-get-machines':\n        machines = get_machines_command()\n\
    \    elif command == 'netwitness-get-machine':\n        get_machine_command()\n\
    \    elif command == 'netwitness-get-machine-iocs':\n        list_iocs_command()\n\
    \    elif command == 'netwitness-get-machine-modules':\n        get_machine_modules_command()\n\
    \    elif command == 'netwitness-get-machine-module':\n        get_machine_module_command()\n\
    \    elif command == 'netwitness-blacklist-ips':\n        blacklist_ips_command()\n\
    \    elif command == 'netwitness-blacklist-domains':\n        blacklist_domains_command()\n\
    \nexcept ValueError as e:\n    LOG(e.message)\n    LOG.print_log()\n    return_error(e.message)\n\
    \nsys.exit(0)\n"
  subtype: python2
  type: python
tests:
- NetWitness Endpoint Test
toversion: 4.1.9
