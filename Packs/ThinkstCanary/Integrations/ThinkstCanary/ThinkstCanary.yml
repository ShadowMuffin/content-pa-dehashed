category: Deception
commonfields:
  id: Thinkst Canary
  version: -1
configuration:
- defaultvalue: ''
  display: Canary Server URL (e.g., https://***.canary.tools)
  name: server
  required: true
  type: 0
- defaultvalue: ''
  display: API Authentication Token
  name: auth_token
  required: true
  type: 4
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- defaultvalue: 24 hours
  display: First fetch time (<number> <time unit>, e.g., 12 hours, 7 days, 3 months,
    1 year)
  name: fetchDelta
  required: false
  type: 0
- display: Incident type
  name: incidentType
  required: false
  type: 13
description: By presenting itself as an apparently benign and legitimate service(s),
  the Canary draws the attention of unwanted activity. When someone trips one of the
  Canary's triggers, an alert is sent to notify the responsible parties so that action
  can be taken before valubale systems in your network are compromised.
display: Thinkst Canary
name: Thinkst Canary
script:
  commands:
  - arguments: []
    description: Lists all registered Canaries.
    name: canarytools-list-canaries
    outputs:
    - contextPath: CanaryTools.Device.ID
      description: Device ID
      type: string
    - contextPath: CanaryTools.Device.Name
      description: Device name
      type: string
    - contextPath: CanaryTools.Device.Description
      description: Device description
      type: string
    - contextPath: CanaryTools.Device.Address
      description: Device IP address
      type: string
    - contextPath: CanaryTools.Device.Status
      description: Device status - Live (True/False)
      type: boolean
    - contextPath: CanaryTools.Device.Location
      description: Device location
      type: string
    - contextPath: CanaryTools.Device.Version
      description: Device version
      type: string
    - contextPath: CanaryTools.Device.LastSeen
      description: Device last seen time
      type: date
    - contextPath: CanaryTools.Device.LastUpdated
      description: Device last updated time
      type: date
  - arguments: []
    description: Lists all Canary tokens.
    name: canarytools-list-tokens
    outputs:
    - contextPath: CanaryTools.Token.CanaryToken
      description: Canary Token
      type: string
    - contextPath: CanaryTools.Token.CreatedTime
      description: Token Created time
      type: date
    - contextPath: CanaryTools.token.Enabled
      description: Token status - Enabled (True / False)
      type: boolean
    - contextPath: CanaryTools.Token.Kind
      description: Token Kind
      type: string
    - contextPath: CanaryTools.Token.Triggered
      description: Token triggered count
      type: number
    - contextPath: CanaryTools.Token.DocName
      description: Token document name (If the token is from type document)
      type: string
    - contextPath: CanaryTools.Token.TokenURL
      description: Token URL (How the token is presented)
      type: string
  - arguments:
    - description: IP address
      name: ip
      required: true
    - description: Destination port
      name: port
    description: Checks whether a given IP address and port are whitelisted.
    name: canarytools-check-whitelist
    outputs:
    - contextPath: CanaryTools.IP.Address
      description: IP address
      type: string
    - contextPath: CanaryTools.IP.Port
      description: Destination port for the IP whitelist
      type: string
    - contextPath: CanaryTools.IP.Whitelisted
      description: Is the IP address whitelisted (true/false)
      type: boolean
  - arguments:
    - description: IP address to whitelist
      name: ip
      required: true
    - description: Destination port to whitelist
      name: port
    description: Adds an IP address to the whitelist in Canary
    name: canarytools-whitelist-ip
    outputs:
    - contextPath: CanaryTools.IP.Address
      description: IP address
      type: string
    - contextPath: CanaryTools.IP.Port
      description: Destination port for the IP whitelist
      type: string
    - contextPath: CanaryTools.IP.Whitelisted
      description: Is the IP address whitelisted (True/False)
      type: boolean
  - arguments:
    - description: Alert ID (e.g., incident:canarytoken:d6fe0ae4dfd36cc3cc6d9d4f::1548593719,
        Can be retrieved through fetch incidents)
      name: alert_id
      required: true
    - auto: PREDEFINED
      description: Required status for the alert (Acknowledge, Unacknowledge)
      name: status
      predefined:
      - Acknowledge
      - Unacknowledge
      required: true
    description: Edits the status for an alert in Canary Tools.
    name: canarytools-edit-alert-status
    outputs:
    - contextPath: CanaryTools.Alert.ID
      description: Alert ID
      type: string
    - contextPath: CanaryTools.Alert.Status
      description: Alert status
      type: string
  - arguments:
    - description: Canary Token, Can be retrieved through list-tokens command
      name: token
      required: true
    description: Fetches a Canary Token file from the Canary Tools server.
    name: canarytools-get-token
    outputs:
    - contextPath: CanaryTools.Token.CanaryToken
      description: Canary Token
      type: string
    - contextPath: File.Size
      description: File Size
      type: string
    - contextPath: File.SHA1
      description: File SHA-1
      type: string
    - contextPath: File.SHA256
      description: File SHA-256
      type: string
    - contextPath: File.Name
      description: File name
      type: string
    - contextPath: File.SSDeep
      description: File SSDeep
      type: string
    - contextPath: File.EntryID
      description: File EntryID
      type: string
    - contextPath: File.Info
      description: File info
      type: string
    - contextPath: File.Type
      description: File type
      type: string
    - contextPath: File.MD5
      description: File MD5
      type: string
    - contextPath: File.Extension
      description: File extension
      type: string
  isfetch: true
  runonce: false
  script: ''
  subtype: python2
  type: python
tests:
- CanaryTools Test
toversion: 4.1.9
