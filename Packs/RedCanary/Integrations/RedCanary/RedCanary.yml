category: Endpoint
commonfields:
  id: RedCanary
  version: -1
configuration:
- defaultvalue: ''
  display: Domain (for example, https://demisto.my.redcanary.co)
  name: domain
  required: true
  type: 0
- defaultvalue: ''
  display: API Key
  name: api_key
  required: true
  type: 4
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- defaultvalue: 3 days
  display: First fetch timestamp (<number> <time unit>, e.g., 12 hours, 7 days)
  name: fetch_time
  required: false
  type: 0
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
description: Red Canary collects endpoint data using Carbon Black Response and CrowdStrike
  Falcon.  The collected data is standardized into a common schema which allows teams
  to detect, analyze and respond to security incidents.
display: Red Canary
name: RedCanary
script:
  commands:
  - arguments:
    - default: true
      description: Detection ID. Can be obtained from the context.
      name: id
      required: true
    description: Mark a detection as acknowledged to inform that it's being handled.
    name: redcanary-acknowledge-detection
  - arguments:
    - default: true
      description: Detection ID. Can be obtained from the context.
      name: id
      required: true
    - auto: PREDEFINED
      description: The way in which the detection was remediated.
      name: remediation-state
      predefined:
      - remediated
      - not_remediated_false_positive
      - not_remediated_sanctioned_activity
      - not_remediated_unwarranted
      required: true
    - defaultValue: remediated by Demisto.
      description: Describe the reason why the detection was remediated in this manner.
        This is ignored for 'remediated' state
      name: comment
    description: Update the remediation state of a detection.
    name: redcanary-update-remediation-state
  - arguments:
    - description: What page of results to fetch. Defaults to first page.
      name: page
    - description: How many results to return per page.
      name: per-page
    description: Get a list of confirmed detections.
    name: redcanary-list-detections
    outputs:
    - contextPath: RedCanary.Detection.ID
      description: Detection ID.
      type: number
    - contextPath: RedCanary.Detection.Headline
      description: Human readable text about the detection.
      type: string
    - contextPath: RedCanary.Detection.Severity
      description: The severity of the detection. High, medium, or low
      type: string
    - contextPath: RedCanary.Detection.Summary
      description: A summary of information about the detection.
      type: string
    - contextPath: RedCanary.Detection.Classification
      description: Detection Classification
      type: string
    - contextPath: RedCanary.Detection.Subclassification
      description: Detection Subclassification
      type: string
    - contextPath: RedCanary.Detection.Time
      description: The time the detection was confirmed as a threat by Red Canary
      type: date
    - contextPath: RedCanary.Detection.Acknowledged
      description: Whether or not the detection is acknowledged.
      type: boolean
    - contextPath: RedCanary.Detection.RemediationStatus
      description: The state the detection is currently in.
      type: string
    - contextPath: RedCanary.Detection.Reason
      description: The reason for the detection.
      type: String
    - contextPath: RedCanary.Detection.EndpointUserID
      description: The ID of the user in the infected endpoint.
      type: Number
    - contextPath: RedCanary.Detection.EndpointID
      description: The ID of the endpoint infected in the detection.
      type: Number
    - contextPath: Endpoint.Hostname
      description: Fully-qualified endpoint hostname.
      type: string
    - contextPath: Endpoint.ID
      description: Endpoint ID
      type: string
    - contextPath: Endpoint.IPAddress
      description: IP Address of the endpoint
    - contextPath: Endpoint.MACAddress
      description: MAC address of the endpoint
    - contextPath: Endpoint.OS
      description: The operating system platform used by the endpoint
      type: string
    - contextPath: Endpoint.OSVersion
      description: The complete operating system version identifier used by the endpoint
      type: string
    - contextPath: Endpoint.Memory
      description: Physical memory of the endpoint in bytes
      type: number
    - contextPath: Endpoint.IsIsolated
      description: Whether or not the endpoint is currently network isolated
      type: boolean
    - contextPath: Endpoint.IsDecommissioned
      description: Whether or not the endpoint is decommissioned
      type: boolean
    - contextPath: Account.Username
      description: Endpoint user name
      type: string
    - contextPath: Account.Hostname
      description: Endpoint host name
      type: string
  - arguments:
    - defaultValue: '1'
      description: Page number in the query response. Default is 1.
      name: page
    - defaultValue: '50'
      description: Number of returned results per page. Default is 50
      name: per-page
    description: Get a list of endpoints.
    name: redcanary-list-endpoints
    outputs:
    - contextPath: Endpoint.Hostname
      description: Fully-qualified endpoint hostname
      type: string
    - contextPath: Endpoint.ID
      description: Endpoint ID
      type: string
    - contextPath: Endpoint.IPAddress
      description: IP Address of the endpoint
    - contextPath: Endpoint.MACAddress
      description: MAC Address of the endpoint
    - contextPath: Endpoint.OS
      description: The operating system platform used by the endpoint
      type: string
    - contextPath: Endpoint.OSVersion
      description: The complete operating system version identifier used by the endpoint
      type: string
    - contextPath: Endpoint.Memory
      description: Physical memory of the endpoint in bytes
      type: number
    - contextPath: Endpoint.IsIsolated
      description: Whether or not the endpoint is currently network isolated
      type: boolean
    - contextPath: Endpoint.IsDecommissioned
      description: Whether or not the endpoint is decommissioned
      type: boolean
  - arguments:
    - description: Playbook ID for execution.
      name: playbook-id
    - description: Detection to execute the playbook on. Can be retrieve from the
        context
      name: detection-id
      required: true
    - description: Playbook name for execution. if playbook ID is specify, this is
        ignored.
      name: playbook-name
    description: Execute a predefined playbook on a detection.
    name: redcanary-execute-playbook
  - arguments:
    - default: true
      description: Endpoint ID
      name: id
      required: true
    description: Get an endpoint by unique identifier.
    name: redcanary-get-endpoint
    outputs:
    - contextPath: Endpoint.Hostname
      description: Fully-qualified endpoint hostname
      type: string
    - contextPath: Endpoint.ID
      description: Endpoint ID
      type: string
    - contextPath: Endpoint.IPAddress
      description: IP Address of the endpoint
    - contextPath: Endpoint.MACAddress
      description: MAC Address of the endpoint
    - contextPath: Endpoint.OS
      description: The operating system platform used by the endpoint
      type: string
    - contextPath: Endpoint.OSVersion
      description: The complete operating system version identifier used by the endpoint
      type: string
    - contextPath: Endpoint.Memory
      description: Physical memory of the endpoint in bytes
      type: number
    - contextPath: Endpoint.IsIsolated
      description: Whether or not the endpoint is currently network isolated
      type: boolean
    - contextPath: Endpoint.IsDecommissioned
      description: Whether or not the endpoint is decommissioned
      type: boolean
  - arguments:
    - default: true
      description: Endpoint ID
      name: id
      required: true
    description: Get a list of detections associated with the endpoint.
    name: redcanary-get-endpoint-detections
    outputs:
    - contextPath: RedCanary.Detection.ID
      description: Detection ID.
      type: number
    - contextPath: RedCanary.Detection.Headline
      description: Human readable text about the detection.
      type: string
    - contextPath: RedCanary.Detection.Severity
      description: The severity of the detection. High, medium, or low
      type: string
    - contextPath: RedCanary.Detection.Summary
      description: A summary of information about the detection.
      type: string
    - contextPath: RedCanary.Detection.Classification
      description: Detection Classification
      type: string
    - contextPath: RedCanary.Detection.Subclassification
      description: Detection Subclassification
      type: string
    - contextPath: RedCanary.Detection.Time
      description: The time the detection was confirmed as a threat by Red Canary
      type: date
    - contextPath: RedCanary.Detection.Acknowledged
      description: Whether or not the detection is acknowledged.
      type: boolean
    - contextPath: RedCanary.Detection.RemediationStatus
      description: The state the detection is currently in.
      type: string
    - contextPath: Endpoint.Hostname
      description: Fully-qualified endpoint hostname
      type: string
    - contextPath: Endpoint.ID
      description: Endpoint ID
      type: string
    - contextPath: Endpoint.IPAddress
      description: IP Address of the endpoint
    - contextPath: Endpoint.MACAddress
      description: MAC Address of the endpoint
    - contextPath: Endpoint.OS
      description: The operating system platform used by the endpoint
      type: string
    - contextPath: Endpoint.OSVersion
      description: The complete operating system version identifier used by the endpoint
      type: string
    - contextPath: Endpoint.Memory
      description: Physical memory of the endpoint in bytes
      type: number
    - contextPath: Endpoint.IsIsolated
      description: Whether or not the endpoint is currently network isolated
      type: boolean
    - contextPath: Endpoint.IsDecommissioned
      description: Whether or not the endpoint is decommissioned
      type: boolean
    - contextPath: Account.Username
      description: Endpoint user name
      type: string
    - contextPath: Account.Hostname
      description: Endpoint host name
      type: string
  - arguments:
    - default: true
      description: Detection ID
      name: id
      required: true
    description: Get a detection by unique identifier.
    name: redcanary-get-detection
    outputs:
    - contextPath: RedCanary.Detection.ID
      description: Detection ID.
      type: number
    - contextPath: RedCanary.Detection.Headline
      description: Human readable text about the detection.
      type: string
    - contextPath: RedCanary.Detection.Severity
      description: The severity of the detection. High, medium, or low
      type: string
    - contextPath: RedCanary.Detection.Summary
      description: A summary of information about the detection.
      type: string
    - contextPath: RedCanary.Detection.Classification
      description: Detection Classification
      type: string
    - contextPath: RedCanary.Detection.Subclassification
      description: Detection Subclassification
      type: string
    - contextPath: RedCanary.Detection.Time
      description: The time the detection was confirmed as a threat by Red Canary
      type: date
    - contextPath: RedCanary.Detection.Acknowledged
      description: Whether or not the detection is acknowledged.
      type: boolean
    - contextPath: RedCanary.Detection.RemediationStatus
      description: The state the detection is currently in.
      type: string
    - contextPath: RedCanary.Detection.Reason
      description: The reason for the detection
      type: String
    - contextPath: RedCanary.Detection.EndpointUserID
      description: The ID of the user in the infected endpoint
      type: Number
    - contextPath: RedCanary.Detection.EndpointID
      description: The ID of the endpoint infected in the detection
      type: Number
    - contextPath: Endpoint.Hostname
      description: Fully-qualified endpoint hostname
      type: string
    - contextPath: Endpoint.ID
      description: Endpoint ID
      type: string
    - contextPath: Endpoint.IPAddress
      description: IP Address of the endpoint
    - contextPath: Endpoint.MACAddress
      description: MAC Address of the endpoint
    - contextPath: Endpoint.OS
      description: The operating system platform used by the endpoint
      type: string
    - contextPath: Endpoint.OSVersion
      description: The complete operating system version identifier used by the endpoint
      type: string
    - contextPath: Endpoint.Memory
      description: Physical memory of the endpoint in bytes
      type: number
    - contextPath: Endpoint.IsIsolated
      description: Whether or not the endpoint is currently network isolated
      type: boolean
    - contextPath: Endpoint.IsDecommissioned
      description: Whether or not the endpoint is decommissioned
      type: boolean
    - contextPath: Account.Username
      description: Endpoint user name
      type: string
    - contextPath: Account.Hostname
      description: Endpoint host name
      type: string
    - contextPath: Domain.Name
      description: Domain name
      type: string
    - contextPath: File.Name
      description: File name
      type: string
    - contextPath: File.MD5
      description: File MD5
      type: string
    - contextPath: File.SHA256
      description: File SHA256
      type: string
    - contextPath: File.Path
      description: File path in the endpoint
      type: string
    - contextPath: File.Extension
      description: File extension
      type: string
    - contextPath: IP.Address
      description: IP Address
      type: string
    - contextPath: IP.Port
      description: Port
      type: string
    - contextPath: Process.Name
      description: Process name
      type: string
    - contextPath: Process.Path
      description: process binary path
      type: string
    - contextPath: Process.MD5
      description: Binary MD5
      type: string
    - contextPath: Process.SHA256
      description: Binary SHA256
      type: string
    - contextPath: Process.StartTime
      description: Process execution time
      type: date
    - contextPath: Process.CommandLine
      description: Process command line
      type: string
  isfetch: true
  runonce: false
  script: ''
  subtype: python2
  type: python
tests:
- RedCanaryTest
toversion: 4.1.9
