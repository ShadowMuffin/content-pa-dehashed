category: Case Management
commonfields:
  id: Service Manager
  version: -1
configuration:
- defaultvalue: ''
  display: Server URL (e.g. https://192.168.0.1:13080)
  name: url
  required: true
  type: 0
- defaultvalue: ''
  display: Username
  name: username
  required: true
  type: 9
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Service Manager By Micro Focus (Formerly HPE Software).
display: Micro Focus Service Manager
image: data:image/png;base64,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
name: Service Manager
script:
  commands:
  - arguments:
    - description: The title of incident
      name: title
      required: true
    - description: The description of the incident
      name: description
      required: true
    - description: 'Examples: CI1001060, CI1001030'
      name: service
      required: true
    - description: Default is 4. Should be number like 3 or 4
      name: impact
    - description: Default is 4. Should be number like 3 or 4
      name: urgency
    - description: 'The alert status. Example: SLA BREACH'
      name: alertStatus
    - description: 'The area. Example: performance, failure, hardware, access, '
      name: area
    - description: 'Example: "Office Supplies (North America)"'
      name: assignmentGroup
    - description: 'Examples: CI1000783'
      name: affectedCI
    - description: 'Category of incident. Example: (incident, complaint)'
      name: category
      required: true
    - description: 'Example: advantage'
      name: company
    - description: 'Example: "Categorization"'
      name: phase
    - description: 'Example: "Categorize"'
      name: status
    - description: 'Example: system or application hangs, function or feature not
        working, error message, job failed, hardware failure, etc.'
      name: subarea
    description: Creates a new incident.
    name: hpsm-create-incident
    outputs:
    - contextPath: Ticket.ID
      description: The id of the ticket
    - contextPath: Ticket.Creator
      description: Who created/opened the ticket
    - contextPath: Ticket.Assignee
      description: To whom the ticket assigned
    - contextPath: Ticket.State
      description: The state of the ticket (e.g open, closed, on hold)
    - contextPath: HPSM.Incidents.IncidentID
      description: The id of incident
    - contextPath: HPSM.Incidents.Service
      description: Service/device number (e.g CI1001030)
    - contextPath: HPSM.Incidents.Area
      description: Incident area
    - contextPath: HPSM.Incidents.Assignee
      description: Incident assignee
    - contextPath: HPSM.Incidents.AssignmentGroup
      description: Incident assignment group
    - contextPath: HPSM.Incidents.Category
      description: Incident category
    - contextPath: HPSM.Incidents.ClosedBy
      description: The user that closed the incident
    - contextPath: HPSM.Incidents.ClosedTime
      description: Incident close time
    - contextPath: HPSM.Incidents.ClosureCode
      description: Incident closure code
    - contextPath: HPSM.Incidents.Company
      description: Incident company
    - contextPath: HPSM.Incidents.Contact
      description: Incident contact details
    - contextPath: HPSM.Incidents.Description
      description: Incident description
    - contextPath: HPSM.Incidents.Impact
      description: Incident impact
    - contextPath: HPSM.Incidents.JournalUpdates
      description: Incident journal updates
    - contextPath: HPSM.Incidents.OpenTime
      description: Incident open time
    - contextPath: HPSM.Incidents.OpenedBy
      description: The user that opened the incident
    - contextPath: HPSM.Incidents.Phase
      description: Incident phase
    - contextPath: HPSM.Incidents.Solution
      description: Incident solution
    - contextPath: HPSM.Incidents.Status
      description: Incident status
    - contextPath: HPSM.Incidents.Subarea
      description: Incident sub area
    - contextPath: HPSM.Incidents.Title
      description: Incident title
    - contextPath: HPSM.Incidents.UpdatedBy
      description: The last user that update the incident
    - contextPath: HPSM.Incidents.UpdatedTime
      description: Incident update time
    - contextPath: HPSM.Incidents.Urgency
      description: Incident urgency
  - arguments:
    - description: 'OPTIONAL example: field1=value1&field2=value2. Also look https://docs.software.hpe.com/SM/9.50/Hybrid/Content/webservicesguide/rest_queries.htm'
      name: query
    description: Returns all incidents
    name: hpsm-list-incidents
    outputs:
    - contextPath: HPSM.IncidentIDs
      description: Result of incident query. Contains array of incident ids
  - arguments:
    - default: true
      description: The id of incident (example IM10013)
      name: incidentId
      required: true
    description: Returns single incident by id. If incident not exists with such id,
      then error will returned
    name: hpsm-get-incident-by-id
    outputs:
    - contextPath: Ticket.ID
      description: The id of the ticket
    - contextPath: Ticket.Creator
      description: Who created/opened the ticket
    - contextPath: Ticket.Assignee
      description: To whom the ticket assigned
    - contextPath: Ticket.State
      description: The state of the ticket (e.g open, closed, on hold)
    - contextPath: HPSM.Incidents.IncidentID
      description: The id of incident
    - contextPath: HPSM.Incidents.Service
      description: Service/device number (e.g CI1001030)
    - contextPath: HPSM.Incidents.Area
      description: Incident area
    - contextPath: HPSM.Incidents.Assignee
      description: Incident Assignee
    - contextPath: HPSM.Incidents.AssignmentGroup
      description: Incident assignment group
    - contextPath: HPSM.Incidents.Category
      description: Incident category
    - contextPath: HPSM.Incidents.ClosedBy
      description: The user that closed the incident
    - contextPath: HPSM.Incidents.ClosedTime
      description: Incident close time
    - contextPath: HPSM.Incidents.ClosureCode
      description: Incident closure code
    - contextPath: HPSM.Incidents.Company
      description: Incident company
    - contextPath: HPSM.Incidents.Contact
      description: Incident contact details
    - contextPath: HPSM.Incidents.Description
      description: Incident description
    - contextPath: HPSM.Incidents.Impact
      description: Incident impact
    - contextPath: HPSM.Incidents.JournalUpdates
      description: Incident journal updates
    - contextPath: HPSM.Incidents.OpenTime
      description: Incident open time
    - contextPath: HPSM.Incidents.OpenedBy
      description: The user that opened the incident
    - contextPath: HPSM.Incidents.Phase
      description: Incident phase
    - contextPath: HPSM.Incidents.Solution
      description: Incident solution
    - contextPath: HPSM.Incidents.Status
      description: Incident status
    - contextPath: HPSM.Incidents.Subarea
      description: Incident sub area
    - contextPath: HPSM.Incidents.Title
      description: Incident title
    - contextPath: HPSM.Incidents.UpdatedBy
      description: The last user that update the incident
    - contextPath: HPSM.Incidents.UpdatedTime
      description: Incident update time
    - contextPath: HPSM.Incidents.Urgency
      description: Incident urgency
  - arguments:
    - description: 'OPTIONAL example (field1=value1&field2=value2)  Also see here:
        https://docs.software.hpe.com/SM/9.50/Hybrid/Content/webservicesguide/rest_queries.htm'
      name: query
    description: Returns a list of devices, filtered according to query.
    name: hpsm-list-devices
    outputs:
    - contextPath: HPSM.DeviceIDs
      description: All the ids(configurationItems) of the devices
  - arguments:
    - description: 'Id of device, configuration item of device. Example: CI1000011'
      name: configurationItem
      required: true
    description: Find and return device by id
    name: hpsm-get-device
    outputs:
    - contextPath: HPSM.Devices.AssignmentGroup
      description: Device assignment group
    - contextPath: HPSM.Devices.Company
      description: Device company
    - contextPath: HPSM.Devices.ConfigurationItem
      description: Device configuration item
    - contextPath: HPSM.Devices.ConfigurationItemSubType
      description: Device configurationItem sub type
    - contextPath: HPSM.Devices.ConfigurationItemType
      description: Device configurationItem item type
    - contextPath: HPSM.Devices.Department
      description: Device department
    - contextPath: HPSM.Devices.DisplayName
      description: Device display name
    - contextPath: HPSM.Devices.Location
      description: Device location
    - contextPath: HPSM.Devices.LocationCode
      description: Device location code
    - contextPath: HPSM.Devices.Model
      description: Device model
    - contextPath: HPSM.Devices.PartNumber
      description: Device part number
    - contextPath: HPSM.Devices.Status
      description: Device status
    - contextPath: HPSM.Devices.UpdatedBy
      description: The last user that update the device
  script: "var url = params.url + '/SM/9/rest';\n\n// handle '/' at the end of the\
    \ url\nif (url[url.length - 1] === '/') {\n    url = url.substring(0, url.length\
    \ - 1);\n}\n\nvar token = Base64.encode(params.username.identifier + ':' + params.username.password);\n\
    \nvar result;\n// The command input arg holds the command sent from the user.\n\
    switch (command) {\n    case 'test-module':\n        result = 'ok';\n        break;\n\
    \    case 'hpsm-create-incident':\n        result = createIncident();\n      \
    \  break;\n    case 'hpsm-list-incidents':\n        result = listIncidents();\n\
    \        break;\n    case 'hpsm-get-incident-by-id':\n        result = getIncidentById();\n\
    \        break;\n    case 'hpsm-list-devices':\n        result = listDevices();\n\
    \        break;\n    case 'hpsm-get-device':\n        result = getDeviceById();\n\
    \        break;\n    default:\n}\nreturn result;\n\nfunction createIncident()\
    \ {\n    var newIncident = {\n        Incident: {\n            Category: args.category,\n\
    \            Description: [\n                args.description\n            ],\n\
    \            Service: args.service,\n            Title: args.title,\n        }\n\
    \    };\n\n    if (args.impact) {\n        newIncident.Incident.Impact = args.impact;\n\
    \    }\n    if (args.urgency) {\n        newIncident.Incident.Urgency = args.urgency;\n\
    \    }\n    if (args.alertStatus) {\n        newIncident.Incident.AlertStatus\
    \ = args.alertStatus;\n    }\n    if (args.area) {\n        newIncident.Incident.Area\
    \ = args.area;\n    }\n    if (args.assignmentGroup) {\n        newIncident.Incident.AssignmentGroup\
    \ = args.assignmentGroup;\n    }\n    if (args.affectedCI) {\n        newIncident.Incident.AffectedCI\
    \ = args.affectedCI;\n    }\n    if (args.company) {\n        newIncident.Incident.Company\
    \ = args.company;\n    }\n    if (args.category) {\n        newIncident.Incident.Category\
    \ = args.category;\n    }\n\n    if (args.phase) {\n        newIncident.Incident.Phase\
    \ = args.phase;\n    }\n    if (args.status) {\n        newIncident.Incident.Status\
    \ = args.status;\n    }\n    if (args.subarea) {\n        newIncident.Incident.Subarea\
    \ = args.subarea;\n    }\n\n    var res = doPost('/incidents', newIncident);\n\
    \    var parsedRes = JSON.parse(res);\n    if (parsedRes.ReturnCode !== 0) {\n\
    \        throw 'Failed to create incident. Error Response: ' + res.Messages;\n\
    \    }\n\n    hrIncident = parsedRes.Incident;\n\n    var entryContext = {\n \
    \       'HPSM.Incidents': [parsedRes.Incident],\n        Ticket: [\n         \
    \   {\n                ID: parsedRes.Incident.IncidentID,\n                Creator:\
    \ parsedRes.Incident.OpenedBy,\n                Assignee: parsedRes.Incident.Assignee,\n\
    \                State: parsedRes.Incident.Status\n            }\n        ]\n\
    \    };\n    return {\n        Type: entryTypes.note,\n        ContentsFormat:\
    \ formats.json,\n        Contents: parsedRes,\n\n        ReadableContentsFormat:\
    \ formats.markdown,\n        HumanReadable: tableToMarkdown('Created Incident\
    \ ' + parsedRes.Incident.IncidentID, hrIncident),\n\n        EntryContext: entryContext\n\
    \    };\n}\n\n// queryToObject takes query of format field1=value1&field2=value2\
    \ and return query object like: { \"field1\": \"value1\", \"field2\": \"value2\"\
    \ }\nfunction queryToObject(query) {\n    if (!query) {\n        return null;\n\
    \    }\n\n    var queryObj = {};\n    var queryArr = query.split('&');\n    queryArr.forEach(function(keyValuePair)\
    \ {\n        var a = keyValuePair.split('=');\n        var key = a[0];\n     \
    \   var value = a[1];\n        queryObj[key] = value;\n    });\n\n    return queryObj;\n\
    }\n\nfunction listIncidents() {\n    var incidents = doGet('/incidents', args.query);\n\
    \    incidents = JSON.parse(incidents);\n\n    var hrIncidents = [];\n    var\
    \ incidentIds = [];\n    if (incidents.content && incidents.content.length > 0)\
    \ {\n        incidents.content.forEach(function(inc) {\n            hrIncidents.push(inc.Incident);\n\
    \            incidentIds.push(inc.Incident.IncidentID);\n        });\n    }\n\n\
    \    var entryContext = {\n        'HPSM.IncidentIDs': incidentIds\n    };\n\n\
    \    return {\n        Type: entryTypes.note,\n        ContentsFormat: formats.json,\n\
    \        Contents: incidents,\n\n        ReadableContentsFormat: formats.markdown,\n\
    \        HumanReadable: tableToMarkdown('Incidents List', hrIncidents),\n\n  \
    \      EntryContext: entryContext\n    };\n}\n\nfunction getIncidentById() {\n\
    \    var incident = doGet('/incidents/' + args.incidentId);\n    incident = JSON.parse(incident);\n\
    \n    hrIncident = incident.Incident;\n    var entryContext = {\n        'HPSM.Incidents':\
    \ [incident.Incident],\n        Ticket: [\n            {\n                ID:\
    \ incident.Incident.IncidentID,\n                Creator: incident.Incident.OpenedBy,\n\
    \                Assignee: incident.Incident.Assignee,\n                State:\
    \ incident.Incident.Status\n            }\n        ]\n    };\n    return {\n \
    \       Type: entryTypes.note,\n        ContentsFormat: formats.json,\n      \
    \  Contents: incident,\n\n        ReadableContentsFormat: formats.markdown,\n\
    \        HumanReadable: tableToMarkdown('Incident ' + args.incidentId, hrIncident),\n\
    \n        EntryContext: entryContext\n    };\n}\n\nfunction listDevices() {\n\
    \    var devices = doGet('/devices', args.query);\n    devices = JSON.parse(devices);\n\
    \n    var hrDevices = [];\n    var deviceIds = [];\n    if (devices.content &&\
    \ devices.content.length > 0) {\n        devices.content.forEach(function(dev)\
    \ {\n            hrDevices.push(dev.Device);\n            deviceIds.push(dev.Device.ConfigurationItem);\n\
    \        });\n    }\n\n    var entryContext = {\n        'HPSM.DeviceIDs': deviceIds\n\
    \    };\n\n    return {\n        Type: entryTypes.note,\n        ContentsFormat:\
    \ formats.json,\n        Contents: devices,\n\n        ReadableContentsFormat:\
    \ formats.markdown,\n        HumanReadable: tableToMarkdown('Devices List', hrDevices),\n\
    \n        EntryContext: entryContext\n    };\n}\n\nfunction getDeviceById() {\n\
    \    var device = doGet('/devices/' + args.configurationItem);\n    device = JSON.parse(device);\n\
    \n    hrDevice = device.Device;\n    var entryContext = {\n        'HPSM.Devices':\
    \ [device.Device],\n    };\n    return {\n        Type: entryTypes.note,\n   \
    \     ContentsFormat: formats.json,\n        Contents: device,\n\n        ReadableContentsFormat:\
    \ formats.markdown,\n        HumanReadable: tableToMarkdown('Device ' + args.configurationItem,\
    \ hrDevice),\n\n        EntryContext: entryContext\n    };\n}\n\nfunction doPost(queryPath,\
    \ body) {\n    return doRequest('POST', queryPath, body);\n}\n\nfunction doPut(queryPath,\
    \ body) {\n    return doRequest('PUT', queryPath, body);\n}\n\nfunction doRequest(method,\
    \ queryPath, body) {\n    var requestUrl = url + queryPath;\n    var res = http(\n\
    \        requestUrl,\n        {\n            Method: method,\n            Headers:\
    \ {\n                Authorization: ['Basic ' + token],\n                'Content-Type':\
    \ ['application/json']\n            },\n            Body: JSON.stringify(body)\n\
    \        },\n        params.insecure,\n        params.proxy\n    );\n\n    if\
    \ (res.StatusCode < 200 || res.StatusCode >= 300) {\n        var parsedRes;\n\
    \        try {\n            parsedRes = JSON.parse(res.Body);\n        } catch\
    \ (err) {}\n\n        if (res.Body && parsedRes && parsedRes.ReturnCode !== 0\
    \ && parsedRes.Messages) {\n            throw method + ' Request Failed to ' +\
    \ requestUrl + '.\\nStatus code: ' + res.StatusCode + '.\\nError from Service\
    \ Manager: ' + parsedRes.Messages;\n        }\n\n        throw method + ' Request\
    \ Failed to ' + requestUrl + '.\\nStatus code: ' + res.StatusCode + '.\\nBody:\
    \ ' + JSON.stringify(res.Body) + '.';\n    }\n\n    return res.Body;\n}\n\nfunction\
    \ doGet(queryPath, queryParams) {\n    var requestUrl = url + queryPath;\n   \
    \ if (queryParams && typeof queryParams === 'string') {\n        // in case query\
    \ is a string, then we convert it obj and then encode it to URL query\n      \
    \  // we also convert every \\\" to \" and after encoding URI, the encodeURI encodes\
    \ \" to %22. We decode it to its original form\n        requestUrl += '?' + encodeURI(queryParams.replace(/\\\
    \\\"/g,'\"')).replace(/%22/g,\"\\\"\");\n    } else if (queryParams) {\n     \
    \   // if the query is object then we encode it\n        requestUrl += encodeToURLQuery(queryParams);\n\
    \    }\n\n    var res = http(\n        requestUrl,\n        {\n            Method:\
    \ 'GET',\n            Headers: {\n                Authorization: ['Basic ' + token],\n\
    \                'Content-Type': ['application/json']\n            }\n       \
    \ },\n        params.insecure,\n        params.proxy\n    );\n\n    if (res.StatusCode\
    \ < 200 || res.StatusCode >= 300) {\n        throw 'GET Request Failed to ' +\
    \ requestUrl + '.\\nStatus code: ' + res.StatusCode + '.\\nBody: ' + JSON.stringify(res)\
    \ + '.';\n    }\n\n    return res.Body;\n}\n"
  type: javascript
toversion: 4.1.9
