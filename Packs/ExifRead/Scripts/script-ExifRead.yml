args:
- default: true
  description: Entry ID of image file
  name: EntryID
  required: true
comment: Read image files metadata and provide Exif tags
commonfields:
  id: ExifRead
  version: -1
dockerimage: demisto/exifread
enabled: true
name: ExifRead
outputs:
- contextPath: Exif.tag
  description: Exif tag name
  type: string
- contextPath: Exif.value
  description: Exif tag value
  type: string
runonce: false
script: "import exifread\n\nres = demisto.getFilePath(demisto.args()['EntryID'])\n\
  f = open(res['path'], 'rb')\n\ntags = exifread.process_file(f)\narr = []\nfor tag\
  \ in tags.keys():\n    arr.append({'tag':str(tag), 'value':str(tags[tag])})\n\n\
  md = tableToMarkdown('Exif Tags', arr)\n\ndemisto.results({\n    'ContentsFormat':\
  \ formats['json'],\n    'Type': entryTypes['note'],\n    'Contents': {'Exif': arr},\n\
  \    'HumanReadable': md,\n    'EntryContext': {'Exif':arr}\n})\n"
scripttarget: 0
subtype: python2
tags:
- Utility
toversion: 4.1.9
type: python
