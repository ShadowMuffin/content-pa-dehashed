category: Data Enrichment & Threat Intelligence
commonfields:
  id: WhatsMyBrowser
  version: -1
configuration:
- defaultvalue: https://api.whatismybrowser.com/api/v2/user_agent_parse
  display: URL for WhatIsMyBrowser
  name: url
  required: true
  type: 0
- defaultvalue: ''
  display: API Key
  name: api_key
  required: true
  type: 4
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
description: Parse user agents and determine if they are malicious as well as enrich
  information about the agent
display: WhatIsMyBrowser
name: WhatsMyBrowser
script:
  commands:
  - arguments:
    - description: User Agent String
      name: UserAgent
      required: true
    description: Parses a User Agent string
    name: ua-parse
    outputs:
    - contextPath: UA.Parse.Software
      description: Software extracted from UA string
      type: string
    - contextPath: UA.Parse.SoftwareName
      description: Software Name extracted from UA string
      type: string
    - contextPath: UA.Parse.OperatingSystem
      description: Operating System extracted from UA string
      type: string
    - contextPath: UA.Parse.Abusive
      description: Whether or not the UA has been identified as abusive
      type: boolean
    - contextPath: UA.Parse.OperatingSystemName
      description: Operating System Name extracted from UA string
      type: string
    - contextPath: UA.Parse.UserAgent
      description: User agent string
      type: string
    - contextPath: UA.Parse.HardwareType
      description: Hardware Type as extracted from UA string
      type: string
    - contextPath: UA.Parse.HardwareSubType
      description: Hardware Sub Type as extracted from UA string
      type: string
  runonce: false
  script: ''
  subtype: python3
  type: python
tests:
- WhatsMyBrowser-Test
toversion: 4.1.9
