category: Endpoint
commonfields:
  id: FalconHost
  version: -1
configuration:
- defaultvalue: https://falconapi.crowdstrike.com/
  display: Server URL (e.g. https://192.168.0.1)
  name: url
  required: true
  type: 0
- display: API ID
  name: id
  required: true
  type: 0
- display: API Key
  name: key
  required: true
  type: 4
- defaultvalue: 'true'
  display: Use system proxy settings
  name: useproxy
  required: false
  type: 8
- defaultvalue: 'false'
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
description: Crowdstrike IOCs, detections API, Threat Graph API.
detaileddescription: 'Please provide the API id and key for the CrowsStrike Falcon
  Host API.

  API Key Pairs can be requested by emailing support@crowdstrike.com.'
display: FalconHost
fromversion: 2.5.0
image: data:image/png;base64,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
name: FalconHost
script:
  commands:
  - arguments:
    - auto: PREDEFINED
      description: The type of the indicator
      name: type
      predefined:
      - sha256
      - sha1
      - md5
      - domain
      - ipv4
      - ipv6
      required: true
    - description: The string representation of the indicator
      name: value
      required: true
    - auto: PREDEFINED
      defaultValue: detect
      description: "The policy to enact when the value is detected on a host. A value\
        \ of none is equivalent to turning the indicator off.\t"
      name: policy
      predefined:
      - detect
      - none
    - auto: PREDEFINED
      description: The level at which the indicator will be shared. Only red share
        level (not shared) is supported, which indicates that the IOC is not shared
        with other Falcon Host customers.
      name: share_level
      predefined:
      - red
    - description: 'This represents the days the indicator should be valid for. This
        only applies to domain, ipv4, and ipv6 types. Default is 30 if not provided. '
      name: expiration_days
    - description: The source where this indicator originated. This can be used for
        tracking where this indicator was defined. Limit 200 characters.
      name: source
    - description: A meaningful description of the indicator. Limit 200 characters.
      name: description
    description: Uploads one or more indicators for CrowdStrike to monitor
    execution: true
    name: cs-upload-ioc
  - arguments:
    - auto: PREDEFINED
      description: The IOC type to retrieve
      name: type
      predefined:
      - sha256
      - sha1
      - md5
      - domain
      - ipv4
      - ipv6
      required: true
    - description: The IOC value to retrieve
      name: value
      required: true
    description: Get the full definition of one or more indicators that you are watching
    name: cs-get-ioc
  - arguments:
    - auto: PREDEFINED
      description: The IOC type to update
      name: type
      predefined:
      - sha256
      - sha1
      - md5
      - domain
      - ipv4
      - ipv6
      required: true
    - description: The IOC value to update
      name: value
      required: true
    - auto: PREDEFINED
      defaultValue: detect
      description: The policy to enact when the value is detected on a host. A value
        of none is equivalent to turning the indicator off.
      name: policy
      predefined:
      - detect
      - none
    - auto: PREDEFINED
      description: The level at which the indicator will be shared. Only red share
        level (not shared) is supported, which indicates that the IOC is not shared
        with other Falcon Host customers.
      name: share_level
      predefined:
      - red
    - description: This represents the days the indicator should be valid for. This
        only applies to domain, ipv4, and ipv6 types. Default is 30.
      name: expiration_days
    - description: The source where this indicator originated. This can be used for
        tracking where this indicator was defined. Limit 200 characters.
      name: source
    - description: A meaningful description of the indicator. Limit 200 characters.
      name: description
    description: Updates one or more of the uploaded indicators
    execution: true
    name: cs-update-ioc
  - arguments:
    - auto: PREDEFINED
      description: The IOC type to delete
      name: type
      predefined:
      - sha256
      - sha1
      - md5
      - domain
      - ipv4
      - ipv6
      required: true
    - description: The IOC value to delete
      name: value
    description: Deletes an indicator that you are monitoring
    execution: true
    name: cs-delete-ioc
  - arguments:
    - description: A list of indicator types. Separate multiple types by comma. Valid
        types are sha256, sha1, md5, domain, ipv4, ipv6.
      isArray: true
      name: types
    - description: Comma-separated list of indicator values
      isArray: true
      name: values
    - description: Comma-separated list of indicator policies
      isArray: true
      name: policies
    - description: A list of share levels. Only red is supported.
      isArray: true
      name: share_levels
    - description: Comma-separated list of IOC sources
      isArray: true
      name: sources
    - description: Start of date range to search (YYYY-MM-DD format)
      name: from_expiration_date
    - description: End of date range to search (YYYY-MM-DD format)
      name: to_expiration_date
    - auto: PREDEFINED
      description: The order of the results. Format is field.asc or field.desc.
      name: sort
      predefined:
      - type.asc
      - type.desc
      - value.asc
      - value.desc
      - policy.asc
      - policy.desc
      - share_level.asc
      - share_level.desc
      - expiration_timestamp.asc
      - expiration_timestamp.desc
    - description: The maximum number of records to return. The minimum is 1 and the
        maximum is 500. Default is 100.
      name: limit
    - description: The offset to begin the list from. For example, start from the
        10th record and return the list. Default is 0.
      name: offset
    description: Returns a list of your uploaded IOCs that match the search criteria
    name: cs-search-iocs
  - arguments:
    - default: true
      description: Search for a value across all fields
      name: query
    - description: Filter devices using query syntax of "field:value+field:value"
        where string values are enclosed in single quotes or as arrays in single quotes
        (['x', 'y']). Numerical fields and dates also support operators like field:>value.
        For a list of relevant fields, see the CrowdStrike documentation.
      name: filter
    - description: Number of results to return
      name: limit
    - description: The result to start from
      name: offset
    description: Search for devices in your environment by platform, host name, IP,
      or various other parameters
    name: cs-device-search
    outputs:
    - contextPath: FalconHostDevices
      description: Device IDs found by device search
      type: string
  - arguments:
    - default: true
      description: The ID of the process. Allows multiple values separated by comma.
      name: ids
      required: true
    description: Get details for one or more devices, according to device ID
    name: cs-device-details
    outputs:
    - contextPath: FalconHostDetails
      description: The ID to retrieve details for. Supports comma-separated list of
        IDs.
      type: string
    - contextPath: Endpoint.ID
      description: Unique ID of the endpoint in FalconHost
      type: string
    - contextPath: Endpoint.IPAddress
      description: IPAddress of the endpoint
      type: string
    - contextPath: Endpoint.Domain
      description: Domain of the endpoint
      type: string
    - contextPath: Endpoint.MACAddress
      description: MACAddress of the endpoint
      type: string
    - contextPath: Endpoint.OS
      description: OS of the endpoint
      type: string
    - contextPath: Endpoint.OSVersion
      description: OSVersion of the endpoint
      type: string
    - contextPath: Endpoint.BIOSVersion
      description: BIOSVersion of the endpoint
      type: string
    - contextPath: Endpoint.HostName
      description: The host of the endpoint
      type: string
  - arguments:
    - auto: PREDEFINED
      description: The type of indicator
      name: type
      predefined:
      - sha256
      - sha1
      - md5
      - domain
      required: true
    - default: true
      description: The actual string representation of the indicator
      name: value
      required: true
    description: Returns the number of devices on which an IOC ran, according to type
      and value of an IOC
    name: cs-device-count-ioc
  - arguments:
    - auto: PREDEFINED
      description: The type of indicator from the list of supported indicator types.
      name: type
      predefined:
      - sha256
      - sha1
      - md5
      - domain
      - ipv4
      - ipv6
      required: true
    - description: The actual string representation of the indicator
      name: value
      required: true
    description: Returns a list of device IDs on which an indicator ran
    name: cs-device-ran-on
    outputs:
    - contextPath: FalconHostDevices
      description: Device IDs found by device IOC search
      type: string
  - arguments:
    - auto: PREDEFINED
      description: The type of indicator from the list of supported indicator types.
      name: type
      predefined:
      - sha256
      - sha1
      - md5
      - domain
      required: true
    - description: The actual string representation of the indicator
      name: value
      required: true
    - description: "The device ID you want to check against\t"
      name: device_id
      required: true
    description: Returns the process ID of the indicator if it ran on given device
      recently
    name: cs-processes-ran-on
    outputs:
    - contextPath: FalconHostProcesses
      description: List of processes of the searched indicators
      type: string
  - arguments:
    - default: true
      description: The ID of the process. Allows multiple values separated by comma.
      name: ids
      required: true
    description: Retrieves the details of a process, according to process ID, that
      is running or that previously ran.
    name: cs-process-details
  - arguments:
    - default: true
      description: "The IDs of the detections you want to resolve. Falcon Host API\
        \ v2: detection ids are in the following format: ldt:[first field]:[second\
        \ field],  for example, ldt:cf54bb61f92e4d3e75bf4f7c11fc8f74:4295536142.\t"
      name: ids
      required: true
    - auto: PREDEFINED
      description: "The status to which you want to transition a detection\t"
      name: status
      predefined:
      - new
      - in_progress
      - true_positive
      - false_positive
      - ignored
      required: true
    deprecated: true
    description: Deprecated. Use the cs-falcon-resolve-detection command from the
      CrowdStrike Falcon integration instead.
    execution: true
    name: cs-resolve-detection
    outputs:
    - contextPath: CrowdStrikeHost.Detections.cid
      description: cid of the detection
      type: string
    - contextPath: CrowdStrikeHost.Detections.detection_id
      description: ID of the detection
      type: string
    - contextPath: CrowdStrikeHost.Detections.first_behavior
      description: First behavior of the detection
      type: string
    - contextPath: CrowdStrikeHost.Detections.last_behavior
      description: Last behavior of the detection
      type: string
    - contextPath: CrowdStrikeHost.Detections.max_confidence
      description: Max confidence of the detection
      type: number
    - contextPath: CrowdStrikeHost.Detections.max_severity
      description: Max severity of the detection
      type: number
    - contextPath: CrowdStrikeHost.Detections.max_severity_display_name
      description: Displayname of the max severity
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.alleged_file_type
      description: Alleged filetype of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.behavior_id
      description: ID of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.device_id
      description: ID of the device of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.user_id
      description: ID of the user of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.control_graph_id
      description: ID of the control graph of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.cmdline
      description: Command line of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.confidence
      description: Confidence of the behavior
      type: number
    - contextPath: CrowdStrikeHost.Detections.behaviors.severity
      description: Severity of the behavior
      type: number
    - contextPath: CrowdStrikeHost.Detections.behaviors.filename
      description: Filename of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.ioc_description
      description: IOC description of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.ioc_source
      description: IOC source of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.ioc_type
      description: IOC type of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.ioc_value
      description: IOC value of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.md5
      description: MD5 of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.sha256
      description: SHA256 of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.timestamp
      description: Timestamp of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.parent_details.parent_cmdline
      description: Commandline of the parent of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.parent_details.parent_md5
      description: MD5 of the parent of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.parent_details.parent_sha256
      description: SHA256 of the parent of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.parent_details.parent_control_graph_id
      description: Control graph ID of the parent of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.device.agent_version
      description: Agent version of the device
      type: string
    - contextPath: CrowdStrikeHost.Detections.device.bios_version
      description: Bios version of the device
      type: string
    - contextPath: CrowdStrikeHost.Detections.device.os_version
      description: OS version of the device
      type: string
    - contextPath: CrowdStrikeHost.Detections.device.mac_address
      description: MACAddress of the device
      type: string
    - contextPath: CrowdStrikeHost.Detections.device.local_ip
      description: Local IP of the device
      type: string
    - contextPath: CrowdStrikeHost.Detections.device.external_ip
      description: External IP of the device
      type: string
    - contextPath: CrowdStrikeHost.Detections.device.hostname
      description: Hostname of the device
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.technique
      description: Technique of the behavior
      type: string
  - arguments:
    - description: Free text search filter
      name: query
    - description: 'First Behavior of the detection. Example: 2017-01-31T22:36:11Z'
      name: first_behavior
    deprecated: true
    description: Deprecated. Use the cs-falcon-search-detection command from the CrowdStrike
      Falcon integration instead.
    name: cs-detection-search
    outputs:
    - contextPath: CrowdStrikeHost.Detections.detection_id
      description: IDs of the related detections
      type: string
  - arguments:
    - description: ID of the detections
      isArray: true
      name: detection_id
      required: true
    deprecated: true
    description: Deprecated. Use the cs-falcon-search-detection command from the CrowdStrike
      Falcon integration instead.
    name: cs-detection-details
    outputs:
    - contextPath: CrowdStrikeHost.Detections.cid
      description: cid of the detection
      type: string
    - contextPath: CrowdStrikeHost.Detections.detection_id
      description: ID of the detection
      type: string
    - contextPath: CrowdStrikeHost.Detections.first_behavior
      description: First behavior of the detection
      type: string
    - contextPath: CrowdStrikeHost.Detections.last_behavior
      description: Last behavior of the detection
      type: string
    - contextPath: CrowdStrikeHost.Detections.max_confidence
      description: Max confidence of the detection
      type: number
    - contextPath: CrowdStrikeHost.Detections.max_severity
      description: Max severity of the detection
      type: number
    - contextPath: CrowdStrikeHost.Detections.max_severity_display_name
      description: Displayname of the max severity
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.alleged_file_type
      description: Alleged filetype of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.behavior_id
      description: ID of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.device_id
      description: ID of the device of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.user_id
      description: ID of the user of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.control_graph_id
      description: ID of the control graph of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.cmdline
      description: Command line of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.confidence
      description: Confidence of the behavior
      type: number
    - contextPath: CrowdStrikeHost.Detections.behaviors.severity
      description: Severity of the behavior
      type: number
    - contextPath: CrowdStrikeHost.Detections.behaviors.filename
      description: Filename of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.ioc_description
      description: IOC description of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.ioc_source
      description: IOC source of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.ioc_type
      description: IOC type of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.ioc_value
      description: IOC value of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.md5
      description: MD5 of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.sha256
      description: SHA256 of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.timestamp
      description: Timestamp of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.parent_details.parent_cmdline
      description: Commandline of the parent of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.parent_details.parent_md5
      description: MD5 of the parent of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.parent_details.parent_sha256
      description: SHA256 of the parent of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.parent_details.parent_control_graph_id
      description: Control graph ID of the parent of the behavior
      type: string
    - contextPath: CrowdStrikeHost.Detections.device.agent_version
      description: Agent version of the device
      type: string
    - contextPath: CrowdStrikeHost.Detections.device.bios_version
      description: Bios version of the device
      type: string
    - contextPath: CrowdStrikeHost.Detections.device.os_version
      description: OS version of the device
      type: string
    - contextPath: CrowdStrikeHost.Detections.device.mac_address
      description: MAC address of the device
      type: string
    - contextPath: CrowdStrikeHost.Detections.device.local_ip
      description: Local IP of the device
      type: string
    - contextPath: CrowdStrikeHost.Detections.device.external_ip
      description: External IP of the device
      type: string
    - contextPath: CrowdStrikeHost.Detections.device.hostname
      description: Hostname of the device
      type: string
    - contextPath: CrowdStrikeHost.Detections.behaviors.technique
      description: Technique of the behavior
      type: string
  - arguments:
    - description: Crowd Strike threat graph ID.
      isArray: true
      name: ctg_id
      required: true
    description: Gets the details of a threat graph summary.
    name: cs-threatgraph-summary
    outputs:
    - contextPath: CrowdStrikeHost.ThreatGraphSummary.customer_id
      description: Customer ID.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphSummary.device_id
      description: Device ID.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphSummary.edges
      description: Summary edges.
    - contextPath: CrowdStrikeHost.ThreatGraphSummary.id
      description: Threat graph ID.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphSummary.object_id
      description: Object ID.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphSummary.properties
      description: Threat graph properties.
    - contextPath: CrowdStrikeHost.ThreatGraphSummary.scope
      description: Threat graph scope.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphSummary.timestamp
      description: Timestamp when the threat graph summary was created.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphSummary.vertex_type
      description: Threat graph vertex type.
      type: string
  - arguments:
    - description: ID of the threat graph processes.
      isArray: true
      name: process_id
      required: true
    description: Gets the summary of Threat Graph Processes.
    name: cs-threatgraph-processes
    outputs:
    - contextPath: CrowdStrikeHost.ThreatGraphProcesses.customer_id
      description: Customer ID.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphProcesses.device_id
      description: Device ID.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphProcesses.edges
      description: Threat graph edges.
      type: unknown
    - contextPath: CrowdStrikeHost.ThreatGraphProcesses.id
      description: Process ID.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphProcesses.object_id
      description: Object ID.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphProcesses.properties
      description: Threat graph properties.
    - contextPath: CrowdStrikeHost.ThreatGraphProcesses.scope
      description: Threat graph scope.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphProcesses.timestamp
      description: Timestamp when the threat graph processes were created.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphProcesses.vertex_type
      description: Threat graph vertex type.
      type: string
  - arguments:
    - description: ID of  threat graph detection.
      isArray: true
      name: detection_id
      required: true
    description: Gets the child process Threat Graph Detections.
    name: cs-threatgraph-detections
    outputs:
    - contextPath: CrowdStrikeHost.ThreatGraphDetections.customer_id
      description: Customer ID.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphDetections.device_id
      description: Device ID.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphDetections.edges
      description: Threat graph edges.
      type: unknown
    - contextPath: CrowdStrikeHost.ThreatGraphDetections.id
      description: Detection ID.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphDetections.object_id
      description: Object ID.
    - contextPath: CrowdStrikeHost.ThreatGraphDetections.properties
      description: Threat graph properties.
    - contextPath: CrowdStrikeHost.ThreatGraphDetections.scope
      description: Threat graph scope.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphDetections.timestamp
      description: Timestamp when the threat graph detections were created.
      type: string
    - contextPath: CrowdStrikeHost.ThreatGraphDetections.vertex_type
      description: Threat graph vertex type.
      type: string
  runonce: false
  script: "var SERVER_URL = params.url;\nif (SERVER_URL[SERVER_URL.length - 1] !==\
    \ '/') {\n    SERVER_URL += '/';\n}\n//HELPER FUNCTIONS\n\nfunction doReq(method,\
    \ path, query, body) {\n    var result = http(\n        SERVER_URL + path + encodeToURLQuery(query),\n\
    \        {\n            Headers: {\n                'Content-Type': ['application/json'],\n\
    \                'Accept': ['application/json']\n            },\n            Username:\
    \ params.id,\n            Password: params.key,\n            Method: method,\n\
    \            Body: body ? JSON.stringify(body) : ''\n        },\n        params.insecure,\n\
    \        params.useproxy\n    );\n    if (result.StatusCode < 200 || result.StatusCode\
    \ > 299) {\n        if (result.StatusCode === 404 && result.Body.indexOf('Resource\
    \ Not Found') > -1) {\n                // Skip this error - it just means query\
    \ returned no results. Handle as no results.\n        } else {\n            throw\
    \ 'Failed to perform request ' + path + ', request status code: ' + result.StatusCode\
    \ + ', body: ' + result.Body;\n        }\n    }\n\n\n    if (result.Body === '')\
    \ {\n        throw 'No content received.';\n    } else\n    {\n        var obj;\n\
    \        try {\n            obj = JSON.parse(result.Body);\n        } catch (ex)\
    \ {\n            throw 'Error parsing reply - ' + result.Body + ' - ' + ex;\n\
    \        }\n\n        if (obj.errors && obj.errors.length > 0) {\n           \
    \ if (dq(obj, 'errors.[0].code') === 404 && dq(obj, 'errors.[0].message').indexOf('Resource\
    \ Not Found') > -1) {\n                // Skip this error - it just means query\
    \ returned no results. Handle as no results.\n            } else {\n         \
    \       throw JSON.stringify(obj.errors);\n            }\n        }\n        return\
    \ {\n            body: result.Body,\n            obj: obj,\n            statusCode:\
    \ result.StatusCode\n        };\n    }\n}\n\nfunction dateToEpoch(d) {\n    return\
    \ d ? new Date(d).getTime() : null;\n}\n\nfunction uploadIOC() {\n    args.expiration_days\
    \ = parseInt(args.expiration_days)\n    var res = doReq('POST', 'indicators/entities/iocs/v1',\
    \ {}, [args]);\n    return {\n        Type: entryTypes.note,\n        Contents:\
    \ res.body,\n        ContentsFormat: formats.json,\n        HumanReadable: 'IOC\
    \ [' + args.value + '] uploaded'\n    };\n}\n\n\n// add args to a if exists\n\
    function add(a, k, f) {\n    if (args[k]) {\n        // check if the argument\
    \ is a number\n        if(!isNaN(args[k])){\n            args[k] = args[k].toString();\n\
    \        }\n        var parts = argToList(args[k]);\n        for (var i=0; i<parts.length;\
    \ i++) {\n            // check if the argument is a number\n            if(!isNaN(parts[i])){\n\
    \                parts[i] = parts[i].toString();\n            }\n            parts[i]\
    \ = parts[i].trim();\n        }\n        a[k] = f ? f(args[k]) : parts.length\
    \ > 1 ? parts : parts[0];\n    }\n}\n\n//COMMANDS//\n\nfunction getIOC() {\n \
    \   var res = doReq('GET', 'indicators/entities/iocs/v1', {ids: args.type + ':'\
    \ + args.value});\n    var md = '### Falcon Host custom IOC retrieval\\n';\n \
    \   if (res.obj.resources) {\n        for (var i=0; i<res.obj.resources.length;\
    \ i++) {\n            md += objToList(res.obj.resources[i], res.obj.resources[i].value)\
    \ + '\\n';\n        }\n    } else {\n        md += 'No result found';\n    }\n\
    \    return {\n        Type: entryTypes.note,\n        Contents: res.body,\n \
    \       ContentsFormat: formats.json,\n        HumanReadable: md\n    };\n}\n\n\
    function updateIOC() {\n    var a = {};\n    add(a, 'policy');\n    add(a, 'share_level');\n\
    \    add(a, 'expiration_days');\n    add(a, 'source');\n    add(a, 'description');\n\
    \    var res = doReq('PATCH', 'indicators/entities/iocs/v1', {ids: args.type +\
    \ ':' + args.value}, a);\n    return {\n        Type: entryTypes.note,\n     \
    \   Contents: res.body,\n        ContentsFormat: formats.json,\n        HumanReadable:\
    \ 'IOC [' + args.value + '] updated'\n    };\n}\n\nfunction deleteIOC() {\n  \
    \  var a = {};\n    var res = doReq('DELETE', 'indicators/entities/iocs/v1', {ids:\
    \ args.type + ':' + args.value});\n    return {\n        Type: entryTypes.note,\n\
    \        Contents: res.body,\n        ContentsFormat: formats.json,\n        HumanReadable:\
    \ 'IOC [' + args.value + '] deleted'\n    };\n}\n\nfunction searchIOCs() {\n \
    \   var a = {};\n    add(a, 'types');\n    add(a, 'values');\n    add(a, 'policies');\n\
    \    add(a, 'share_levels');\n    add(a, 'sources');\n    add(a, 'sort');\n  \
    \  add(a, 'limit');\n    add(a, 'offset');\n    if (args.from_expiration_date)\
    \ {\n        a['from.expiration_timestamp'] = args.from_expiration_date + 'T00:00:00';\n\
    \    }\n    if (args.to_expiration_date) {\n        a['to.expiration_timestamp']\
    \ = args.to_expiration_date + 'T23:59:59';\n    }\n    var res = doReq('GET',\
    \ 'indicators/queries/iocs/v1', a);\n    var md = '## Falcon Host IOC Search\\\
    n';\n    if (res.obj.resources) {\n        var fullRes = doReq('GET', 'indicators/entities/iocs/v1',\
    \ {ids: res.obj.resources});\n        if (fullRes.obj.resources) {\n         \
    \   for (var i=0; i<fullRes.obj.resources.length; i++) {\n                md +=\
    \ objToList(fullRes.obj.resources[i], fullRes.obj.resources[i].value) + '\\n';\n\
    \            }\n            res.obj.resources = fullRes.obj.resources;\n     \
    \   } else {\n            md += 'No result found';\n        }\n    } else {\n\
    \        md += 'No result found';\n    }\n    return {\n        Type: entryTypes.note,\n\
    \        Contents: res.obj,\n        ContentsFormat: formats.json,\n        HumanReadable:\
    \ md\n    };\n}\n\nfunction deviceSearch() {\n    var a = {};\n    add(a, 'filter');\n\
    \    add(a, 'limit');\n    add(a, 'offset');\n    if (args.query) {\n        a.q\
    \ = args.query;\n    }\n    var res = doReq('GET', 'devices/queries/devices/v1',\
    \ a);\n    var md = '## Falcon Host Device Search\\n';\n    var ec = {};\n   \
    \ if (res.obj.resources && res.obj.resources.length > 0) {\n        ec.FalconHostDevices\
    \ = res.obj.resources;\n        md += '### Devices\\n';\n        for (var i=0;\
    \ i<res.obj.resources.length; i++) {\n            md += res.obj.resources[i] +\
    \ '\\n';\n        }\n    } else {\n        md += 'No result found';\n    }\n \
    \   return {\n        Type: entryTypes.note,\n        Contents: res.obj,\n   \
    \     ContentsFormat: formats.json,\n        HumanReadable: md,\n        EntryContext:\
    \ ec\n    };\n}\n\nfunction deviceDetails() {\n    var ids = argToList(args.ids);\n\
    \    var res = doReq('GET', 'devices/entities/devices/v1', {ids: ids});\n    var\
    \ md = '## Falcon Host Device Details\\n';\n    var found = false;\n    var ec\
    \ = {};\n    if (res.obj.resources) {\n        var endpoint = []; //add Endpoint\
    \ in context\n        ec = {\"FalconHostDetails\": res.obj.resources, \"Endpoint\"\
    :  endpoint};\n        for (var i=0; i<res.obj.resources.length; i++) {\n    \
    \        var o = res.obj.resources[i];\n            var cleanObj = {};\n     \
    \       var keys = Object.keys(o);\n            endpoint.push({\n            \
    \    \"HostName\": 'FalconHost',\n                \"ID\": o.device_id,\n     \
    \           \"IPAddress\": o.local_ip,\n                \"Domain\": o.machine_domain,\n\
    \                \"MACAddress\": o.mac_address,\n                \"OS\": o.platform_name,\n\
    \                \"OSVersion\": o.os_version,\n                \"BIOSVersion\"\
    : o.bios_version,\n            });\n            for (var j=0; j<keys.length; j++)\
    \ {\n                if (keys[j] !== 'policies' && keys[j] !== 'meta') {\n   \
    \                 cleanObj[keys[j]] = o[keys[j]];\n                }\n       \
    \     }\n            md += objToList(cleanObj, o.hostname) + '\\n';\n        \
    \    if (o.policies) {\n                md += '#### Policies\\n';\n          \
    \      md += arrToMd(o.policies) + '\\n';\n            }\n            if (o.meta)\
    \ {\n                md += objToList(o.meta, 'Meta') + '\\n';\n            }\n\
    \            found = true;\n        }\n        ec[\"Endpoint\"] = endpoint;\n\
    \    }\n    if (!found) {\n        md += 'No result found';\n    }\n    return\
    \ {\n        Type: entryTypes.note,\n        Contents: res.obj,\n        ContentsFormat:\
    \ formats.json,\n        HumanReadable: md,\n        EntryContext: ec\n    };\n\
    }\n\nfunction deviceCountIOC() {\n    var res = doReq('GET', 'indicators/aggregates/devices-count/v1',\
    \ args);\n    var md = '## Falcon Host IOC Device Count\\n';\n    if (res.obj.resources\
    \ && res.obj.resources.length > 0) {\n        md += arrToMd(res.obj.resources);\n\
    \    } else {\n        md += 'No result found';\n    }\n    return {\n       \
    \ Type: entryTypes.note,\n        Contents: res.obj,\n        ContentsFormat:\
    \ formats.json,\n        HumanReadable: md\n    };\n}\n\nfunction deviceRanOn()\
    \ {\n    var res = doReq('GET', 'indicators/queries/devices/v1', args);\n    var\
    \ md = '## Falcon Host IOC Device Ran On\\n';\n    var ec = {};\n    if (res.obj.resources\
    \ && res.obj.resources.length > 0) {\n        ec.FalconHostDevices = res.obj.resources;\n\
    \        md += '### Devices\\n';\n        for (var i=0; i<res.obj.resources.length;\
    \ i++) {\n            md += res.obj.resources[i] + '\\n';\n        }\n    } else\
    \ {\n        md += 'No result found';\n    }\n    return {\n        Type: entryTypes.note,\n\
    \        Contents: res.obj,\n        ContentsFormat: formats.json,\n        HumanReadable:\
    \ md,\n        EntryContext: ec\n    };\n}\n\nfunction processesRanOn() {\n  \
    \  var res = doReq('GET', 'indicators/queries/processes/v1', args);\n    var md\
    \ = '## Falcon Host IOC Processes Ran On Device\\n';\n    var ec = {};\n    if\
    \ (res.obj.resources && res.obj.resources.length > 0) {\n        ec.FalconHostProcesses\
    \ = res.obj.resources;\n        md += '### Processes\\n';\n        for (var i=0;\
    \ i<res.obj.resources.length; i++) {\n            md += res.obj.resources[i] +\
    \ '\\n';\n        }\n    } else {\n        md += 'No result found';\n    }\n \
    \   return {\n        Type: entryTypes.note,\n        Contents: res.obj,\n   \
    \     ContentsFormat: formats.json,\n        HumanReadable: md,\n        EntryContext:\
    \ ec\n    };\n}\n\nfunction processDetails() {\n    var ids = argToList(args.ids);\n\
    \    var res = doReq('GET', 'processes/entities/processes/v1', {ids: ids});\n\
    \    var md = '## Falcon Host Process Details\\n';\n    if (res.obj.resources\
    \ && res.obj.resources.length > 0) {\n        md += arrToMd(res.obj.resources);\n\
    \    } else {\n        md += 'No result found';\n    }\n    return {\n       \
    \ Type: entryTypes.note,\n        Contents: res.obj,\n        ContentsFormat:\
    \ formats.json,\n        HumanReadable: md\n    };\n}\n\nfunction resolveDetection()\
    \ {\n    var ids = argToList(args.ids);\n    doReq('PATCH', 'detects/entities/detects/v2',\
    \ {}, {ids: ids, status: args.status});\n    var res = doReq('POST', 'detects/entities/summaries/GET/v1',\
    \ {}, {ids: ids});\n    var md = '## Falcon Host Detection Details\\n';\n    var\
    \ ec = {};\n    if (res.obj.resources && res.obj.resources.length > 0) {\n   \
    \     ec = res.obj.resources;\n        md += tableToMarkdown('', prettifyDetectionsDetails(res.obj.resources),\n\
    \            ['First Behavior', 'Device Hostname', 'Max Severity Display Name',\
    \ 'Technique', 'Filename', 'Commandline', 'Detection ID', 'Device ID', 'Status']);\n\
    \    } else {\n        md += 'No result found';\n    }\n    return {\n       \
    \ Type: entryTypes.note,\n        Contents: res.obj,\n        ContentsFormat:\
    \ formats.json,\n        HumanReadable: md,\n        EntryContext: {\n       \
    \     \"CrowdStrikeHost.Detections(val.detection_id == obj.detection_id)\": ec\n\
    \        }\n    };\n}\n\nfunction detectionSearch() {\n    var headers = {};\n\
    \n    if ((!args.query && !args.first_behavior)) {\n            return {\n   \
    \             Type: entryTypes.error,\n                Contents: 'You must specify\
    \ at least one of the following: query, first_behavior',\n                ContentsFormat:\
    \ formats.text,\n            };\n    }\n    if (args.query) {\n        headers.q\
    \ = args.query;\n    }\n    if (args.first_behavior) {\n        headers.first_behavior\
    \ = args.first_behavior;\n    }\n\n    var res = doReq('GET', 'detects/queries/detects/v1',\
    \ headers);\n    var ec = [];\n    var md = '## Falcon Host List of Detections\\\
    n';\n    if (res.obj.resources && res.obj.resources.length > 0) {\n        //ec.detectionID\
    \ = res.obj.resources;\n        md += '### Detections\\n';\n        for (var i=0;\
    \ i<res.obj.resources.length; i++) {\n            md += res.obj.resources[i] +\
    \ '\\n';\n            ec.push({\n               'detection_id': res.obj.resources[i]\n\
    \            });\n        }\n    } else {\n        md += 'No result found';\n\
    \    }\n    return {\n        Type: entryTypes.note,\n        Contents: res.obj,\n\
    \        ContentsFormat: formats.json,\n        HumanReadable: md,\n        EntryContext:\
    \ {\n            \"CrowdStrikeHost.Detections(val.detection_id == obj.detection_id)\"\
    : ec\n        }\n    };\n}\n\nfunction prettifyDetectionsDetails(detections) {\n\
    \    var prettyDetections = [];\n    for (var i=0; i<detections.length; i++) {\n\
    \        var detection = detections[i];\n        prettyDetections[i] = {\n   \
    \         'First Behavior': detection.first_behavior,\n            'Max Severity\
    \ Display Name': detection.max_severity_displayname,\n            'Detection ID':\
    \ detection.detection_id,\n            'Status': detection.status,\n         \
    \   'Device Hostname': detection.device.hostname,\n            'Technique': detection.behaviors[0].technique,\n\
    \            'Filename': detection.behaviors[0].filename,\n            'Commandline':\
    \ detection.behaviors[0].cmdline,\n            'Device ID': detection.behaviors[0].device_id,\n\
    \        };\n    }\n    return prettyDetections;\n}\n\nfunction detectionDetails()\
    \ {\n    var ids = argToList(args.detection_id);\n    var res = doReq('POST',\
    \ 'detects/entities/summaries/GET/v1', {}, {ids: ids});\n    var md = '## Falcon\
    \ Host Detection Details\\n';\n    var ec = {};\n    if (res.obj.resources &&\
    \ res.obj.resources.length > 0) {\n        ec = res.obj.resources;\n        md\
    \ += tableToMarkdown('', prettifyDetectionsDetails(res.obj.resources),\n     \
    \       ['First Behavior', 'Device Hostname', 'Max Severity Display Name', 'Technique',\
    \ 'Filename', 'Commandline', 'Detection ID', 'Device ID', 'Status']);\n    } else\
    \ {\n        md += 'No result found';\n    }\n    return {\n        Type: entryTypes.note,\n\
    \        Contents: res.obj,\n        ContentsFormat: formats.json,\n        HumanReadable:\
    \ md,\n        EntryContext: {\n            \"CrowdStrikeHost.Detections(val.detection_id\
    \ == obj.detection_id)\": ec\n        }\n    };\n}\n\nfunction threatGraphSummary()\
    \ {\n    var ids = argToList(args.ctg_id);\n    var res = doReq('GET', 'threatgraph/combined/control-graphs/summary/v1',\
    \ {ids: ids});\n    var md = '## Falcon Host Threat Graph Summary\\n';\n    var\
    \ ec = {};\n    if (res.obj.resources && res.obj.resources.length > 0) {\n   \
    \     ec = {\"CrowdStrikeHost.ThreatGraphSummary(val.id == obj.id)\": res.obj.resources};\n\
    \        md += tableToMarkdown('', res.obj.resources)\n    } else {\n        md\
    \ += 'No result found';\n    }\n    return {\n        Type: entryTypes.note,\n\
    \        Contents: res.obj,\n        ContentsFormat: formats.json,\n        HumanReadable:\
    \ md,\n        EntryContext: ec\n    };\n}\n\nfunction threatGraphProcesses()\
    \ {\n    var ids = argToList(args.process_id);\n    var res = doReq('GET', 'threatgraph/combined/processes/summary/v1',\
    \ {ids: ids});\n    var md = '## Falcon Host Threat Graph Processess Summary\\\
    n';\n    var ec = {};\n    if (res.obj.resources && res.obj.resources.length >\
    \ 0) {\n        ec = {\"CrowdStrikeHost.ThreatGraphProcessess(val.id == obj.id)\"\
    : res.obj.resources};\n        md += tableToMarkdown('', res.obj.resources)\n\
    \    } else {\n        md += 'No result found';\n    }\n    return {\n       \
    \ Type: entryTypes.note,\n        Contents: res.obj,\n        ContentsFormat:\
    \ formats.json,\n        HumanReadable: md,\n        EntryContext: ec\n    };\n\
    }\nfunction threatGraphDetections() {\n    var ids = argToList(args.detection_id);\n\
    \    var res = doReq('GET', 'threatgraph/combined/detections/summary/v1', {ids:\
    \ ids});\n    var md = '## Falcon Host Threat Graph Detections Summary\\n';\n\
    \    var ec = {};\n    if (res.obj.resources && res.obj.resources.length > 0)\
    \ {\n        ec = {\"CrowdStrikeHost.ThreatGraphDetections\":res.obj.resources};\n\
    \        md += tableToMarkdown('', res.obj.resources)\n    } else {\n        md\
    \ += 'No result found';\n    }\n    return {\n        Type: entryTypes.note,\n\
    \        Contents: res.obj,\n        ContentsFormat: formats.json,\n        HumanReadable:\
    \ md,\n        EntryContext: ec\n    };\n}\n\nswitch (command) {\n    case 'test-module':\n\
    \        args = {filter: \"platform_name:'Windows'\"};\n        deviceSearch();\n\
    \        return true;\n    case 'cs-upload-ioc':\n        return uploadIOC();\n\
    \    case 'cs-get-ioc':\n        return getIOC();\n    case 'cs-update-ioc':\n\
    \        return updateIOC();\n    case 'cs-delete-ioc':\n        return deleteIOC();\n\
    \    case 'cs-search-iocs':\n        return searchIOCs();\n    case 'cs-device-search':\n\
    \        return deviceSearch();\n    case 'cs-device-details':\n        return\
    \ deviceDetails();\n    case 'cs-device-count-ioc':\n        return deviceCountIOC();\n\
    \    case 'cs-device-ran-on':\n        return deviceRanOn();\n    case 'cs-processes-ran-on':\n\
    \        return processesRanOn();\n    case 'cs-process-details':\n        return\
    \ processDetails();\n    case 'cs-resolve-detection':\n        return resolveDetection();\n\
    \    case 'cs-detection-search':\n        return detectionSearch();\n    case\
    \ 'cs-detection-details':\n        return detectionDetails();\n    case 'cs-threatgraph-summary':\n\
    \        return threatGraphSummary();\n    case 'cs-threatgraph-processes':\n\
    \        return threatGraphProcesses();\n    case 'cs-threatgraph-detections':\n\
    \        return threatGraphDetections();\n    default:\n        throw 'Unknown\
    \ command - ' + command;\n}"
  type: javascript
tests:
- No tests
toversion: 4.1.9
