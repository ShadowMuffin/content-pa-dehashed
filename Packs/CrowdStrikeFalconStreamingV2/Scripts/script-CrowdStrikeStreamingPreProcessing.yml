comment: 'Pre processing script for CrowdStrike Streaming, will not duplicate incidents(detection
  events) that have same Host.

  Will add entry to duplicate(older) incident notifying a duplicate incident was ignored.

  '
commonfields:
  id: CrowdStrikeStreamingPreProcessing
  version: -1
enabled: true
name: CrowdStrikeStreamingPreProcessing
script: "res = True\nfor inc in demisto.incidents():\n    host = ''\n    if inc['labels']:\n\
  \        for t in inc['labels']:\n            if t['type'] == 'System':\n      \
  \          host = t['value']\n    if len(host) > 0:\n        sameIncidents = demisto.executeCommand(\"\
  getIncidents\",\n            {\"query\":\"labels.value:\\\"\"+host+\"\\\"  and labels.type:System\"\
  })\n        if not isError(sameIncidents[0]):\n            # if found sameIncidents\
  \ found, add this incident data to war room\n            sameIncidentsCount = sameIncidents[0]['Contents']['total']\n\
  \            if sameIncidentsCount > 0:\n                res = False\n         \
  \       otherIncidents = sameIncidents[0]['Contents']['data']\n                entries\
  \ = []\n                entries.append({'Contents': \"Duplicate incident from crowdstrike:\
  \ \"+inc['name']})\n                entries.append({\"Type\": 1, \"ContentsFormat\"\
  : \"json\", \"Contents\": json.dumps(inc)})\n                entries_str = json.dumps(entries)\n\
  \                demisto.executeCommand(\"addEntries\", {\"id\":otherIncidents[0][\"\
  id\"],\"entries\":entries_str})\n\ndemisto.results(res)"
scripttarget: 0
subtype: python2
tags:
- preProcessing
- crowdStrike
- crowdStrikeStreaming
toversion: 4.1.9
type: python
