category: Messaging
commonfields:
  id: EWS Mail Sender
  version: -1
configuration:
- defaultvalue: https://outlook.office365.com/EWS/Exchange.asmx/
  display: Exchange URL or Server IP address
  name: ewsServer
  required: true
  type: 0
- defaultvalue: ''
  display: 'Authentication: Email address (for Office 365) or DOMAIN\USERNAME (e.g.
    DEMISTO.INT\admin)'
  name: credentials
  required: true
  type: 9
- defaultvalue: '2013'
  display: Server Version (2007, 2010, 2010_SP2, 2013, or 2016)
  name: defaultServerVersion
  required: true
  type: 0
- defaultvalue: Basic
  display: Authentication Type (NTLM, Basic, or Digest). For Office 365 use Basic.
  name: authType
  required: true
  type: 0
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: 'false'
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- defaultvalue: 'false'
  display: Has impersonation rights
  name: impersonation
  required: false
  type: 8
- defaultvalue: ''
  display: Sender Mailbox
  name: mailbox
  required: false
  type: 0
description: Exchange Web Services and Office 365 Email sender
display: EWS Mail Sender
name: EWS Mail Sender
script:
  commands:
  - arguments:
    - description: A CSV list of email addresses for the 'to' field.
      name: to
      required: true
    - description: A CSV list of email addresses for the 'cc' field.
      name: cc
    - description: A CSV list of email addresses for the 'bcc' field.
      name: bcc
    - description: Subject for the email to be sent.
      name: subject
      required: true
    - description: The email address specified in the 'reply to' field.
      name: replyTo
    - description: The contents (body) of the email to send.
      name: body
    - description: Send an HTML formatted email. This argument overrides the "body"
        argument.
      name: htmlBody
    - description: 'A CSV list of War Room entry IDs that contain files, and are used
        to attach files to the outgoing email. For example: attachIDs=15@8,19@8.'
      isArray: true
      name: attachIDs
    - description: A CSV list of names of attachments to send. Should be the same
        number of elements as attachIDs.
      isArray: true
      name: attachNames
    - description: A CSV list of CIDs to embed attachments within the email itself.
      isArray: true
      name: attachCIDs
    description: Sends an email using EWS.
    name: send-mail
  dockerimage: demisto/py-ews:latest
  script: ''
  subtype: python2
  type: python
tests:
- EWS Mail Sender Test
- EWS Mail Sender Test 2
toversion: 4.1.9
