args:
- default: true
  description: Policy to retrive it's ID (Could be a list)
  name: policy
  required: true
comment: Returns a table of policies and their TrendMicro IDs
commonfields:
  id: TrendMicroGetPolicyID
  version: -1
dependson:
  must:
  - trendmicro-security-profile-retrieve-all
name: TrendMicroGetPolicyID
script: "ID_LABEL = 'Label/PolicyID'\n\npolicies = argToList(demisto.get(demisto.args(),'policy'))\n\
  ID = []\nres = []\nif policies:\n    resp = demisto.executeCommand(\"TrendmicroSecurityProfileRetrieveAll\"\
  , {})\n    if isError(resp[0]):\n        demisto.results(resp)\n    else:\n    \
  \    for policy in policies:\n            policyRes = {\"policy\": policy, 'ID':\
  \ ''}\n            for policyItem in resp[0][\"Contents\"]:\n                if\
  \ str(policyItem[\"name\"]) == policy:\n                    policyRes[\"ID\"] =\
  \ policyItem[\"ID\"]\n                    ID += [policyItem[\"ID\"]]\n         \
  \           break;\n            res += [policyRes]\n        demisto.setContext(ID_LABEL,\"\
  ,\".join(ID))\n        demisto.results([{\"ContentsFormat\": formats[\"table\"],\
  \ \"Type\": entryTypes[\"note\"], \"Contents\":res}])\nelse:\n    demisto.results([{\
  \ \"Type\" : entryTypes[\"error\"], \"ContentsFormat\" : formats[\"text\"], \"Contents\"\
  \ : 'Policy was not provided' }])"
scripttarget: 0
subtype: python2
system: true
tags:
- Trend Micro
timeout: 0s
toversion: 4.1.9
type: python
