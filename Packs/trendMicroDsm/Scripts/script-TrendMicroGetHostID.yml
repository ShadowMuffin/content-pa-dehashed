args:
- default: true
  description: Hostname to retrive it's ID (Could be a list)
  name: hostname
  required: true
comment: Returns a table of hosts and thers TrendMicro IDs
commonfields:
  id: TrendMicroGetHostID
  version: -1
dependson:
  must:
  - trendmicro-host-retrieve-all
name: TrendMicroGetHostID
script: "ID_LABEL = 'Label/HostID'\n\nhostnames = argToList(demisto.get(demisto.args(),'hostname'))\n\
  ID = []\nres = []\nif hostnames:\n    resp = demisto.executeCommand(\"TrendmicroHostRetrieveAll\"\
  , {})\n    if isError(resp[0]):\n        demisto.results(resp)\n    else:\n    \
  \    for hostname in hostnames:\n            hostRes = {\"hostname\": hostname,\
  \ 'ID': ''}\n            for host in resp[0][\"Contents\"]:\n                if\
  \ str(host[\"name\"]) == hostname:\n                    hostRes[\"ID\"] = host[\"\
  ID\"]\n                    ID += [host[\"ID\"]]\n                    break;\n  \
  \          res += [hostRes]\n        demisto.setContext(ID_LABEL,\",\".join(ID))\n\
  \        demisto.results([{\"ContentsFormat\": formats[\"table\"], \"Type\": entryTypes[\"\
  note\"], \"Contents\":res}])\nelse:\n    demisto.results([{ \"Type\" : entryTypes[\"\
  error\"], \"ContentsFormat\" : formats[\"text\"], \"Contents\" : 'Hostname was not\
  \ provided' }])"
scripttarget: 0
subtype: python2
system: true
tags:
- Trend Micro
timeout: 0s
toversion: 4.1.9
type: python
