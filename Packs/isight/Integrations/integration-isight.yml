category: Data Enrichment & Threat Intelligence
commonfields:
  id: FireEye iSIGHT
  version: -1
configuration:
- defaultvalue: ''
  display: Public Key
  name: publicKey
  required: true
  type: 0
- defaultvalue: ''
  display: Private Key
  name: privateKey
  required: true
  type: 4
- defaultvalue: '2.5'
  display: Version
  name: version
  required: true
  type: 0
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: FireEye cyber threat intelligence
display: FireEye iSIGHT
image: data:image/png;base64,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
name: FireEye iSIGHT
script:
  commands:
  - arguments:
    - default: true
      description: ip to search by
      name: ip
      required: true
    description: basic search reports by ip
    name: ip
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
    - contextPath: IP.Address
      description: The IP address
    - contextPath: Report.ID
      description: Report ID
    - contextPath: Report.title
      description: Report title
    - contextPath: Report.publishDate
      description: Report publish date
    - contextPath: Report.intelligenceType
      description: Report intelligence type (overview, vulnerability, malware, threat)
  - arguments:
    - default: true
      description: domain to search by
      name: domain
      required: true
    description: basic search reports by domain
    name: domain
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
    - contextPath: Domain.Name
      description: The domain name.
    - contextPath: Report.ID
      description: Report ID
    - contextPath: Report.title
      description: Report title
    - contextPath: Report.publishDate
      description: Report publish date
    - contextPath: Report.intelligenceType
      description: Report intelligence type (overview, vulnerability, malware, threat)
  - arguments:
    - description: md5 or sha1 to search by
      name: file
    description: basic search file report by md5/sha1. NOTE - specify only one of
      md5/sha1 arguments
    name: file
    outputs:
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
    - contextPath: Report.ID
      description: Report ID
    - contextPath: Report.title
      description: Report title
    - contextPath: Report.publishDate
      description: Report publish date
    - contextPath: Report.intelligenceType
      description: Report intelligence type (overview, vulnerability, malware, threat)
  - arguments:
    - default: true
      description: Report ID to search by
      name: reportID
      required: true
    description: Get specific report
    name: isight-get-report
    outputs:
    - contextPath: Report.ID
      description: Report ID
    - contextPath: Report.title
      description: Report title
    - contextPath: Report.publishDate
      description: Report publish date
    - contextPath: Report.intelligenceType
      description: Report intelligence type (overview, vulnerability, malware, threat)
    - contextPath: Report.audience
      description: Report audience
    - contextPath: Report.ThreatScape
      description: Report threat scape
    - contextPath: Report.operatingSystems
      description: Report operating systems
    - contextPath: Report.riskRating
      description: Report risk rating
    - contextPath: Report.version
      description: Report version
    - contextPath: Report.tagSection
      description: Report tag section
  - arguments:
    - default: true
      description: entry-id of the file to submit (e.g. 41@18)
      name: entryID
      required: true
    - description: file description
      name: description
      required: true
    - auto: PREDEFINED
      description: Type of the given file
      name: type
      predefined:
      - malware
      - other
      required: true
    description: Submission of malware and other files for community sharing
    name: isight-submit-file
  script: "\nvar baseUrl = 'https://api.isightpartners.com'; // iSight base url\n\
    var publicKey = params.publicKey;\nvar privateKey = params.privateKey;\nvar acceptVersion\
    \ = params.version;\nvar insecure = params.insecure;\nvar proxy = params.proxy;\n\
    \nvar VENDOR_NAME = 'FireEye iSIGHT';\n\n// we use this to map record-type to\
    \ dbot-score\nvar intelligenceTypeToScore = {\n    'overview': 1,\n    'vulnerability':\
    \ 2,\n    'malware': 3,\n    'threat': 3\n};\n\n// we use this to determine the\
    \ order of reputation sevirity of the types\nvar intelligenceTypeOrder = ['overview',\
    \ 'vulnerability', 'malware', 'threat'];\n\nvar epoch2DateStr = function(epochStr)\
    \ {\n    return new Date(parseInt(epochStr) * 1000).toString();\n}\n\nvar createTableEntry\
    \ = function (name, contents, table, context) {\n    return {\n        // type\n\
    \        Type: entryTypes.note,\n         // contents\n        ContentsFormat:\
    \ formats.json,\n        Contents: contents,\n        // human-readable\n    \
    \    ReadableContentsFormat: formats.markdown,\n        HumanReadable: tableToMarkdown(name,\
    \ table),\n        // context\n        EntryContext: context\n    };\n}\n\nvar\
    \ getHeaders = function(query) {\n    var timestamp = new Date().toUTCString();\n\
    \    if (timestamp.indexOf('+') > 0) {\n        timestamp = timestamp.substring(0,timestamp.indexOf('+'));\n\
    \    } else if (timestamp.indexOf('-') > 0) {\n        timestamp = timestamp.substring(0,timestamp.indexOf('-'));\n\
    \    }\n    message = query + acceptVersion + 'application/json' + timestamp;\n\
    \    hashed = HMAC_SHA256_MAC(privateKey, message);\n\n    return {\n        'Accept':\
    \ ['application/json'],\n        'Accept-Version': [acceptVersion],\n        'X-Auth':\
    \ [publicKey],\n        'X-Auth-Hash': [hashed],\n        'Date': [timestamp]\n\
    \    }\n}\n\nvar sendRequest = function(query) {\n    var headers = getHeaders(query);\n\
    \    var requestUrl = baseUrl + query;\n\n    var res = http(\n        requestUrl,\n\
    \        {\n            Method: 'GET',\n            Headers: headers,\n      \
    \      Body: ''\n        },\n        insecure,\n        proxy\n    );\n\n    if\
    \ (res.StatusCode < 200 || res.StatusCode >= 300) {\n        throw 'Request Failed.\\\
    nUrl: ' + requestUrl + '\\nStatus code: ' + res.StatusCode + '.\\nResult: ' +\
    \ JSON.stringify(res);\n    }\n\n    if (res.StatusCode === 204) {\n        return\
    \ [];\n    }\n\n    var body = JSON.parse(res.Body);\n    if (!body || !body.success)\
    \ {\n        throw 'Request Failed.\\nResonse body: ' + body;\n    }\n    return\
    \ body;\n};\n\nvar basicSearch = function(key, value) {\n    var basicSearchQuery\
    \ = '/search/basic?' + key + '=' + encodeURIComponent(value);\n    var res = sendRequest(basicSearchQuery);\n\
    \    return res.message;\n}\n\nvar createContextReportsAndScore = function(records)\
    \ {\n    var dbotScore = 0;\n    var highetsRecordType = 'None';\n    var reports\
    \ = [];\n\n    // 1. set dbotScore to to the highest record-type among all records\n\
    \    // 2. create report context-object for each record\n    records && records.forEach(function(record)\
    \ {\n       var recordType = record['intelligenceType'];\n       var recordScore\
    \ =  intelligenceTypeToScore[recordType] || 0;\n       if (dbotScore < recordScore)\
    \ {\n           dbotScore = recordScore;\n       }\n       if(intelligenceTypeOrder.indexOf(highetsRecordType)\
    \ < intelligenceTypeOrder.indexOf(recordType)) {\n           highetsRecordType\
    \ = recordType;\n       }\n       var reportUrl = record['reportLink'];\n    \
    \   reports.push({\n           ID: record['reportId'],\n           title: record['title'],\n\
    \           publishDate: epoch2DateStr(record['publishDate']),\n           intelligenceType:\
    \ recordType\n       });\n    });\n\n    return {\n        dbotScore: dbotScore,\n\
    \        reports: reports,\n        highetsRecordType: highetsRecordType\n   \
    \ }\n}\n\nvar basicSearchIP = function(ip) {\n    var records = basicSearch('ip',\
    \ ip);\n\n    if (!records) {\n        return {\n            Type: entryTypes.note,\n\
    \            Contents: \"No items match your search\",\n            ContentsFormat:\
    \ formats.text,\n            EntryContext: {\n                DBotScore: {\n \
    \                   Indicator: ip,\n                    Type: 'IP',\n        \
    \            Vendor: VENDOR_NAME,\n                    Score: 0\n            \
    \    }\n            }\n        };\n    }\n\n    var res = createContextReportsAndScore(records);\n\
    \    var context = {\n        DBotScore: {Indicator: ip, Type: 'IP', Vendor: VENDOR_NAME,\
    \ Score: res.dbotScore},\n        'Report(val.ID && val.ID == obj.ID)': res.reports,\n\
    \        'IP.Address': ip\n    };\n\n    if (res.dbotScore > 2) {\n        addMalicious(context,\
    \ outputPaths.ip,{\n            Address: ip,\n            Malicious: {Vendor:\
    \ VENDOR_NAME, Description: 'IP was identified as ' + res.highetsRecordType}\n\
    \        });\n    }\n\n    return createTableEntry(\"Results:\", records, records,\
    \ context);\n}\n\nvar basicSearchDomain = function(domain) {\n    var records\
    \ = basicSearch('domain', domain);\n\n    if (!records) {\n        return {\n\
    \            Type: entryTypes.note,\n            Contents: \"No items match your\
    \ search\",\n            ContentsFormat: formats.text,\n            EntryContext:\
    \ {\n                DBotScore: {\n                    Indicator: domain,\n  \
    \                  Type: 'domain',\n                    Vendor: VENDOR_NAME,\n\
    \                    Score: 0\n                }\n            }\n        };\n\
    \    }\n\n    var res = createContextReportsAndScore(records);\n    var context\
    \ = {\n        DBotScore: {Indicator: domain, Type: 'domain', Vendor: VENDOR_NAME,\
    \ Score: res.dbotScore},\n        'Report(val.ID && val.ID == obj.ID)': res.reports,\n\
    \        'Domain.Name': domain\n    };\n\n    if (res.dbotScore > 2) {\n     \
    \   addMalicious(context, outputPaths.domain,{\n            Name: domain,\n  \
    \          Malicious: {Vendor: VENDOR_NAME, Description: 'domain was identified\
    \ as ' + res.highetsRecordType}\n        });\n    }\n\n    return createTableEntry(\"\
    Results:\", records, records, context);\n}\n\nvar basicSearchfile = function(key,\
    \ value) {\n    var records = basicSearch(key, value);\n\n    if (!records) {\n\
    \        return {\n            Type: entryTypes.note,\n            Contents: \"\
    No items match your search\",\n            ContentsFormat: formats.text,\n   \
    \         EntryContext: {\n                DBotScore: {\n                    Indicator:\
    \ value,\n                    Type: 'file',\n                    Vendor: VENDOR_NAME,\n\
    \                    Score: 0\n                }\n            }\n        };\n\
    \    }\n\n    var res = createContextReportsAndScore(records);\n    var context\
    \ = {\n        DBotScore: {Indicator: value, Type: 'file', Vendor: VENDOR_NAME,\
    \ Score: res.dbotScore},\n        'Report(val.ID && val.ID == obj.ID)': res.reports\n\
    \    };\n\n    if (res.dbotScore > 2) {\n        var malicuousObj = {\n      \
    \      Malicious: {\n                Vendor: VENDOR_NAME,\n                Description:\
    \ 'file was identified as ' + res.highetsRecordType\n            }\n        };\n\
    \        malicuousObj[key.toUpperCase()] = value;\n        addMalicious(context,\
    \ outputPaths.file, malicuousObj);\n    }\n\n    return createTableEntry(\"Results:\"\
    , records, records, context);\n}\n\nvar getReport = function(reportID) {\n   \
    \ var reportQuery = '/report/'+ encodeURIComponent(reportID);\n\n    var res =\
    \ sendRequest(reportQuery);\n    var report = res.message.report;\n\n    var context\
    \ = {\n        'Report(val.ID && val.ID == obj.ID)' : {\n            ID: report.reportId,\n\
    \            title: report.title,\n            intelligenceType: report.intelligenceType,\n\
    \            audience: report.audience,\n            publishDate: report.publishDate,\n\
    \            ThreatScape: report.ThreatScape.product,\n            operatingSystems:\
    \ report.operatingSystems,\n            riskRating: report.riskRating,\n     \
    \       version: report.version,\n            tagSection: report.tagSection\n\
    \        }\n    }\n\n    var table = [{\n        ID: report.reportId,\n      \
    \  title: report.title,\n        intelligenceType: report.intelligenceType,\n\
    \        audience: report.audience.join(),\n        publishDate: report.publishDate,\n\
    \        ThreatScape: report.ThreatScape.product.join(),\n        operatingSystems:\
    \ report.operatingSystems,\n        riskRating: report.riskRating,\n        version:\
    \ report.version\n    }];\n\n    return createTableEntry(\"Report - \" + reportID,\
    \ res, table, context);\n}\n\nvar submitFile = function(entryID, description,\
    \ type) {\n    var query = '/submit/data';\n    var requestUrl = baseUrl + query;\n\
    \    var headers = getHeaders(query);\n    var res = httpMultipart(\n        \
    \    requestUrl, // URL\n            entryID, // Optional - FilePath / EntryID\n\
    \            { // HTTP Request Headers\n                Method: 'POST',\n    \
    \            Headers: headers\n            },\n            { // Multipart Contents\n\
    \                type: type,\n                description: description\n     \
    \       },\n            insecure,\n            proxy\n        );\n\n    var statusCode\
    \ = res && res.StatusCode;\n\n    switch (statusCode) {\n        case 200:\n \
    \           return \"The file was submitted sucessfully\";\n        case 403:\n\
    \            throw \"\\nGot 403 error\\nQuery valid but the response was refused\
    \ because the user has exceeded their daily quota of submission requests\";\n\
    \        default:\n            throw '\\nSubmit File Failed.\\nUrl: ' + requestUrl\
    \ + '\\nStatus code: ' + statusCode + '.\\nResult: ' + JSON.stringify(res, null,\
    \ 2);\n    }\n}\n\nswitch (command) {\n    case 'test-module':\n        basicSearch('ip',\
    \ '66.34.253.56');\n        return 'ok';\n    case 'ip':\n        return basicSearchIP(args.ip);\n\
    \    case 'domain':\n        return basicSearchDomain(args.domain);\n    case\
    \ 'file':\n        var hash = args.file;\n        var hashLength = hash && hash.length\n\
    \        if(hashLength === 32) {\n            return basicSearchfile('md5', hash);\n\
    \        } else if(hashLength === 40) {\n            return basicSearchfile('sha1',\
    \ hash);\n        } else {\n            throw 'file argument must be md5(32 charecters)\
    \ or sha1(40 charecters) ';\n        }\n    case 'isight-get-report':\n      \
    \  return getReport(args.reportID);\n    case 'isight-submit-file':\n        return\
    \ submitFile(args.entryID, args.description, args.type);\n}\n"
  type: javascript
tests:
- No test
toversion: 4.1.9
