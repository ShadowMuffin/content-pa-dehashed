description: 'Use McAfee Active Response to collect data from an endpoint for IR purposes
  (requires ePO as well)


  Input:

  * Hostname (Default: ${Endpoint.Hostname})'
fromversion: ''
id: MAR - Endpoint data collection
inputs:
- description: Hostname to run on
  key: Hostname
  playbookInputQuery: null
  required: false
  value:
    simple: ${Endpoint.Hostname}
name: MAR - Endpoint data collection
outputs: []
starttaskid: '0'
system: true
tasks:
  '0':
    id: '0'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '1'
      - '4'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: 14834984-3a59-4eed-8de7-54179611c63d
      iscommand: false
      name: ''
      version: -1
    taskid: 14834984-3a59-4eed-8de7-54179611c63d
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 705,\n    \"y\": 50\n  }\n}"
  '1':
    id: '1'
    ignoreworker: false
    nexttasks:
      '#default#':
      - '3'
      'yes':
      - '2'
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${modules(val.brand=="epo")}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: 528a058d-8c60-46dc-80b0-8139b45eeafd
      iscommand: false
      name: is ePO enabled?
      scriptName: Exists
      type: condition
      version: -1
    taskid: 528a058d-8c60-46dc-80b0-8139b45eeafd
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 369,\n    \"y\": 195\n  }\n}"
  '10':
    id: '10'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '11'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,Services
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: 38ad462f-1c16-4c4a-8cd8-446e19c24694
      iscommand: true
      name: Get host services
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: 38ad462f-1c16-4c4a-8cd8-446e19c24694
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 612.5,\n    \"y\": 1010\n  }\n}"
  '11':
    id: '11'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '23'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,CommandLineHistory
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: 6e9fb885-21b5-417d-800c-e02aa81cb91f
      iscommand: true
      name: Get host Command line history
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: 6e9fb885-21b5-417d-800c-e02aa81cb91f
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 612.5,\n    \"y\": 1185\n  }\n}"
  '12':
    id: '12'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '13'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,CurrentFlow
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: 69f8efa1-8783-4165-8ce4-2f5e0f3db937
      iscommand: true
      name: Get host "Current flow"
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: 69f8efa1-8783-4165-8ce4-2f5e0f3db937
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1042.5,\n    \"y\": 660\n  }\n}"
  '13':
    id: '13'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '18'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,DNSCache
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: 08612fec-a2cb-4b1c-8a10-e8148722075f
      iscommand: true
      name: Get host DNS cache
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: 08612fec-a2cb-4b1c-8a10-e8148722075f
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1042.5,\n    \"y\": 835\n  }\n}"
  '14':
    id: '14'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '21'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,EnvironmentVariables
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: 5479417e-4e95-422a-8e92-4f585f40fd50
      iscommand: true
      name: Get host environment variables
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: 5479417e-4e95-422a-8e92-4f585f40fd50
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1902.5,\n    \"y\": 1360\n  }\n}"
  '15':
    id: '15'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '17'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,LocalGroups
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: cd3926a0-6157-4ef3-8fd1-86b6cbd79e7c
      iscommand: true
      name: Get host local groups
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: cd3926a0-6157-4ef3-8fd1-86b6cbd79e7c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1472.5,\n    \"y\": 1185\n  }\n}"
  '17':
    id: '17'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '22'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,LoggedInUsers
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: 0287ca41-8587-4bb2-84d6-4824b5133df1
      iscommand: true
      name: Get host logged in users
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: 0287ca41-8587-4bb2-84d6-4824b5133df1
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1472.5,\n    \"y\": 1360\n  }\n}"
  '18':
    id: '18'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '19'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,NetworkShares
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: c781977e-2b17-4273-86c2-246912262601
      iscommand: true
      name: Get host network shares
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: c781977e-2b17-4273-86c2-246912262601
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1042.5,\n    \"y\": 1010\n  }\n}"
  '19':
    id: '19'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '20'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,InteractiveSessions
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: ebfbc02e-b674-4899-8586-ea8621533c3b
      iscommand: true
      name: Get host interactive sessions
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: ebfbc02e-b674-4899-8586-ea8621533c3b
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1042.5,\n    \"y\": 1185\n  }\n}"
  '2':
    id: '2'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '3'
    note: false
    quietmode: 0
    scriptarguments:
      searchText:
        simple: ${inputs.Hostname}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: 5c61873e-d9e2-4967-8776-82db5c05628b
      iscommand: false
      name: Get host info from ePO
      scriptName: EPOFindSystem
      type: regular
      version: -1
    taskid: 5c61873e-d9e2-4967-8776-82db5c05628b
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 92.5,\n    \"y\": 355\n  }\n}"
  '20':
    id: '20'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '24'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,NetworkInterfaces
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: 79f385d1-1aa0-47f9-84de-f0b579492151
      iscommand: true
      name: Get host network interfaces
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: 79f385d1-1aa0-47f9-84de-f0b579492151
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1042.5,\n    \"y\": 1360\n  }\n}"
  '21':
    id: '21'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '3'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,UsbConnectedStorageDevices
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: c35f205c-5c9a-4846-85b9-0a11e1b9f5ad
      iscommand: true
      name: Get host's connected USB Storage Devices
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: c35f205c-5c9a-4846-85b9-0a11e1b9f5ad
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1902.5,\n    \"y\": 1535\n  }\n}"
  '22':
    id: '22'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '3'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,UserProfiles
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: cac5062b-32b7-4789-8f25-c28ea0e40873
      iscommand: true
      name: Get host user profiles
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: cac5062b-32b7-4789-8f25-c28ea0e40873
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1472.5,\n    \"y\": 1535\n  }\n}"
  '23':
    id: '23'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '25'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,Software
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: 00e3cf95-5dda-411c-8ec5-027ba3348a21
      iscommand: true
      name: Get host installed software
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: 00e3cf95-5dda-411c-8ec5-027ba3348a21
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 612.5,\n    \"y\": 1360\n  }\n}"
  '24':
    id: '24'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '3'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,NetworkSessions
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: 4afc3a44-f5f9-462a-8f41-dc697c9366e2
      iscommand: true
      name: Get host Network Sessions
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: 4afc3a44-f5f9-462a-8f41-dc697c9366e2
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1042.5,\n    \"y\": 1535\n  }\n}"
  '25':
    id: '25'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '3'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,Startup
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: e7fcd15d-3273-4163-803e-26d5e76f712e
      iscommand: true
      name: Get host Startup items
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: e7fcd15d-3273-4163-803e-26d5e76f712e
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 612.5,\n    \"y\": 1535\n  }\n}"
  '26':
    id: '26'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '27'
      - '28'
      - '29'
      - '30'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: 41252036-b29b-4a75-82e7-68fe3fa9b0a5
      iscommand: false
      name: Collect data from endpoint
      type: title
      version: -1
    taskid: 41252036-b29b-4a75-82e7-68fe3fa9b0a5
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 1257.5,\n    \"y\": 370\n  }\n}"
  '27':
    id: '27'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '15'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: 23bbdc19-0b43-4b5e-8d2b-939183909e09
      iscommand: false
      name: Users and groups
      type: title
      version: -1
    taskid: 23bbdc19-0b43-4b5e-8d2b-939183909e09
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 1472.5,\n    \"y\": 515\n  }\n}"
  '28':
    id: '28'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '9'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: bf8c2f0a-d98b-4059-82db-a9f06f937177
      iscommand: false
      name: Executable
      type: title
      version: -1
    taskid: bf8c2f0a-d98b-4059-82db-a9f06f937177
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 612.5,\n    \"y\": 515\n  }\n}"
  '29':
    id: '29'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '12'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: abee0804-81a8-45da-8fab-a3792b165c49
      iscommand: false
      name: Network
      type: title
      version: -1
    taskid: abee0804-81a8-45da-8fab-a3792b165c49
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 1042.5,\n    \"y\": 515\n  }\n}"
  '3':
    id: '3'
    ignoreworker: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: fed35557-6859-44e6-817a-ee0538819714
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: fed35557-6859-44e6-817a-ee0538819714
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 612.5,\n    \"y\": 1710\n  }\n}"
  '30':
    id: '30'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '14'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: c5ff2c93-f30c-45eb-87b7-bcd676d1e7a2
      iscommand: false
      name: Others
      type: title
      version: -1
    taskid: c5ff2c93-f30c-45eb-87b7-bcd676d1e7a2
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 1902.5,\n    \"y\": 515\n  }\n}"
  '4':
    id: '4'
    ignoreworker: false
    nexttasks:
      '#default#':
      - '3'
      'yes':
      - '26'
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${modules(val.brand=="McAfee Active Response")}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: ''
      id: 71f42a72-b2e7-479a-86e7-bc6ff218671e
      iscommand: false
      name: is MAR enabled?
      scriptName: Exists
      type: condition
      version: -1
    taskid: 71f42a72-b2e7-479a-86e7-bc6ff218671e
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 1122,\n    \"y\": 195\n  }\n}"
  '6':
    id: '6'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '10'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,Processes
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: d3c21d0d-fc2a-4ba5-8bb9-da70f49ae96c
      iscommand: true
      name: Get host Processes
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: d3c21d0d-fc2a-4ba5-8bb9-da70f49ae96c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 612.5,\n    \"y\": 835\n  }\n}"
  '9':
    id: '9'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '6'
    note: false
    quietmode: 0
    scriptarguments:
      collector:
        simple: Processes
      collectors:
        simple: HostInfo,ScheduledTasks
      filter-by:
        simple: hostname
      filter-operator:
        simple: Equals
      filter-value:
        simple: ${inputs.Hostname}
      filter_collector:
        simple: HostInfo
      outputs: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: McAfee Active Response
      description: ''
      id: 98827aec-511a-4f30-8fdb-04240496380d
      iscommand: true
      name: Get host Scheduled tasks
      script: McAfee Active Response|||mar-search-multiple
      type: regular
      version: -1
    taskid: 98827aec-511a-4f30-8fdb-04240496380d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 612.5,\n    \"y\": 660\n  }\n}"
tests:
- MAR - Endpoint data collection test
toversion: 4.1.9
version: -1
view: "{\n  \"linkLabelsPosition\": {\n    \"1_2_yes\": 0.54\n  },\n  \"paper\": {\n\
  \    \"dimensions\": {\n      \"height\": 1725,\n      \"width\": 2190,\n      \"\
  x\": 92.5,\n      \"y\": 50\n    }\n  }\n}"
