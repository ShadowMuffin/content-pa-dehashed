comment: ''
commonfields:
  id: SsdeepReputationTest
  version: -1
enabled: true
name: SsdeepReputationTest
outputs:
- contextPath: expectBadSsdeepValue
  description: ''
runas: DBotWeakRole
runonce: false
script: "import time\n\ndef get_indicator_from_value(indicator_value):\n    try:\n\
  \        res = demisto.executeCommand(\"findIndicators\", {'value': indicator_value})\n\
  \        indicator = res[0]['Contents'][0]\n        return indicator\n    except:\n\
  \        pass\n\nincident = demisto.incidents()[0]\nssdeep1 = \"768:P7XINhXznVJ8CC1rBXdo0zekXUd3CdPJxB7mNmDZkUKMKZQbFTiKKAZTe:yhT8C+fuioHq1KEFoA7\"\
  \nssdeep2 = \"768:P7XINhXznVJ8CC1rBXdo0zekXUd3CdPJxB7mNmDZkUKMKZQbFTiKKAZT6:yhT8C+fuioHq1KEFoA8\"\
  \nres = demisto.executeCommand(\"createNewIndicator\", {\"type\": \"ssdeep\", \"\
  value\": ssdeep1, \"seenNow\": True, \"merge\": True, \"reputation\": \"Good\",\
  \ 'relatedIncidents': incident['id']})\nres = demisto.executeCommand(\"createNewIndicator\"\
  , {\"type\": \"ssdeep\", \"value\": ssdeep2, \"seenNow\": True, \"merge\": True,\
  \ \"reputation\": \"Good\", 'relatedIncidents': incident['id']})\n\ndemisto.setContext('expectBadSsdeepValue',\
  \ ssdeep2)\nmd5 = \"be0975d3ae691cf77f4f0952e791a0fb\"\nres = demisto.executeCommand(\"\
  createNewIndicator\", {\"type\": \"md5\", \"value\": md5, \"seenNow\": True, \"\
  merge\": True, \"reputation\": \"Bad\", 'relatedIncidents': incident['id']})\nres\
  \ = demisto.setContext(\"File\", {\n    \"MD5\": md5,\n    \"SSDeep\": ssdeep1\n\
  })\n"
scripttarget: 0
subtype: python2
tags: []
toversion: 4.1.9
type: python
