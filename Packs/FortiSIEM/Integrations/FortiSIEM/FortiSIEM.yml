category: Analytics & SIEM
commonfields:
  id: FortiSIEM
  version: -1
configuration:
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- defaultvalue: ''
  display: Server URL (e.g. https://192.168.0.1)
  name: host
  required: true
  type: 0
- defaultvalue: ''
  display: Credentials
  name: credentials
  required: true
  type: 9
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: unsecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Search and update events of FortiSIEM and manage resource lists.
display: FortiSIEM
name: FortiSIEM
script:
  commands:
  - arguments:
    - description: ID of the incident by which to filter.
      name: incID
      required: true
    - defaultValue: '10'
      description: Maximum number of results to return.
      name: maxResults
    - auto: PREDEFINED
      defaultValue: 'true'
      description: Whether to extend the data.
      name: extendedData
      predefined:
      - 'true'
      - 'false'
    - defaultValue: '60'
      description: Maximum time for the event report to finish (in seconds).
      name: maxWaitTime
    description: Get events by incidents
    name: fortisiem-get-events-by-incident
    outputs:
    - contextPath: FortiSIEM.Events.EventType
      description: Event type.
      type: string
    - contextPath: FortiSIEM.Events.EventID
      description: FortiSIEM Event ID.
      type: string
    - contextPath: FortiSIEM.Events.RawEventLog
      description: Raw Event Log.
      type: string
    - contextPath: FortiSIEM.Events.ReportingDevice
      description: Reporting Device.
      type: string
    - contextPath: FortiSIEM.Events.IncidentID
      description: Incident ID.
      type: number
    - contextPath: FortiSIEM.Events.User
      description: Event User.
      type: string
    - contextPath: FortiSIEM.Events.EventReceiveTime
      description: Event received timestamp.
      type: number
    - contextPath: FortiSIEM.Events.EventName
      description: Event Name.
      type: string
    - contextPath: FortiSIEM.Events.ReportingIP
      description: Reporting IP address.
      type: string
    - contextPath: FortiSIEM.Events.SystemEventCategory
      description: System Event Category.
      type: string
    - contextPath: FortiSIEM.Events.EventAction
      description: EventAction.
      type: string
    - contextPath: FortiSIEM.Events.RelayingIP
      description: Relaying IP address.
      type: string
    - contextPath: FortiSIEM.Events.EventSeverityCategory
      description: Severity Category.
      type: string
    - contextPath: FortiSIEM.Events.OrganizationName
      description: Organization Name.
      type: string
    - contextPath: FortiSIEM.Events.ReportingVendor
      description: Reporting Vendor.
      type: string
    - contextPath: FortiSIEM.Events.ReportingModel
      description: Reporting Model.
      type: string
    - contextPath: FortiSIEM.Events.OrganizationName
      description: Organization name.
      type: string
    - contextPath: FortiSIEM.Events.CollectorID
      description: Collector ID.
      type: number
    - contextPath: FortiSIEM.Events.EventParserName
      description: Name of raw event parser.
      type: string
    - contextPath: FortiSIEM.Events.HostIP
      description: Host IP address.
      type: string
    - contextPath: FortiSIEM.Events.HostName
      description: Host name.
      type: string
    - contextPath: FortiSIEM.Events.FileName
      description: Name of the file associated with the event.
      type: string
    - contextPath: FortiSIEM.Events.ProcessName
      description: Name of the process associated with the event.
      type: string
    - contextPath: FortiSIEM.Events.JobName
      description: Name of the job associated with the event.
      type: string
    - contextPath: FortiSIEM.Events.Status
      description: Event status.
      type: string
    - contextPath: FortiSIEM.Events.DestinationPort
      description: Port of the traffic's destination.
      type: string
    - contextPath: FortiSIEM.Events.SourcePort
      description: Port of the traffic's origin.
      type: string
    - contextPath: FortiSIEM.Events.DestinationIP
      description: Destination IP address for the web.
      type: string
    - contextPath: FortiSIEM.Events.SourceIP
      description: 'IP address of the traffic''s origin. The source varies by the
        direction: l In HTTP requests, this is the web browser or other client. l
        In HTTP responses, this is the physical server.'
      type: string
    - contextPath: FortiSIEM.Events.ExtendedData
      description: All additional data returned by FortiSIEM.
      type: string
    - contextPath: FortiSIEM.Events.DestinationInterface
      description: Interface of the traffic's destination.
      type: string
    - contextPath: FortiSIEM.Events.NATTranslation
      description: NAT source port.
      type: string
    - contextPath: FortiSIEM.Events.Protocol
      description: 'tcp: The protocol used by web traffic (tcp by default).'
      type: string
    - contextPath: FortiSIEM.Events.SourceMAC
      description: MAC address associated with the source IP address.
      type: string
    - contextPath: FortiSIEM.Events.NATIP
      description: NAT source IP.
      type: string
  - arguments:
    - description: ID of the incident to close.
      name: incident_id
      required: true
    - description: Reason for closing.
      name: close_reason
    description: Clear (close) a FortiSIEM incident.
    name: fortisiem-clear-incident
  - arguments:
    - defaultValue: '10'
      description: Maximum number of results to return.
      name: maxResults
    - auto: PREDEFINED
      defaultValue: 'true'
      description: Whether to extend the data.
      name: extendedData
      predefined:
      - 'true'
      - 'false'
    - defaultValue: '60'
      description: Maximum time for the event report to finish (in seconds).
      name: maxWaitTime
    - description: Reporting IP address.
      name: reptDevIpAddr
    - description: Destination IP address.
      name: destIpAddr
    - description: Source IP address.
      name: srcIpAddr
    - description: Destination MAC address.
      name: destMACAddr
    - description: Source MAC address.
      name: srcMACAddr
    - description: Destination domain.
      name: destDomain
    - description: Source domain.
      name: srcDomain
    - description: Destination name.
      name: destName
    - description: Source name.
      name: srcName
    - description: Destination action.
      name: destAction
    - description: Destination user.
      name: destUser
    - defaultValue: '1'
      description: Relative report time value.
      name: reportWindow
    - auto: PREDEFINED
      defaultValue: Minute
      description: Relative report time unit.
      name: reportWindowUnit
      predefined:
      - Minute
      - Day
      - Hour
      - Daily
    - description: event type.
      name: eventType
    - description: Source geo country.
      name: srcGeoCountry
    - description: User.
      name: User
    description: Returns an event list according to the specified filters.
    name: fortisiem-get-events-by-filter
    outputs:
    - contextPath: FortiSIEM.Events.EventType
      description: FortiSIEM event type.
      type: Unknown
    - contextPath: FortiSIEM.Events.SourceCountry
      description: Event source country.
      type: Unknown
  - arguments:
    - description: CSV list of device IPs.
      name: device_ip
    - defaultValue: '50'
      description: Maximum number of results to return.
      name: limit
    description: Returns the description of each device.
    name: fortisiem-get-cmdb-devices
    outputs:
    - contextPath: FortiSIEM.CmdbDevice
      description: CMDB devices.
      type: Unknown
  - arguments:
    - description: The query to get events.
      name: query
      required: true
    - defaultValue: '60'
      description: Interval time of the search.
      name: report-window
    - auto: PREDEFINED
      defaultValue: Minute
      description: Interval unit.
      name: interval-type
      predefined:
      - Minute
      - Hourly
      - Daily
    - description: Maximum number of results to return.
      name: limit
    - auto: PREDEFINED
      defaultValue: 'true'
      description: Whether to extend the data.
      name: extended-data
      predefined:
      - 'true'
      - 'false'
    - description: Command timeout.
      name: max-wait-time
    description: Returns event list filtered by query
    name: fortisiem-get-events-by-query
    outputs:
    - contextPath: FortiSIEM.Events.EventType
      description: FortiSIEM event type.
      type: Unknown
    - contextPath: FortiSIEM.Events.SourceCountry
      description: Event source country.
      type: Unknown
  - arguments: []
    description: Get all FortiSIEM resource lists hierarchy.
    name: fortisiem-get-lists
  - arguments:
    - description: ID of the resource group. Run the "fortisiem-get-lists" command
        to get the ID. command.
      name: group_id
      required: true
    - description: 'CSV list of key-value pairs of attributes, for example: name=SomeName,lowIp=192.168.1.1,highIp=192.168.1.2'
      name: object-info
      required: true
    - auto: PREDEFINED
      description: Resource Type
      name: resource_type
      predefined:
      - Reports
      - Rules
      - Networks
      - Watch Lists
      - Protocols
      - Malware IP
      - Event Type
      - Malware Domains
      - Malware Urls
      - Malware Hash
      - Malware Processes
      - Country Groups
      - Default Password
      - Anonymity Network
      - User Agents
      - Remediations
      required: true
    description: add element to a resource list.
    name: fortisiem-add-item-to-resource-list
    outputs:
    - contextPath: FortiSIEM.Resource
      description: 'Resource object in fortiSIEM lists. '
      type: Unknown
  - arguments:
    - description: CSV list of resource IDs.
      name: ids
      required: true
    - auto: PREDEFINED
      description: Resource Type
      name: resource_type
      predefined:
      - Reports
      - Rules
      - Networks
      - Watch Lists
      - Protocols
      - Malware IP
      - Event Type
      - Malware Domains
      - Malware Urls
      - Malware Hash
      - Malware Processes
      - Country Groups
      - Default Password
      - Anonymity Network
      - User Agents
      - Remediations
      required: true
    description: Removes elements from a resource list.
    name: fortisiem-remove-item-from-resource-list
  - arguments:
    - description: ID of the resource group. Run the "fortisiem-get-lists" command
        to get the ID.
      name: group_id
      required: true
    - auto: PREDEFINED
      description: Resource type.
      name: resource_type
      predefined:
      - Reports
      - Rules
      - Networks
      - Watch Lists
      - Protocols
      - Malware IP
      - Event Type
      - Malware Domains
      - Malware Urls
      - Malware Hash
      - Malware Processes
      - Country Groups
      - Default Password
      - Anonymity Network
      - User Agents
      - Remediations
      required: true
    description: Lists all elements in a resource list.
    name: fortisiem-get-resource-list
  isfetch: true
  runonce: false
  script: '-'
  subtype: python2
  type: python
tests:
- No Test
toversion: 4.1.9
