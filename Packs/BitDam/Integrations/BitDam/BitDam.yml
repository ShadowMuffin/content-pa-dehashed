category: Email Gateway
commonfields:
  id: BitDam
  version: -1
configuration:
- defaultvalue: https://app.bitdam.com/api/v1.0
  display: BitDam API URL
  name: url
  required: true
  type: 0
- defaultvalue: ''
  display: API Token
  name: apitoken
  required: true
  type: 4
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: BitDam secure email gateway protects from advanced content-borne threats
  with the most accurate prevention of known and unknown threats, at their source.
display: BitDam
name: BitDam
script:
  commands:
  - arguments:
    - description: The file's entry ID from the War Room. Supported files types are
        doc, dot, docx, docm, dotx, dotm, pdf, rtf, xls, xlt, xlsx, xlsm, xltx, xltm,
        xlsb, xlam, csv, ppt, pptx, pptm, potx, potm, ppam, ppsx, ppsm and pps.
      name: entryId
      required: true
    description: Uploads a file sample to the BitDam service.
    name: bitdam-upload-file
    outputs:
    - contextPath: BitDam.FileScan.SHA1
      description: The SHA1 hash of the file.
      type: string
  - arguments:
    - description: The value of the file's unique identifier (for example - file's
        SHA1)
      name: idValue
      required: true
    description: Returns the verdict for a scanned file.
    name: bitdam-get-verdict
    outputs:
    - contextPath: BitDam.Analysis.Status
      description: The status of the analysis. Can be "DONE" or "IN_PROGRESS".
      type: string
    - contextPath: BitDam.Analysis.Verdict
      description: The final verdict of the analysis.
      type: string
    - contextPath: BitDam.Analysis.ID
      description: The unique identifier of the analysis.
      type: string
    - contextPath: DBotScore.Indicator
      description: The indicator.
      type: string
    - contextPath: DBotScore.Score
      description: The DBot score.
      type: number
    - contextPath: DBotScore.Type
      description: The indicator Type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The DBot score vendor.
      type: string
    - contextPath: File.Malicious.Name
      description: The name of the file.
      type: string
    - contextPath: File.Malicious.Vendor
      description: For malicious files, the vendor that made the decision.
      type: string
    - contextPath: File.Malicious.Description
      description: For malicious files, the reason that the vendor made the decision.
      type: string
  runonce: false
  script: ''
  subtype: python3
  type: python
tests:
- Detonate File - BitDam Test
toversion: 4.1.9
