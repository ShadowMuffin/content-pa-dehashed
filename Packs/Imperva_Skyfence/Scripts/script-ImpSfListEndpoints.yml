args: []
comment: The endpoints list request enables a client application to receive a list
  of all managed and unmanaged endpoints, with their basic details. This list can
  then be externally filtered or searched by the application to identify individual
  endpoints that might require action. For any such endpoint, the application can
  obtain fuller details (see Endpoint Details Request below) and if relevant change
  its enrollment status.
commonfields:
  id: ImpSfListEndpoints
  version: -1
dependson:
  must:
  - imp-sf-list-endpoints
name: ImpSfListEndpoints
script: "\nresp = demisto.executeCommand(\"imp-sf-list-endpoints\", demisto.args())\n\
  \nif isError(resp[0]):\n    demisto.results(resp)\nelse:\n    data = demisto.get(resp[0],\
  \ \"Contents.result\")\n    if data:\n        for i in range(len(data)):\n     \
  \     data[i][LAST_UPDATED_FORMATED] = datetime.datetime.fromtimestamp(float(data[i]['last_updated'])\
  \ / 1000.0).strftime(\"%Y-%m-%d %H:%M:%S\")\n\n        data = data if isinstance(data,\
  \ list) else [data]\n        data = [{k: formatCell(row[k]) for k in row} for row\
  \ in data]\n        demisto.results({\"ContentsFormat\": formats[\"table\"], \"\
  Type\": entryTypes[\"note\"], \"Contents\": data} )\n    else:\n        demisto.results(\"\
  No results.\")\n"
scripttarget: 0
subtype: python2
system: true
tags:
- Imperva Skyfence
timeout: 0s
toversion: 4.1.9
type: python
