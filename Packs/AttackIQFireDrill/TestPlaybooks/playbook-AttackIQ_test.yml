id: AttackIQ - Test
inputs: []
name: AttackIQ - Test
outputs: []
starttaskid: '0'
tasks:
  '0':
    id: '0'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '1'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: aa4fc742-6d67-4885-86c7-4c67a220b01a
      iscommand: false
      name: ''
      version: -1
    taskid: aa4fc742-6d67-4885-86c7-4c67a220b01a
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 50\n  }\n}"
  '1':
    id: '1'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '2'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: b8b24a45-d873-4630-852b-385533b27f87
      iscommand: false
      name: Clear Context
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: b8b24a45-d873-4630-852b-385533b27f87
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 195\n  }\n}"
  '10':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.Id
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.Name
          operator: isEqualString
          right:
            value:
              simple: Arseny's ransomware project
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.Description
          operator: isEqualString
          right:
            value:
              simple: Test of common ransomware variants
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.AssessmentState
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.Creator
          operator: isEqualString
          right:
            value:
              simple: foo@test.com
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.Owner
          operator: isEqualString
          right:
            value:
              simple: foo@test.com
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.User
          operator: isEqualString
          right:
            value:
              simple: foo@test.com
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.Created
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.Modified
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.Users
          operator: containsGeneral
          right:
            value:
              simple: 71e92cf9-5159-466c-8050-142d1ba279ea
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.DefaultAssetCount
          operator: isEqualNumber
          right:
            value:
              simple: '1'
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.DefaultAssetGroupCount
          operator: isEqualNumber
          right:
            value:
              simple: '0'
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.MasterJobCount
          operator: isEqualNumber
          right:
            value:
              simple: '3'
      label: 'yes'
    id: '10'
    ignoreworker: false
    nexttasks:
      'yes':
      - '11'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 7b757335-0be5-4f61-8155-6d150269d9f5
      iscommand: false
      name: Assert assessments
      type: condition
      version: -1
    taskid: 7b757335-0be5-4f61-8155-6d150269d9f5
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1420\n  }\n}"
  '11':
    id: '11'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '12'
    note: false
    scriptarguments:
      assessment_id:
        simple: c4e352ae-1506-4c74-bd90-853f02dd765a
    separatecontext: false
    task:
      brand: ''
      id: e5bc34be-103d-403c-8294-33b92cf75dd3
      iscommand: true
      name: Get tests by assessment
      script: '|||attackiq-list-tests-by-assessment'
      type: regular
      version: -1
    taskid: e5bc34be-103d-403c-8294-33b92cf75dd3
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1595\n  }\n}"
  '12':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: AttackIQTest.TotalAssetCount
          operator: greaterThanOrEqual
          right:
            value:
              simple: '1'
      - - left:
            iscontext: true
            value:
              simple: AttackIQTest.User
          operator: isEqualString
          right:
            value:
              simple: foo@test.com
      - - left:
            iscontext: true
            value:
              simple: AttackIQTest.Created
          operator: isEqualString
          right:
            value:
              simple: '2019-08-27T10:17:09.968467Z'
      - - left:
            iscontext: true
            value:
              simple: AttackIQTest.UsingDefaultAssets
          operator: isTrue
      - - left:
            iscontext: true
            value:
              simple: AttackIQTest.UsingDefaultSchedule
          operator: isTrue
      - - left:
            iscontext: true
            value:
              simple: AttackIQTest.Scenarios.Id
          operator: isEqualString
          right:
            value:
              simple: b7425756-ab9a-4c7e-8fda-d1080c170910
      - - left:
            iscontext: true
            value:
              simple: AttackIQTest.Scenarios.Name
          operator: isEqualString
          right:
            value:
              simple: Download Petya Ransomware
      - - left:
            iscontext: true
            value:
              simple: AttackIQTest.Assets.Id
          operator: isEqualString
          right:
            value:
              simple: 03e17460-849e-4b86-b6c6-ef0db72823ff
      - - left:
            iscontext: true
            value:
              simple: AttackIQTest.Assets.Ipv4Address
          operator: isEqualString
          right:
            value:
              simple: 172.31.39.254
      - - left:
            iscontext: true
            value:
              simple: AttackIQTest.Assets.Hostname
          operator: isEqualString
          right:
            value:
              simple: ec2amaz-g4iu5no
      - - left:
            iscontext: true
            value:
              simple: AttackIQTest.Assets.ProductName
          operator: isEqualString
          right:
            value:
              simple: Windows Server 2016 Datacenter
      - - left:
            iscontext: true
            value:
              simple: AttackIQTest.Assets.Status
          operator: isEqualString
          right:
            value:
              simple: Active
      label: 'yes'
    id: '12'
    ignoreworker: false
    nexttasks:
      'yes':
      - '15'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 6fc050d7-9dc7-4f16-8561-e21f85052f9a
      iscommand: false
      name: Assert tests
      type: condition
      version: -1
    taskid: 6fc050d7-9dc7-4f16-8561-e21f85052f9a
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1770\n  }\n}"
  '13':
    id: '13'
    ignoreworker: false
    note: false
    separatecontext: false
    task:
      brand: ''
      description: runs all of the tests in the assessment.
      id: b323f345-f89c-48d1-827c-ebd050dc85f2
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: b323f345-f89c-48d1-827c-ebd050dc85f2
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 5310\n  }\n}"
  '14':
    id: '14'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '16'
    note: false
    scriptarguments:
      assessment_id:
        simple: c4e352ae-1506-4c74-bd90-853f02dd765a
    separatecontext: false
    task:
      brand: ''
      description: Get all assessments in a page or by assessment id.
      id: a24b2e45-730f-412a-81a7-428a15e69610
      iscommand: true
      name: Get assessment by id
      script: '|||attackiq-get-assessment-by-id'
      type: regular
      version: -1
    taskid: a24b2e45-730f-412a-81a7-428a15e69610
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2120\n  }\n}"
  '15':
    id: '15'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '14'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 3deb49e1-32d2-4c32-8bc7-37f5c761069e
      iscommand: false
      name: Clear Context
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 3deb49e1-32d2-4c32-8bc7-37f5c761069e
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1945\n  }\n}"
  '16':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.Id
          operator: isEqualString
          right:
            value:
              simple: c4e352ae-1506-4c74-bd90-853f02dd765a
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.DefaultSchedule
          operator: isEqualString
          right:
            value:
              simple: 41;8;*;*;1
      label: 'yes'
    id: '16'
    ignoreworker: false
    nexttasks:
      'yes':
      - '17'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: c3734332-9469-4833-8ab2-b4c53ca1ff22
      iscommand: false
      name: Assert get assessment results
      type: condition
      version: -1
    taskid: c3734332-9469-4833-8ab2-b4c53ca1ff22
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2295\n  }\n}"
  '17':
    id: '17'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '18'
    note: false
    scriptarguments:
      outcome_filter:
        simple: Failed
      page_number: {}
      page_size: {}
      show_last_result: {}
      test_id:
        simple: 1c350a5a-84f2-4938-93d8-cc31f0a99482
    separatecontext: false
    task:
      brand: ''
      description: Returns the test results of an assessment.
      id: bd59e663-6030-497d-8d86-0ca9feddd4b4
      iscommand: true
      name: Get task results with Failed
      script: '|||attackiq-get-test-results'
      type: regular
      version: -1
    taskid: bd59e663-6030-497d-8d86-0ca9feddd4b4
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2470\n  }\n}"
  '18':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: AttackIQTestResult.Id
          operator: isNotExists
      label: No Results
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Id
                root: AttackIQTestResult
                transformers:
                - operator: count
          operator: isEqualNumber
          right:
            value:
              simple: '10'
      label: All Results
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Id
                root: AttackIQTestResult
                transformers:
                - operator: count
          operator: isEqualNumber
          right:
            value:
              simple: '10'
      label: Some Results
    id: '18'
    ignoreworker: false
    nexttasks:
      All Results:
      - '21'
      No Results:
      - '19'
      Some Results:
      - '28'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 2c607f94-02f5-42db-84a4-2f47ceba24e9
      iscommand: false
      name: Assert results
      type: condition
      version: -1
    taskid: 2c607f94-02f5-42db-84a4-2f47ceba24e9
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2650\n  }\n}"
  '19':
    id: '19'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '20'
    note: false
    scriptarguments:
      outcome_filter:
        simple: Passed
      page_number: {}
      page_size: {}
      show_last_result: {}
      test_id:
        simple: 1c350a5a-84f2-4938-93d8-cc31f0a99482
    separatecontext: false
    task:
      brand: ''
      description: Returns the test results of an assessment.
      id: 4b8af899-2007-40e9-8ef5-faa48c577665
      iscommand: true
      name: Get task results with Passed
      script: '|||attackiq-get-test-results'
      type: regular
      version: -1
    taskid: 4b8af899-2007-40e9-8ef5-faa48c577665
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 500,\n    \"y\": 2820\n  }\n}"
  '2':
    id: '2'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '3'
    note: false
    scriptarguments:
      assessment_id:
        simple: c4e352ae-1506-4c74-bd90-853f02dd765a
    separatecontext: false
    task:
      brand: ''
      description: Activates the assessment. this is required for execution.
      id: c2dfe87f-c2d3-40eb-805c-218876b12b0c
      iscommand: true
      name: Activate assessment
      script: '|||attackiq-activate-assessment'
      type: regular
      version: -1
    taskid: c2dfe87f-c2d3-40eb-805c-218876b12b0c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 370\n  }\n}"
  '20':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Id
                root: AttackIQTestResult
                transformers:
                - operator: count
          operator: isEqualNumber
          right:
            value:
              simple: '10'
      label: 'yes'
    id: '20'
    ignoreworker: false
    nexttasks:
      'yes':
      - '28'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: d51792b6-2fdd-4671-8f33-9590b1c46d05
      iscommand: false
      name: Assert all results
      type: condition
      version: -1
    taskid: d51792b6-2fdd-4671-8f33-9590b1c46d05
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 500,\n    \"y\": 3030\n  }\n}"
  '21':
    id: '21'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '22'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 52c91407-2f41-4abc-8054-3b808182e14a
      iscommand: false
      name: Clear Context
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 52c91407-2f41-4abc-8054-3b808182e14a
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -350,\n    \"y\": 2820\n  }\n}"
  '22':
    id: '22'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '23'
    note: false
    scriptarguments:
      outcome_filter:
        simple: Passed
      page_number: {}
      page_size: {}
      show_last_result: {}
      test_id:
        simple: 1c350a5a-84f2-4938-93d8-cc31f0a99482
    separatecontext: false
    task:
      brand: ''
      description: Returns the test results of an assessment.
      id: 7ed08cab-fa81-4c36-80c9-1fb5633722d6
      iscommand: true
      name: Get task results with Passed
      script: '|||attackiq-get-test-results'
      type: regular
      version: -1
    taskid: 7ed08cab-fa81-4c36-80c9-1fb5633722d6
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": -350,\n    \"y\": 3000\n  }\n}"
  '23':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Id
                root: AttackIQTestResult
                transformers:
                - operator: count
          operator: isNotExists
      label: 'yes'
    id: '23'
    ignoreworker: false
    nexttasks:
      'yes':
      - '28'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: df6ce789-8c77-404a-89cb-25b227c9a7c9
      iscommand: false
      name: Assert no results
      type: condition
      version: -1
    taskid: df6ce789-8c77-404a-89cb-25b227c9a7c9
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": -350,\n    \"y\": 3195\n  }\n}"
  '24':
    id: '24'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '25'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: List all available assessment templates.
      id: 7d0c8121-b6bb-4898-8a0b-40e1bfb48746
      iscommand: true
      name: List templates
      script: '|||attackiq-list-assessment-templates'
      type: regular
      version: -1
    taskid: 7d0c8121-b6bb-4898-8a0b-40e1bfb48746
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3550\n  }\n}"
  '25':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${AttackIQ.Template.[0].ID}
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Template.Name
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Template.ProjectName
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Template.Description
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: ${AttackIQ.Template.ProjectDescription}
          operator: isExists
      label: 'yes'
    id: '25'
    ignoreworker: false
    nexttasks:
      'yes':
      - '26'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 35b43d81-ee64-4680-80d7-a07890f4e597
      iscommand: false
      name: Assert outputs
      type: condition
      version: -1
    taskid: 35b43d81-ee64-4680-80d7-a07890f4e597
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3715\n  }\n}"
  '26':
    id: '26'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '27'
    note: false
    scriptarguments:
      name:
        simple: Assessment from test playbook
      template_id:
        simple: ${AttackIQ.Template.[0].ID}
    separatecontext: false
    task:
      brand: ''
      description: Create a new assesment.
      id: c75ee702-174d-43d7-8959-c8461e2f7c35
      iscommand: true
      name: Create new assesment
      script: '|||attackiq-create-assessment'
      type: regular
      version: -1
    taskid: c75ee702-174d-43d7-8959-c8461e2f7c35
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3880\n  }\n}"
  '27':
    id: '27'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '34'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: List all assets.
      id: 89c1361d-a2e9-4894-8c39-5c9fe2f8570d
      iscommand: true
      name: List assets
      script: '|||attackiq-list-assets'
      type: regular
      version: -1
    taskid: 89c1361d-a2e9-4894-8c39-5c9fe2f8570d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4060\n  }\n}"
  '28':
    id: '28'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '24'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 986d41c7-8294-4942-818e-de4c3ab9ed91
      iscommand: false
      name: Clear context
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 986d41c7-8294-4942-818e-de4c3ab9ed91
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3370\n  }\n}"
  '29':
    id: '29'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '30'
    note: false
    scriptarguments:
      assessment_id:
        simple: ${AttackIQ.Assessment.Id}
      asset_groups: {}
      assets:
        simple: ${AttackIQ.Asset.ID}
    separatecontext: false
    task:
      brand: ''
      description: Add assets or asset groups to an assesment.
      id: 90e244f0-be39-4710-83de-b6d160737cc6
      iscommand: true
      name: Add asset to new assessment
      script: '|||attackiq-add-assets-to-assessment'
      type: regular
      version: -1
    taskid: 90e244f0-be39-4710-83de-b6d160737cc6
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4390\n  }\n}"
  '3':
    id: '3'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '4'
    note: false
    scriptarguments:
      assessment_id:
        simple: c4e352ae-1506-4c74-bd90-853f02dd765a
    separatecontext: false
    task:
      brand: ''
      description: Get assessment execution status - supports only on demand runs.
      id: 4f6355b8-76ac-463d-8442-13a1d75de229
      iscommand: true
      name: Get assessment execution status
      script: '|||attackiq-get-assessment-execution-status'
      type: regular
      version: -1
    taskid: 4f6355b8-76ac-463d-8442-13a1d75de229
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 545\n  }\n}"
  '30':
    id: '30'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '32'
    note: false
    scriptarguments:
      assessment_id:
        simple: ${AttackIQ.Assessment.Id}
      asset_groups:
        simple: ${AttackIQ.Asset.Groups.[0].ID}
      assets: {}
    separatecontext: false
    task:
      brand: ''
      description: Add assets or asset groups to an assesment.
      id: 17af4cf7-5e8d-42c3-8240-6adde04d2e7e
      iscommand: true
      name: Add asset group to new assessment
      script: '|||attackiq-add-assets-to-assessment'
      type: regular
      version: -1
    taskid: 17af4cf7-5e8d-42c3-8240-6adde04d2e7e
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4565\n  }\n}"
  '31':
    id: '31'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '13'
    note: false
    scriptarguments:
      assessment_id:
        simple: ${AttackIQ.Assessment.Id}
    separatecontext: false
    task:
      brand: ''
      description: Deletes an assessment
      id: 6b0d5c09-76c9-45d7-8ce5-db04f66dad65
      iscommand: true
      name: Delete assessment
      script: '|||attackiq-delete-assessment'
      type: regular
      version: -1
    taskid: 6b0d5c09-76c9-45d7-8ce5-db04f66dad65
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 5110\n  }\n}"
  '32':
    id: '32'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '33'
    note: false
    scriptarguments:
      assessment_id:
        simple: ${AttackIQ.Assessment.Id}
    separatecontext: false
    task:
      brand: ''
      description: Returns all assessments by its ID in the AttackIQ FireDrill platform.
      id: 6bd3fd1c-3b9d-488e-880b-756255cd6c72
      iscommand: true
      name: Get created assessment details
      script: '|||attackiq-get-assessment-by-id'
      type: regular
      version: -1
    taskid: 6bd3fd1c-3b9d-488e-880b-756255cd6c72
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4740\n  }\n}"
  '33':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.DefaultAssetCount
          operator: isEqualString
          right:
            value:
              simple: '1'
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.DefaultAssetGroupCount
          operator: isEqualString
          right:
            value:
              simple: '1'
      label: 'yes'
    id: '33'
    ignoreworker: false
    nexttasks:
      'yes':
      - '31'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: a72ab1c8-908f-4522-8ef0-f7d09429960c
      iscommand: false
      name: Validate creation correctly
      type: condition
      version: -1
    taskid: a72ab1c8-908f-4522-8ef0-f7d09429960c
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4920\n  }\n}"
  '34':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.DefaultAssetCount
          operator: isEqualString
          right:
            value:
              simple: '0'
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.DefaultAssetGroupCount
          operator: isEqualString
          right:
            value:
              simple: '0'
      label: 'yes'
    id: '34'
    ignoreworker: false
    nexttasks:
      'yes':
      - '29'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: f60619c6-0d03-4658-8b16-a123f8e6414c
      iscommand: false
      name: Validate no assets in assessment
      type: condition
      version: -1
    taskid: f60619c6-0d03-4658-8b16-a123f8e6414c
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4230\n  }\n}"
  '4':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: AttackIQ.Assessment.Running
          operator: isFalse
      label: 'yes'
    id: '4'
    ignoreworker: false
    nexttasks:
      'yes':
      - '7'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: e0428bde-b757-457b-8a7c-2b285f02212f
      iscommand: false
      name: Assert execution status
      type: condition
      version: -1
    taskid: e0428bde-b757-457b-8a7c-2b285f02212f
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 720\n  }\n}"
  '7':
    id: '7'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '8'
    note: false
    scriptarguments:
      show_last_result:
        simple: 'True'
      test_id:
        simple: 1c350a5a-84f2-4938-93d8-cc31f0a99482
    separatecontext: false
    task:
      brand: ''
      id: 512e595e-ae4c-4dd6-8a76-99d29f12f2fe
      iscommand: true
      name: Get test results
      script: '|||attackiq-get-test-results'
      type: regular
      version: -1
    taskid: 512e595e-ae4c-4dd6-8a76-99d29f12f2fe
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 895\n  }\n}"
  '8':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: AttackIQTestResult.Assessment.Id
          operator: isEqualString
          right:
            value:
              simple: c4e352ae-1506-4c74-bd90-853f02dd765a
      - - left:
            iscontext: true
            value:
              simple: AttackIQTestResult.Assessment.Name
          operator: isEqualString
          right:
            value:
              simple: Arseny's ransomware project
      - - left:
            iscontext: true
            value:
              simple: AttackIQTestResult.Scenario.Name
          operator: isEqualString
          right:
            value:
              simple: Download ODCODC Ransomware
      - - left:
            iscontext: true
            value:
              simple: AttackIQTestResult.Asset.Ipv4Address
          operator: isEqualString
          right:
            value:
              simple: 172.31.39.254
      - - left:
            iscontext: true
            value:
              simple: AttackIQTestResult.JobState
          operator: isEqualString
          right:
            value:
              simple: Finished
      - - left:
            iscontext: true
            value:
              simple: AttackIQTestResult.Outcome
          operator: isEqualString
          right:
            value:
              simple: Passed
      label: 'yes'
    id: '8'
    ignoreworker: false
    nexttasks:
      'yes':
      - '9'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 9441bb82-7032-45e9-8d97-14cc5e6a7725
      iscommand: false
      name: Assert test results
      type: condition
      version: -1
    taskid: 9441bb82-7032-45e9-8d97-14cc5e6a7725
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1070\n  }\n}"
  '9':
    id: '9'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '10'
    note: false
    scriptarguments:
      assessment_id: {}
      page_number: {}
    separatecontext: false
    task:
      brand: ''
      description: Get all assessments in a page or by assessment id.
      id: 01489657-281c-4404-87a9-6d77682ce489
      iscommand: true
      name: Get all assessments
      script: '|||attackiq-list-assessments'
      type: regular
      version: -1
    taskid: 01489657-281c-4404-87a9-6d77682ce489
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1245\n  }\n}"
toversion: 4.1.9
version: -1
view: "{\n  \"linkLabelsPosition\": {},\n  \"paper\": {\n    \"dimensions\": {\n \
  \     \"height\": 5325,\n      \"width\": 1230,\n      \"x\": -350,\n      \"y\"\
  : 50\n    }\n  }\n}"
