category: Data Enrichment & Threat Intelligence
commonfields:
  id: Cofense Triage
  version: -1
configuration:
- defaultvalue: ''
  display: Server URL (e.g., https://192.168.0.1)
  name: host
  required: true
  type: 0
- defaultvalue: ''
  display: User
  name: user
  required: true
  type: 0
- defaultvalue: ''
  display: API Token
  name: token
  required: true
  type: 4
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- defaultvalue: 3 days
  display: First fetch time (<number> <time unit>, e.g., 12 hours, 7 days, 3 months,
    1 year)
  name: date_range
  required: false
  type: 0
- defaultvalue: ''
  display: Category ID to fetch - corresponds to the ranking that determines the Cofense
    Triage prioritization (1-5)
  name: category_id
  required: false
  type: 0
- defaultvalue: ''
  display: Match Priority - the highest match priority based on rule hits for the
    report
  name: match_priority
  required: false
  type: 0
- defaultvalue: ''
  display: 'Tags - CSV list of tags of processed reports by which to filter '
  name: tags
  required: false
  type: 0
- defaultvalue: '30'
  display: Maximum number of incidents to fetch each time
  name: max_fetch
  required: false
  type: 0
- defaultvalue: 'false'
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
deprecated: true
description: Deprecated - We recommend using Cofense Triage v2 instead.
display: Cofense Triage - Deprecated
name: Cofense Triage
script:
  commands:
  - arguments:
    - description: File hash, MD5 or SHA256.
      name: file_hash
    - description: The reported URLs.
      name: url
    - description: Report's subject
      name: subject
    - defaultValue: 60 days
      description: 'Retrieve reports that were reported after this time, for example:
        "2 hours, 4 minutes, 6 month, 1 day".'
      name: reported_at
    - defaultValue: 60 days
      description: 'Retrieve reports that were created after this time, for example:
        "2 hours, 4 minutes, 6 month, 1 day".'
      name: created_at
    - description: Name or ID of the reporter.
      name: reporter
    - default: true
      defaultValue: '30'
      description: Maximum number of matches to fetch. Default is 30.
      name: max_matches
    - auto: PREDEFINED
      description: Returns all fields of a report.
      name: verbose
      predefined:
      - 'true'
      - 'false'
    description: Runs a query for reports.
    name: cofense-search-reports
    outputs:
    - contextPath: Cofense.Report.ID
      description: ID number of the report.
    - contextPath: Cofense.Report.EmailAttachments
      description: Email attachments.
    - contextPath: Cofense.Report.EmailAttachments.id
      description: Email attachment ID.
    - contextPath: Cofense.Report.Tags
      description: Report tags.
      type: string
    - contextPath: Cofense.Report.ClusterId
      description: Cluster ID number.
      type: number
    - contextPath: Cofense.Report.CategoryId
      description: Report category.
      type: number
    - contextPath: Cofense.Report.CreatedAt
      description: Report creation date.
      type: date
    - contextPath: Cofense.Report.ReportedAt
      description: Reporting time.
      type: string
    - contextPath: Cofense.Report.MatchPriority
      description: The highest match priority based on rule hits for the report.
      type: number
    - contextPath: Cofense.Report.ReporterId
      description: Reporter ID.
      type: number
    - contextPath: Cofense.Report.Location
      description: Location of the report.
      type: string
    - contextPath: Cofense.Report.Reporter
      description: Reporter email address.
      type: string
    - contextPath: Cofense.Report.SuspectFromAddress
      description: Suspect from address.
      type: string
    - contextPath: Cofense.Report.ReportSubject
      description: Report subject.
      type: string
    - contextPath: Cofense.Report.ReportBody
      description: Report body.
      type: string
    - contextPath: Cofense.Report.Md5
      description: MD5 hash of the file.
      type: number
    - contextPath: Cofense.Report.Sha256
      description: SHA256 hash of the file.
  - arguments:
    - description: ID of the attachment.
      name: attachment_id
      required: true
    description: 'Retrieves an attachment by the attachment ID number. '
    name: cofense-get-attachment
    outputs:
    - contextPath: Cofense.Attachment.ID
      description: The ID number of the report that contains the attachment.
      type: string
    - contextPath: Cofense.File.Size
      description: The date and time (in UTC) when the threat was found on the device.
      type: string
    - contextPath: Cofense.File.EntryID
      description: The file path where the threat was found on the device.
      type: string
    - contextPath: Cofense.File.Name
      description: The name of the threat.
      type: string
    - contextPath: Cofense.File.SHA1
      description: The SHA1 hash of the threat.
      type: string
    - contextPath: Cofense.File.SHA256
      description: The SHA256 hash of the threat.
      type: string
    - contextPath: Cofense.File.MD5
      description: The MD5 hash of the threat.
      type: string
  - arguments:
    - description: ID of the reporter.
      name: reporter_id
      required: true
    description: Retrieves Email address of the reporter by ID
    name: cofense-get-reporter
    outputs:
    - contextPath: Cofense.Report.ID
      description: ID of the reporter.
    - contextPath: Cofense.Report.Email
      description: Reporter email address.
  - arguments:
    - description: ID of the report
      name: report_id
      required: true
    description: 'Retrieves a report by the report ID number. '
    name: cofense-get-report-by-id
    outputs:
    - contextPath: Cofense.Report.ID
      description: ID number of the report
    - contextPath: Cofense.Report.EmailAttachments
      description: Email attachments.
    - contextPath: Cofense.Report.EmailAttachments.id
      description: Email attachment ID.
    - contextPath: Cofense.Report.Tags
      description: Report tags.
      type: string
    - contextPath: Cofense.Report.ClusterId
      description: Cluster ID number.
      type: number
    - contextPath: Cofense.Report.CategoryId
      description: Report category.
      type: number
    - contextPath: Cofense.Report.CreatedAt
      description: Report creation date.
      type: date
    - contextPath: Cofense.Report.ReportedAt
      description: Reporting time.
      type: string
    - contextPath: Cofense.Report.MatchPriority
      description: The highest match priority based on rule hits for the report.
      type: number
    - contextPath: Cofense.Report.ReporterId
      description: Reporter ID.
      type: number
    - contextPath: Cofense.Report.Location
      description: Location of the report.
      type: string
    - contextPath: Cofense.Report.Reporter
      description: Reporter email address.
      type: string
    - contextPath: Cofense.Report.SuspectFromAddress
      description: Suspect from address.
      type: string
    - contextPath: Cofense.Report.ReportSubject
      description: Report subject.
      type: string
    - contextPath: Cofense.Report.ReportBody
      description: Report body.
      type: string
    - contextPath: Cofense.Report.Md5
      description: MD5 hash of the file.
      type: number
    - contextPath: Cofense.Report.Sha256
      description: SHA256 hash of the file.
  dockerimage: demisto/python3:3.8.3.8715
  isfetch: true
  runonce: false
  script: '-'
  subtype: python3
  type: python
tests:
- No test
toversion: 4.1.9
