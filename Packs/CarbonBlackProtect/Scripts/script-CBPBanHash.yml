args:
- default: true
  description: The hash value(s) to ban (comma-separated).
  name: hash
  required: true
comment: Ban/blacklist a hash in CBEP/Bit9.
commonfields:
  id: CBPBanHash
  version: -1
dependson:
  must:
  - cbp-fileRule-update
name: CBPBanHash
script: "CBP_HASH_BANNED = '3'\nres = []\nt = []\nfor h in argToList(demisto.args()['hash']):\n\
  \    e = demisto.executeCommand(\"cbp-fileRule-update\", {\"fileState\": CBP_HASH_BANNED,\
  \ \"hash\": h})[0]\n    if isError(e):\n        res += [e]\n    else:\n        t.append(\
  \ e['Contents'] )\n\nres.append({'ContentsFormat': formats['table'], 'Type': entryTypes['note'],\
  \ 'Contents': t} )\ndemisto.results(res)"
scripttarget: 0
subtype: python2
system: true
tags:
- carbon-black-protection
- bit9
timeout: 0s
toversion: 4.1.9
type: python
