args:
- default: true
  description: Only show computers matching this query. If omitted, displays all computers.
    Query is in CBEP/Bit9 syntax documented in https://developer.carbonblack.com/reference/enterprise-protection/7.2/rest-api/#query-condition
    - e.g. "name:*srv*"
  name: query
comment: Find a computer in CBEP/Bit9.
commonfields:
  id: CBPFindComputer
  version: -1
dependson:
  must:
  - cbp-computer-search
name: CBPFindComputer
script: "# query syntax is according to Carbon Black Enterprise Protection query language\
  \ documented in https://developer.carbonblack.com/reference/enterprise-protection/7.2/rest-api/#query-condition\
  \ - e.g. \"name:*srv*\"\nres = []\ndArgs = demisto.args()\nif not \"limit\" in demisto.args():\n\
  \    dArgs[\"limit\"] = \"10\"\nresCmd1 = demisto.executeCommand(\"cbp-computer-search\"\
  , dArgs)\nfor entry in resCmd1:\n    if isError(entry):\n        res.append(entry)\n\
  \    else:\n        matches = entry[\"Contents\"]\n        if matches:\n       \
  \     res.append(  { \"Type\" : entryTypes[\"note\"], \"ContentsFormat\" : formats[\"\
  table\"], \"Contents\" : matches } )\n        else:\n            res.append(  {\
  \ \"Type\" : entryTypes[\"note\"], \"ContentsFormat\" : formats[\"text\"], \"Contents\"\
  \ : \"No matches.\" } )\ndemisto.results(res)"
scripttarget: 0
subtype: python2
system: true
tags:
- carbon-black-protection
- bit9
timeout: 0s
toversion: 4.1.9
type: python
