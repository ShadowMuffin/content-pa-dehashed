args:
- default: true
  description: md5 hash to find
  name: md5
  required: true
comment: Search the CBP/Bit9 file catalog for an md5 hash.
commonfields:
  id: CBPCatalogFindHash
  version: -1
dependson:
  must:
  - cbp-fileCatalog-search
name: CBPCatalogFindHash
script: "md5s = argToList(demisto.args()['md5'])\nfound = []\nres = []\nt = []\nfor\
  \ md5 in md5s:\n    resp = demisto.executeCommand('cbp-fileCatalog-search', {'query':\
  \ 'md5:'+ md5})\n    if isError(resp[0]):\n        demisto.results(resp)\n    else:\n\
  \        data = demisto.get(resp[0], 'Contents')\n        if data:\n           \
  \ found.append(md5)\n            t += data\nappendContext('found_hashes', ','.join(found),\
  \ dedup=True)\nif t:\n    res.append({ \"Type\" : entryTypes[\"note\"], \"ContentsFormat\"\
  \ : formats[\"table\"], \"Contents\" : t })\nelse:\n    res.append({ \"Type\" :\
  \ entryTypes[\"note\"], \"ContentsFormat\" : formats[\"text\"], \"Contents\" : 'No\
  \ results.' })\ndemisto.results(res)\n"
scripttarget: 0
subtype: python2
system: true
tags:
- carbon-black-protection
- bit9
- enhancement
timeout: 0s
toversion: 4.1.9
type: python
