id: 67b0f25f-b061-4468-8613-43ab13147173
inputs: []
name: CbP-PlayBook
outputs: []
starttaskid: '0'
tasks:
  '0':
    id: '0'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '11'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: bd94baef-08a0-4ef0-8cc0-7162e08cc66b
      iscommand: false
      name: ''
      version: -1
    taskid: bd94baef-08a0-4ef0-8cc0-7162e08cc66b
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": -119\n  }\n}"
  '1':
    id: '1'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '13'
    note: false
    quietmode: 0
    scriptarguments:
      group: {}
      limit: {}
      offset: {}
      query:
        simple: id:2
      sort: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: carbonblackprotection
      description: commands.server.cbp.ConnectorSearch.description
      id: 7cfce34b-34b3-425e-81e6-0fe10f71a771
      iscommand: true
      name: cbp-connector-search
      script: carbonblackprotection|||cbp-connector-search
      type: regular
      version: -1
    taskid: 7cfce34b-34b3-425e-81e6-0fe10f71a771
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 195\n  }\n}"
  '10':
    id: '10'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '6'
    note: false
    quietmode: 0
    scriptarguments:
      fields:
        simple: ID,FileName,PathName,UploadStatus,FileCatalogId,ComputerId,UploadedFileSize,UploadPath,CreatedBy,CreatedByUserId,DateCreated,DateModified,Priority
      isArray:
        simple: 'true'
      path:
        simple: CbP.FileUpload
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: bda09352-7e80-4815-8c3f-f8300727f6f2
      iscommand: false
      name: VerifyContext
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: bda09352-7e80-4815-8c3f-f8300727f6f2
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 430,\n    \"y\": 1419\n  }\n}"
  '11':
    id: '11'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '1'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      key: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: 48ffb19b-32fa-4647-8fd2-b86d13c6e752
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 48ffb19b-32fa-4647-8fd2-b86d13c6e752
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 13\n  }\n}"
  '12':
    id: '12'
    ignoreworker: false
    note: false
    quietmode: 0
    scriptarguments:
      fields:
        simple: Size,SHA1,SHA256,Name,SSDeep,EntryID
      isArray:
        simple: 'true'
      path:
        simple: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 85bce2ff-18b7-4d70-86fa-5388e786c5f7
      iscommand: false
      name: VerifyContext
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 85bce2ff-18b7-4d70-86fa-5388e786c5f7
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 430,\n    \"y\": 1943\n  }\n}"
  '13':
    id: '13'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '2'
    note: false
    quietmode: 0
    scriptarguments:
      expectedValue: {}
      fields: {}
      path:
        simple: ${CbP.Connector.ID}${CbP.Connector.Enabled}${CbP.Connector.ConnectorVersion}${CbP.Connector.CanAnalyze}${CbP.Connector.AnalysisTargets}${CbP.Connector.AnalysisName}${CbP.Connector.AnalysisEnabled}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verify path in context

        - Verify path existence

        - If matching object is array - verify fields exists in each object in array

        - If matching object is not array - verify fields exists in matching object

        - if ''expectedValue'' supplied - ensure that given value equal to context
        path


        '
      id: b8abb944-63bc-41dd-8193-5bd6abb9bf35
      iscommand: false
      name: VerifyContext
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: b8abb944-63bc-41dd-8193-5bd6abb9bf35
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 430,\n    \"y\": 369\n  }\n}"
  '2':
    id: '2'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '3'
    note: false
    quietmode: 0
    scriptarguments:
      id:
        simple: ${CbP.Connector.ID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: carbonblackprotection
      description: commands.server.cbp.ConnectorGet.description
      id: e3c839a1-c546-46f1-890c-c7faa8907b54
      iscommand: true
      name: cbp-connector-get
      script: carbonblackprotection|||cbp-connector-get
      type: regular
      version: -1
    taskid: e3c839a1-c546-46f1-890c-c7faa8907b54
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 545\n  }\n}"
  '3':
    id: '3'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '9'
    note: false
    quietmode: 0
    scriptarguments:
      analysisStatus: {}
      analysisTarget: {}
      computerId: {}
      connectorId:
        simple: ${CbP.Connector.ID}
      fileCatalogId:
        simple: '26866'
      priority: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: carbonblackprotection
      description: commands.server.cbp.fileAnalysisPost.description
      id: ca6c90fa-e16d-43e6-8410-81871eb665da
      iscommand: true
      name: cbp-fileAnalysis-createOrUpdate
      script: carbonblackprotection|||cbp-fileAnalysis-createOrUpdate
      type: regular
      version: -1
    taskid: ca6c90fa-e16d-43e6-8410-81871eb665da
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 720\n  }\n}"
  '4':
    id: '4'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '5'
    note: false
    quietmode: 0
    scriptarguments:
      id:
        simple: ${CbP.FileAnalysis.ID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: carbonblackprotection
      description: commands.server.cbp.fileAnalysisGet.description
      id: d992be28-403e-4ab9-8312-bd2e7b10316c
      iscommand: true
      name: cbp-fileAnalysis-get
      script: carbonblackprotection|||cbp-fileAnalysis-get
      type: regular
      version: -1
    taskid: d992be28-403e-4ab9-8312-bd2e7b10316c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1070\n  }\n}"
  '5':
    id: '5'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '10'
    note: false
    quietmode: 0
    scriptarguments:
      computerId: {}
      fileCatalogId:
        simple: '26866'
      priority: {}
      uploadStatus: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: carbonblackprotection
      description: commands.server.cbp.FileUploadPost.description
      id: bf45144a-6ad5-4a06-84f6-b804e00b2978
      iscommand: true
      name: cbp-fileUpload-createOrUpdate
      script: carbonblackprotection|||cbp-fileUpload-createOrUpdate
      type: regular
      version: -1
    taskid: bf45144a-6ad5-4a06-84f6-b804e00b2978
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1245\n  }\n}"
  '6':
    id: '6'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '7'
    note: false
    quietmode: 0
    scriptarguments:
      id:
        simple: ${CbP.FileUpload.ID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: carbonblackprotection
      description: commands.server.cbp.FileUploadGet.description
      id: 1c5d2193-43de-4d12-83b0-3e594d35723c
      iscommand: true
      name: cbp-fileUpload-get
      script: carbonblackprotection|||cbp-fileUpload-get
      type: regular
      version: -1
    taskid: 1c5d2193-43de-4d12-83b0-3e594d35723c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1595\n  }\n}"
  '7':
    id: '7'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '12'
    note: false
    quietmode: 0
    scriptarguments:
      id:
        simple: ${CbP.FileUpload.ID}
    separatecontext: false
    skipunavailable: false
    task:
      brand: carbonblackprotection
      description: commands.server.cbp.FileUploadGet.description
      id: adc1f041-6b2b-4a75-8560-131bcb1fc147
      iscommand: true
      name: cbp-fileUpload-download
      script: carbonblackprotection|||cbp-fileUpload-download
      type: regular
      version: -1
    taskid: adc1f041-6b2b-4a75-8560-131bcb1fc147
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1770\n  }\n}"
  '9':
    id: '9'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '4'
    note: false
    quietmode: 0
    scriptarguments:
      expectedValue: {}
      fields:
        simple: ID,FileName,PathName,FileCatalogId,AnalysisResult,AnalysisStatus,ConnectorId,AnalysisTarget,ComputerId,DateModified,DateCreated,Priority
      isArray:
        simple: 'true'
      path:
        simple: CbP.FileAnalysis
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 2379e04f-71c0-4f0b-8544-c1d459317c09
      iscommand: false
      name: VerifyContext
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 2379e04f-71c0-4f0b-8544-c1d459317c09
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 430,\n    \"y\": 920\n  }\n}"
toversion: 4.1.9
version: -1
view: "{\n  \"linkLabelsPosition\": {},\n  \"paper\": {\n    \"dimensions\": {\n \
  \     \"height\": 2157,\n      \"width\": 760,\n      \"x\": 50,\n      \"y\": -119\n\
  \    }\n  }\n}"
