category: Vulnerability Management
commonfields:
  id: Nessus
  version: -1
configuration:
- defaultvalue: ''
  display: 'Server Url (format : https://127.0.0.1:8834)'
  name: url
  required: true
  type: 0
- defaultvalue: ''
  display: Username
  name: username
  required: true
  type: 0
- defaultvalue: ''
  display: Password
  name: password
  required: true
  type: 4
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
description: Vulnerability scanner for auditors and security analysts by Tenable Network
  Security
display: Nessus
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAbCAYAAAC3BEsmAAARtElEQVR42u1ad1hU17bXqNHcGPV91viSm+QmNzc3msQ8UbGDDRVsUVRAQESkg0gRaSKCgoD0ooiogI4IiEiT3keagCAdgaEXQYJGY2Hub2/mjEPAAXJJXv5wf9/+GM45e5211m/vVc+YuGS29GZZDc5Wee3ybQo6ZZtk1GutHM+51De2vD9mBKOhufUjrWOnYjfLaNQQOlJyWnX6Fg4uY96NP320tD0ay/8nMi5Ve+UWRa74jgPcNT8pc8Xwd/U2JW5gcMSRkRDFhpimpGvesGKLAqEDGvu5qoYng8a8G3/ayMq7P/lGeOz8xPSsJddvxfyjupYzfkxUfKr2qq37KShrdx6kc/V2Je5mWc32sOgE8REAPPWArkX9yq2KlIYYaKgZWbPGvBt/yqiqqZ+AwyoaEZuy+vad5PlxKZliYVEJXw0AmJnkJO7TOFZcU9fwyTuA//rjbt79mSUV1esvscIWWTud+/hOUsaciLiU2YMDzIAspcA96eh98R3Af/2Rk180Lf9+yVrWzWgxp3NXFiRlZH+IkzxLGMDwy8rcVfClvoEhRu8A/muPGk7DuPA7SStS7+Z9m551byLM9fzYlIyZgwKMgIv5TYMlRMY9KZk5En8UwF5+rGk5+cXzQiPjReNT735f39g8faQCnrsc9F5VDWduTGL6gpCIONHkjJz5DzkNI6JzITBkckFx2Tc3I+OXRMQlLywurfrC9LTb+/+fwMFFTk9Kz/7+ZlS8KGT7ETJ+4nTOf9xgz5ZWVE/OyM7/Ku1u3ucw2XMrH9aNGwDwul0qXKRK/UBegSh7v7ZZTlUtZ9ZoAVxRXTvJ1SdQ7Ji1c8Cmver1SNOeILV6vmWf1i/bFXXbjE6cDXH0uixRUl79gTAF5BYUT0fEf0hR2yxtq4L2I7Ke0AG9X5CutakbnrxzLTRSDsqZM9j65Myc91hh0YssHTzPY+1DrOmR2gc+5LWebZPX7tq+X7fY2snH1t7jokjhg7J+is0rePAl/J2XhZ2Hr9lpdz8n7ysn2zs6pwjjNz6V/YWtm6+7ua37RbPTbpfsPfzsmlvb+21EyDzJxvn8esMTZ4OgixZGJvIXcnXJqh3N9vS7ZuQfFP6vIXeIIMBkrpdWeeHjH2yloGVaiOt8kJdK7uNa2HkGdT3++f3/FmCYkcVGVmeT1+8+9Jr4eXGaVim9mVi7HNex2XqRS6dn5hQsGowOTNJmvLN0uZQ8cSW89ft5vzHJb/BDaMlrHmvxu3bTtKyq5sM3PDfPOOHgfU5SVvPpckl5sqkpjVUCNMg1cg/KfQGFh2Vm54sy629FJ64Aj78ug26WbJLl7jqgx21oavlBmL69rwQtRd3hydLNcnQNNiW3urZ+I3P/QXn1N3hP3HrpQyQGGlQmottlm/dxf1LS63HwvOQdl8L+YlgAi/eB/Do+hb08IS1rO36/EuOdZNyjhC9eDdUeLsDqgwAM37ABu7FDFAKuoTShQAAksUe1F4K/2rhHjQqG9fS+KATZoajbBBch9puTu0xSVuMRlMu4EvxV5koBCJzCZ5Jymi/BMwGX0iEyim6S49o4X7Al6zu7useanXLzhaIID5QGqQfg/b3b5HWebdmn/RyW7PXKrX1KJnogoEgf1G98UFb5zz5ZUggPv2IT0PfLqh7lNja1LhzCDSzesV+3B/JR0KSVj3BhhreTe63tj2apHLHMXrIRutnRhwfR56a9Gq+ITNhkv66HhSUy03eCxmIJGS4KTEnNbe0fDgtgid2qvUetzq4h95zP+Z9Zht0L4fmgwZx2wYlLDOsEG57sB3D2vftLf1I6zFmJ9zGpGJh+5Oh56SzM206csHVnva/85HLe3xZKaAY4/Of2qhpV5ReV/pvQ6XjUOVHb5HQcc58oCmar8qS9l8b1sOjl8WnsH/1v3BbzuHhN+ZiNSzTkekXk2CB9qBe7fSdvo0lDQSSQZDZaL0ztFd+roZtikjMWRsanLob8UrauPtZ7DxnWkfVLsRmMrJwiOroeU7cRETtKAHMatpF77hev2eIdffoDTWz6Zy7nAxwRGYuD7/9DbLHUx/+G9BmPixdhdbqIZSE6cPO9embYJxgBVa+Cpsk6cq+t49FHWsan00GkX+q0X8e8tOohZ/ZIAIYZmqxhZJ3KnDjynJKuRVEaO1dkML4Q7PxTx8Q2fRWPHuHB1sXHg9xDpWYRNuJLolgycdo60th5ywajg5M/Fj5vs4q+ZdnxM56BzHXiAwEafwPZul7weZuOsvOLZzuf9/fBKXoMy7GSuY405L8GePdBfS4CJ6mmlrb3lPWO18KKMO6yF8Cpvo3OZVbYPPjwKJz4ck5D05xhAwwz2SunbryOuX/vfokIgo1mMMOATH0SiF998vTpeOY5TkPzAIAPGVjxAQ6PTlRgzC5MHgQzqCmvqv1WmDLqGpq+lFUzLiPvFusDsjMjK/8LnHQpnEZCi4KjZ34moYbTKDTaDYtJnIsy3sfk95MnTycesbAvYMqqhH52ftEWYevb2h9NvJtb+HXP06djBdzNKABswC2vqtmMLGI69N6Oa9T0wtK1JqZlfSWMFvLeKZev3/qc/B4RwAf1jq8TfCYgOEIWwQQ5Mfw0aiWUg6qJqTCAcUL5AJuecg3HieH7w3NXbjgNJ02AqdVbwbMg5PQD3KN5hQ+WkVgBk5pYKLkHPKrmF5f+bbjpx1ErpzCGLuEH/8chgIILGPaA7tJG5QRXVtdJllXWfKigZdIiGPDCqjiAp49HwNLIAWbGGfeLXghI+vljCNeRlVe46o2JNu8HMEwOq8+kZv99j4phA3MSYV65d/MK9YbD3/2Siu+l5DS7mMgap5XNaWyeu1tZv5x5F1HwOpxoeU2TElTevJFXS5vbuf67pLLqrSnWef9gY/i7fvk+THCL8mGLqIAbtw3cfa8tDwyJmPMHAwwfrE+CrK3k3jFrlxsIBCk/FA/Qhd44+scdWIgnlLSMT4kgrZv6RwAMn1g+XVnXIglK7eePFbVNS2FKP2lp65j0W4CRm1KAi0srxMAsP6DZsPsQV9/S4SFyyBQrB6+Mt01rR+90ExvXbESzz8l6QhvxQfXDuvqpSFHk8Y5eJpVjTD9ydsoXUohuNUOrYrQ+vYIj4qQLH5RPE5QHp2YW5ExnrArDM5mI8JGiHXyJWnw9lJ7sE3DD6Fpo1PcDdBeXOkpBViONovPulyzZqqDTzrgORibISN2iFKJoJR3zSkt7r/irIZHqqezcz0cNYDLSs/JFdirpNa0W8MdEQRa2HgFNre1/xzqOIMAIxijAqKzIMcEDs24lLz8daq4QWEcUIqNq1BQWnUjzPqRsuqRA0vecgiB9WAoC9pv1ilqmuTDjGwXlYYVGfYNTEb+uTw4mXWI2DC+HlqcKRtr1s62rr2NtfdO00Qyy+GkSPyjMXQsZSymokAu0+1UYIQ/lFfojm5hzytlH7WFt/bhRAZgM38BQNZjL12/8MVVqr7vv1W70g19D0AEAo2y2CwwxAPDBAgAjmqIoDOxUOtx27krQNwJdlB9gvuxQsbq3bqfKr3gPeTdiBCaXBli8KHyLnOZTdFl2CMqTkXXvI5zO3ZZnPIKlD+i3YH0fb7ziibjA6SaKNT3ldrOiqnYSE2SNMsBMzDMn+HasvoGlYyrcRifw4VknmpPz9cjg5unHOjlqAJNx3N7DE7t7QO0akW0/H32AF2ShvrwYZpmaWUxqoq+GRnrmF5UshA9fLXzepxMRLGaBOHLhpfD3A3wrKzTyg9DIhHlXgsJVkZ5dBuCF2xV1upmNxW+BqhvfLyqtnD1IxD7W3NZjLhS7AWbdVs/sTCqqeY0kuIRS+aea0LsQEKL9ewH2CQgGwIeFACxYNygar3nU5jOfgJBdhicc3VHQYO9WMWzDu17D2sCN0N499Kn6nJ1TuGbUAEZYPx2nNZOJQjGZKlg/gFX0T1CAb0YlzEKEWM0om9yDIo+P+QMHePwATe9vHTz93ElFDpOfEsG07htqfXd3z1j42JnwddsRvBWAZ36KCLOeRp6Jjk9bLAgwTCu3oblFKMBIa0QA8M9CABbS0Gken5qZ+ykrLOYIqnutjEshwaKdq6/fqAFMBro1q2E+OlbzBBeYA0w0GYhug5giBzn9GketUxANf/R7AcQpHt/R+Xj8cJ41sXFJYkqW8Kkot96klR8EN5O4XO7YodajyyUOvbxgatUAsgZm8X/QwFiIihIFmCgbjQFueXWtqDBaKezctRI4ccgmBgW4qaV9ItzIkDx5XmIZMrgRvRpaOt4ZRYCZHDVcnSnIDwbwIX0rlkBFaTvjs9fwfLCT92XXuobm94S9o6ikciLy7V3NrW2fCl4HSLtO2HsGwnR/NhSfqD9Hwn/yAYaPMyPXzWzdA1BuVB5qPWrzIlLo5DCgyKkZV/gGhE4BEAzAfMsUEhGr+TY694pKv1PWs7zHHAoG4FpeFI0U6Dtja+cwlCZXD8XTlRu3VaH7PoD7SqjRow7w4597JqAbc1WwXo05aKmyo6NrvLG1yzWm7CnOK3igZOifys5bEBR+Z0K/rsvloKnwcRJIk27AFdBS4rPnz+nOLnxQ8TXywzKR9XtIDboGxQ8DmN1/oX02IJpE7XYHfHEn4YcAgUCMi+5U5SXWLTYK9eTkvT5sZscC0JLRienTfruenVswl9zHc/ysASBE9m2+ii93KR/pZsw3Od0wv02omCljzkVANhn1gymowX+HurbBzgNH6hj5BQGG/6dVNHTYQhdCJlTsHp9yPu+E7GMV6gUD4g18a7VA1cAqD+v5PEFfJ0cbYOZz2RnIzbIQwDCMv7VdGBqV8Cl8MRsM9UtF0HDohF9LPu3i4wef6W1m6xqMAKeIFNtBl9Ii/hu+XJbQOe1y4dKiDTJ8JRH+EZm2AIgE1J3dILyJq0+AE/6P37hHvVvQVwGcNFTCAjbJaHCZ1A3NDxT21V7hnSRvvo4801rXzM7C1u2CP8xxdd8JJTLRk/pLcnq2JOGj63H3eP3j9pGCoPECsl4UMOrgovLRpiyCK+uC5SJAUB0jcBMAWJ/b2NwqcSc5cwtk7RXjmXvCG/z7K9Sas05BL16Xrtuh+OJocsr15jZFHSZVpXrZeUCvoaKqZkBveMBnsyBOm/2o5gDg4Q98cbABTYonzEYR+GyWNdDkVszTNLa5C2UTYKjAEJ4KRK4tRSVnOa8PCkGJEqhZRZ22Gl2sDby8WhJBXtkKKUUqoLiAUhi6ohtladSMe0yKg6qQQXVxWdW8tvbOCfiYwBHR/EsmrWICJfgzOlfwaMGcMvknpet2IdBeUJ5bMYnScDkvV5AAUiCHFuPRwyR8IcXbxz2oZ1mJXns8KnMvQJfwjh4yTnB9k2RBUelMdPFC6LvopqZ4kM1H+VgCeTCJbuh1umGgF/SNn+KDBQUhaVKKBhRIBVmFKbFXjYuK1PoR4MvUjA/zmvU8xhRJs+H6YM+ycwqmoA1mtVvFoI36RSgfSuA32qFMAirtqMCsNds4nbdn5xbOFKRRWvlwKtqM1jBxjVAq/XAAk08DYBAalBb6z8/QXgyHD/xakEZgSORapHJJKJb0rOQVFsA3Q4PyxPsQoFdO7SgHPKsgxRoQM+C6Fnz0Y16+LiAH6GFullF/BlfEik3OnJGefe8HWMluWujBPRSOuhqaWufzsBiHjSd78IhlETbfi5U8PeBZvkxUTmotlXuV9SyKE1LvrhEKTHUN5zOYPgOU/kxg203gi/STMnJGXOBGejAhOiFtN2iYg5Yx/lqgKiMhbE1MYsYnSBtk4J/cDI47BqsZWseipRhjbOXEcvMNdA6PSZJPSLv7v0N8sjMDwY4MfJADvp8KQK4YBd8fq2NqextBmB82nin6qIsh14TB1qPI8X50fOqP8JmG8PPe6DLdVDc6CT5sYsgnM87e/q63opMUcwsfzBbGB8z+AsQC1ug/X4UMd9QxTU+7BKCufRzBkwhpB9IvNsqqZkBPh6EfU3z7ZQbeVZANfPCbD+j+lsrO2YSc3sbK0euCrqldOJEJOXEMYpJAr0tBDvggQxrYTRkKl/8AcBTGqPm8w/gAAAAASUVORK5CYII=
name: Nessus
script:
  commands:
  - arguments:
    - description: The table's headers to be shown by order
      name: foldersHeaders
    - description: The table's headers to be shown by order
      name: scansHeaders
    description: Returns the scan list
    name: nessus-list-scans
    outputs:
    - contextPath: NessusScan.UUID
      description: The uuid for the scan.
    - contextPath: NessusScan.Name
      description: The name of the scan.
    - contextPath: NessusScan.Status
      description: The status of the scan.
    - contextPath: NessusScan.FolderID
      description: The unique id of the folder housing the scan.
    - contextPath: NessusScan.ID
      description: The unique id of the scan.
    - contextPath: NessusScan.UserPermissions
      description: The sharing permissions for the scan.
    - contextPath: NessusScan.CreationDate
      description: The creation date for the scan in unixtime.
    - contextPath: NessusScan.LastModificationDate
      description: The last modification date for the scan in unixtime.
    - contextPath: NessusScan.Type
      description: The type of scan (local, remote, or agent).
    - contextPath: NessusScan.Policy
      description: The policy if the scan.
    - contextPath: NessusFolder.UnreadCount
      description: The number of unread scans in the folder.
    - contextPath: NessusFolder.Custom
      description: The custom status of the folder (1 or 0).
    - contextPath: NessusFolder.DefaultTag
      description: Whether or not the folder is the default (1 or 0).
    - contextPath: NessusFolder.Type
      description: The type of the folder (main, trash, custom).
    - contextPath: NessusFolder.Name
      description: The name of the folder.
    - contextPath: NessusFolder.ID
      description: The unique id of the folder.
  - arguments:
    - description: The table's headers to be shown by order
      name: foldersHeaders
    - description: The table's headers to be shown by order
      name: scansHeaders
    deprecated: true
    description: Returns the scan list
    name: scans-list
    outputs:
    - contextPath: NessusScan.UUID
      description: The uuid for the scan.
    - contextPath: NessusScan.Name
      description: The name of the scan.
    - contextPath: NessusScan.Status
      description: The status of the scan.
    - contextPath: NessusScan.FolderID
      description: The unique id of the folder housing the scan.
    - contextPath: NessusScan.ID
      description: The unique id of the scan.
    - contextPath: NessusScan.UserPermissions
      description: The sharing permissions for the scan.
    - contextPath: NessusScan.CreationDate
      description: The creation date for the scan in unixtime.
    - contextPath: NessusScan.LastModificationDate
      description: The last modification date for the scan in unixtime.
    - contextPath: NessusScan.Type
      description: The type of scan (local, remote, or agent).
    - contextPath: NessusScan.Policy
      description: The policy if the scan.
    - contextPath: NessusFolder.UnreadCount
      description: The number of unread scans in the folder.
    - contextPath: NessusFolder.Custom
      description: The custom status of the folder (1 or 0).
    - contextPath: NessusFolder.DefaultTag
      description: Whether or not the folder is the default (1 or 0).
    - contextPath: NessusFolder.Type
      description: The type of the folder (main, trash, custom).
    - contextPath: NessusFolder.Name
      description: The name of the folder.
    - contextPath: NessusFolder.ID
      description: The unique id of the folder.
  - arguments:
    - default: true
      description: The Scan ID (use command list-scans to get possible scan ID's)
      name: scanId
      required: true
    - description: If specified, these targets will be scanned instead of the default.
        Value can be single host or of comma separated targets.
      name: targets
    description: Launches a new vulnerability scan
    name: nessus-launch-scan
    outputs:
    - contextPath: ScanUUID
      description: The uuid of the launched scan.
  - arguments:
    - default: true
      description: The Scan ID (use command list-scans to get possible scan ID's)
      name: scanId
      required: true
    - description: If specified, these targets will be scanned instead of the default.
        Value can be single host or of comma separated targets.
      name: targets
    deprecated: true
    description: Launches a new vulnerability scan
    name: scan-launch
    outputs:
    - contextPath: ScanUUID
      description: The uuid of the launched scan.
  - arguments:
    - default: true
      description: The Scan ID (use command list-scans to get possible scan ID's)
      name: scanId
      required: true
    - description: The history_id of the historical data that should be returned.
      name: historyId
    - description: The tables to be shown by order
      name: tables
    description: Returns details for the given scan
    name: nessus-scan-details
    outputs:
    - contextPath: NessusScan.UUID
      description: The uuid for the scan.
    - contextPath: NessusScan.Name
      description: The name of the scan.
    - contextPath: NessusScan.Status
      description: The status of the scan.
    - contextPath: NessusScan.FolderID
      description: The unique id of the folder housing the scan.
    - contextPath: NessusScan.ID
      description: The unique id of the scan.
    - contextPath: NessusScan.UserPermissions
      description: The sharing permissions for the scan.
    - contextPath: NessusScan.CreationDate
      description: The creation date for the scan in unixtime.
    - contextPath: NessusScan.LastModificationDate
      description: The last modification date for the scan in unixtime.
    - contextPath: NessusScan.Type
      description: The type of scan (local, remote, or agent).
    - contextPath: NessusScan.Policy
      description: The policy if the scan.
    - contextPath: Endpoint.ID
      description: The unique id of the host.
    - contextPath: Endpoint.Index
      description: The index for the host.
    - contextPath: Endpoint.Hostname
      description: The overall severity rating of the host.
    - contextPath: Endpoint.Progress
      description: The scan progress of the host.
    - contextPath: Endpoint.Critical
      description: The percentage of critical findings on the host.
    - contextPath: Endpoint.High
      description: The percentage of high findings on the host.
    - contextPath: Endpoint.Medium
      description: The percentage of medium findings on the host.
    - contextPath: Endpoint.Low
      description: The percentage of low findings on the host.
    - contextPath: Endpoint.Info
      description: The percentage of info findings on the host.
    - contextPath: Endpoint.TotalChecksConsidered
      description: The total number of checks considered on the host.
    - contextPath: Endpoint.NumChecksConsidered
      description: The number of checks considered on the host.
    - contextPath: Endpoint.ScanProgressTotal
      description: The total scan progress for the host.
    - contextPath: Endpoint.ScanProgressCurrent
      description: The current scan progress for the host.
    - contextPath: Endpoint.Score
      description: The overall score for the host.
    - contextPath: Vulnerability.PluginID
      description: The unique id of the vulnerability plugin.
    - contextPath: Vulnerability.PluginName
      description: The name of the vulnerability plugin.
    - contextPath: Vulnerability.PluginFamily
      description: The parent family of the vulnerability plugin.
    - contextPath: Vulnerability.Count
      description: The number of vulnerabilities found.
    - contextPath: Vulnerability.VulnerabilityIndex
      description: The index of the vulnerability plugin.
    - contextPath: Vulnerability.SeverityIndex
      description: The severity index order of the plugin.
    - contextPath: Note.Title
      description: The title of the note.
    - contextPath: Note.Message
      description: The specific message of the note.
    - contextPath: Note.Sevirity
      description: The severity of the note.
    - contextPath: Filter.Name
      description: The short name of the filter.
    - contextPath: Filter.ReadableName
      description: The long name of the filter.
    - contextPath: Filter.Operators
      description: The comparison options for the filter.
    - contextPath: Filter.Type
      description: The input type for the filter.
    - contextPath: Filter.ReadableRegest
      description: The input placeholder for the filter.
    - contextPath: Filter.Regex
      description: The input regex values for the filter.
    - contextPath: Filter.Options
      description: Other input options for the filter.
    - contextPath: History.ID
      description: The unique id of the historical data.
    - contextPath: History.UUID
      description: The uuid of the historical data.
    - contextPath: History.OwnerID
      description: The unique id of the owner of the scan.
    - contextPath: History.Status
      description: The status of the historical data.
    - contextPath: History.CreationDate
      description: The creation date for the historical data in unixtime.
    - contextPath: History.LastModification_date
      description: The last modification date for the historical data in unixtime.
    - contextPath: Remediations.Remediations
      description: Remedy to vulnerabilites found during the scan.
    - contextPath: Remediations.NumHosts
      description: Number of hosts of Remediations
    - contextPath: Remediations.NumCVEs
      description: Number of CVE's
    - contextPath: Remediations.NumImpactedHosts
      description: Number of impacted hosts
    - contextPath: Remediations.NumRemediatedCVEs
      description: Number of Remediated CVE's
  - arguments:
    - default: true
      description: The Scan ID (use command list-scans to get possible scan ID's)
      name: scanId
      required: true
    - description: The history_id of the historical data that should be returned.
      name: historyId
    - description: The tables to be shown by order
      name: tables
    deprecated: true
    description: Returns details for the given scan
    name: scan-details
    outputs:
    - contextPath: NessusScan.UUID
      description: The uuid for the scan.
    - contextPath: NessusScan.Name
      description: The name of the scan.
    - contextPath: NessusScan.Status
      description: The status of the scan.
    - contextPath: NessusScan.FolderID
      description: The unique id of the folder housing the scan.
    - contextPath: NessusScan.ID
      description: The unique id of the scan.
    - contextPath: NessusScan.UserPermissions
      description: The sharing permissions for the scan.
    - contextPath: NessusScan.CreationDate
      description: The creation date for the scan in unixtime.
    - contextPath: NessusScan.LastModificationDate
      description: The last modification date for the scan in unixtime.
    - contextPath: NessusScan.Type
      description: The type of scan (local, remote, or agent).
    - contextPath: NessusScan.Policy
      description: The policy if the scan.
    - contextPath: Endpoint.ID
      description: The unique id of the host.
    - contextPath: Endpoint.Index
      description: The index for the host.
    - contextPath: Endpoint.Hostname
      description: The overall severity rating of the host.
    - contextPath: Endpoint.Progress
      description: The scan progress of the host.
    - contextPath: Endpoint.Critical
      description: The percentage of critical findings on the host.
    - contextPath: Endpoint.High
      description: The percentage of high findings on the host.
    - contextPath: Endpoint.Medium
      description: The percentage of medium findings on the host.
    - contextPath: Endpoint.Low
      description: The percentage of low findings on the host.
    - contextPath: Endpoint.Info
      description: The percentage of info findings on the host.
    - contextPath: Endpoint.TotalChecksConsidered
      description: The total number of checks considered on the host.
    - contextPath: Endpoint.NumChecksConsidered
      description: The number of checks considered on the host.
    - contextPath: Endpoint.ScanProgressTotal
      description: The total scan progress for the host.
    - contextPath: Endpoint.ScanProgressCurrent
      description: The current scan progress for the host.
    - contextPath: Endpoint.Score
      description: The overall score for the host.
    - contextPath: Vulnerability.PluginID
      description: The unique id of the vulnerability plugin.
    - contextPath: Vulnerability.PluginName
      description: The name of the vulnerability plugin.
    - contextPath: Vulnerability.PluginFamily
      description: The parent family of the vulnerability plugin.
    - contextPath: Vulnerability.Count
      description: The number of vulnerabilities found.
    - contextPath: Vulnerability.VulnerabilityIndex
      description: The index of the vulnerability plugin.
    - contextPath: Vulnerability.SeverityIndex
      description: The severity index order of the plugin.
    - contextPath: Note.Title
      description: The title of the note.
    - contextPath: Note.Message
      description: The specific message of the note.
    - contextPath: Note.Sevirity
      description: The severity of the note.
    - contextPath: Filter.Name
      description: The short name of the filter.
    - contextPath: Filter.ReadableName
      description: The long name of the filter.
    - contextPath: Filter.Operators
      description: The comparison options for the filter.
    - contextPath: Filter.Type
      description: The input type for the filter.
    - contextPath: Filter.ReadableRegest
      description: The input placeholder for the filter.
    - contextPath: Filter.Regex
      description: The input regex values for the filter.
    - contextPath: Filter.Options
      description: Other input options for the filter.
    - contextPath: History.ID
      description: The unique id of the historical data.
    - contextPath: History.UUID
      description: The uuid of the historical data.
    - contextPath: History.OwnerID
      description: The unique id of the owner of the scan.
    - contextPath: History.Status
      description: The status of the historical data.
    - contextPath: History.CreationDate
      description: The creation date for the historical data in unixtime.
    - contextPath: History.LastModification_date
      description: The last modification date for the historical data in unixtime.
    - contextPath: Remediations.Remediations
      description: Remedy to vulnerabilites found during the scan.
    - contextPath: Remediations.NumHosts
      description: Number of hosts of Remediations
    - contextPath: Remediations.NumCVEs
      description: Number of CVE's
    - contextPath: Remediations.NumImpactedHosts
      description: Number of impacted hosts
    - contextPath: Remediations.NumRemediatedCVEs
      description: Number of Remediated CVE's
  - arguments:
    - default: true
      description: The Scan ID (use command list-scans to get possible scan ID's)
      name: scanId
      required: true
    - description: The history_id of the historical data that should be returned.
      name: historyId
    - description: The id of the host to retrieve.
      name: hostId
      required: true
    deprecated: true
    description: Returns details for the given host.
    name: scan-host-details
    outputs:
    - contextPath: Endpoint.ID
      description: The unique id of the host.
    - contextPath: Endpoint.Index
      description: The index for the host.
    - contextPath: Endpoint.Hostname
      description: The overall severity rating of the host.
    - contextPath: Endpoint.Progress
      description: The scan progress of the host.
    - contextPath: Endpoint.Critical
      description: The percentage of critical findings on the host.
    - contextPath: Endpoint.High
      description: The percentage of high findings on the host.
    - contextPath: Endpoint.Medium
      description: The percentage of medium findings on the host.
    - contextPath: Endpoint.Low
      description: The percentage of low findings on the host.
    - contextPath: Endpoint.Info
      description: The percentage of info findings on the host.
    - contextPath: Endpoint.TotalChecksConsidered
      description: The total number of checks considered on the host.
    - contextPath: Endpoint.NumChecksConsidered
      description: The number of checks considered on the host.
    - contextPath: Endpoint.ScanProgressTotal
      description: The total scan progress for the host.
    - contextPath: Endpoint.ScanProgressCurrent
      description: The current scan progress for the host.
    - contextPath: Endpoint.Score
      description: The overall score for the host.
  - arguments:
    - default: true
      description: The Scan ID (use command list-scans to get possible scan ID's)
      name: scanId
      required: true
    - description: The history_id of the historical data that should be returned.
      name: historyId
    - description: The id of the host to retrieve.
      name: hostId
      required: true
    description: Returns details for the given host.
    name: nessus-scan-host-details
    outputs:
    - contextPath: Endpoint.ID
      description: The unique id of the host.
    - contextPath: Endpoint.Index
      description: The index for the host.
    - contextPath: Endpoint.Hostname
      description: The overall severity rating of the host.
    - contextPath: Endpoint.Progress
      description: The scan progress of the host.
    - contextPath: Endpoint.Critical
      description: The percentage of critical findings on the host.
    - contextPath: Endpoint.High
      description: The percentage of high findings on the host.
    - contextPath: Endpoint.Medium
      description: The percentage of medium findings on the host.
    - contextPath: Endpoint.Low
      description: The percentage of low findings on the host.
    - contextPath: Endpoint.Info
      description: The percentage of info findings on the host.
    - contextPath: Endpoint.TotalChecksConsidered
      description: The total number of checks considered on the host.
    - contextPath: Endpoint.NumChecksConsidered
      description: The number of checks considered on the host.
    - contextPath: Endpoint.ScanProgressTotal
      description: The total scan progress for the host.
    - contextPath: Endpoint.ScanProgressCurrent
      description: The current scan progress for the host.
    - contextPath: Endpoint.Score
      description: The overall score for the host.
  - arguments:
    - default: true
      description: The Scan ID (use command list-scans to get possible scan ID's)
      name: scanId
      required: true
    - description: The history_id of the historical data that should be returned.
      name: historyId
    - description: scan report file format (nessus, csv, html, db, pdf)
      name: format
      required: true
    - description: The password used to encrypt database exports (*Required when exporting
        as DB).
      name: password
    - description: 'The chapters to include in the export (expecting a semi-colon
        delimited string comprised of some combination of the following options: vuln_hosts_summary,
        vuln_by_host, compliance_exec, remediations, vuln_by_plugin, compliance)'
      name: chapters
    description: Export the given scan (Nessus, HTML, PDF, CSV, or DB format)
    name: nessus-scan-export
    outputs:
    - contextPath: ScanReportID
      description: ID of the scan report.
  - arguments:
    - default: true
      description: The Scan ID (use command list-scans to get possible scan ID's)
      name: scanId
      required: true
    - description: The history_id of the historical data that should be returned.
      name: historyId
    - description: scan report file format (nessus, csv, html, db, pdf)
      name: format
      required: true
    - description: The password used to encrypt database exports (*Required when exporting
        as DB).
      name: password
    - description: 'The chapters to include in the export (expecting a semi-colon
        delimited string comprised of some combination of the following options: vuln_hosts_summary,
        vuln_by_host, compliance_exec, remediations, vuln_by_plugin, compliance)'
      name: chapters
    deprecated: true
    description: Export the given scan (Nessus, HTML, PDF, CSV, or DB format)
    name: scan-export
    outputs:
    - contextPath: ScanReportID
      description: ID of the scan report.
  - arguments:
    - default: true
      description: The Scan ID (use command list-scans to get possible scan ID's)
      name: scanId
      required: true
    - description: The id of the file to download (result from command export-scan).
      name: fileId
      required: true
    deprecated: true
    description: Download an exported scan
    name: scan-report-download
  - arguments:
    - default: true
      description: The Scan ID (use command list-scans to get possible scan ID's)
      name: scanId
      required: true
    - description: The id of the file to download (result from command export-scan).
      name: fileId
      required: true
    description: Download an exported scan
    name: nessus-scan-report-download
  - arguments:
    - default: true
      description: The uuid for the editor template to use
      name: editor
      required: true
    - description: The name of the scan
      name: name
      required: true
    - description: The description of the scan
      name: description
    - description: The unique id of the policy to use(number)
      name: policyId
    - description: The unique id of the destination folder for the scan(number)
      name: folderId
    - description: The unique id of the scanner to use(number)
      name: scannerId
    - description: If true, the schedule for the scan is enabled(true/false)
      name: schedule
      required: true
    - description: When to launch the scan. (i.e. ON_DEMAND, DAILY, WEEKLY, MONTHLY,
        YEARLY)
      name: launch
    - description: The starting time and date for the scan (i.e. YYYYMMDDTHHMMSS).
      name: startTime
    - description: Expects a semi-colon delimited string comprised of three values.
        The frequency (FREQ=ONCE or DAILY or WEEKLY or MONTHLY or YEARLY), the interval
        (INTERVAL=1 or 2 or 3 ... x), and the days of the week (BYDAY=SU,MO,TU,WE,TH,FR,SA).
        To create a scan that runs every three weeks on Monday Wednesday and Friday
        the string would be 'FREQ=WEEKLY;INTERVAL=3;BYDAY=MO,WE,FR'
      name: rules
    - description: The timezone for the scan schedule
      name: timeZone
    - description: The list of targets to scan, Value can be single host or of comma
        separated targets.
      name: targets
      required: true
    - description: A comma separated list of accounts who will recieve the email summary
        report
      name: emails
    - description: An array containing permissions to apply to the scan
      name: acls
    - description: The name of a file containing the list of targets to scan
      name: fileTargets
    deprecated: true
    description: Creates a new scan
    name: scan-create
    outputs:
    - contextPath: NessusScan.UUID
      description: The uuid for the scan.
    - contextPath: NessusScan.Name
      description: The name of the scan.
    - contextPath: NessusScan.Status
      description: The status of the scan.
    - contextPath: NessusScan.FolderID
      description: The unique id of the folder housing the scan.
    - contextPath: NessusScan.ID
      description: The unique id of the scan.
    - contextPath: NessusScan.UserPermissions
      description: The sharing permissions for the scan.
    - contextPath: NessusScan.CreationDate
      description: The creation date for the scan in unixtime.
    - contextPath: NessusScan.LastModificationDate
      description: The last modification date for the scan in unixtime.
    - contextPath: NessusScan.Type
      description: The type of scan (local, remote, or agent).
    - contextPath: NessusScan.Policy
      description: The policy if the scan.
  - arguments:
    - default: true
      description: The uuid for the editor template to use
      name: editor
      required: true
    - description: The name of the scan
      name: name
      required: true
    - description: The description of the scan
      name: description
    - description: The unique id of the policy to use(number)
      name: policyId
    - description: The unique id of the destination folder for the scan(number)
      name: folderId
    - description: The unique id of the scanner to use(number)
      name: scannerId
    - description: If true, the schedule for the scan is enabled(true/false)
      name: schedule
      required: true
    - description: When to launch the scan. (i.e. ON_DEMAND, DAILY, WEEKLY, MONTHLY,
        YEARLY)
      name: launch
    - description: The starting time and date for the scan (i.e. YYYYMMDDTHHMMSS).
      name: startTime
    - description: Expects a semi-colon delimited string comprised of three values.
        The frequency (FREQ=ONCE or DAILY or WEEKLY or MONTHLY or YEARLY), the interval
        (INTERVAL=1 or 2 or 3 ... x), and the days of the week (BYDAY=SU,MO,TU,WE,TH,FR,SA).
        To create a scan that runs every three weeks on Monday Wednesday and Friday
        the string would be 'FREQ=WEEKLY;INTERVAL=3;BYDAY=MO,WE,FR'
      name: rules
    - description: The timezone for the scan schedule
      name: timeZone
    - description: The list of targets to scan, Value can be single host or of comma
        separated targets.
      name: targets
      required: true
    - description: A comma separated list of accounts who will recieve the email summary
        report
      name: emails
    - description: An array containing permissions to apply to the scan
      name: acls
    - description: The name of a file containing the list of targets to scan
      name: fileTargets
    description: Creates a new scan
    name: nessus-scan-create
    outputs:
    - contextPath: NessusScan.UUID
      description: The uuid for the scan.
    - contextPath: NessusScan.Name
      description: The name of the scan.
    - contextPath: NessusScan.Status
      description: The status of the scan.
    - contextPath: NessusScan.FolderID
      description: The unique id of the folder housing the scan.
    - contextPath: NessusScan.ID
      description: The unique id of the scan.
    - contextPath: NessusScan.UserPermissions
      description: The sharing permissions for the scan.
    - contextPath: NessusScan.CreationDate
      description: The creation date for the scan in unixtime.
    - contextPath: NessusScan.LastModificationDate
      description: The last modification date for the scan in unixtime.
    - contextPath: NessusScan.Type
      description: The type of scan (local, remote, or agent).
    - contextPath: NessusScan.Policy
      description: The policy if the scan.
  - arguments: []
    description: Returns all scan editors template list
    name: nessus-get-scans-editors
  - arguments:
    - description: The Scan ID (use command list-scans to get possible scan ID's)
      name: scanId
      required: true
    - description: The id of the file to download (result from command export-scan).
      name: fileId
      required: true
    deprecated: true
    description: Check the file status of an exported scan
    name: scan-export-status
    outputs:
    - contextPath: NessusScan.ScanReportStatus
      description: The status of the scan report.
  - arguments:
    - description: The Scan ID (use command list-scans to get possible scan ID's)
      name: scanId
      required: true
    - description: The id of the file to download (result from command export-scan).
      name: fileId
      required: true
    description: Check the file status of an exported scan
    name: nessus-scan-export-status
    outputs:
    - contextPath: NessusScan.ScanReportStatus
      description: The status of the scan report.
  - arguments:
    - description: The Scan ID (use command list-scans to get possible scan ID's)
      name: scanId
      required: true
    description: Get scan status by scan id
    name: nessus-scan-status
    outputs:
    - contextPath: NessusScan.Status
      description: The status of the scan report.
  script: "var getReadyURL = function() {\n    u = params.url;\n    if (u && u[u.length\
    \ - 1] !== '/') {\n      u = u +'/';\n    }\n    return u;\n};\n\nvar resToMD\
    \ = function(body, title) {\n    return tblToMd(title, body, Object.keys(body));\n\
    };\n\nvar entities = {\n    NessusScan: {\n        uuid:                   'UUID',\n\
    \        name:                   'Name' ,\n        status:                 'Status',\n\
    \        folder_id:              'FolderID',\n        id:                    \
    \ 'ID',\n        type:                   'Type',\n        policy:            \
    \     'Policy',\n        user_permissions:       'UserPermissions',\n        creation_date:\
    \          'CreationDate'  ,\n        last_modification_date: 'LastModificationDate'\n\
    \    },\n    NessusFolder: {\n        unread_count:           'UnreadCount',\n\
    \        custom:                 'Custom',\n        default_tag:            'DefaultTag',\n\
    \        type:                   'Type',\n        name:                   'Name',\n\
    \        id:                     'ID'\n    },\n    Endpoint : {\n        host_id:\
    \                'ID',\n        host_index:             'Index',\n        hostname:\
    \               'Hostname',\n        progress:               'Progress',\n   \
    \     critical:               'Critical',\n        high:                   'High',\n\
    \        medium:                 'Medium',\n        low:                    'Low',\n\
    \        info:                   'Info',\n        totalchecksconsidered:  'TotalChecksConsidered',\n\
    \        numchecksconsidered:    'NumChecksConsidered',\n        scanprogresstotal:\
    \      'ScanProgressTotal',\n        scanprogresscurrent:    'ScanProgressCurrent',\n\
    \        score:                  'Score'\n    },\n    Vulnerability : {\n    \
    \    plugin_id:              'PluginID'  ,\n        plugin_name:            'PluginName',\n\
    \        plugin_family:          'PluginFamily',\n        count:             \
    \     'Count'  ,\n        vuln_index:             'VulnerabilityIndex',\n    \
    \    severity_index:         'SeverityIndex'\n    },\n    Note : {\n        title:\
    \                  'Title',\n        message:                'Message',\n    \
    \    severity:               'Sevirity'\n    },\n    Filter:{\n        name: \
    \                  'Name',\n        readable_name:          'ReadableName',\n\
    \        operators:              'Operators',\n        'control.type':       \
    \  'Type',\n        'control.readable_regest':'ReadableRegest',\n        'control.regex':\
    \        'Regex',\n        'control.options':      'Options'\n    },\n    History:{\n\
    \        history_id:             'ID',\n        uuid:                   'UUID',\n\
    \        owner_id:               'OwnerID',\n        status:                 'Status',\n\
    \       creation_date:           'CreationDate',\n        last_modification_date:\
    \ 'LastModification_date'\n\n    },\n    Remediations:{\n        remediations:\
    \           'Remediations',\n        num_hosts:              'NumHosts',\n   \
    \     num_cves:               'NumCVEs',\n        num_impacted_hosts:     'NumImpactedHosts',\n\
    \        num_remediated_cves:    'NumRemediatedCVEs'\n    }\n};\n\n//returns single\
    \ object withing entity (i.e. File[0])\nvar jsonToEntityObject = function(origObj,\
    \ newKeys){\n    var ret = {};\n    for(var key in newKeys){\n        if(newKeys[key]){\n\
    \            ret[newKeys[key]] = dq(origObj, key);\n        }\n    }\n    return\
    \ ret;\n};\n\n//returns entire entity array (i.e. File)\nvar jsonToEntity = function(origObj,\
    \ newKeys){\n    var j;\n    if(!Array.isArray(origObj)){\n        return [jsonToEntityObject(origObj,\
    \ newKeys)];\n    }\n    else if(origObj.length > 0){ //makes sure no empty arrays\
    \ are pushed\n        var ret = [];\n        for(j=0; j<origObj.length; j++){\n\
    \            ret.push(jsonToEntityObject(origObj[j], newKeys));\n        }\n \
    \       return ret;\n    }\n};\n\nvar login = function() {\n    var result = http(\n\
    \        getReadyURL()+'session',\n        {\n            Headers: {'Content-Type':\
    \ ['application/json']},\n            Method: 'POST',\n            Body: JSON.stringify({'username':params.username,'password':params.password}),\n\
    \        },\n        params.insecure\n    );\n    if (result.StatusCode !== 200\
    \ && result.StatusCode !== 201) {\n        throw 'Failed to login, request status\
    \ code: ' + result.StatusCode + ', check that username/password are correct';\n\
    \    }\n    return JSON.parse(result.Body).token;\n};\n\nvar logout = function(token)\
    \ {\n    var result = http(\n        getReadyURL()+'session',\n        {\n   \
    \         Headers: {'Content-Type': ['application/json'], 'X-Cookie': ['token='+token]},\n\
    \            Method: 'DELETE',\n        },\n        params.insecure\n    );\n\
    \    if (result.StatusCode !== 200 && result.StatusCode !== 401) {\n        throw\
    \ 'Failed to logout session, request status code: ' + result.StatusCode + ', body='+result.Body;\n\
    \    }\n    return 'deleted';\n};\n\nvar listScans = function(token) {\n    var\
    \ result = http(\n        getReadyURL()+'scans',\n        {\n            Headers:\
    \ {'Content-Type': ['application/json'], 'X-Cookie': ['token='+token]},\n    \
    \        Method: 'GET',\n        },\n        params.insecure\n    );\n\n    if\
    \ (result.StatusCode !== 200 ) {\n        throw 'Failed to get scans list, request\
    \ status code: ' + result.StatusCode + ', body='+result.Body;\n    }\n    logout(token);\n\
    \n    var res = JSON.parse(result.Body);\n    var md = '';\n    if(res.folders\
    \ && res.folders.length > 0){\n        md += tblToMd('Folders', res.folders, args.foldersHeaders?\
    \ args.foldersHeaders : Object.keys(res.folders[0]));\n    }\n    if(res.scans\
    \ && res.scans.length > 0){\n        md += tblToMd('Scans', res.scans, args.scansHeaders?\
    \ args.scansHeaders : Object.keys(res.scans[0]));\n    }\n    var context = {\n\
    \        NessusFolder : jsonToEntity(res.folders, entities.NessusFolder),\n  \
    \      NessusScan : jsonToEntity(res.scans, entities.NessusScan)\n    };\n   \
    \ return {\n        Type: entryTypes.note,\n        Contents: JSON.parse(result.Body),\n\
    \        ContentsFormat: formats.json,\n        HumanReadable: md,\n        EntryContext:\
    \ context\n    };\n};\n\nvar scanLaunch = function(token,scanId, targets) {\n\
    \    var body = \"\";\n    if (targets && targets.length > 0 ) {\n        var\
    \ targetsArr = [ targets ];\n        body = JSON.stringify({'alt_targets': targetsArr});\n\
    \    }\n    var result = http(\n        getReadyURL()+'scans/'+scanId+'/launch',\n\
    \        {\n            Headers: {'Content-Type': ['application/json'], 'X-Cookie':\
    \ ['token='+token]},\n            Method: 'POST',\n            Body: body,\n \
    \       },\n        params.insecure\n    );\n    if (result.StatusCode !== 200\
    \ ) {\n        throw 'Failed to launch scans list, request status code: ' + result.StatusCode\
    \ + ', body='+result.Body;\n    }\n    logout(token);\n    var res = JSON.parse(result.Body);\n\
    \    setContext('ScanUUID', res.scan_uuid);\n    var md = 'scan uuid: ' + res.scan_uuid;\n\
    \n    return {\n        Type: entryTypes.note,\n        Contents: res,\n     \
    \   ContentsFormat: formats.json,\n        HumanReadable: md\n    };\n};\n\nvar\
    \ scanDetails = function(token,scanId,historyId) {\n    var url = getReadyURL()+'scans/'+scanId;\n\
    \    if (historyId && historyId.length > 0 ){\n        url = url + '?history_id='+historyId;\n\
    \    }\n    var result = http(\n        url,\n        {\n            Headers:\
    \ {'Content-Type': ['application/json'], 'X-Cookie': ['token='+token]},\n    \
    \        Method: 'GET',\n        },\n        params.insecure\n    );\n    if (result.StatusCode\
    \ !== 200 ) {\n        throw 'Failed to get scan Details, request status code:\
    \ ' + result.StatusCode + ', body='+result.Body;\n    }\n    logout(token);\n\
    \    var res = JSON.parse(result.Body);\n\n    var tbToEntity = {'hosts':'Endpoint','comphosts':'Endpoint','vulnerabilities':'Vulnerability',/*'compliance':'Vulnerability',*/'notes':'Note','filters':'Filter','history':'History','remediations':'Remediations'};\n\
    \    var tables = Object.keys(tbToEntity);\n    if(args.tables)\n        tables\
    \ = args.tables.split(/([ ,\\,])/);\n\n    var md = '';\n    var cur, i, j;\n\
    \    for(i=0; i<tables.length; i++){\n        cur = res[tables[i]];\n        if(cur){\n\
    \            if(!Array.isArray(cur)){\n                md+=tblToMd('Scan '+args.scanId+'\
    \ '+tables[i], cur, Object.keys(cur));\n            }\n            else if(cur.length\
    \ > 0){\n                md+=tblToMd('Scan '+args.scanId+' '+tables[i], cur, Object.keys(cur[0]));\n\
    \            }\n            else{\n                md+='### '+'Scan '+args.scanId+'\
    \ '+tables[i]+'\\n' + 'No data returned\\n';\n            }\n        }\n    }\n\
    \    var context = { NessusScan : jsonToEntity(res.info, entities.NessusScan)};\n\
    \    var curField;\n    context.NessusScan.ID = args.scanId;\n    for(i=0; i<tables.length;\
    \ i++){\n        cur = res[tables[i]];\n        if(Array.isArray(cur) ? cur.length!=0\
    \ : !!cur){\n            curField = context.NessusScan[0][tbToEntity[tables[i]]];\n\
    \            if(curField){\n                context.NessusScan[0][tbToEntity[tables[i]]]=curField.concat(jsonToEntity(cur,\
    \ entities[tbToEntity[tables[i]]]));\n            }\n            else{\n     \
    \           context.NessusScan[0][tbToEntity[tables[i]]] = jsonToEntity(cur, entities[tbToEntity[tables[i]]]);\n\
    \            }\n        }\n    }\n    var ec = {};\n    ec['NessusScan(val.ID\
    \ && val.ID == '+scanId+' || val.UUID && val.UUID == '+context.NessusScan.UUID+')']\
    \ = context.NessusScan;\n\n    return {\n        Type: entryTypes.note,\n    \
    \    Contents: result.Body,\n        ContentsFormat: formats.json,\n        HumanReadable:\
    \ md,\n        EntryContext: ec\n    };\n\n};\n\nvar scanStatus = function(token,scanId){\n\
    \    var url = getReadyURL()+'scans/'+scanId;\n    var result = http(\n      \
    \  url,\n        {\n            Headers: {'Content-Type': ['application/json'],\
    \ 'X-Cookie': ['token='+token]},\n            Method: 'GET',\n        },\n   \
    \     params.insecure\n    );\n    if (result.StatusCode !== 200 ) {\n       \
    \ throw 'Failed to get scan Details, request status code: ' + result.StatusCode\
    \ + ', body='+result.Body;\n    }\n    logout(token);\n    var res = JSON.parse(result.Body);\n\
    \n    //setContext('ScanStatus',res.info.status);\n\n    var context = {};\n \
    \   context['NessusScan(val.ID && val.ID == ' + scanId +').Status'] = res.info.status;\n\
    \    //log(JSON.stringify(context));\n\n    return {\n        Type: entryTypes.note,\n\
    \        Contents: result.Body,\n        ContentsFormat: formats.json,\n     \
    \   HumanReadable: 'Scan status: '+ res.info.status,\n        EntryContext: context\n\
    \    };\n};\n\nvar scanHostDetails = function(token,scanId,historyId,hostId) {\n\
    \    var url = getReadyURL()+'scans/'+scanId + '/hosts/' + hostId;\n    if (historyId\
    \ && historyId.length > 0 ){\n        url = url + '?history_id='+historyId;\n\
    \    }\n    var result = http(\n        url,\n        {\n            Headers:\
    \ {'Content-Type': ['application/json'], 'X-Cookie': ['token='+token]},\n    \
    \        Method: 'GET',\n        },\n        params.insecure\n    );\n    if (result.StatusCode\
    \ !== 200 ) {\n        throw 'Failed to get scan Details, request status code:\
    \ ' + result.StatusCode + ', body='+result.Body;\n    }\n    logout(token);\n\
    \    return JSON.parse(result.Body);\n};\n\nvar scanExport = function(token, scanId,\
    \ historyId, format, password, chapters) {\n    var url = getReadyURL()+'scans/'+scanId\
    \ + '/export';\n    if (historyId && historyId.length > 0 ){\n        url = url\
    \ + '?history_id='+historyId;\n    }\n    var body = {'format':format};\n    if\
    \ (password && password.length > 0){\n        body.password = password;\n    }\n\
    \    if (chapters && chapters.length > 0){\n        body.chapters = chapters;\n\
    \    }\n    var result = http(\n        url,\n        {\n            Headers:\
    \ {'Content-Type': ['application/json'], 'X-Cookie': ['token='+token]},\n    \
    \        Method: 'POST',\n            Body: JSON.stringify(body),\n        },\n\
    \        params.insecure\n    );\n    if (result.StatusCode !== 200 ) {\n    \
    \    throw 'Failed to launch scans list, request status code: ' + result.StatusCode\
    \ + ', body='+result.Body;\n    }\n    logout(token);\n\n    var context = {};\n\
    \    context['NessusScan(val.ID && val.ID == ' + scanId +').ScanReportID'] = JSON.parse(result.Body).file;\n\
    \n    return {\n        Type: entryTypes.note,\n        Contents: result.Body,\n\
    \        ContentsFormat: formats.json,\n        HumanReadable: 'Report file id:\
    \ ' + JSON.parse(result.Body).file,\n        EntryContext: context\n    };\n};\n\
    \nvar getReport = function(token, scanId, fileId) {\n    var res = http(\n   \
    \     getReadyURL()+'scans/'+ scanId + '/export/' + fileId + '/download',\n  \
    \      {\n            Headers: {'Content-Type': ['application/json'], 'X-Cookie':\
    \ ['token='+token]},\n            Method: 'GET',\n        },\n        params.insecure\n\
    \    );\n    if (res.StatusCode !== 200) {\n        return 'Failed to execute\
    \ request:' + res.StatusCode + ', body: ' + res.Body;\n    }\n    var savedFile\
    \ = saveFile(res.Body);\n    logout(token);\n    return savedFile;\n};\n\nvar\
    \ scanCreate = function(token, editorUuid, name, description, policy,folder, scannerId,\
    \ schedule, launchTime, startTime, rules, timeZone, targets,fileTargets, emails,\
    \ acls) {\n    var body = {};\n    body.uuid = editorUuid;\n    body.settings\
    \ = {};\n    body.settings.name = name;\n    if (description && description.length\
    \ > 0){\n        body.settings.description = description;\n    }\n    if (policy\
    \ && policy.length > 0){\n        body.settings.policy_id = parseInt(policy);\n\
    \    }\n    if (folder && folder.length > 0){\n        body.settings.folder_id\
    \ = parseInt(folder);\n    }\n    if (scannerId && scannerId.length > 0){\n  \
    \      body.settings.scanner_id = parseInt(scannerId);\n    }\n    if (schedule\
    \ && schedule.length > 0){\n        body.settings.enabled = (schedule == 'true');\n\
    \    }\n    if (launchTime && launchTime.length > 0){\n        body.settings.launch\
    \ = launchTime;\n    }\n    if (startTime && startTime.length > 0){\n        body.settings.starttime\
    \ = startTime;\n    }\n    if (rules && rules.length > 0){\n        body.settings.rrules\
    \ = rules;\n    }\n    if (timeZone && timeZone.length > 0){\n        body.settings.timezone\
    \ = timeZone;\n    }\n    if (targets && targets.length > 0 ) {\n        body.settings.text_targets\
    \ = targets;\n    }\n    if (fileTargets && fileTargets.length > 0 ) {\n     \
    \   body.settings.file_targets = fileTargets;\n    }\n    if (emails && emails.length\
    \ > 0 ) {\n        body.settings.emails = emails;\n    }\n    if (acls && acls.length\
    \ > 0 ) {\n        body.settings.acls = acls;\n    }\n    var result = http(\n\
    \        getReadyURL()+'scans',\n        {\n            Headers: {'Content-Type':\
    \ ['application/json'], 'X-Cookie': ['token='+token]},\n            Method: 'POST',\n\
    \            Body: JSON.stringify(body),\n        },\n        params.insecure\n\
    \    );\n    if (result.StatusCode !== 200 ) {\n        throw 'Failed to launch\
    \ scans list, request status code: ' + result.StatusCode + ', body='+result.Body;\n\
    \    }\n    logout(token);\n\n    var res = JSON.parse(result.Body);\n    var\
    \ md = tblToMd('Created Scan Details', res.scan, Object.keys(res.scan));\n   \
    \ var context = {NessusScan: jsonToEntity(res.scan, entities.NessusScan)};\n\n\
    \    return {\n        Type: entryTypes.note,\n        Contents: JSON.parse(result.Body),\n\
    \        ContentsFormat: formats.json,\n        HumanReadable: md,\n        EntryContext:\
    \ context\n    };\n};\n\nvar getEditors = function(token) {\n    var url = getReadyURL()+'editor/scan/templates';\n\
    \    var result = http(\n        url,\n        {\n            Headers: {'Content-Type':\
    \ ['application/json'], 'X-Cookie': ['token='+token]},\n            Method: 'GET',\n\
    \        },\n        params.insecure\n    );\n    if (result.StatusCode !== 200\
    \ ) {\n        throw 'Failed to get scan editors, request status code: ' + result.StatusCode\
    \ + ', body='+result.Body;\n    }\n    logout(token);\n\n    var res = JSON.parse(result.Body).templates;\n\
    \    var md = tblToMd('Nessus Scans Editors',res,\n                    ['title','name','desc','uuid','cloud_only','subscription_only','is_agent','more_info','manager_only','unsupported']);\n\
    \    return {\n        Type: entryTypes.note,\n        Contents: result.Body,\n\
    \        ContentsFormat: formats.json,\n        HumanReadable: md\n    };\n};\n\
    \nvar getStatus = function(token,scanId,fileId) {\n    var url = getReadyURL()+'scans/'+scanId+'/export/'+fileId+'/status';\n\
    \    var result = http(\n        url,\n        {\n            Headers: {'Content-Type':\
    \ ['application/json'], 'X-Cookie': ['token='+token]},\n            Method: 'GET',\n\
    \        },\n        params.insecure\n    );\n    if (result.StatusCode !== 200\
    \ ) {\n        throw 'Failed to get export status, request status code: ' + result.StatusCode\
    \ + ', body='+result.Body;\n    }\n    logout(token);\n\n    var context = {};\n\
    \    context['NessusScan(val.ID && val.ID == '+scanId+').ScanReportStatus'] =\
    \ JSON.parse(result.Body).status;\n\n    return {\n        Type: entryTypes.note,\n\
    \        Contents: result.Body,\n        ContentsFormat: formats.json,\n     \
    \   HumanReadable: 'Report file status: ' + JSON.parse(result.Body).status,\n\
    \        EntryContext: context\n    };\n};\nswitch (command) {\n    case 'test-module':\n\
    \        token = login();\n        logout(token);\n        return (token && token.length\
    \ >0);\n    case 'scans-list': //deprecated\n    case 'nessus-list-scans':\n \
    \       return listScans(login());\n    case 'scan-launch': //deprecated\n   \
    \ case 'nessus-launch-scan':\n        return scanLaunch(login(),args.scanId,args.targets);\n\
    \    case 'scan-details': //deprecated\n    case 'nessus-scan-details':\n    \
    \    return scanDetails(login(),args.scanId,args.historyId);\n    case 'scan-export':\
    \ //deprecated\n    case 'nessus-scan-export':\n        return scanExport(login(),args.scanId,args.historyId,args.format,args.password,args.chapters);\n\
    \    case 'scan-report-download': //deprecated\n    case 'nessus-scan-report-download':\n\
    \        return {Type: 3, FileID: getReport(login(),args.scanId,args.fileId),File:\
    \ args.fileId+'', Contents: 'we must have contents for an entry'};\n    case 'scan-export-status':\
    \ //deprecated\n    case 'nessus-scan-export-status':\n        return getStatus(login(),args.scanId,args.fileId);\n\
    \    case 'scan-create': //deprecated\n    case 'nessus-scan-create':\n      \
    \  return scanCreate(login(),args.editor,args.name, args.description, args.policyId,\
    \ args.folderId, args.scannerId, args.schedule, args.launch, args.startTime, args.rules,\n\
    \            args.timeZone, args.targets,args.fileTargets, args.emails, args.acls);\n\
    \    case 'nessus-get-scans-editors':\n        return getEditors(login());\n \
    \   case 'nessus-scan-status':\n        return scanStatus(login(),args.scanId);\n\
    \    case 'nessus-scan-host-details':\n    case 'scan-host-details': //deprecated\n\
    \        return scanHostDetails(login(),args.scanId,args.historyId,args.hostId);\n\
    \n}\n"
  type: javascript
tests:
- Nessus - Test
toversion: 4.1.9
