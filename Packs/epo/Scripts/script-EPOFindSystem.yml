args:
- description: Free text to search on. could be the hostname, agent guid etc.
  name: searchText
  required: true
comment: Return system info
commonfields:
  id: EPOFindSystem
  version: -1
dependson:
  must:
  - epo-command
name: EPOFindSystem
outputs:
- contextPath: Endpoint.Hostname
  description: Hostname
script: "\ndef createSystemContext(system):\n    context = {}\n    context[\"AutoID\"\
  ] = system[\"EPOBranchNode.AutoID\"]\n    context[\"CPUSerialNum\"] = system[\"\
  EPOComputerProperties.CPUSerialNum\"]\n    context[\"CPUSpeed\"] = system[\"EPOComputerProperties.CPUSpeed\"\
  ]\n    context[\"CPUType\"] = system[\"EPOComputerProperties.CPUType\"]\n    context[\"\
  ComputerName\"] = system[\"EPOComputerProperties.ComputerName\"]\n    context[\"\
  DefaultLangID\"] = system[\"EPOComputerProperties.DefaultLangID\"]\n    context[\"\
  Description\"] = system[\"EPOComputerProperties.Description\"]\n    context[\"DomainName\"\
  ] = system[\"EPOComputerProperties.DomainName\"]\n    context[\"FreeDiskSpace\"\
  ] = system[\"EPOComputerProperties.FreeDiskSpace\"]\n    context[\"FreeMemory\"\
  ] = system[\"EPOComputerProperties.FreeMemory\"]\n    context[\"IPAddress\"] = system[\"\
  EPOComputerProperties.IPAddress\"]\n    context[\"Hostname\"] = system[\"EPOComputerProperties.IPHostName\"\
  ]\n    context[\"IPSubnet\"] = system[\"EPOComputerProperties.IPSubnet\"]\n    context[\"\
  IPSubnetMask\"] = system[\"EPOComputerProperties.IPSubnetMask\"]\n    context[\"\
  IPV4x\"] = system[\"EPOComputerProperties.IPV4x\"]\n    context[\"IPV6\"] = system[\"\
  EPOComputerProperties.IPV6\"]\n    context[\"IPXAddress\"] = system[\"EPOComputerProperties.IPXAddress\"\
  ]\n    context[\"IsPortable\"] = system[\"EPOComputerProperties.IsPortable\"]\n\
  \    context[\"LastAgentHandler\"] = system[\"EPOComputerProperties.LastAgentHandler\"\
  ]\n    context[\"NetAddress\"] = system[\"EPOComputerProperties.NetAddress\"]\n\
  \    context[\"NumOfCPU\"] = system[\"EPOComputerProperties.NumOfCPU\"]\n    context[\"\
  OSBitMode\"] = system[\"EPOComputerProperties.OSBitMode\"]\n    context[\"OSBuildNum\"\
  ] = system[\"EPOComputerProperties.OSBuildNum\"]\n    context[\"OSOEMID\"] = system[\"\
  EPOComputerProperties.OSOEMID\"]\n    context[\"OSPlatform\"] = system[\"EPOComputerProperties.OSPlatform\"\
  ]\n    context[\"OSServicePackVer\"] = system[\"EPOComputerProperties.OSServicePackVer\"\
  ]\n    context[\"OSType\"] = system[\"EPOComputerProperties.OSType\"]\n    context[\"\
  OSVersion\"] = system[\"EPOComputerProperties.OSVersion\"]\n    context[\"ParentID\"\
  ] = system[\"EPOComputerProperties.ParentID\"]\n    context[\"SubnetAddress\"] =\
  \ system[\"EPOComputerProperties.SubnetAddress\"]\n    context[\"SubnetMask\"] =\
  \ system[\"EPOComputerProperties.SubnetMask\"]\n    context[\"SystemDescription\"\
  ] = system[\"EPOComputerProperties.SystemDescription\"]\n    context[\"SysvolFreeSpace\"\
  ] = system[\"EPOComputerProperties.SysvolFreeSpace\"]\n    context[\"SysvolTotalSpace\"\
  ] = system[\"EPOComputerProperties.SysvolTotalSpace\"]\n    context[\"TimeZone\"\
  ] = system[\"EPOComputerProperties.TimeZone\"]\n    context[\"TotalDiskSpace\"]\
  \ = system[\"EPOComputerProperties.TotalDiskSpace\"]\n    context[\"TotalPhysicalMemory\"\
  ] = system[\"EPOComputerProperties.TotalPhysicalMemory\"]\n    context[\"UserName\"\
  ] = system[\"EPOComputerProperties.UserName\"]\n    context[\"UserProperty1\"] =\
  \ system[\"EPOComputerProperties.UserProperty1\"]\n    context[\"UserProperty2\"\
  ] = system[\"EPOComputerProperties.UserProperty2\"]\n    context[\"UserProperty3\"\
  ] = system[\"EPOComputerProperties.UserProperty3\"]\n    context[\"UserProperty4\"\
  ] = system[\"EPOComputerProperties.UserProperty4\"]\n    context[\"Vdi\"] = system[\"\
  EPOComputerProperties.Vdi\"]\n    context[\"AgentGUID\"] = system[\"EPOLeafNode.AgentGUID\"\
  ]\n    context[\"AgentVersion\"] = system[\"EPOLeafNode.AgentVersion\"]\n    context[\"\
  ExcludedTags\"] = system[\"EPOLeafNode.ExcludedTags\"]\n    context[\"LastUpdate\"\
  ] = system[\"EPOLeafNode.LastUpdate\"]\n    context[\"ManagedState\"] = system[\"\
  EPOLeafNode.ManagedState\"]\n    context[\"Tags\"] = system[\"EPOLeafNode.Tags\"\
  ]\n\n    return context\n\n\nresp = demisto.executeCommand(\"epo-command\", {\"\
  command\":\"system.find\", \"searchText\": demisto.args()[\"searchText\"]})\nres_error=[]\n\
  for res in resp:\n    if isError(res):\n        res_error.append(res)\n    else:\n\
  \        endpoint = []\n        context = {}\n        for entry in demisto.get(res,'Contents'):\n\
  \            endpoint.append(createSystemContext(entry))\n\n        context[\"Endpoint(val.Hostname\
  \ == obj.Hostname)\"] = endpoint\n\n        demisto.results({'Type' : entryTypes['note'],\n\
  \                        'Contents': demisto.get(res,'Contents'),\n            \
  \            'ContentsFormat' : formats['json'],\n                        'HumanReadable':\
  \ demisto.get(res,'HumanReadable'),\n                        'ReadableContentsFormat'\
  \ : formats['markdown'],\n                        'EntryContext' : context})\n"
scripttarget: 0
subtype: python2
system: true
tags:
- epo
timeout: 0s
toversion: 4.1.9
type: python
