category: Endpoint
commonfields:
  id: epo
  version: -1
configuration:
- defaultvalue: ''
  display: https://<address>:port
  name: address
  required: true
  type: 0
- defaultvalue: ''
  display: Username
  name: authentication
  required: true
  type: 9
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: McAfee ePolicy Orchestrator
detaileddescription: 'Integration with Intel Security''s ePolicy Orchestrator using
  the official API. '
display: McAfee ePO
image: data:image/png;base64,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
name: epo
script:
  commands:
  - arguments:
    - default: true
      description: String to search for in help.
      name: search
    - description: Command for which to print help.
      name: command
    description: Prints help (information) for ePO commands. If no command argument
      is specified, returns all ePO commands.
    name: epo-help
  - arguments: []
    description: Checks the latest DAT file in the McAfee repository.
    name: epo-get-latest-dat
    outputs:
    - contentPath: mcAfeeLatestDatVersion
      contextPath: McAfee.ePO.latestDAT
      description: Latest McAfee DAT file version.
      type: number
  - arguments: []
    description: Checks the existing DAT file version in ePO.
    name: epo-get-current-dat
    outputs:
    - contextPath: McAfee.ePO.epoDAT
      description: Current McAfee DAT file in ePO repository
      type: number
  - arguments:
    - description: A CSV list of IP addresses or system names.
      name: systems
      required: true
    - description: Number of times the server will attempt to send the task to the
        client. Default is 1 retry.
      name: retryAttempts
    - description: Retry interval in seconds. Default is 30.
      name: retryIntervalInSeconds
    - description: The threshold (in minutes) after which attempts to send the task
        to the client are aborted. Default is 5.
      name: abortAfterMinutes
    - description: The threshold (in minutes) that the client task is allowed to run.
        Defaults to 20.
      name: stopAfterMinutes
    - description: Duration (in minutes) over which to randomly spread task execution.
        Default is 0 (executes on all clients immediately).
      name: randomizationInterval
    description: Runs a client task to update the DAT file.
    name: epo-update-client-dat
  - arguments: []
    description: Triggers a server task in specific ePO servers to retrieve the latest
      signatures from the update server.
    name: epo-update-repository
  - arguments:
    - description: String to search for in the system tree group.
      name: search
    description: Returns system tree groups.
    name: epo-get-system-tree-group
    outputs:
    - contextPath: McAfee.ePO.SystemTreeGroups.groupId
      description: System tree group ID.
      type: number
    - contextPath: McAfee.ePO.SystemTreeGroups.groupPath
      description: System tree group path.
      type: string
  - arguments:
    - description: System tree group ID.
      name: groupId
      required: true
    - auto: PREDEFINED
      description: Whether to return all system data.
      name: verbose
      predefined:
      - 'true'
      - 'false'
    description: Finds computers within a specified group in the ePO tree.
    name: epo-find-systems
    outputs:
    - contextPath: Endpoint.Name
      description: Endpoint name
      type: string
    - contextPath: Endpoint.Domain
      description: Endpoint domain.
      type: string
    - contextPath: Endpoint.Hostname
      description: Endpoint hostname.
      type: string
    - contextPath: Endpoint.IPAddress
      description: Endpoint IP address.
      type: string
    - contextPath: Endpoint.OS
      description: Endpoint OS.
      type: string
    - contextPath: Endpoint.OSVersion
      description: Endpoint OS version.
      type: string
    - contextPath: Endpoint.Processor
      description: Processor model.
      type: string
    - contextPath: Endpoint.Processors
      description: Number of processors.
      type: number
    - contextPath: Endpoint.Memory
      description: Endpoint memory.
      type: number
    - contextPath: McAfee.ePO.Endpoint.Name
      description: Endpoint name.
      type: string
    - contextPath: McAfee.ePO.Endpoint.Domain
      description: Endpoint domain.
      type: string
    - contextPath: McAfee.ePO.Endpoint.Hostname
      description: Endpoint hostname.
      type: string
    - contextPath: McAfee.ePO.Endpoint.IPAddress
      description: Endpoint IP address.
      type: string
    - contextPath: McAfee.ePO.Endpoint.OS
      description: Endpoint OS.
      type: string
    - contextPath: McAfee.ePO.Endpoint.OSVersion
      description: Endpoint OS version.
      type: string
    - contextPath: McAfee.ePO.Endpoint.Processor
      description: Processor model.
      type: string
    - contextPath: McAfee.ePO.Endpoint.Processors
      description: Number of processors.
      type: number
    - contextPath: McAfee.ePO.Endpoint.Memory
      description: Endpoint memory.
      type: number
  - arguments: []
    description: Executes the ePO command. Receives the mandatory ''command'' argument,
      and other optional arguments. Run the ''epo-help'' command to get a list of
      available commands. You can also specify the ''headers'' argument to filter
      table headers. Example/:/ !epo-command command=system.find searchText=10.0.0.1
      headers=EPOBranchNode.AutoID,EPOComputerProperties.ComputerName
    name: epo-command
  - arguments:
    - description: The command to execute. Run either th core.help command or the
        !epo-help to get all available commands.
      name: command
      required: true
    - description: CSV list of key value pairs as additional arguments to pass, for
        example, "argName1:argValue1,argName2:argValue2".
      name: commandArgs
      required: true
    description: Executes the ePO command. Run the ''epo-help'' command to get a list
      of available commands. For example/:/  !epo-advanced-command command=clienttask.find
      commandArgs=searchText:On-demand. You can also specify the ''headers'' argument
      to filter table headers, for example/:/ !epo-command command=system.find searchText=10.0.0.1
      headers=EPOBranchNode.AutoID,EPOComputerProperties.ComputerName.
    name: epo-advanced-command
  - arguments:
    - description: Agent hostname.
      name: names
      required: true
    description: Wakes up an agent.
    name: epo-wakeup-agent
  - arguments:
    - description: Hostnames on which to apply tags.
      name: names
      required: true
    - description: Tag name.
      name: tagName
      required: true
    description: Applies a tag to hostnames.
    name: epo-apply-tag
  - arguments:
    - description: Hostnames from which to clear tags.
      name: names
      required: true
    - description: Tag name.
      name: tagName
      required: true
    description: Clears a tag from hostnames.
    name: epo-clear-tag
  - arguments:
    - description: Table name
      name: target
      required: true
    - description: 'The columns to select, in SQUID syntax. Example: "(select EPOEvents.AutoID
        EPOEvents.DetectedUTC EPOEvents.ReceivedUTC)"'
      name: select
    - description: 'Filter results, in SQUID syntax. Example: "(where ( eq ( OrionTaskLogTask
        .UserName "ga" )))"'
      name: where
    - description: 'Order in which to return the results, in SQUID syntax. Example:
        "(order (asc OrionTaskLogTask.StartDate) )")'
      name: order
    - description: 'Group the results, in SQUID Syntax. Example: "(group EPOBranchNode.NodeName)"'
      name: group
    - description: Perform join, in SQUID syntax.
      name: joinTables
    - description: Name for the query to appear in the context
      name: query_name
    description: Queries an ePO table.
    name: epo-query-table
    outputs:
    - contextPath: McAfee.ePO.Query
      description: Query result.
  - arguments:
    - description: Name of the table.
      name: table
    description: Returns an ePO table.
    name: epo-get-tables
  - arguments:
    - description: Hostname to search.
      name: searchText
    - auto: PREDEFINED
      description: Whether to print all system data.
      isArray: true
      name: verbose
      predefined:
      - 'true'
      - 'false'
    description: Finds systems in the system tree.
    name: epo-find-system
    outputs:
    - contextPath: Endpoint.Name
      description: Endpoint name.
      type: string
    - contextPath: Endpoint.Domain
      description: Endpoint domain.
      type: string
    - contextPath: Endpoint.Hostname
      description: Endpoint hostname.
      type: string
    - contextPath: Endpoint.IPAddress
      description: Endpoint IP address.
      type: string
    - contextPath: Endpoint.OS
      description: Endpoint OS.
      type: string
    - contextPath: Endpoint.OSVersion
      description: Endpoint OS version.
      type: string
    - contextPath: Endpoint.Processor
      description: Processor model.
      type: string
    - contextPath: Endpoint.Processors
      description: Number of processors.
      type: number
    - contextPath: Endpoint.Memory
      description: Endpoint memory. '
      type: number
    - contextPath: McAfee.ePO.Endpoint.Name
      description: Endpoint name.
      type: string
    - contextPath: McAfee.ePO.Endpoint.Domain
      description: Endpoint domain.
      type: string
    - contextPath: McAfee.ePO.Endpoint.Hostname
      description: Endpoint hostname.
      type: string
    - contextPath: McAfee.ePO.Endpoint.IPAddress
      description: Endpoint IP address.
      type: string
    - contextPath: McAfee.ePO.Endpoint.OS
      description: Endpoint OS
      type: string
    - contextPath: McAfee.ePO.Endpoint.OSVersion
      description: Endpoint OS version
      type: string
    - contextPath: McAfee.ePO.Endpoint.Processor
      description: Processor model.
      type: string
    - contextPath: McAfee.ePO.Endpoint.Processors
      description: Number of processors.
      type: number
    - contextPath: McAfee.ePO.Endpoint.Memory
      description: Endpoint memory.
      type: number
  - arguments: []
    description: Gets the ePO version. This requires global admin permissions.
    name: epo-get-version
    outputs:
    - contextPath: McAfee.ePO.Version
      description: ePO version
      type: string
  - arguments:
    - description: Asset name.
      name: names
      required: true
    - description: Group ID.
      name: parentGroupId
      required: true
    description: Moves a system to a different group.
    name: epo-move-system
  runonce: false
  script: "//GLOBALS//\nvar serverUrl = params.address;\nif (serverUrl[serverUrl.length\
    \ - 1] !== '/') {\n    serverUrl += '/';\n}\n\nvar EPO_SYSTEM_ATTRIBUTE_MAP =\
    \ {\n    'EPOComputerProperties.ComputerName': 'Name',\n    'EPOComputerProperties.DomainName':\
    \ 'Domain',\n    'EPOComputerProperties.IPHostName': 'Hostname',\n    'EPOComputerProperties.IPAddress':\
    \ 'IPAddress',\n    'EPOComputerProperties.OSType': 'OS',\n    'EPOComputerProperties.OSVersion':\
    \ 'OSVersion',\n    'EPOComputerProperties.CPUType': 'Processor',\n    'EPOComputerProperties.NumOfCPU':\
    \ 'Processors',\n    'EPOComputerProperties.TotalPhysicalMemory': 'Memory',\n\
    };\n\n//HELPER//\nfunction callEpo(pCommand, pArgs) {\n    var url = serverUrl\
    \ + 'remote/' + pCommand;\n    url += encodeToURLQuery(pArgs);\n    url += (Object.keys(pArgs).length\
    \ > 0) ? '&' : '?';\n    url += ':output=json';\n    var result = http(\n    \
    \    url,\n        {\n            Method: 'GET',\n            Username: params.authentication.identifier,\n\
    \            Password: params.authentication.password\n        },\n        params.insecure,\n\
    \        params.proxy\n    );\n\n    if (isResponseOK(result)) {\n        trimmedRes\
    \ = result.Body.substring(okStr.length);\n        trimmedRes = trimmedRes.replace('\\\
    n',' ');\n        parsedRes = JSON.parse(trimmedRes);\n        return parsedRes;\n\
    \    } else if (result.StatusCode == 200){\n        throw 'Error accessing ePO\
    \ interface. Command: ' + url + \". Body: \" + result.Body;\n    } else {\n  \
    \      throw 'Error accessing ePO interface. Command: ' + url + \". Response:\
    \ \" + JSON.stringify(result);\n    }\n}\n\nfunction doRawHttp(method, url, parameters,\
    \ body) {\n    if (!parameters) {\n        parameters = {};\n    }\n    var result\
    \ = http(\n        url + encodeToURLQuery(parameters),\n        {\n          \
    \  Headers: {'Content-Type': ['application/json']},\n            Method: method,\n\
    \            Body: ''\n        },\n        params.insecure,\n        params.proxy\n\
    \    );\n    if (result.StatusCode < 200 && result.StatusCode > 299) {\n     \
    \   throw 'Failed to perform request ' + url + encodeToURLQuery(parameters) +\
    \ ', request status code: ' + result.StatusCode;\n    }\n    return result;\n\
    }\n\nfunction isResponseOK(response) {\n    // EPO response if of format: OK ->\
    \ data. Error: error string\n    if (response.StatusCode === 200) {\n        okStr\
    \ = 'OK:';\n        if (response.Body.indexOf(okStr) === 0) {\n            return\
    \ true;\n        }\n    }\n    return false;\n}\n\nfunction systemsToMd(systems,verbose)\
    \ {\n    var i;\n    var md='';\n    if (verbose==\"true\") {\n        for (i=0;i<systems.length;i++)\
    \ {\n            md += systemToMd(systems[i],verbose);\n        }\n    } else\
    \ {\n        var tmpHead='|';\n        var tmpLine='|';\n        for (var key\
    \ in EPO_SYSTEM_ATTRIBUTE_MAP) {\n            tmpHead += EPO_SYSTEM_ATTRIBUTE_MAP[key]\
    \ + '|';\n            tmpLine += '-|';\n        }\n        md += tmpHead + '\\\
    n'+tmpLine+'\\n';\n        for (i=0;i<systems.length;i++) {\n            md +=\
    \ systemToMd(systems[i],verbose);\n        }\n    }\n    return md;\n}\n\nfunction\
    \ systemToMd(system,verbose) {\n    var md='';\n    var key;\n    if (verbose==\"\
    true\") {\n        md += '#### '+ system[\"EPOComputerProperties.ComputerName\"\
    ]+'\\n';\n        md += \"Attribute|Value\\n-|-\\n\";\n        for (key in system)\
    \ {\n            md += key +\"|\"+system[key]+\"\\n\";\n        }\n        md\
    \ += \"---\\n\";\n    } else {\n        md +='|';\n        for (key in EPO_SYSTEM_ATTRIBUTE_MAP)\
    \ {\n            md += system[key] +\"|\";\n        }\n        md += '\\n';\n\
    \    }\n    return md;\n}\n\n//COMMANDS//\nfunction epoHelp() {\n    var pArgs\
    \ = {};\n    if (args.command) {\n        pArgs.command = args.command;\n    }\n\
    \    var readyRes = callEpo('core.help',pArgs);\n    var md;\n    var line;\n\
    \    var cmd;\n    var desc;\n\n    if (args.command) {\n        md = '#### ePO\
    \ Help - ' + args.command + '\\n';\n        md += readyRes;\n    } else {\n  \
    \      parsedRes = Array.isArray(parsedRes) ? parsedRes : [parsedRes];\n     \
    \   md = '#### ePO Help\\n';\n        for (var i=0;i<parsedRes.length;i++) {\n\
    \            line = parsedRes[i];\n            line = line.replace(/(\\r\\n|\\\
    n|\\r)/gm,\" \");\n            if (!args.search || (args.search.toLowerCase()\
    \ && line.toLowerCase().indexOf(args.search.toLowerCase())>=0)) {\n          \
    \      desc = line.split('-')[1] ? line.split('-')[1].trim() : 'N/A';\n      \
    \          cmd = line.split('-')[0] ? line.split('-')[0].trim() : 'N/A';\n   \
    \             md += '- **' + cmd + \"** - \" + desc + '\\n';\n            }\n\
    \        }\n    }\n    return {\n        Type: entryTypes.note,\n        Contents:\
    \ readyRes,\n        ContentsFormat: formats.json,\n        HumanReadable: md\n\
    \    };\n}\n\nfunction epoGetLatestDatRaw() {\n    var url = \"http://update.nai.com/products/commonupdater/gdeltaavv.ini\"\
    \n    //Another option is to use avvdat.ini - provided here in case any additional\
    \ data from that file is needed in the future\n    //var url = \"http://update.nai.com/Products/CommonUpdater/avvdat.ini\"\
    \n    result = doRawHttp(\"GET\",url);\n    var res = '';\n    var sections =\
    \ result.Body.split('\\r\\n\\r\\n');\n    var lines = sections[0].split('\\r\\\
    n');\n    for (var i=0;i<lines.length;i++) {\n        if (lines[i].indexOf(\"\
    CurrentVersion\")===0){\n            return lines[i].split('=')[1];\n        }\n\
    \    }\n    throw 'Cannot get McAfee latest DAT file version';\n}\n\nfunction\
    \ epoGetLatestDat() {\n    var datVersion = epoGetLatestDatRaw();\n    var md='McAfee\
    \ Latest DAT file version is: **' + datVersion + '**\\n';\n    ec = {};\n    ec.mcafee\
    \ = {\"latestDAT\": datVersion};\n    return {\n        Type: entryTypes.note,\n\
    \        Contents: datVersion,\n        ContentsFormat: formats.json,\n      \
    \  HumanReadable: md,\n        EntryContext: {\n                \"mcafee(val.latestDAT\
    \ === obj.latestDAT)\": ec.mcafee, //backward compatability\n                \"\
    McAfee.ePO.latestDAT\": datVersion\n        }\n    };\n}\n\nfunction epoGetCurrentDat()\
    \ {\n    var pArgs = {\"searchText\":\"VSCANDAT1000\"};\n    var result = callEpo('repository.findPackages',\
    \ pArgs);\n    if (result && result.length>0) {\n        result = result[0];\n\
    \        var epoDAT = result.productDetectionProductVersion.split('.')[0];\n \
    \       ec = {};\n        ec.mcafee = {\"epoDAT\": epoDAT};\n        var md =\
    \ \"McAfee ePO Current DAT file version in repository is: **\" + epoDAT + '**\\\
    n';\n        return {\n            Type: entryTypes.note,\n            Contents:\
    \ result,\n            ContentsFormat: formats.json,\n            HumanReadable:\
    \ md,\n            EntryContext: {\n                \"mcafee(val.epoDAT==obj.epoDAT)\"\
    : ec.mcafee, //backward compatability\n                \"McAfee.ePO.epoDAT\":\
    \ epoDAT\n            }\n        };\n    } else {\n        throw 'Error getting\
    \ current DAT version. Please check that the DAT file exists. Response: ' + JSON.stringify(result);\n\
    \    }\n}\n\nfunction epoUpdateClientDatTask() {\n    var pArgs = {'searchText':\
    \ 'VSEContentUpdateDemisto'}; //need to configure this task in ePO beforehand\n\
    \    var result = callEpo('clienttask.find', pArgs);\n    if (result && Array.isArray(result))\
    \ {\n        result = result[0];\n    }\n    if (result) {\n          return result.objectId;\n\
    \        }\n         // If reached here then the response is an empty \"OK:\"\
    , which means VSEContentUpdateDemisto was not found in the server\n        throw\
    \ 'Error getting DAT update task. It seems the task \"VSEContentUpdateDemisto\"\
    \ is missing from the EPO server. Please contact support for more details';\n\
    }\n\nfunction epoUpdateClientDat() {\n    var clientTask = epoUpdateClientDatTask();\n\
    \    var pArgs = {'names':args.systems, 'productId':'EPOAGENTMETA', 'taskId':clientTask};\n\
    \n    var options = ['retryAttempts', 'retryIntervalInSeconds', 'abortAfterMinutes',\
    \ 'stopAfterMinutes', 'randomizationInterval'];\n    for (var i=0;i<options.length;i++)\
    \ {\n        if (args[options[i]]) {\n            pArgs[options[i]] = args[options[i]];\n\
    \        }\n    }\n    var result = callEpo('clienttask.run', pArgs);\n    var\
    \ md = \"ePO client DAT update task started: \" + result;\n    return {\n    \
    \    Type: entryTypes.note,\n        Contents: result,\n        ContentsFormat:\
    \ formats.json,\n        HumanReadable: md\n    };\n}\n\nfunction epoUpdateRepository()\
    \ {\n    var pArgs = {\n        'sourceRepository': 'McAfeeHttp',\n        'targetBranch':'Current'\n\
    \    };\n    var result = callEpo('repository.pull', pArgs);\n\n    var md = \"\
    ePO repository update started.\\n\";\n    md += result;\n    return {\n      \
    \  Type: entryTypes.note,\n        Contents: result,\n        ContentsFormat:\
    \ formats.json,\n        HumanReadable: md\n    };\n}\n\nfunction prettifySystemTree(SystemTree)\
    \ {\n    var prettySystemTree = [];\n    for (i=0; i < SystemTree.length; i++)\
    \ {\n        var system = SystemTree[i];\n        prettySystemTree[i] = {\n  \
    \          'groupId': system.groupId,\n            'groupPath': system.groupPath\n\
    \        };\n    }\n    return prettySystemTree;\n}\n\nfunction epoGetSystemTreeGroups()\
    \ {\n    var pArgs = {};\n    if (args.search) {\n        pArgs.searchText=args.search;\n\
    \    }\n    var result = callEpo('system.findGroups', pArgs);\n    if (result.length\
    \ === 0) {\n        return 'System Tree Group was not found.';\n    }\n    var\
    \ md = \"#### ePO System Tree groups\\n\";\n    md += \"Group ID | Group path\\\
    n-|-\\n\";\n    for (var i=0;i<result.length;i++) {\n        md += result[i].groupId\
    \ + \"|\" + result[i].groupPath + \"\\n\";\n    }\n    return {\n        Type:\
    \ entryTypes.note,\n        Contents: result,\n        ContentsFormat: formats.json,\n\
    \        HumanReadable: md,\n        EntryContext: {\n            \"McAfee.ePO(val.groupId==obj.groupId)\"\
    : {'SystemTreeGroups': prettifySystemTree(result)}\n        }\n    };\n}\n\nfunction\
    \ epoGetSystemGroupPath(groupId) {\n    var result = epoGetSystemTreeGroups();\n\
    \    result = result.Contents;\n    for (var i=0;i<result.length;i++) {\n    \
    \    if (groupId == result[i].groupId) {\n            return result[i].groupPath;\n\
    \        }\n    }\n    return null;\n}\n\nfunction prettifyFindSystem(FindSystem)\
    \ {\n    var prettyFindSystem = [];\n    for (i=0; i < FindSystem.length; i++)\
    \ {\n        var system = FindSystem[i];\n        prettyFindSystem[i] = {\n  \
    \          'Name': system['EPOComputerProperties.ComputerName'],\n           \
    \ 'Domain': system['EPOComputerProperties.DomainName'],\n            'Hostname':\
    \ system['EPOComputerProperties.IPHostName'],\n            'IPAddress': system['EPOComputerProperties.IPAddress'],\n\
    \            'OS': system['EPOComputerProperties.OSType'],\n            'OSVersion':\
    \ system['EPOComputerProperties.OSVersion'],\n            'Processor': system['EPOComputerProperties.CPUType'],\n\
    \            'Processors': system['EPOComputerProperties.NumOfCPU'],\n       \
    \     'Memory': system['EPOComputerProperties.TotalPhysicalMemory'],\n       \
    \ };\n    }\n    return prettyFindSystem;\n}\n\nfunction epoFindSystems() {\n\
    \    var name = epoGetSystemGroupPath(args.groupId);\n\n    if (!name) {\n   \
    \     throw 'System Tree group not found';\n    }\n    var pArgs = {'groupId':args.groupId};\n\
    \    var result = callEpo('epogroup.findSystems', pArgs);\n    if (result) {\n\
    \        var md = '#### Systems in '+name+'\\n';\n        if (result.length>0)\
    \ {\n            md += systemsToMd(result,args.verbose);\n        } else {\n \
    \           md += 'No systems found\\n';\n        }\n        return {\n      \
    \      Type: entryTypes.note,\n            Contents: result,\n            ContentsFormat:\
    \ formats.json,\n            HumanReadable: md,\n            EntryContext: {\n\
    \                'Endpoint(val.IPAddress==obj.IPAddress)': prettifyFindSystem(result),\n\
    \                'McAfee.ePO.Endpoint(val.IPAddress==obj.IPAddress)': prettifyFindSystem(result),\n\
    \            }\n        };\n    } else {\n        throw 'No systems found. Response:\
    \ ' + JSON.stringify(result);\n    }\n}\n\nfunction epoFindSystem() {\n    var\
    \ pArgs = {'searchText':args.searchText};\n    var result = callEpo('system.find',\
    \ pArgs);\n    if (result) {\n        var md = '#### Systems in the System Tree\\\
    n';\n        if (result.length>0) {\n            md += systemsToMd(result,args.verbose);\n\
    \        } else {\n            md += 'No systems found\\n';\n        }\n     \
    \   return {\n            Type: entryTypes.note,\n            Contents: result,\n\
    \            ContentsFormat: formats.json,\n            HumanReadable: md,\n \
    \           EntryContext: {\n                'Endpoint(val.IPAddress==obj.IPAddress)':\
    \ prettifyFindSystem(result),\n                'McAfee.ePO.Endpoint(val.IPAddress==obj.IPAddress)':\
    \ prettifyFindSystem(result),\n            }\n        };\n    } else {\n     \
    \   throw 'No systems found. Response: ' + JSON.stringify(result);\n    }\n}\n\
    \nfunction epoWakeupAgent() {\n    var pArgs = {'names':args.names};\n    var\
    \ result = callEpo('system.wakeupAgent', pArgs);\n\n    var md = \"ePO agent was\
    \ awaken.\\n\";\n    md += result;\n\n    return {\n        Type: entryTypes.note,\n\
    \        Contents: result,\n        ContentsFormat: formats.json,\n        HumanReadable:\
    \ md\n    };\n}\n\nfunction epoApplyTag() {\n    var pArgs = {\n        'names':\
    \ args.names,\n        'tagName': args.tagName\n    };\n    var result = callEpo('system.applyTag',\
    \ pArgs);\n\n    var md = \"ePO applied the tags on the hostnames successfully.\\\
    n\";\n\n    return {\n        Type: entryTypes.note,\n        Contents: result,\n\
    \        ContentsFormat: formats.json,\n        HumanReadable: md\n    };\n}\n\
    \nfunction epoClearTag() {\n    var pArgs = {\n        'names': args.names,\n\
    \        'tagName': args.tagName\n    };\n    var result = callEpo('system.clearTag',\
    \ pArgs);\n\n    var md = \"ePO cleared the tags from the hostnames successfully.\\\
    n\";\n\n    return {\n        Type: entryTypes.note,\n        Contents: result,\n\
    \        ContentsFormat: formats.json,\n        HumanReadable: md\n    };\n}\n\
    \nfunction epoGetTables() {\n    var result;\n    var pArgs = {};\n    if (args.table)\
    \ {\n        pArgs.table = args.table;\n    }\n\n    result = callEpo('core.listTables',\
    \ pArgs);\n\n    var md = tableToMarkdown(\n            'ePO tables:',\n     \
    \       Object.keys(result || {}).map(function (k) { return result[k]; }), //\
    \ object keys\n            args.headers && args.headers.split(',')\n        );\n\
    \n    return {\n        Type: entryTypes.note,\n        Contents: result,\n  \
    \      ContentsFormat: formats.json,\n        HumanReadable: md\n    };\n}\n\n\
    function epoQueryTable() {\n    var pArgs = {'target': args.target};\n    var\
    \ result;\n    var ec = {};\n    var ec_key = '';\n    if (args.select) {\n  \
    \      pArgs.select = args.select;\n    }\n    if (args.where) {\n        pArgs.where\
    \ = args.where;\n    }\n    if (args.order) {\n        pArgs.order = args.order;\n\
    \    }\n    if (args.group) {\n        pArgs.group = args.group;\n    }\n    if\
    \ (args.joinTables) {\n        pArgs.joinTables = args.joinTables;\n    }\n\n\
    \    result = callEpo('core.executeQuery', pArgs);\n\n    var md = tableToMarkdown(\n\
    \            'ePO Table Query:',\n            Object.keys(result || {}).map(function\
    \ (k) { return result[k]; }), // object keys\n            args.headers && args.headers.split(',')\n\
    \        );\n\n    if (args.query_name) {\n        ec_key = 'McAfee.ePO.Query.'\
    \ + args.query_name;\n    } else {\n        var ts = (new Date()).getTime() /\
    \ 1000;\n        ec_key = 'McAfee.ePO.Query.' + ts;\n    }\n    ec[ec_key] = result;\n\
    \n    return {\n        Type: entryTypes.note,\n        Contents: result,\n  \
    \      ContentsFormat: formats.json,\n        HumanReadable: md,\n        EntryContext:\
    \ ec\n    };\n}\n\nfunction epoGetVersion() {\n    var pArgs = {};\n    var result;\n\
    \n    result = callEpo('epo.getVersion', pArgs);\n\n    var md = \"### ePO version\
    \ is:\\n\" + result;\n    var ec = {\"McAfee.ePO.Version\": result};\n\n    return\
    \ {\n        Type: entryTypes.note,\n        Contents: result,\n        ContentsFormat:\
    \ formats.text,\n        HumanReadable: md,\n        EntryContext: ec\n    };\n\
    \n}\n\nfunction epoMoveSystem() {\n    var pArgs = {\n        'names': args.names,\n\
    \        'parentGroupId': args.parentGroupId\n    };\n\n    var result;\n    result\
    \ = callEpo('system.move', pArgs);\n\n    if (result === true) {\n        result\
    \ = 'System ' + args.names + ' moved successfully to GroupId ' + args.parentGroupId;\n\
    \        return {\n            Type: entryTypes.note,\n            Contents: result,\n\
    \            ContentsFormat: formats.text,\n            HumanReadable: result\n\
    \        };\n    } else {\n        result = 'System ' + args.names + ' failed\
    \ to move to GroupId ' + args.parentGroupId;\n        return {\n            Type:\
    \ entryTypes.error,\n            Contents: result,\n            ContentsFormat:\
    \ formats.text,\n            HumanReadable: result\n          };\n    }\n}\n\n\
    function parseCommandArgs(command, commandArgs) {\n    //commandArgs should be\
    \ in the format of:  keyName1:keyValue1, keyName2:KeyValue2\n    if (!commandArgs)\
    \ {\n        return null;\n    }\n    var commandArgsDict = {};\n    commandArgsDict.command\
    \ = command;\n    var commandArgsList = commandArgs.split(',');\n    var temp\
    \ = [];\n    for (i=0; i < commandArgsList.length; i++) {\n        //commandArgsVal\
    \ in commandArgsList:\n        temp = commandArgsList[i].split(':');\n       \
    \ commandArgsDict[temp[0]] = temp[1];\n    }\n    return commandArgsDict;\n}\n\
    \nfunction epoCommand(parsedArgs) {\n    if (parsedArgs) {\n        args = parsedArgs;\n\
    \    }\n    var pArgs = {};\n    for (var key in args) {\n        if (key != 'command'\
    \ && key != 'headers') {\n            pArgs[key] = args[key];\n        }\n   \
    \ }\n    var result = callEpo(args.command, pArgs);\n\n    var md;\n    var contents;\n\
    \    if (typeof result === 'string') {\n        md = \"#### ePO command *\" +\
    \ args.command + \"* results:\\n\" + result;\n        contents = {result: result};\n\
    \    } else {\n\n        md = tableToMarkdown(\n            'ePO command *' +\
    \ args.command + '* results:',\n            Object.keys(result || {}).map(function\
    \ (k) { return result[k]; }), // object keys\n            args.headers && args.headers.split(',')\n\
    \        );\n        contents = result;\n    }\n    return {\n        Type: entryTypes.note,\n\
    \        Contents: contents,\n        ContentsFormat: formats.json,\n        HumanReadable:\
    \ md\n    };\n}\n\nswitch (command) {\n    // This is the call made when pressing\
    \ the integration test button.\n    case 'test-module':\n        epoHelp();\n\
    \        return 'ok';\n\n    case 'epo-help':\n        return epoHelp();\n\n \
    \   case 'epo-get-latest-dat':\n        return epoGetLatestDat();\n\n    case\
    \ 'epo-get-current-dat':\n        return epoGetCurrentDat();\n\n    case 'epo-update-client-dat':\n\
    \        return epoUpdateClientDat();\n\n    case 'epo-update-repository':\n \
    \       return epoUpdateRepository();\n\n    case 'epo-get-system-tree-group':\n\
    \        return epoGetSystemTreeGroups();\n\n    case 'epo-find-systems':\n  \
    \      return epoFindSystems();\n\n    case 'epo-find-system':\n        return\
    \ epoFindSystem();\n\n    case 'epo-wakeup-agent':\n        return epoWakeupAgent();\n\
    \n    case 'epo-apply-tag':\n        return epoApplyTag();\n\n    case 'epo-clear-tag':\n\
    \        return epoClearTag();\n\n    case 'epo-get-tables':\n        return epoGetTables();\n\
    \n    case 'epo-query-table':\n        return epoQueryTable();\n\n    case 'epo-get-version':\n\
    \        return epoGetVersion();\n\n    case 'epo-move-system':\n        return\
    \ epoMoveSystem();\n\n\n    case 'epo-command':\n        if (!args.command) {\n\
    \            throw 'ePO error: command argument is missing';\n        }\n    \
    \    return epoCommand(undefined);\n\n    case 'epo-advanced-command':\n     \
    \   if (!args.command) {\n            throw 'ePO error: command argument is missing';\n\
    \        }\n        if (!args.commandArgs) {\n            throw 'ePO error: commandArgs\
    \ argument is missing';\n        }\n        var parsedArgs = parseCommandArgs(args.command,\
    \ args.commandArgs);\n        return epoCommand(parsedArgs);\n\n    default:\n\
    \        throw 'ePO Error: unknown command';\n}"
  type: javascript
tests:
- Test Playbook McAfee ePO
toversion: 4.1.9
