comment: 'Used by the server-side script "Autoruns".

  Uses d2 agent on endpoint to run SysInternals Autoruns.'
commonfields:
  id: D2Autoruns
  version: -1
dependson: {}
name: D2Autoruns
script: "//+Autoruns/autorunsc64.exe\n//+Autoruns/autorunsc.exe\ntry {\n  if (env.OS\
  \ !== 'windows') {\n    throw ('script can only run on Windows');\n  }\n\n  var\
  \ arch = wmi_query('select OSArchitecture from win32_operatingsystem')[0].OSArchitecture;\n\
  \n  var binary = 'autorunsc.exe';\n  if (arch === '64-bit') {\n    binary = 'autorunsc64.exe';\n\
  \  }\n\n  var output = execute(binary + ' -ct -h -s -t -accepteula');\n\n  if (output.Success)\
  \ {\n    pack(output.Stdout);\n  } else {\n    throw output.Stdout + '\\n' + output.Error;\n\
  \  }\n} catch (ex) {\n  pack('Execution failed: ' + ex);\n}\n"
scripttarget: 1
system: true
tags:
- agent
- endpoint
- forensics
timeout: 0s
toversion: 4.1.9
type: javascript
