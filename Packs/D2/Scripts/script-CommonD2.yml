comment: Common code that will be merged into each D2 agent script when it runs
commonfields:
  id: CommonD2
  version: -1
dependson: {}
name: CommonD2
script: "// Common functions script\n// =======================\n// This script will\
  \ be appended to each d2 agent script before being executed.\n// Place here all\
  \ common functions you'd like to share between d2 agent scripts.\n/**\n * Checks\
  \ if the given string represents a valid IPv4 address\n * @param {String} ip - the\
  \ string to check\n * @returns {Boolean} true if valid IPv4 address\n */\nfunction\
  \ isIp(ip) {\n  var d = ip.split('.'), i = d.length;\n  if (i !== 4) {\n    return\
  \ false;\n  }\n  var ok = true;\n  while (i-- && ok) {\n    ok = d[i].length !==\
  \ 0 && !isNaN(parseInt(d[i])) && d[i] > -1 && d[i] < 256;\n  }\n  return ok;\n}\n\
  /**\n * Execute a command and pack the standard output or throw the error\n * @param\
  \ {String} command - the command to execute on the OS\n * @returns {Void}\n */\n\
  function packOutput(command){\n  var output = execute(command);\n  if (output.Success)\
  \ {\n    pack(output.Stdout);\n  } else {\n    throw 'Errcode:' + output.Error +\
  \ '\\nStderr:' + output.Stderr + '\\nStdout: ' + output.Stdout;\n  }\n}"
scripttarget: 1
tags:
- infra
- agent
timeout: 0s
toversion: 4.1.9
type: javascript
