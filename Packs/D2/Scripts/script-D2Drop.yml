args:
- description: Full filesystem path and filename under which to save the file
  name: destpath
  required: true
- description: Source file name
  name: files
  required: true
- auto: PREDEFINED
  description: Overwrite file
  name: force
  predefined:
  - 'true'
  - 'false'
comment: 'Drop a file to a target system by providing its path on the server. Use
  CopyFileD2 instead in most cases.

  This is a utility agent script to be used inside server scripts. See CopyFileD2
  for an example.'
commonfields:
  id: D2Drop
  version: -1
enabled: true
name: D2Drop
runas: DBotWeakRole
runonce: false
script: "var tempDir = '';\nif( env.TEMP ) {\n    tempDir = env.TEMP;\n} else if (\
  \ env.TMPDIR ) {\n    tempDir = env.TMPDIR;\n} else if ( env.TMP) {\n    tempDir\
  \ = env.TMP;\n} else {\n    tempDir = '/tmp';\n}\n\nvar filesRes = files( tempDir,\
  \ true, false, args.files );\nif ( filesRes && filesRes.length > 0 ) {\n    if (\
  \ 1 != copy( filesRes[0].Path, args.destpath, args.force === 'true') )\n       \
  \ throw \"Error copying file \" + filesRes[0].Path + \" to \" + filesRes[0].destpath\
  \ + \".\";\n    else\n        pack(\"File copied successfully.\");\n} else {\n \
  \   pack(\"Failed to find temp file.\");\n}"
scripttarget: 1
system: true
tags:
- agent
- util
tests:
- No test - D2 tests are not supported yet in content tests
toversion: 4.1.9
type: javascript
