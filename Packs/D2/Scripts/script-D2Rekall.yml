args:
- default: true
  description: Path to the memory dump file in the machine's filesystem.
  name: file
  required: true
- description: Format argument for Rekall e.g. json or text.
  name: format
comment: Use the D2 agent to execute Rekall on a system (usually a forensics workstation)
  and analyze a memory dump file located on that system.
commonfields:
  id: D2Rekall
  version: -1
dependson: {}
name: D2Rekall
script: "if (args.format)\n    fmt = args.format;\nelse\n    fmt= \"text\";\nvar out\
  \ = execute('rekal --format ' + fmt + ' -f ' + args.file + ' ' + args.cmd, 60*60);\
  \ // 1 hour timeout\npack(out.Stdout);\nif( ! out.Success) {\n    pack('Exception\
  \ thrown: ' + out.Error + \"\\nStderr: \" + out.Stderr);\n}"
scripttarget: 1
system: true
tags:
- agent
- memory
- forensics
timeout: 0s
toversion: 4.1.9
type: javascript
