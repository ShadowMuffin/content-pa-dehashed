args:
- description: Name of the log to retrieve
  name: logName
  required: true
comment: Copy a log file. Works on Windows and Unix (differently - take a peek at
  the script itself to see how).
commonfields:
  id: D2GetSystemLog
  version: -1
dependson: {}
name: D2GetSystemLog
script: "function copyLogUnix() {\n  pack_file('/var/log/' + args.logName, args.logName);\n\
  }\nfunction copyLogWindows() {\n  var fileName = 'c:\\\\' + args.logName + '.log';\n\
  \  var output = execute('wevtutil epl ' + args.logName + ' ' + fileName);\n  if\
  \ (!output.Success) {\n    pack(output);\n    throw output.Error + ': ';\n  }\n\
  \  pack_file(fileName, args.logName);\n  del(fileName);\n}\ntry {\n  if (env.OS\
  \ === 'windows') {\n    copyLogWindows();\n  } else  {\n    copyLogUnix();\n  }\n\
  } catch (ex) {\n  pack('Error: ' + ex);\n}"
scripttarget: 1
system: true
tags:
- agent
- endpoint
timeout: 0s
toversion: 4.1.9
type: javascript
