comment: For phishing incidents, iterate on all attachments and run PE dump on each
commonfields:
  id: StaticAnalyze
  version: -1
dependson:
  must:
  - D2PEDump
name: StaticAnalyze
script: "var entries = executeCommand('getEntries', {});\nvar res = [];\nfor (var\
  \ i=0; i<entries.length; i++) {\n    if (entries[i].File) {\n        var fileName\
  \ = fileNameFromEntry(entries[i].ID);\n        var rep = executeCommand('D2PEDump',\
  \ {file: fileName, files: fileName, system: args.system});\n        Array.prototype.push.apply(res,\
  \ rep);\n    }\n}\nif (res.length > 0) {\n  return res;\n}\nreturn 'No files found';"
scripttarget: 0
system: true
tags:
- phishing
timeout: 0s
toversion: 4.1.9
type: javascript
