comment: Show running processes
commonfields:
  id: D2Processes
  version: -1
dependson: {}
name: D2Processes
script: "function processesUnix() {\n  var output = execute('ps ax');\n  if (output.Success)\
  \ {\n    pack(output.Stdout);\n  } else {\n    throw output.Error;\n  }\n}\nfunction\
  \ processesWindows() {\n  var ps = wmi_query('select ProcessId, CommandLine, ThreadCount,\
  \ WorkingSetSize, Description From Win32_Process');\n  pack(ps, 'table');\n}\ntry\
  \ {\n  if (env.OS === 'windows') {\n    processesWindows();\n  } else {\n    processesUnix();\n\
  \  }\n} catch (ex) {\n  pack('Error: ' + ex);\n}"
scripttarget: 1
system: true
tags:
- agent
- endpoint
timeout: 0s
toversion: 4.1.9
type: javascript
