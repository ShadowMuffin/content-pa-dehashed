args:
- description: Glob of directory name used for searching,e.g. Windows
  name: directoryPath
- description: Glob of file name used for searching, e.g. *exe
  name: fileName
- description: Glob of file size used for searching, e.g.10??
  name: fileSize
- description: Glob of file MD5 hash used for searching, e.g. 1c7b*
  name: fileMD5Hash
- description: Glob of file SHA1 hash used for searching, e.g. 1c7b*
  name: fileSHA1Hash
- description: Glob of file SHA256 hash used for searching, e.g. 1c7b*
  name: fileSHA256Hash
- description: Glob of a magic number used for searching, 4D54*
  name: magicNumber
- description: Maximum number of rows to return
  name: limit
- auto: PREDEFINED
  description: Type of filter to apply to the question results
  name: filter_type
  predefined:
  - less
  - notless
  - greater
  - notgreater
  - equal
  - notequal
  - contains
  - notcontains
  - startswith
  - endswith
  - notstartswith
  - doesnotendwith
  - regex
  - notregex
  required: true
- description: Value to filter results by
  name: filter_value
  required: true
- defaultValue: Computer Name
  description: Semicolon separated list of columns to return. E.g. "Computer Name;IP
    Address"
  name: sensors
comment: "Get the requested sensors from all machines where the Index Query File Details\
  \ match the given filter.\nE.g. !TaniumFilterQuestionByIndexQueryFileDetails sensors=\"\
  Computer Name\" filter_type=contains filter_value=Demisto limit=5 \nwill be translated\
  \ the following plain text Tanium question:\n\"Get Computer Name from all machines\
  \ with any Index Query File Details[*, *, *, *, *, *, *, 5] containing \"Demisto\"\
  \""
commonfields:
  id: TaniumFilterComputersByIndexQueryFileDetails
  version: -1
dependson:
  must:
  - tn-ask-manual-question
enabled: true
name: TaniumFilterComputersByIndexQueryFileDetails
outputs:
- contextPath: Tanium.QuestionResults.Computer Name
  description: Computer Name that contains the index query file details as specified
    by the filters
- contextPath: Tanium.QuestionResults.Count
  description: Number or results per computer name that match the filter
runonce: false
script: "dArgs = demisto.args()\nquestion_filters=\"Index Query File Details\"\n\n\
  sensors=dArgs.get(\"sensors\")\ndel dArgs['sensors']\n\nfilter_type = None\nfilter_value\
  \ = None\n\nif 'filter_type' in dArgs:\n    filter_type = dArgs.get('filter_type')\n\
  \    del dArgs['filter_type']\n\nif 'filter_value' in dArgs:\n    filter_value =\
  \ dArgs.get('filter_value')\n    del dArgs['filter_value']\n\nparams = []\nfor key\
  \ in dArgs:\n    params.append(key + \"=\" + dArgs[key])\n\nif len(params) > 0:\n\
  \    question_filters = question_filters + \"{\" + ','.join(params) + \"}\"\n\n\
  if filter_type is not None:\n    question_filters = question_filters + \",that \"\
  +filter_type+\":\"+filter_value\n\ndemisto.results(demisto.executeCommand('tn-ask-manual-question',\
  \ {'sensors':sensors, 'question_filters': question_filters}))\n"
scripttarget: 0
subtype: python2
tags:
- tanium
toversion: 4.1.9
type: python
