category: Endpoint
commonfields:
  id: GRR
  version: -1
configuration:
- defaultvalue: ''
  display: Server URL (e.g. https://192.168.0.1)
  name: server
  required: true
  type: 0
- defaultvalue: '8000'
  display: Port
  name: port
  required: false
  type: 0
- defaultvalue: ''
  display: Username
  name: credentials
  required: true
  type: 9
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Use GRR Rapid Response framework
display: GRR
image: data:image/png;base64,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
name: GRR
script:
  commands:
  - arguments:
    - default: true
      description: The ID of the client
      name: client_id
      required: true
    - description: JSON string of the flow to set
      name: flow
      required: true
    - description: The headers to show
      name: headers
    description: Starts a flow on a given client with given parameters
    important:
    - contextPath: Flow.ID
      description: The Flow ID
    name: grr-set-flows
    outputs:
    - contextPath: Flow
      description: A GRR Flow
    - contextPath: Flow.ID
      description: The GRR Flow ID
    - contextPath: Flow.Args
      description: The GRR Flow Args
    - contextPath: Flow.Creator
      description: The GRR Flow Creator
    - contextPath: Flow.LastActiveAt
      description: When Was the flow last active
    - contextPath: Flow.NestedFlow
      description: The GRR Flow Nested Flows
    - contextPath: Flow.StartedAt
      description: When was the flow started at
    - contextPath: Flow.State
      description: The GRR Flow State
  - arguments:
    - default: true
      description: The ID of the client
      name: client_id
      required: true
    - description: Starting offset
      name: offset
    - description: Max number of flows to fetch
      name: count
    - description: headers to show in output
      name: headers
    description: Lists flows launched on a given client
    important:
    - contextPath: Flow.ID
      description: The Flow ID
    name: grr-get-flows
    outputs:
    - contextPath: Flow
      description: A GRR Flow
    - contextPath: Flow.ID
      description: The GRR Flow ID
    - contextPath: Flow.Args
      description: The GRR Flow Args
    - contextPath: Flow.Creator
      description: The GRR Flow Creator
    - contextPath: Flow.LastActiveAt
      description: When Was the flow last active
    - contextPath: Flow.NestedFlow
      description: The GRR Flow Nested Flows
    - contextPath: Flow.StartedAt
      description: When was the flow started at
    - contextPath: Flow.State
      description: The GRR Flow State
  - arguments:
    - description: Target host, Can be FQDN or client ID
      name: hostname
    - description: Fetch this number of elements, an array of path strings
      name: paths
    - description: Maximum size of file we will download
      name: max_file_size
    - description: Action to apply to found files - STAT, HASH or DOWNLOAD
      name: action
    - description: Path type to glob in - UNSET, OS, TSK, REGISTRY, MEMORY, TMPFILE
      name: pathtype
    deprecated: true
    description: Downloads files from specified machine without requiring approval
    name: grr-get-files
  - arguments:
    - description: Starting offset
      name: offset
    - description: Max number of items to fetch
      name: count
    - description: 'Only return hunts created by a given user. If approved_by or/and
        description_contains are also supplied, then logical AND is applied to all
        the criterias. NOTE: this filter can only be used in conjunction with ''active_within''
        filter (to prevent queries of death)'
      name: created_by
    - description: 'Only return hunts where description contains given substring (matching
        is case-insensitive).If created_by or/and approved_by are also supplied, then
        logical AND is applied to all the criterias. NOTE: this filter can only be
        used in conjunction with ''active_within'' filter (to prevent queries of death)'
      name: description_contains
    - description: Only return hunts that were active within given time duration
      name: active_within
    - description: headers to show in output
      name: headers
    description: Renders list of available hunts
    important:
    - contextPath: Hunt.ID
      description: The Hunt ID
    name: grr-get-hunts
    outputs:
    - contextPath: Hunt
      description: A GRR Hunt
    - contextPath: Hunt.ID
      description: The GRR Hunt ID
    - contextPath: Hunt.Creator
      description: The GRR Hunt Creator
    - contextPath: Hunt.Description
      description: The GRR Hunt Description
    - contextPath: Hunt.Created
      description: The time the GRR Hunt was created
    - contextPath: Hunt.Expires
      description: The time the GRR Hunt expires
    - contextPath: Hunt.IsRobot
      description: Is the Hunt originated from a robot
    - contextPath: Hunt.Name
      description: The GRR Hunt Name
    - contextPath: Hunt.State
      description: The GRR Hunt State
  - arguments:
    - default: true
      description: Hunt id
      name: hunt_id
      required: true
    - description: headers to show in output
      name: headers
    description: Renders hunt's summary
    important:
    - contextPath: Hunt.ID
      description: The Hunt ID
    name: grr-get-hunt
    outputs:
    - contextPath: Hunt
      description: A GRR Hunt
    - contextPath: Hunt.ID
      description: The GRR Hunt ID
    - contextPath: Hunt.Creator
      description: The GRR Hunt Creator
    - contextPath: Hunt.Description
      description: The GRR Hunt Description
    - contextPath: Hunt.Created
      description: The time the GRR Hunt was created
    - contextPath: Hunt.Expires
      description: The time the GRR Hunt expires
    - contextPath: Hunt.IsRobot
      description: Is the Hunt originated from a robot
    - contextPath: Hunt.Name
      description: The GRR Hunt Name
    - contextPath: Hunt.State
      description: The GRR Hunt State
  - arguments:
    - description: Hunt runner arguments
      name: hunt_runner_args
    - description: Hunt arguments
      name: hunt_args
    - description: The headers to show
      name: headers
    description: Handles hunt creation request
    name: grr-set-hunts
  - arguments:
    - description: 'Search query string. See here for syntax: https://github.com/google/grr-doc/blob/master/user_manual.adoc#searching-for-a-client '
      name: query
    - description: 'Found clients starting offset. '
      name: offset
    - description: 'Number of found client to fetch. '
      name: count
    - description: headers to show in output
      name: headers
    description: 'Renders results of a client search. '
    important:
    - contextPath: Client.ID
      description: The Client ID
    name: grr-get-clients
    outputs:
    - contextPath: Client
      description: A GRR Client
    - contextPath: Client.ID
      description: The GRR Client ID
    - contextPath: Client.LastBootedAt
      description: The GRR Client LastBootedAt time
    - contextPath: Client.FirstSeenAt
      description: The GRR Client FirstSeenAt time
    - contextPath: Client.LatClock
      description: The GRR Client LastClock
    - contextPath: Client.LastCrashAt
      description: The GRR Client LastCrashAt time
    - contextPath: Client.AgentInfo
      description: The GRR Client AgentInfo
    - contextPath: Client.HardwareInfo
      description: The GRR Client HardwareInfo
    - contextPath: Client.Interfaces
      description: The GRR Client Interfaces
    - contextPath: Client.Labels
      description: The GRR Client Labels
    - contextPath: Client.OS
      description: The GRR Client OS details
    - contextPath: Client.User
      description: The GRR Client User
    - contextPath: Client.Volumes
      description: The GRR Client Volumes
  - arguments:
    - default: true
      description: The ID of the client
      name: client_id
      required: true
    - description: JSON string of the flow to set
      name: flow
      required: true
    deprecated: true
    description: Starts a flow on a given client with given parameters
    name: grr_set_flows
  - arguments:
    - default: true
      description: The ID of the client
      name: client_id
      required: true
    - description: Starting offset
      name: offset
    - description: Max number of flows to fetch
      name: count
    deprecated: true
    description: Lists flows launched on a given client
    name: grr_get_flows
  - arguments:
    - description: Target host, Can be FQDN or client ID
      name: hostname
    - description: Fetch this number of elements, an array of path strings
      name: paths
    - description: Maximum size of file we will download
      name: max_file_size
    - description: Action to apply to found files - STAT, HASH or DOWNLOAD
      name: action
    - description: Path type to glob in - UNSET, OS, TSK, REGISTRY, MEMORY, TMPFILE
      name: pathtype
    description: Downloads files from specified machine without requiring approval
    name: grr_get_files
  - arguments:
    - description: Starting offset
      name: offset
    - description: Max number of items to fetch
      name: count
    - description: 'Only return hunts created by a given user. If approved_by or/and
        description_contains are also supplied, then logical AND is applied to all
        the criterias. NOTE: this filter can only be used in conjunction with ''active_within''
        filter (to prevent queries of death)'
      name: created_by
    - description: 'Only return hunts where description contains given substring (matching
        is case-insensitive).If created_by or/and approved_by are also supplied, then
        logical AND is applied to all the criterias. NOTE: this filter can only be
        used in conjunction with ''active_within'' filter (to prevent queries of death)'
      name: description_contains
    - description: Only return hunts that were active within given time duration
      name: active_within
    description: Renders list of available hunts
    name: grr_get_hunts
  - arguments:
    - default: true
      description: Hunt id
      name: hunt_id
      required: true
    description: Renders hunt's summary
    name: grr_get_hunt
  - arguments:
    - description: Hunt runner arguments
      name: hunt_runner_args
    - description: Hunt arguments
      name: hunt_args
    description: Handles hunt creation request
    name: grr_set_hunts
  script: "var username = params.credentials.identifier;\nvar password = params.credentials.password;\n\
    var server = params.server + ':' + params.port;\nvar insecure = params.insecure;\n\
    var proxy = params.proxy;\n\nvar getCSRFToken = function(url) {\n    var res =\
    \ http(\n            url,\n            {\n                Method: 'GET',\n   \
    \             Username: username,\n                Password: password\n      \
    \      },\n            insecure,\n            proxy\n        );\n    if (res.StatusCode\
    \ < 200 || res.StatusCode >= 300) {\n        throw 'Failed to get CSRF token,\
    \ request status code: ' + res.StatusCode + ' and Body: ' + res.Body + '.';\n\
    \    }\n\n    for (var ix in res.Cookies) {\n        if (res.Cookies[ix].Name.toLowerCase()\
    \ === 'csrftoken') {\n            return res.Cookies[ix].Value;\n        }\n \
    \   }\n    return 'Failed to get CSRF token, Please verify credentials and check\
    \ GRR logs.';\n}\n\nvar sendRequest = function(method, url, queryName, body) {\n\
    \    var csrfToken = getCSRFToken(url);\n    var res = http(\n            url,\n\
    \            {\n                Method: method,\n                Username: username,\n\
    \                Password: password,\n                Body: body,\n          \
    \      Headers: {'X-CSRFToken': [csrfToken]},\n                Cookies: [{Name:\
    \ 'csrftoken', Value: csrfToken, Path: '/', MaxAge: 300}]\n            },\n  \
    \          insecure,\n            proxy\n        );\n    if (res.StatusCode <\
    \ 200 || res.StatusCode >= 300) {\n        throw 'Failed to ' + (queryName ||\
    \ 'get main page') + ', request status code: ' + res.StatusCode + ' and Body:\
    \ ' + res.Body + '.';\n    }\n    return res.Body;\n}\n\nvar parseJSON = function(raw){\n\
    \    var output = null;\n    var innerParse = function(i){\n        var att =\
    \ null;\n        if(typeof i === 'object' && 'value' in i){\n            if (typeof\
    \ i.value === 'object'){\n                i = JSON.parse(JSON.stringify(i.value));\n\
    \            }else {\n                i = i.value;\n            }\n        }\n\
    \n        if(typeof i === 'object'){\n            att = {};\n            for (var\
    \ k in i){\n                if (k == \"urn\"){\n                    if(typeof\
    \ i[k] === 'object' && 'value' in i[k]){\n                        if (typeof i[k].value\
    \ === 'object'){\n                            i[k] = JSON.parse(JSON.stringify(i[k].value));\n\
    \                        }else {\n                            i[k] = i[k].value;\n\
    \                        }\n                    }\n                    if(typeof\
    \ i[k] === 'string'){\n                        var urn = i[k].split('/');\n  \
    \                      if (urn.length > 0){\n                            att.id\
    \ = urn[urn.length - 1];\n                        }\n                    }\n \
    \               }\n                if (typeof i[k] === 'object'){\n          \
    \          att[k] = parseJSON(i[k]);\n                } else {\n             \
    \       att[k] = i[k];\n                }\n            }\n        }\n        else{\n\
    \            att = i;\n        }\n        return att;\n    }\n\n    if(raw instanceof\
    \ Array){\n        output = [];\n        raw.forEach(function(row){\n        \
    \    output.push(innerParse(row))\n        })\n    } else {\n        output =\
    \ innerParse(raw);\n    }\n\n    return output;\n}\nvar getHunts = function(method,\
    \ url, queryName, body, jsonPath, title) {\n    var raw = JSON.parse(sendRequest(method,\
    \ url, queryName, body).slice(5));\n    var output = parseJSON(jsonPath ? dq(raw,jsonPath)\
    \ : raw);\n\n    if(!(output instanceof Array )){\n        output = [output];\n\
    \    }\n\n    var context = { Hunt : [] };\n    output.forEach(function(i){\n\
    \        var huntEntity = {\n            ID : i.id,\n            Created : i.created,\n\
    \            Creator : i.creator,\n            Description : i.description,\n\
    \            Expires : i.expires,\n            IsRobot : i.is_robot,\n       \
    \     Name: i.name,\n            State: i.state\n        };\n\n        context.Hunt.push(huntEntity);\n\
    \    });\n\n    return {\n          Type: entryTypes.note,\n          Contents:\
    \ raw,\n          ContentsFormat: formats.json,\n          HumanReadable: tblToMd(title,output,argToList(args.headers)),\n\
    \          EntryContext: context\n      };\n};\n\nvar getHunt = function(method,\
    \ url, queryName, body, jsonPath, title) {\n    var raw = JSON.parse(sendRequest(method,\
    \ url, queryName, body).slice(5));\n    var output = parseJSON(jsonPath ? dq(raw,jsonPath)\
    \ : raw);\n\n    if(!(output instanceof Array )){\n        output = [output];\n\
    \    }\n\n    var context = { Hunt : [] };\n    output.forEach(function(i){\n\
    \        var huntEntity = {\n            ID : i.id,\n            Created : i.created,\n\
    \            Creator : i.creator,\n            Description : i.description,\n\
    \            Expires : i.expires,\n            IsRobot : i.is_robot,\n       \
    \     Name: i.name,\n            State: i.state\n        };\n\n        context.Hunt.push(huntEntity);\n\
    \    });\n\n    return {\n          Type: entryTypes.note,\n          Contents:\
    \ raw,\n          ContentsFormat: formats.json,\n          HumanReadable: tblToMd(title,output,argToList(args.headers)),\n\
    \          EntryContext: context\n      };\n};\n\nvar getFlows = function(method,\
    \ url, queryName, body, jsonPath, title) {\n    var raw = JSON.parse(sendRequest(method,\
    \ url, queryName, body).slice(5));\n    var output = parseJSON(jsonPath ? dq(raw,jsonPath)\
    \ : raw);\n    if(!(output instanceof Array )){\n        output = [output];\n\
    \    }\n\n    var context = { Flow : [] };\n\n    output.forEach(function(i){\n\
    \        var flowEntity = {\n            ID : i.id,\n            Created : i.created,\n\
    \            Creator : i.creator,\n            Description : i.description,\n\
    \            Expires : i.expires,\n            IsRobot : i.is_robot,\n       \
    \     Name: i.name,\n            State: i.state,\n            Args : i.args,\n\
    \            LastActiveAt : i.last_active_at,\n            NestedFlow : (i.nested_flows\
    \ && typeof i === 'object' ? i.nested_flows.map(function(a) {return a.id}) : i.nested_flows),\
    \ //i.nested_flows.map(function(a) {return a.id}),\n            StartedAt : i.started_at\n\
    \        };\n\n        context.Flow.push(flowEntity);\n    });\n\n    return {\n\
    \          Type: entryTypes.note,\n          Contents: raw,\n          ContentsFormat:\
    \ formats.json,\n          HumanReadable: tblToMd(title,output,argToList(args.headers)),\n\
    \          EntryContext: context\n      };\n};\n\nvar getClients = function(method,\
    \ url, queryName, body, jsonPath, title) {\n    var raw = JSON.parse(sendRequest(method,\
    \ url, queryName, body).slice(5));\n    var output = parseJSON(jsonPath ? dq(raw,jsonPath)\
    \ : raw);\n    if(!(output instanceof Array )){\n        output = [output];\n\
    \    }\n\n    var context = { Client : [] };\n\n    output.forEach(function(i){\n\
    \        var clientEntity = {\n            FirstSeenAt : i.first_seen_at,\n  \
    \          ID : i.id,\n            LastBootedAt : i.last_booted_at,\n        \
    \    LastClock : i.last_clock,\n            LastCrashAt : i.last_crash_at,\n \
    \           LastSeenAt : i.last_seen_at,\n            AgentInfo : i.agent_info,\n\
    \            HardwareInfo : i.hardware_info,\n            Interfaces : i.interfaces,\n\
    \            Labels : i.labels,\n            OS : i.os_info,\n            User\
    \ : i.users,\n            Volumes : i.volumes\n        };\n\n        context.Client.push(clientEntity);\n\
    \    });\n\n    return {\n          Type: entryTypes.note,\n          Contents:\
    \ raw,\n          ContentsFormat: formats.json,\n          HumanReadable: tblToMd(title,output,argToList(args.headers)),\n\
    \          EntryContext: context\n      };\n};\n\nvar sendRequestAndParse = function(method,\
    \ url, queryName, body) {\n    return JSON.parse(sendRequest(method, url, queryName,\
    \ body).slice(5));\n};\n\nswitch (command) {\n    case 'test-module':\n      \
    \  return sendRequest('GET', server) ? 'ok' : 'No body in response';\n    case\
    \ 'grr-set-flows':\n    case 'grr_set_flows'://deprecated\n        return getFlows('POST',\
    \ server + '/api/clients/' + args.client_id + '/flows', 'post flow', '{\"flow\"\
    : ' + args.flow + '}',null,\"Set Flow\");\n    case 'grr-get-files': \n    case\
    \ 'grr_get_files'://deprecated\n        var pathsArr;\n        try {\n       \
    \     pathsArr = JSON.parse(args.paths);\n        } catch (e) {\n            logDebug('input\
    \ is not a valid JSON trying to split');\n            pathsArr = args.paths ?\
    \ args.paths.split(\",\") : [];\n        }\n        args.paths = pathsArr;\n \
    \       return sendRequestAndParse('POST', server + '/api/robot-actions/get-files',\
    \ 'post get-files', JSON.stringify(args));\n    case 'grr-get-hunts':\n    case\
    \ 'grr_get_hunts'://deprecated\n        return getHunts('GET', server + '/api/hunts'\
    \ + encodeToURLQuery(args), 'get hunts',null,\"items\",'Hunts');\n    case 'grr-get-hunt':\n\
    \    case 'grr_get_hunt'://deprecated\n        return getHunt('GET', server +\
    \ '/api/hunts/' + args.hunt_id, 'get hunt',null,\"\",\"Hunt {0}\".format(args.hunt_id));\n\
    \    case 'grr-set-hunts':\n    case 'grr_set_hunts'://deprecated\n        return\
    \ getHunts('POST', server + '/api/hunts', 'set hunts', JSON.stringify(args),null,null,\"\
    Set Hunt\");\n    case 'grr-get-clients':\n        return getClients('GET',server\
    \ + '/api/clients' + encodeToURLQuery(args), 'get client',null,\"items\",\"Clients\"\
    );\n    case 'grr-get-flows':\n    case 'grr_get_flows'://deprecated\n       \
    \ var urlArgs = {};\n        if (args.count) {\n            urlArgs.count = args.count;\n\
    \        }\n        if (args.offset) {\n            urlArgs.offset = args.offset;\n\
    \        }\n        return getFlows('GET', server + '/api/clients/' + args.client_id\
    \ + '/flows' + encodeToURLQuery(urlArgs), 'get flow',null,\"items\",\"Flows\"\
    );\n}"
  type: javascript
system: true
toversion: 4.1.9
