description: Checking OpenPhish integration by running it on both known phishing and
  a safe URL and checking the results
id: OpenPhish Test Playbook
inputs:
- description: ''
  key: Malicious URL
  playbookInputQuery: null
  required: false
  value:
    simple: http://www.santoguia.net/sew/html/
- description: ''
  key: Non malicious URL
  playbookInputQuery: null
  required: false
  value:
    simple: http://google.com
name: OpenPhish Test Playbook
outputs: []
starttaskid: '0'
tasks:
  '0':
    id: '0'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '10'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: d7a31bf3-42c5-4ef4-8979-805d69aad515
      iscommand: false
      name: ''
      version: -1
    taskid: d7a31bf3-42c5-4ef4-8979-805d69aad515
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 65\n  }\n}"
  '10':
    id: '10'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '2'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: OpenPhish
      description: Show OpenPhish database status
      id: 3c42ee0e-5dcd-49c2-8469-27225beacefc
      iscommand: true
      name: Check OpenPhish status
      script: OpenPhish|||openphish-status
      type: regular
      version: -1
    taskid: 3c42ee0e-5dcd-49c2-8469-27225beacefc
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 225\n  }\n}"
  '2':
    id: '2'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '3'
    note: false
    quietmode: 0
    scriptarguments:
      url:
        simple: ${inputs.Non malicious URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: OpenPhish
      id: 80d1e291-1978-43b2-8917-9813d01cd792
      iscommand: true
      name: Check non-malicious URL
      script: OpenPhish|||url
      type: regular
      version: -1
    taskid: 80d1e291-1978-43b2-8917-9813d01cd792
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 400\n  }\n}"
  '3':
    id: '3'
    ignoreworker: false
    nexttasks:
      'no':
      - '4'
      'yes':
      - '5'
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${URL.Data}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 5b37df0e-683b-4b73-8645-4125dafc6766
      iscommand: false
      name: Check if found malicious
      scriptName: Exists
      type: condition
      version: -1
    taskid: 5b37df0e-683b-4b73-8645-4125dafc6766
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 575\n  }\n}"
  '4':
    id: '4'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '7'
    note: false
    quietmode: 0
    scriptarguments:
      url:
        simple: ${inputs.Malicious URL}
    separatecontext: false
    skipunavailable: false
    task:
      brand: OpenPhish
      id: 7db53265-2562-49c3-8a7c-39f873426169
      iscommand: true
      name: Check malicious URL
      script: OpenPhish|||url
      type: regular
      version: -1
    taskid: 7db53265-2562-49c3-8a7c-39f873426169
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 750\n  }\n}"
  '5':
    id: '5'
    ignoreworker: false
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: False Positive - found non-malicious URL as malicious
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: c5b88e7a-9e3b-4431-8c64-8b5f6ea27c5c
      iscommand: false
      name: False Positive
      scriptName: Print
      type: regular
      version: -1
    taskid: c5b88e7a-9e3b-4431-8c64-8b5f6ea27c5c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 750\n  }\n}"
  '6':
    id: '6'
    ignoreworker: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: c25e6c71-5851-4335-88b5-b557b9e33e12
      iscommand: false
      name: Manual troubleshooting needed
      type: regular
      version: -1
    taskid: c25e6c71-5851-4335-88b5-b557b9e33e12
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 695,\n    \"y\": 50\n  }\n}"
  '7':
    id: '7'
    ignoreworker: false
    nexttasks:
      'no':
      - '9'
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: ${URL.Data}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 6576b7f6-bf3b-488b-83c5-b318db6cdbcb
      iscommand: false
      name: Check if found malicious
      scriptName: Exists
      type: condition
      version: -1
    taskid: 6576b7f6-bf3b-488b-83c5-b318db6cdbcb
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 925\n  }\n}"
  '9':
    id: '9'
    ignoreworker: false
    note: false
    quietmode: 0
    scriptarguments:
      value:
        simple: Did not find malicious URL
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 0ec8f008-7c74-42b6-89ff-34cb555840cb
      iscommand: false
      name: False Negative
      scriptName: Print
      type: regular
      version: -1
    taskid: 0ec8f008-7c74-42b6-89ff-34cb555840cb
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1100\n  }\n}"
toversion: 4.1.9
version: -1
view: "{\n  \"linkLabelsPosition\": {},\n  \"paper\": {\n    \"dimensions\": {\n \
  \     \"height\": 1145,\n      \"width\": 1025,\n      \"x\": 50,\n      \"y\":\
  \ 50\n    }\n  }\n}"
