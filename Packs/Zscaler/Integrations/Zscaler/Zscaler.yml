category: Network Security
commonfields:
  id: Zscaler
  version: -1
configuration:
- defaultvalue: ''
  display: Cloud Name (i.e. https://admin.zscalertwo.net)
  name: cloud
  required: true
  type: 0
- defaultvalue: ''
  display: Credentials
  name: credentials
  required: true
  type: 9
- defaultvalue: ''
  display: API Key
  name: key
  required: true
  type: 4
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Zscaler is a cloud security solution built for performance and flexible
  scalability.
display: Zscaler
name: Zscaler
script:
  commands:
  - arguments:
    - default: true
      description: 'URL to be blacklisted. Should be comma separated (i.e. snapchat.com,tinder.com) '
      name: url
      required: true
    description: Adds URL to the blacklist.
    execution: true
    name: zscaler-blacklist-url
  - arguments:
    - default: true
      description: URL to search for
      name: url
      required: false
    - auto: PREDEFINED
      default: true
      defaultValue: 'true'
      description: Whether multiple URLs are being submitted. If "true", the value
        entered for the "url" command argument is interpreted as a CSV list of URLs.
        If you want to submit a URL that has commas in it, you can set this value
        to "false" and enter the singular URL for the value of the "url" command argument.
      name: multiple
      predefined:
      - 'true'
      - 'false'
    description: Look up the categorization of the given set of URLs, e.g., abc.com,xyz.com.
      Up to 100 URLs can be looked up per request, and a URL cannot exceed 1024 characters.
    name: url
    outputs:
    - contextPath: URL.Data
      description: The URL that was searched
      type: string
    - contextPath: URL.Address
      description: The URL that was searched
      type: string
    - contextPath: URL.urlClassifications
      description: The classification of the URL
      type: string
    - contextPath: URL.urlClassificationsWithSecurityAlert
      description: Classifications with security alert of the URL
      type: string
    - contextPath: URL.Malicious.Vendor
      description: For malicious URLs, the vendor that made the decision
      type: string
    - contextPath: URL.Malicious.Description
      description: For malicious URLs, the reason for the vendor to make the decision
      type: string
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    - contextPath: DBotScore.Score
      description: The actual score.
      type: number
  - arguments:
    - default: true
      description: IP address to search for
      name: ip
      required: false
    description: Look up the categorization of the given set of IP addresses, e.g.,
      8.8.8.8,1.2.3.4. Up to 100 URLs can be looked up per request, and a IP cannot
      exceed 1024 characters.
    name: ip
    outputs:
    - contextPath: IP.Address
      description: The IP address that was searched
      type: string
    - contextPath: IP.ipClassifications
      description: The classification of the IP address
      type: string
    - contextPath: IP.iplClassificationsWithSecurityAlert
      description: Classifications with security alert of the IP address
      type: string
    - contextPath: IP.Malicious.Vendor
      description: For malicious IP addresses, the vendor that made the decision
      type: string
    - contextPath: IP.Malicious.Description
      description: For malicious IP addresses, the reason for the vendor to make the
        decision
      type: string
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested.
      type: string
    - contextPath: DBotScore.Type
      description: The indicator type.
      type: string
    - contextPath: DBotScore.Vendor
      description: The vendor used to calculate the score.
      type: string
    - contextPath: DBotScore.Score
      description: The actual score.
      type: number
  - arguments:
    - default: true
      description: 'URL to be  removed from blacklist. Should be comma separated (i.e.
        snapchat.com,tinder.com) '
      name: url
      required: true
    description: Removes URL from the blacklist.
    execution: true
    name: zscaler-undo-blacklist-url
  - arguments:
    - default: true
      description: 'URL to be whitelisted. Should be comma separated (i.e. snapchat.com,tinder.com) '
      name: url
      required: true
    description: Adds URL to the whitelist.
    execution: true
    name: zscaler-whitelist-url
  - arguments:
    - default: true
      description: 'URL to be  removed from whitelist. Should be comma separated (i.e.
        snapchat.com,tinder.com) '
      name: url
      required: true
    description: Removes URL from the whitelist.
    execution: true
    name: zscaler-undo-whitelist-url
  - arguments:
    - default: true
      description: 'IP address to be  removed from whitelist. Should be comma separated
        (i.e. 8.8.8.8,1.2.3.4) '
      name: ip
      required: true
    description: Removes IP from the whitelist.
    execution: true
    name: zscaler-undo-whitelist-ip
  - arguments:
    - default: true
      description: 'IP address to be whitelisted. Should be comma separated (i.e.
        8.8.8.8,1.2.3.4) '
      name: ip
      required: true
    description: Adds IP address to the whitelist.
    execution: true
    name: zscaler-whitelist-ip
  - arguments:
    - default: true
      description: 'IP address to be  removed from blacklist. Should be comma separated
        (i.e. 8.8.8.8,1.2.3.4) '
      name: ip
      required: true
    description: Removes IP address from the blacklist.
    name: zscaler-undo-blacklist-ip
  - arguments:
    - default: true
      description: 'IP address to be blacklisted. Should be comma separated (i.e.
        8.8.8.8,1.2.3.4) '
      name: ip
      required: true
    description: Adds IP address to the blacklist.
    execution: true
    name: zscaler-blacklist-ip
  - arguments:
    - description: Category ID to add URL to, e.g. RADIO_STATIONS (Could be retreived
        by running the command zscaler-get-categories)
      name: category-id
      required: true
    - description: URL address to add. Comma separated values supported, e.g. pandora.com,spotify.com
      isArray: true
      name: url
      required: true
    description: Adds URL address to given category
    name: zscaler-category-add-url
    outputs:
    - contextPath: Zscaler.Category.CustomCategory
      description: True if category is custom, else false.
      type: boolean
    - contextPath: Zscaler.Category.Description
      description: Category description
      type: string
    - contextPath: Zscaler.Category.ID
      description: Category ID
      type: string
    - contextPath: Zscaler.Category.URL
      description: List of category URL addresses
      type: string
  - arguments:
    - description: Category ID to add URL to, e.g. RADIO_STATIONS (Could be retreived
        by running the command zscaler-get-categories)
      name: category-id
      required: true
    - description: IP address to add. Comma separated values supported, e.g. 1.2.3.4,8.8.8.8
      isArray: true
      name: ip
      required: true
    description: Adds IP address to given category
    name: zscaler-category-add-ip
    outputs:
    - contextPath: Zscaler.Category.CustomCategory
      description: True if category is custom, else false.
      type: boolean
    - contextPath: Zscaler.Category.Description
      description: Category description
      type: string
    - contextPath: Zscaler.Category.ID
      description: Category ID
      type: string
    - contextPath: Zscaler.Category.URL
      description: List of category URL addresses
      type: string
  - arguments:
    - description: Category ID to remove URL from, e.g. RADIO_STATIONS (Could be retreived
        by running the command zscaler-get-categories)
      name: category-id
      required: true
    - description: URL address to remove. Comma separated values supported, e.g. pandora.com,spotify.com
      name: url
      required: true
    description: Removes URL address to given category
    name: zscaler-category-remove-url
    outputs:
    - contextPath: Zscaler.Category.CustomCategory
      description: True if category is custom, else false.
      type: boolean
    - contextPath: Zscaler.Category.Description
      description: Category description
      type: string
    - contextPath: Zscaler.Category.ID
      description: Category ID
      type: string
    - contextPath: Zscaler.Category.URL
      description: List of category URL addresses
      type: string
  - arguments:
    - description: Category ID to remove IP from, e.g. RADIO_STATIONS (Could be retreived
        by running the command zscaler-get-categories)
      name: category-id
      required: true
    - description: IP address to remove. Comma separated values supported, e.g. 1.2.3.4,8.8.8.8
      name: ip
      required: true
    description: Removes IP address to given category
    name: zscaler-category-remove-ip
    outputs:
    - contextPath: Zscaler.Category.CustomCategory
      description: True if category is custom, else false.
      type: boolean
    - contextPath: Zscaler.Category.Description
      description: Category description
      type: string
    - contextPath: Zscaler.Category.ID
      description: Category ID
      type: string
    - contextPath: Zscaler.Category.URL
      description: List of category URL addresses
      type: string
  - arguments:
    - auto: PREDEFINED
      defaultValue: 'false'
      description: True to display URLs of each category in the war room, else false.
      name: displayURL
      predefined:
      - 'true'
      - 'false'
    description: Returns a list of all categories
    name: zscaler-get-categories
    outputs:
    - contextPath: Zscaler.Category.ID
      description: Category ID
      type: string
    - contextPath: Zscaler.Category.CustomCategory
      description: True if category is custom, else false.
      type: boolean
    - contextPath: Zscaler.Category.URL
      description: List of category URL addresses
      type: string
    - contextPath: Zscaler.Category.Description
      description: Category description
      type: string
    - contextPath: Zscaler.Category.Name
      description: Category name
      type: string
  - arguments: []
    description: Returns Zscaler default blacklist
    name: zscaler-get-blacklist
    outputs:
    - contextPath: Zscaler.Blacklist
      description: Zscaler blacklist
      type: string
  - arguments: []
    description: Returns Zscaler default whitelist
    name: zscaler-get-whitelist
    outputs:
    - contextPath: Zscaler.Whitelist
      description: Zsclaer whitelist
      type: string
  - arguments:
    - description: MD5 hash of a file
      name: md5
      required: true
    - auto: PREDEFINED
      defaultValue: full
      description: Type of report, full or summary.
      name: details
      predefined:
      - full
      - summary
    description: Get a full or summary detail report for an MD5 hash of a file that
      was analyzed by Sandbox.
    name: zscaler-sandbox-report
    outputs:
    - contextPath: File.MD5
      description: File MD-5
      type: string
    - contextPath: File.Malicious.Vendor
      description: For malicious files, the vendor that made the decision
      type: string
    - contextPath: File.Malicious.Description
      description: For malicious files, the reason that the vendor made the decision
      type: string
    - contextPath: File.DetectedMalware
      description: Detected Malware
      type: string
    - contextPath: File.FileType
      description: File Type
      type: string
    - contextPath: DBotScore.Indicator
      description: The indicator that was tested
      type: string
    - contextPath: DBotScore.Type
      description: Indicator type
      type: string
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
      type: string
    - contextPath: DBotScore.Score
      description: The actual score
      type: number
  runonce: false
  script: ''
  subtype: python2
  type: python
tests:
- Zscaler Test
toversion: 4.1.9
