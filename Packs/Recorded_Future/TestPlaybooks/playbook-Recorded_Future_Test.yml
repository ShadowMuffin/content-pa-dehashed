fromversion: 4.1.0
id: Recorded Future Test
inputs: []
name: Recorded Future Test
outputs: []
starttaskid: '0'
tasks:
  '0':
    id: '0'
    nexttasks:
      '#none#':
      - '16'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 551d738f-4cd3-482e-88e9-aeb5bd2eecd7
      iscommand: false
      name: ''
      version: -1
    taskid: 551d738f-4cd3-482e-88e9-aeb5bd2eecd7
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 910,\n    \"y\": 50\n  }\n}"
  '1':
    id: '1'
    nexttasks:
      '#none#':
      - '2'
      - '3'
      - '4'
      - '9'
    note: false
    scriptarguments:
      entityType:
        simple: domain
      entityValue:
        simple: google.com
      resultEntityType:
        simple: All
    separatecontext: false
    task:
      brand: Recorded Future
      description: Look up threat intel context for an indicator in Recorded Future.
      id: 1ec72f95-5977-434a-8df5-02bad33b0a4e
      iscommand: true
      name: recorded-future-get-related-entities
      script: Recorded Future|||recorded-future-get-related-entities
      type: regular
      version: -1
    taskid: 1ec72f95-5977-434a-8df5-02bad33b0a4e
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 910,\n    \"y\": 370\n  }\n}"
  '10':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Score
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: DBotScore.Indicator
                    operator: isEqualString
                    right:
                      value:
                        simple: blah
                root: DBotScore
          operator: isEqualNumber
          right:
            value:
              simple: '0'
      label: 'yes'
    id: '10'
    nexttasks:
      'yes':
      - '8'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 6b701b87-b594-4df9-8305-c0703d9b25de
      iscommand: false
      name: Verify DBot Score=0
      type: condition
      version: -1
    taskid: 6b701b87-b594-4df9-8305-c0703d9b25de
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 1555,\n    \"y\": 720\n  }\n}"
  '11':
    id: '11'
    nexttasks:
      '#none#':
      - '12'
      - '13'
      - '14'
    note: false
    scriptarguments:
      detailed:
        simple: 'true'
      limit: {}
      public: {}
      timeout: {}
      url:
        simple: https://www.google.com
    separatecontext: false
    task:
      brand: Recorded Future
      description: Look up threat intel information for a url in Recorded Future.
      id: 1c5ed312-3569-4ed7-88b2-a4e511388ced
      iscommand: true
      name: url
      script: Recorded Future|||url
      type: regular
      version: -1
    taskid: 1c5ed312-3569-4ed7-88b2-a4e511388ced
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 910,\n    \"y\": 1215\n  }\n}"
  '12':
    id: '12'
    nexttasks:
      '#none#':
      - '17'
    note: false
    scriptarguments:
      expectedValue:
        simple: https://www.google.com
      fields: {}
      path:
        simple: URL.Data
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 574fc94d-be2c-447e-866f-11ba3700f57d
      iscommand: false
      name: VerifyContext - URL
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 574fc94d-be2c-447e-866f-11ba3700f57d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 1390\n  }\n}"
  '13':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Type
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: DBotScore.Vendor
                    operator: isEqualString
                    right:
                      value:
                        simple: Recorded Future
                root: DBotScore
          operator: isEqualString
          right:
            value:
              simple: url
      label: 'yes'
    id: '13'
    nexttasks:
      'yes':
      - '17'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 85357c0e-b5f9-4981-82c7-d41ae3364523
      iscommand: false
      name: Verify - DBotScore
      type: condition
      version: -1
    taskid: 85357c0e-b5f9-4981-82c7-d41ae3364523
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 910,\n    \"y\": 1390\n  }\n}"
  '14':
    id: '14'
    nexttasks:
      '#none#':
      - '17'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: Criticality,FirstSeen,LastSeen
      path:
        simple: URL.RecordedFuture
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 18784601-2de7-43af-805b-7137ac61d221
      iscommand: false
      name: VerifyContext - RecordedFuture
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 18784601-2de7-43af-805b-7137ac61d221
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 1390\n  }\n}"
  '15':
    id: '15'
    nexttasks:
      '#none#':
      - '11'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 76e2755a-57cd-4a97-8308-b6908f5b621c
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 76e2755a-57cd-4a97-8308-b6908f5b621c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 910,\n    \"y\": 1040\n  }\n}"
  '16':
    id: '16'
    nexttasks:
      '#none#':
      - '1'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: f9d07f4f-aa05-416f-8b69-1a7296cf52a7
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: f9d07f4f-aa05-416f-8b69-1a7296cf52a7
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 910,\n    \"y\": 195\n  }\n}"
  '17':
    id: '17'
    nexttasks:
      '#none#':
      - '19'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 77bac36a-e4fb-4727-8c24-ffa2cdbc5fac
      iscommand: false
      name: Threats test
      type: title
      version: -1
    taskid: 77bac36a-e4fb-4727-8c24-ffa2cdbc5fac
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 910,\n    \"y\": 1565\n  }\n}"
  '18':
    id: '18'
    nexttasks:
      '#none#':
      - '20'
    note: false
    scriptarguments:
      detailed: {}
      direction: {}
      limit: {}
      orderby: {}
      riskHigher: {}
      riskLower: {}
    separatecontext: false
    task:
      brand: Recorded Future
      description: Returns hash threats from Recorded Future
      id: 419ba47a-4607-4c5c-8b7e-8ba7ba5dfb2e
      iscommand: true
      name: recorded-future-get-threats-hash
      script: Recorded Future|||recorded-future-get-threats-hash
      type: regular
      version: -1
    taskid: 419ba47a-4607-4c5c-8b7e-8ba7ba5dfb2e
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1885\n  }\n}"
  '19':
    id: '19'
    nexttasks:
      '#none#':
      - '18'
      - '21'
      - '23'
      - '25'
      - '27'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 0653d269-614a-4a9c-8849-a17dcd24e80b
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 0653d269-614a-4a9c-8849-a17dcd24e80b
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 910,\n    \"y\": 1710\n  }\n}"
  '2':
    id: '2'
    nexttasks:
      '#none#':
      - '5'
    note: false
    scriptarguments:
      detailed: {}
      enclave-ids: {}
      fullResponse: {}
      ip:
        simple: ${Domain.RecordedFuture.RelatedEntities.IPAddress.[0].Name}
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    separatecontext: false
    task:
      brand: Recorded Future
      description: Look up threat intel information for an IP in Recorded Future.
      id: 19062ba1-28ff-468e-8b56-1d486b2809ba
      iscommand: true
      name: ip
      script: Recorded Future|||ip
      type: regular
      version: -1
    taskid: 19062ba1-28ff-468e-8b56-1d486b2809ba
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 545\n  }\n}"
  '20':
    id: '20'
    nexttasks:
      '#none#':
      - '28'
    note: false
    scriptarguments:
      expectedValue: {}
      fields: {}
      path:
        simple: File
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 238c4155-dc63-484f-800b-c3b5deeb4295
      iscommand: false
      name: VerifyContext - Hash
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 238c4155-dc63-484f-800b-c3b5deeb4295
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2060\n  }\n}"
  '21':
    id: '21'
    nexttasks:
      '#none#':
      - '22'
    note: false
    scriptarguments:
      detailed: {}
      direction: {}
      limit: {}
      orderby: {}
      riskHigher: {}
      riskLower: {}
    separatecontext: false
    task:
      brand: Recorded Future
      description: Returns IP threats from Recorded Future
      id: b18adb3b-16dc-4285-811d-41eed7754ad3
      iscommand: true
      name: recorded-future-get-threats-ip
      script: Recorded Future|||recorded-future-get-threats-ip
      type: regular
      version: -1
    taskid: b18adb3b-16dc-4285-811d-41eed7754ad3
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 1885\n  }\n}"
  '22':
    id: '22'
    nexttasks:
      '#none#':
      - '28'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: Address
      path:
        simple: IP
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 9fd3cf2a-4ef3-48e3-8221-f6f29283960c
      iscommand: false
      name: VerifyContext - IP
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 9fd3cf2a-4ef3-48e3-8221-f6f29283960c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 2060\n  }\n}"
  '23':
    id: '23'
    nexttasks:
      '#none#':
      - '24'
    note: false
    scriptarguments:
      detailed: {}
      direction: {}
      limit: {}
      orderby: {}
      riskHigher: {}
      riskLower: {}
    separatecontext: false
    task:
      brand: Recorded Future
      description: Returns URL threats from Recorded Future
      id: 22adae2c-6e1f-4669-8386-74c38a22eab4
      iscommand: true
      name: recorded-future-get-threats-url
      script: Recorded Future|||recorded-future-get-threats-url
      type: regular
      version: -1
    taskid: 22adae2c-6e1f-4669-8386-74c38a22eab4
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 910,\n    \"y\": 1885\n  }\n}"
  '24':
    id: '24'
    nexttasks:
      '#none#':
      - '28'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: Data
      path:
        simple: URL
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: d8c34d91-ca6b-4d02-8ee3-fd091834dd65
      iscommand: false
      name: VerifyContext - URL
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: d8c34d91-ca6b-4d02-8ee3-fd091834dd65
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 910,\n    \"y\": 2060\n  }\n}"
  '25':
    id: '25'
    nexttasks:
      '#none#':
      - '26'
    note: false
    scriptarguments:
      detailed:
        simple: 'true'
      direction: {}
      limit: {}
      orderby: {}
      riskHigher: {}
      riskLower: {}
    separatecontext: false
    task:
      brand: Recorded Future
      description: Returns domain threats Recorded Future
      id: 06d0a77b-a344-44d7-88f2-d28b6a0f0333
      iscommand: true
      name: recorded-future-get-threats-domain
      script: Recorded Future|||recorded-future-get-threats-domain
      type: regular
      version: -1
    taskid: 06d0a77b-a344-44d7-88f2-d28b6a0f0333
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 1885\n  }\n}"
  '26':
    id: '26'
    nexttasks:
      '#none#':
      - '28'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: Name
      path:
        simple: Domain
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 5f803c89-8a56-41b0-88b0-db86af1781a2
      iscommand: false
      name: VerifyContext - Domain
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 5f803c89-8a56-41b0-88b0-db86af1781a2
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 2060\n  }\n}"
  '27':
    id: '27'
    nexttasks:
      '#none#':
      - '29'
    note: false
    scriptarguments:
      detailed: {}
      direction: {}
      limit: {}
      orderby: {}
      riskHigher: {}
      riskLower: {}
    separatecontext: false
    task:
      brand: Recorded Future
      description: Returns vulnerability threats from Recorded Future
      id: 6567347c-ee11-46cc-81fa-9d02c6b830ff
      iscommand: true
      name: recorded-future-get-threats-vulnerabilities
      script: Recorded Future|||recorded-future-get-threats-vulnerabilities
      type: regular
      version: -1
    taskid: 6567347c-ee11-46cc-81fa-9d02c6b830ff
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1770,\n    \"y\": 1885\n  }\n}"
  '28':
    id: '28'
    nexttasks:
      '#none#':
      - '31'
      - '32'
      - '33'
      - '34'
      - '35'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: Criticality,FirstSeen,LastSeen
      path:
        simple: Domain.RecordedFuture
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: a86771d3-4e12-4567-8741-e0c5751b308e
      iscommand: false
      name: VerifyContext - RecordedFuture
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: a86771d3-4e12-4567-8741-e0c5751b308e
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 910,\n    \"y\": 2235\n  }\n}"
  '29':
    id: '29'
    nexttasks:
      '#none#':
      - '28'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: ID
      path:
        simple: CVE
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 0d0773e7-7159-44ef-82d6-a3b359a441e1
      iscommand: false
      name: VerifyContext - CVE
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 0d0773e7-7159-44ef-82d6-a3b359a441e1
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1770,\n    \"y\": 2060\n  }\n}"
  '3':
    id: '3'
    nexttasks:
      '#none#':
      - '6'
    note: false
    scriptarguments:
      detailed:
        simple: 'true'
      domain:
        simple: ${Domain.RecordedFuture.RelatedEntities.Domain.[0].Name}
      enclave-ids: {}
      long: {}
      threshold: {}
    separatecontext: false
    task:
      brand: Recorded Future
      description: Look up threat intel information for a domain or DNS in Recorded
        Future.
      id: d9459189-f2e3-468a-8c0c-6991aca43bb9
      iscommand: true
      name: domain
      script: Recorded Future|||domain
      type: regular
      version: -1
    taskid: d9459189-f2e3-468a-8c0c-6991aca43bb9
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 695,\n    \"y\": 545\n  }\n}"
  '30':
    id: '30'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: c4c1ff16-cae4-4bc6-8262-1b58e20b7f5c
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: c4c1ff16-cae4-4bc6-8262-1b58e20b7f5c
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 695,\n    \"y\": 3605\n  }\n}"
  '31':
    id: '31'
    nexttasks:
      '#none#':
      - '36'
    note: false
    separatecontext: false
    task:
      brand: Recorded Future
      description: Get the risk rules for domain data
      id: aa42b77c-983c-4602-8c1d-bb4e0b23bbe3
      iscommand: true
      name: recorded-future-get-domain-riskrules
      script: Recorded Future|||recorded-future-get-domain-riskrules
      type: regular
      version: -1
    taskid: aa42b77c-983c-4602-8c1d-bb4e0b23bbe3
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2410\n  }\n}"
  '32':
    id: '32'
    nexttasks:
      '#none#':
      - '36'
    note: false
    separatecontext: false
    task:
      brand: Recorded Future
      description: Get the risk rules for hash data
      id: 185e123c-3c32-44eb-8094-d11ddb585705
      iscommand: true
      name: recorded-future-get-hash-riskrules
      script: Recorded Future|||recorded-future-get-hash-riskrules
      type: regular
      version: -1
    taskid: 185e123c-3c32-44eb-8094-d11ddb585705
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 2410\n  }\n}"
  '33':
    id: '33'
    nexttasks:
      '#none#':
      - '36'
    note: false
    separatecontext: false
    task:
      brand: Recorded Future
      description: Get the risk rules for ip data
      id: 0dfc678c-90d1-487b-8780-09b345be4d4b
      iscommand: true
      name: recorded-future-get-ip-riskrules
      script: Recorded Future|||recorded-future-get-ip-riskrules
      type: regular
      version: -1
    taskid: 0dfc678c-90d1-487b-8780-09b345be4d4b
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 910,\n    \"y\": 2410\n  }\n}"
  '34':
    id: '34'
    nexttasks:
      '#none#':
      - '36'
    note: false
    separatecontext: false
    task:
      brand: Recorded Future
      description: Get the risk rules for url data
      id: c4c7d5c1-e51c-47c0-8653-a84c2c94b2ad
      iscommand: true
      name: recorded-future-get-url-riskrules
      script: Recorded Future|||recorded-future-get-url-riskrules
      type: regular
      version: -1
    taskid: c4c7d5c1-e51c-47c0-8653-a84c2c94b2ad
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1340,\n    \"y\": 2410\n  }\n}"
  '35':
    id: '35'
    note: false
    separatecontext: false
    task:
      brand: Recorded Future
      description: Get the risk rules for vulnerability data
      id: 622efccf-1b49-4823-8375-519fd182c69a
      iscommand: true
      name: recorded-future-get-vulnerability-riskrules
      script: Recorded Future|||recorded-future-get-vulnerability-riskrules
      type: regular
      version: -1
    taskid: 622efccf-1b49-4823-8375-519fd182c69a
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1770,\n    \"y\": 2410\n  }\n}"
  '36':
    id: '36'
    nexttasks:
      '#none#':
      - '37'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: Domain,IP,URL,Vulnerability,Hash
      path:
        simple: RecordedFuture.RiskRule
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 76a49a79-6352-49a4-817a-94f3f038464f
      iscommand: false
      name: VerifyContext - Risk Rules
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 76a49a79-6352-49a4-817a-94f3f038464f
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 695,\n    \"y\": 2585\n  }\n}"
  '37':
    id: '37'
    nexttasks:
      '#none#':
      - '38'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 955fc18a-7b52-474e-8b12-539fec8a6927
      iscommand: false
      name: Alerts
      type: title
      version: -1
    taskid: 955fc18a-7b52-474e-8b12-539fec8a6927
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 695,\n    \"y\": 2760\n  }\n}"
  '38':
    id: '38'
    nexttasks:
      '#none#':
      - '39'
    note: false
    scriptarguments:
      limit: {}
      rule_name:
        simple: DJIA
    separatecontext: false
    task:
      brand: Recorded Future
      description: Get Recorded Future Alert rules by rule name
      id: 458a0d94-f4c6-4785-8992-b78347e47f09
      iscommand: true
      name: recorded-future-get-alert-rules
      script: Recorded Future|||recorded-future-get-alert-rules
      type: regular
      version: -1
    taskid: 458a0d94-f4c6-4785-8992-b78347e47f09
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 695,\n    \"y\": 2905\n  }\n}"
  '39':
    id: '39'
    nexttasks:
      '#none#':
      - '40'
    note: false
    scriptarguments:
      assignee: {}
      direction: {}
      freetext: {}
      from: {}
      limit: {}
      orderby: {}
      rule_id:
        simple: ${RecordedFuture.AlertRule.ID}
      status: {}
      triggered: {}
    separatecontext: false
    task:
      brand: Recorded Future
      description: Get alerts from Recorded Future
      id: 91bb0c5d-7e3f-45c6-8e6b-b0eeb5ee3fb2
      iscommand: true
      name: recorded-future-get-alerts
      script: Recorded Future|||recorded-future-get-alerts
      type: regular
      version: -1
    taskid: 91bb0c5d-7e3f-45c6-8e6b-b0eeb5ee3fb2
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 695,\n    \"y\": 3080\n  }\n}"
  '4':
    id: '4'
    nexttasks:
      '#none#':
      - '7'
    note: false
    scriptarguments:
      detailed: {}
      enclave-ids: {}
      file:
        simple: ${Domain.RecordedFuture.RelatedEntities.Hash.[0].Name}
      long: {}
      retries: {}
      threshold: {}
      wait: {}
    separatecontext: false
    task:
      brand: Recorded Future
      description: Look up threat intel information for a file in Recorded Future.
      id: 302f2157-d7ee-46b2-8191-3cddf0bb43ae
      iscommand: true
      name: file
      script: Recorded Future|||file
      type: regular
      version: -1
    taskid: 302f2157-d7ee-46b2-8191-3cddf0bb43ae
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1125,\n    \"y\": 545\n  }\n}"
  '40':
    id: '40'
    nexttasks:
      '#none#':
      - '41'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: Alert
      path:
        simple: RecordedFuture
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 2902630e-9462-4566-8a96-4d7e18e0ada5
      iscommand: false
      name: VerifyContext - Alerts
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 2902630e-9462-4566-8a96-4d7e18e0ada5
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 695,\n    \"y\": 3255\n  }\n}"
  '41':
    id: '41'
    nexttasks:
      '#none#':
      - '30'
    note: false
    scriptarguments:
      add_to_context: {}
      brand_name:
        simple: Recorded Future
      expect_data: {}
      instance_name: {}
    separatecontext: false
    task:
      brand: ''
      description: Execute FetchIncident for a given instance
      id: 70a745f8-d119-4889-8fc1-b211526d50ef
      iscommand: false
      name: Test fetch
      scriptName: FetchFromInstance
      type: regular
      version: -1
    taskid: 70a745f8-d119-4889-8fc1-b211526d50ef
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 695,\n    \"y\": 3430\n  }\n}"
  '5':
    id: '5'
    nexttasks:
      '#none#':
      - '8'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: Criticality,FirstSeen,LastSeen
      path:
        simple: IP.RecordedFuture
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 16afadcb-5f3f-4963-85ef-5e6b56d5481c
      iscommand: false
      name: VerifyContext IP
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 16afadcb-5f3f-4963-85ef-5e6b56d5481c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 720\n  }\n}"
  '6':
    id: '6'
    nexttasks:
      '#none#':
      - '8'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: Criticality,FirstSeen,LastSeen
      path:
        simple: Domain.[1].RecordedFuture
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: daef6526-c3bb-402d-8394-66bd365edcd5
      iscommand: false
      name: VerifyContext - Domain
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: daef6526-c3bb-402d-8394-66bd365edcd5
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 695,\n    \"y\": 720\n  }\n}"
  '7':
    id: '7'
    nexttasks:
      '#none#':
      - '8'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: Indicator,Type,Vendor,Score
      path:
        simple: DBotScore
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: ba060184-88b8-4bc1-8549-cfaa29d7bf8d
      iscommand: false
      name: VerifyContext - File
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: ba060184-88b8-4bc1-8549-cfaa29d7bf8d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1125,\n    \"y\": 720\n  }\n}"
  '8':
    id: '8'
    nexttasks:
      '#none#':
      - '15'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: fb0af1ea-6b8a-48ed-88c2-b69e91522986
      iscommand: false
      name: URL test
      type: title
      version: -1
    taskid: fb0af1ea-6b8a-48ed-88c2-b69e91522986
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 910,\n    \"y\": 895\n  }\n}"
  '9':
    id: '9'
    nexttasks:
      '#none#':
      - '10'
    note: false
    scriptarguments:
      detailed:
        simple: 'true'
      domain:
        simple: blah
      enclave-ids: {}
      long: {}
      threshold: {}
    separatecontext: false
    task:
      brand: Recorded Future
      description: Look up threat intel information for a domain or DNS in Recorded
        Future.
      id: a9f7cbb4-6b76-465f-89e7-3286d8f15c9c
      iscommand: true
      name: domain
      script: Recorded Future|||domain
      type: regular
      version: -1
    taskid: a9f7cbb4-6b76-465f-89e7-3286d8f15c9c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 1555,\n    \"y\": 545\n  }\n}"
toversion: 4.1.9
version: -1
view: "{\n  \"linkLabelsPosition\": {},\n  \"paper\": {\n    \"dimensions\": {\n \
  \     \"height\": 3620,\n      \"width\": 2100,\n      \"x\": 50,\n      \"y\":\
  \ 50\n    }\n  }\n}"
