category: Network Security
commonfields:
  id: Check Point
  version: -1
configuration:
- defaultvalue: ''
  display: Server URL (e.g. https://192.168.0.1)
  name: server
  required: true
  type: 0
- defaultvalue: '443'
  display: Port
  name: port
  required: true
  type: 0
- defaultvalue: ''
  display: Username
  name: credentials
  required: true
  type: 9
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Manage Check Point firewall via API
display: Check Point Firewall
image: data:image/png;base64,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
name: Check Point
script:
  commands:
  - arguments:
    - description: Object name. Should be unique in domain.
      name: name
      required: true
    - description: Object unique identifier.
      name: uid
    description: Show items in an access rulebase configured in Checkpoint FW
    name: checkpoint-show-access-rule-base
    outputs:
    - contextPath: CheckpointFWRule.Name
      description: Object name. Should be unique in domain
      type: string
    - contextPath: CheckpointFWRule.UID
      description: Object unique identifier
      type: string
    - contextPath: CheckpointFWRule.Type
      description: Type of the object
      type: string
    - contextPath: CheckpointFWRule.Action
      description: Accept, Drop, Apply Layer, Ask, Info. How much details are returned
        depends on the details-level field of the request. This table shows the level
        of detail shown when details-level is set to standard
      type: string
    - contextPath: CheckpointFWRule.ActionSetting
      description: Action settings
      type: string
    - contextPath: CheckpointFWRule.CustomFields
      description: Custom fields
      type: string
    - contextPath: CheckpointFWRule.Data
      description: How much details are returned depends on the details-level field
        of the request. This table shows the level of detail shown when details-level
        is set to standard
      type: string
    - contextPath: CheckpointFWRule.Data.Name
      description: Object name. Should be unique in domain.
      type: string
    - contextPath: CheckpointFWRule.UID
      description: Object unique identifier
      type: string
    - contextPath: CheckpointFWRule.Type
      description: Type of the object
      type: string
    - contextPath: CheckpointFWRule.Data.Domain
      description: Information about the domain the object belongs to
      type: string
    - contextPath: CheckpointFWRule.DataDirection
      description: On which direction the file types processing is applied
      type: string
    - contextPath: CheckpointFWRule.DataNegate
      description: True if negate is set for data
      type: string
    - contextPath: CheckpointFWRule.Destination
      description: Collection of Network objects identified by the name or UID. How
        much details are returned depends on the details-level field of the request.
        This table shows the level of detail shown when details-level is set to standard
      type: string
    - contextPath: CheckpointFWRule.DestinationNegate
      description: True if negate is set for destination.
      type: string
    - contextPath: CheckpointFWRule.Domain
      description: Information about the domain the object belongs to.
      type: string
    - contextPath: CheckpointFWRule.Domain.Name
      description: Object name. Should be unique in domain.
      type: string
    - contextPath: CheckpointFWRule.Domain.UID
      description: Object unique identifier.
      type: string
    - contextPath: CheckpointFWRule.Domain.Type
      description: Domain type
      type: string
    - contextPath: CheckpointFWRule.Enabled
      description: Enable/Disable the rule
      type: string
    - contextPath: CheckpointFWRule.Hits
      description: Hits count object
      type: number
    - contextPath: CheckpointFWRule.Hits.FirstDate
      description: First of hits
      type: string
    - contextPath: CheckpointFWRule.Hits.LastDate
      description: Last date of hits
      type: string
    - contextPath: CheckpointFWRule.Hits.Level
      description: Level of hits
      type: string
    - contextPath: CheckpointFWRule.Hits.Percentage
      description: Percentage of hits
      type: string
    - contextPath: CheckpointFWRule.Hits.Value
      description: Value of hits
      type: string
  - arguments:
    - description: Object unique identifier.
      name: uid
    - description: Object name.
      name: name
    - description: Rule number.
      name: rule_number
    - description: Layer that the rule belongs to identified by the name or UID.
      name: layer
      required: true
    - description: true to enable the rule, false to disable it.
      name: enabled
    description: Set attributes of an access rule object configured in Checkpoint
      FW
    name: checkpoint-set-rule
    outputs:
    - contextPath: CheckpointFWRule.Name
      description: Object name. Should be unique in domain
      type: string
    - contextPath: CheckpointFWRule.UID
      description: Object unique identifier
      type: string
    - contextPath: CheckpointFWRule.Type
      description: Type of the object
      type: string
    - contextPath: CheckpointFWRule.Action
      description: Accept, Drop, Apply Layer, Ask, Info. How much details are returned
        depends on the details-level field of the request. This table shows the level
        of detail shown when details-level is set to standard
      type: string
    - contextPath: CheckpointFWRule.ActionSetting
      description: Action settings
      type: string
    - contextPath: CheckpointFWRule.CustomFields
      description: Custom fields
      type: string
    - contextPath: CheckpointFWRule.Data
      description: How much details are returned depends on the details-level field
        of the request. This table shows the level of detail shown when details-level
        is set  to standard
      type: string
    - contextPath: CheckpointFWRule.Data.Name
      description: Object name. Should be unique in domain
      type: string
    - contextPath: CheckpointFWRule.UID
      description: Object unique identifier
      type: string
    - contextPath: CheckpointFWRule.Type
      description: Type of the object
      type: string
    - contextPath: CheckpointFWRule.Data.Domain
      description: Information about the domain the object belongs to
      type: string
    - contextPath: CheckpointFWRule.DataDirection
      description: On which direction the file types processing is applied
      type: string
    - contextPath: CheckpointFWRule.DataNegate
      description: True if negate is set for data
      type: string
    - contextPath: CheckpointFWRule.Destination
      description: Collection of Network objects identified by the name or UID. How
        much details are returned depends on the details-level field of the request.
        This table shows the level of detail shown when details-level is set to standard
      type: string
    - contextPath: CheckpointFWRule.DestinationNegate
      description: True if negate is set for destination
      type: string
    - contextPath: CheckpointFWRule.Domain
      description: Information about the domain the object belongs to
      type: string
    - contextPath: CheckpointFWRule.Domain.Name
      description: Object name. Should be unique in domain
      type: string
    - contextPath: CheckpointFWRule.Domain.UID
      description: Object unique identifier
      type: string
    - contextPath: CheckpointFWRule.Domain.Type
      description: Domain type
      type: string
    - contextPath: CheckpointFWRule.Enabled
      description: Enable/Disable the rule
      type: string
    - contextPath: CheckpointFWRule.Hits
      description: Hits count object
      type: number
    - contextPath: CheckpointFWRule.Hits.FirstDate
      description: First of hits
      type: string
    - contextPath: CheckpointFWRule.Hits.LastDate
      description: Last date of hits
      type: string
    - contextPath: CheckpointFWRule.Hits.Level
      description: Level of hits
      type: string
    - contextPath: CheckpointFWRule.Hits.Percentage
      description: Percentage of hits
      type: string
    - contextPath: CheckpointFWRule.Hits.Value
      description: Value of hits
      type: string
  - arguments:
    - description: Unique identifier of one or more tasks.
      name: task_id
      required: true
    description: Shows status of a checkpoint task by task uuid
    name: checkpoint-task-status
    outputs:
    - contextPath: CheckpointFWTask.Name
      description: Object name. Should be unique in domain
      type: string
    - contextPath: CheckpointFWTask.UID
      description: Object unique identifier
      type: string
    - contextPath: CheckpointFWTask.Type
      description: Type of the object
      type: string
    - contextPath: CheckpointFWTask.Domain
      description: Information about the domain the object belongs to.
      type: string
    - contextPath: CheckpointFWTask.Domain.Name
      description: Object name. Should be unique in domain.
      type: string
    - contextPath: CheckpointFWTask.Domain.UID
      description: Object unique identifier
      type: string
    - contextPath: CheckpointFWTask.Domain.Type
      description: Domain type
      type: string
    - contextPath: CheckpointFWTask.LastUpdateTime
      description: Last update date and time represented in international ISO 8601
        format
      type: string
    - contextPath: CheckpointFWTask.MetaInfo.CreationTime
      description: Object creation time
      type: string
    - contextPath: CheckpointFWTask.MetaInfo.Creator
      description: Object creator
      type: string
    - contextPath: CheckpointFWTask.MetaInfo.LastModifier
      description: Last modifier of object
      type: string
    - contextPath: CheckpointFWTask.MetaInfo.LastModifyTime
      description: Object last modification time
      type: string
    - contextPath: CheckpointFWTask.MetaInfo.LockStatus
      description: Object lock state. It's not allowed to edit objects locked by other
        session.
      type: string
    - contextPath: CheckpointFWTask.MetaInfo.ValidationStatus
      description: Object validation state - ok, info, warning, error
      type: string
    - contextPath: CheckpointFWTask.ProgressPercentage
      description: Object progress percentage
      type: string
    - contextPath: CheckpointFWTask.ReadOnly
      description: Read only
      type: string
    - contextPath: CheckpointFWTask.StartTime
      description: Start time date and time represented in international ISO 8601
        format.
      type: string
    - contextPath: CheckpointFWTask.Status
      description: Task status
      type: string
    - contextPath: CheckpointFWTask.Suppressed
      description: Is suppressed
      type: string
    - contextPath: CheckpointFWTask.Tags
      description: Collection of tag objects identified by the name or UID. How much
        details are returned depends on the details-level field of the request. This
        table shows the level of detail shown when details-level is set to standard
      type: string
    - contextPath: CheckpointFWTask.Details
      description: Task details. How much details are returned depends on the details-level
        field of the request. This table shows the level of detail shown when details-level
        is set to standard
      type: string
    - contextPath: CheckpointFWTask.ID
      description: Asynchronous task unique identifier
      type: string
    - contextPath: CheckpointFWTask.TaskName
      description: Task name
      type: string
  - arguments:
    - description: No more than that many results will be returned.
      name: limit
    - description: Skip that many results before beginning to return them.
      name: offset
    - auto: PREDEFINED
      description: Sorts results by the given field. The default is the random order.
      name: order
      predefined:
      - ASC
      - DESC
    description: Show host objects configured in Checkpoint FW
    name: checkpoint-show-hosts
    outputs:
    - contextPath: Endpoint.Hostname
      description: Object name. Should be unique in domain
      type: string
    - contextPath: Endpoint.UID
      description: Object unique identifier
      type: string
    - contextPath: Endpoint.Type
      description: Type of the object
      type: string
    - contextPath: Endpoint.Domain
      description: Information about the domain the object belongs to
      type: string
    - contextPath: Endpoint.Domain.Name
      description: Object name. Should be unique in domain
      type: string
    - contextPath: Endpoint.Domain.UID
      description: Object unique identifier
      type: string
    - contextPath: Endpoint.Domain.Type
      description: Type of the object
      type: string
  - arguments:
    - description: IP addresse to be blocked
      name: ip
      required: true
    - auto: PREDEFINED
      description: Whether to block traffic "to" or "from" the IPs, or "both". Default     is
        "both".
      name: direction
      predefined:
      - to
      - from
      - both
    - deprecated: true
      description: Base name for added rules inside checkpoint db
      name: rulename
      required: false
    - description: Base name for added ip/hosts inside checkpoint db
      name: ipname
      required: true
    description: Block one or more IP addresses using Checkpoint Firewall
    name: checkpoint-block-ip
    outputs:
    - contextPath: CheckpointFWRule.Name
      description: Object name. Should be unique in domain
      type: string
    - contextPath: CheckpointFWRule.UID
      description: Object unique identifier
      type: string
    - contextPath: CheckpointFWRule.Type
      description: Type of the object
      type: string
    - contextPath: CheckpointFWRule.Action
      description: Accept, Drop, Apply Layer, Ask, Info. How much details are returned
        depends on the details-level field of the request. This table shows the level
        of detail shown when details-level is set to standard
      type: string
    - contextPath: CheckpointFWRule.ActionSetting
      description: Action settings
      type: string
    - contextPath: CheckpointFWRule.CustomFields
      description: Custom fields
      type: string
    - contextPath: CheckpointFWRule.Data
      description: How much details are returned depends on the details-level field
        of the request. This table shows the level of detail shown when details-level
        is set to standard
      type: string
    - contextPath: CheckpointFWRule.Data.Name
      description: Object name. Should be unique in domain
      type: string
    - contextPath: CheckpointFWRule.UID
      description: Object unique identifier
      type: string
    - contextPath: CheckpointFWRule.Type
      description: Type of the object
      type: string
    - contextPath: CheckpointFWRule.Data.Domain
      description: Information about the domain the object belongs to
      type: string
    - contextPath: CheckpointFWRule.DataDirection
      description: On which direction the file types processing is applied
      type: string
    - contextPath: CheckpointFWRule.DataNegate
      description: True if negate is set for data
      type: string
    - contextPath: CheckpointFWRule.Destination
      description: Collection of Network objects identified by the name or UID. How
        much details are returned depends on the details-level field of the request.
        This table shows the level of detail shown when details-level is set to standard
      type: string
    - contextPath: CheckpointFWRule.DestinationNegate
      description: True if negate is set for destination
      type: string
    - contextPath: CheckpointFWRule.Domain
      description: Information about the domain the object belongs to
      type: string
    - contextPath: CheckpointFWRule.Domain.Name
      description: Object name. Should be unique in domain
      type: string
    - contextPath: CheckpointFWRule.Domain.UID
      description: Object unique identifier
      type: string
    - contextPath: CheckpointFWRule.Domain.Type
      description: Domain type
      type: string
    - contextPath: CheckpointFWRule.Enabled
      description: Enable/Disable the rule
      type: string
    - contextPath: CheckpointFWRule.Hits
      description: Hits count object
      type: number
    - contextPath: CheckpointFWRule.Hits.FirstDate
      description: First of hits
      type: string
    - contextPath: CheckpointFWRule.Hits.LastDate
      description: Last date of hits
      type: string
    - contextPath: CheckpointFWRule.Hits.Level
      description: Level of hits
      type: string
    - contextPath: CheckpointFWRule.Hits.Percentage
      description: Percentage of hits
      type: string
    - contextPath: CheckpointFWRule.Hits.Value
      description: Value of hits
      type: string
  - arguments: []
    description: Use Check Point's Management API (requires management server R80
      or later). Specifying 'command'=<API command> is mandatory
    name: checkpoint
  - arguments:
    - description: uid of the rule
      name: uid
    - description: name of the rule
      name: name
    - default: true
      description: e.g. Network
      name: layer
      required: true
    description: Delete rule from firewall
    name: checkpoint-delete-rule
  runonce: false
  script: "//GLOBALS//\nvar SERVER = params.server.replace(/[\\/]+$/, '') + ':' +\
    \ params.port + '/web_api/';\nvar SESSION_ID;\n\n//DICTIONARIES//\nvar entityDict\
    \ = {\n    CheckpointFWRule: {\n        'name' :                'Name',\n    \
    \    'uid' :                 'UID',\n        'type' :                'Type',\n\
    \        'action' :              'Action',\n        'action-settings' :     'ActionSetting',\n\
    \        'custom-fields' :       'CustomFields',\n        'data.name' :      \
    \     'Data.Name',\n        'data.uid' :            'Data.UID',\n        'data.type'\
    \ :           'Data.Type',\n        'data.domain' :         'Data.Domain',\n \
    \       'data-direction' :      'DataDirection',\n        'data-negate' :    \
    \     'DataNegate',\n        'destination' :         'Destination',\n        'destination-negate'\
    \ :  'DestinationNegate',\n        'domain.name' :         'Domain.Name',\n  \
    \      'domain.uid' :          'Domain.UID',\n        'domain.domain-type':  \
    \ 'Domain.Type',\n        'enabled' :             'Enabled',\n        'hits.first-date'\
    \ :     'Hits.FirstDate',\n        'hits.last-date' :      'Hits.LastDate',\n\
    \        'hits.level' :          'Hits.Level',\n        'hits.percentage' :  \
    \   'Hits.Percentage',\n        'hits.value' :          'Hits.Value'\n       \
    \ },\n    Endpoint: {\n        'name' :            'Hostname',\n        'uid'\
    \ :             'UID',\n        'type' :            'Type',\n        'domain.name'\
    \ :     'Domain.Name',\n        'domain.uid' :      'Domain.UID',\n        'domain.domain-type'\
    \ : 'Domain.Type'\n    },\n    CheckpointFWTask: {\n        'name' :         \
    \               'Name',\n        'uid' :                         'UID',\n    \
    \    'type' :                        'Type',\n        'domain.name' :        \
    \         'Domian.Name',\n        'domain.uid' :                  'Domain.UID',\n\
    \        'domain.domain-type':           'Domain.Type',\n        'last-update-time.iso-8601'\
    \ :   'LastUpdateTime',\n        'meta-info.creation-time' :     'MetaInfo.CreationTime',\n\
    \        'meta-info.creator' :           'MetaInfo.Creator',\n        'meta-info.last-modifier'\
    \ :     'MetaInfo.LastModifier',\n        'meta-info.last-modify-time' :  'MetaInfo.LastModifyTime',\n\
    \        'meta-info.lock' :              'MetaInfo.LockStatus',\n        'meta-info.validation-state'\
    \ :  'MetaInfo.ValidationStatus',\n        'progress-percentage' :         'ProgressPercentage',\n\
    \        'read-only' :                   'ReadOnly',\n        'start-time' : \
    \                 'StartTime',\n        'status' :                      'Status',\n\
    \        'suppressed' :                  'Suppressed',\n        'tags' :     \
    \                   'Tags',\n        'task-details' :                'Details',\n\
    \        'task-id' :                     'ID',\n        'task-name':         \
    \           'TaskName'\n    }\n};\n\n\n//HELPERS//\nfunction extend(obj, src)\
    \ {\n    Object.keys(src).forEach(function(key) { obj[key] = src[key]; });\n \
    \   return obj;\n}\n\n\n//returns single object withing entity (i.e. File[0])\n\
    function jsonToEntityObject(origObj, newKeys) {\n    //log(\"func started\");\n\
    \    var ret = {};\n    var path;\n    var newField;\n    //var temp;\n    for(var\
    \ key in newKeys){\n        if(newKeys[key]){\n            path = newKeys[key].split('.');\n\
    \            origPath = key.split('.');\n            if(path.length == 1){\n \
    \               ret[newKeys[key]] = dq(origObj, '.'+key);\n            }\n   \
    \         else{\n                newField = dq(origObj, '.'+key);\n          \
    \      if(!ret[path[0]] && newField){\n                    ret[path[0]] = {};\n\
    \                }\n                if(newField){\n                    ret[path[0]][path[1]]\
    \ = newField;\n                }\n            }\n        }\n    }\n    return\
    \ ret;\n}\n\n\n//returns entire entity array (i.e. File)\nfunction jsonToEntity(origObj,\
    \ newKeys) {\n    var j;\n    var ret;\n    if(!Array.isArray(origObj)){\n   \
    \     ret = [jsonToEntityObject(origObj, newKeys)];\n        return ret;\n   \
    \ }\n    else if(origObj.length > 0){ //makes sure no empty arrays are pushed\n\
    \        ret = [];\n        for(j=0; j<origObj.length; j++){\n            ret.push(jsonToEntityObject(origObj[j],\
    \ newKeys));\n        }\n        return ret;\n    }\n}\n\n\nfunction prettify_show_hosts(hosts){\n\
    \    var pretty_hosts = [];\n    for (i = 0; i < hosts.length; i++) {\n      \
    \  pretty_hosts[i] = {};\n        if (hosts[i].uid) {\n            pretty_hosts[i].UID\
    \ = hosts[i].uid;\n        }\n        if (hosts[i].name) {\n            pretty_hosts[i].Name\
    \ = hosts[i].name;\n        }\n        if (hosts[i]['ipv4-address']) {\n     \
    \       pretty_hosts[i].IPV4 = hosts[i]['ipv4-address'];\n        }\n        if\
    \ (hosts[i].domain) {\n            pretty_hosts[i].Domain = 'Name: ' + hosts[i].domain.name\
    \ + ', UID: ' + hosts[i].domain.uid + ', Type: ' + hosts[i].domain['domain-type'];\n\
    \        }\n    }\n    return pretty_hosts;\n}\n\n\nfunction prettify_rule_data(rule_data)\
    \ {\n    var pretty_rule_data = {};\n    if (rule_data.name) {\n        pretty_rule_data.Name\
    \ = rule_data.name;\n    }\n    if (rule_data.action && rule_data.action.name)\
    \ {\n        pretty_rule_data.Action = rule_data.action.name;\n    }\n    if (rule_data.enabled)\
    \ {\n        pretty_rule_data.Enabled = rule_data.enabled;\n    }\n    if (rule_data.layer)\
    \ {\n        pretty_rule_data.Layer = rule_data.layer;\n    }\n    if (rule_data['content-direction'])\
    \ {\n        pretty_rule_data['Content Direction'] = rule_data['content-direction'];\n\
    \    }\n    if (rule_data.content && rule_data.content.name) {\n            pretty_rule_data.Content\
    \ = rule_data.content.name;\n    }\n    if (rule_data['content-negate']) {\n \
    \       pretty_rule_data['Content Negate'] = rule_data['content-negate'];\n  \
    \  }\n    if (rule_data.destination && rule_data.destination.name) {\n       \
    \     pretty_rule_data.Destination = rule_data.destination.name;\n    }\n    if\
    \ (rule_data['destination-negate']) {\n        pretty_rule_data['Destination Negate']\
    \ = rule_data['destination-negate'];\n    }\n    if (rule_data.service && rule_data.service.name)\
    \ {\n            pretty_rule_data.Service = rule_data.service.name;\n    }\n \
    \   if (rule_data['service-negate']) {\n        pretty_rule_data['Service Negate']\
    \ = rule_data['service-negate'];\n    }\n    if (rule_data.source && rule_data.source.name)\
    \ {\n            pretty_rule_data.Source = rule_data.source.name;\n    }\n   \
    \ if (rule_data['source-negate']) {\n        pretty_rule_data['Source Negate']\
    \ = rule_data['source-negate'];\n    }\n    return pretty_rule_data;\n}\n\n\n\
    function prettify_rule_base(rule_base) {\n    var pretty_rule_base = [];\n   \
    \ for (i = 0; i < rule_base.length; i++) {\n        pretty_rule_base[i] = {};\n\
    \        if (rule_base[i]['rule-number']) {\n            pretty_rule_base[i]['Rule\
    \ Number'] = rule_base[i]['rule-number'];\n        }\n        if (rule_base[i].name)\
    \ {\n            pretty_rule_base[i].Name = rule_base[i].name;\n        }\n  \
    \      if (rule_base[i]['rule-number']) {\n            pretty_rule_base[i].Name\
    \ = rule_base[i]['rule-number'];\n        }\n        if (rule_base[i].uid) {\n\
    \            pretty_rule_base[i].UID = rule_base[i].uid;\n        }\n        if\
    \ (rule_base[i].action) {\n            pretty_rule_base[i].Action = rule_base[i].action;\n\
    \        }\n        if (rule_base[i].enabled) {\n            pretty_rule_base[i].Enabled\
    \ = rule_base[i].enabled;\n        }\n        if (rule_base[i]['content-direction'])\
    \ {\n            pretty_rule_base[i].Content = rule_base[i]['content-direction'];\n\
    \        }\n    }\n    return pretty_rule_base;\n}\n\n\nfunction sendRequest(cmdURL,\
    \ body, cmdHeaders) {\n    var headers = cmdHeaders? cmdHeaders : {'content-type':\
    \ ['application/json'], 'X-chkp-sid' : [SESSION_ID]};\n    var res = http(\n \
    \       SERVER + cmdURL,\n        {\n            Method: 'POST',\n           \
    \ Headers: headers,\n            Body: body\n        },\n        params.insecure,\n\
    \        params.proxy\n    );\n    if (res.StatusCode < 200 || res.StatusCode\
    \ >= 300) {\n        throw 'Request Failed.\\nStatus code: ' + res.StatusCode\
    \ + '.\\nBody: ' + JSON.stringify(res) + '.';\n    }\n    return res;\n}\n\n\n\
    function login() {\n    var res = sendRequest('login', JSON.stringify({'user':params.credentials.identifier,'password':params.credentials.password}),\
    \ {'content-type': ['application/json']});\n    try {\n      SESSION_ID = JSON.parse(res.Body).sid;\n\
    \      return SESSION_ID;\n    } catch(err){\n        throw 'Login failed. Answer\
    \ from Checkpoint is: ' + JSON.stringify(res.Body);\n    }\n}\n\n\nfunction logout()\
    \ {\n    if (SESSION_ID) {\n        var res = sendRequest('logout', '{}');\n \
    \       SESSION_ID = undefined;\n        try {\n            return JSON.parse(res.Body).message;\n\
    \        } catch(err) {\n            throw 'Logout failed. Answer from Checkpoint\
    \ is: ' + JSON.stringify(res.Body);\n        }\n    }\n    return 'Already logged\
    \ out';\n}\n\n\n//COMMANDS//\nfunction add_host() {\n    sendRequest('add-host',\
    \ JSON.stringify({name:args.ip, 'ip-address':args.ip}));\n    sendRequest('publish',\
    \ '{}');\n}\n\n\nfunction block_ip() {\n    var md = '';\n    var temp = [];\n\
    \    var result;\n    var res;\n    try{\n        sendRequest('add-host', JSON.stringify({name:args.ip,\
    \ 'ip-address':args.ip}));\n    } catch(err){\n\n    }\n    sendRequest('publish',\
    \ '{}');\n    if(!args.direction){\n        args.direction = 'both';\n    }\n\n\
    \    var requestBody = {\n        position : '1',\n        layer: 'Network',\n\
    \        service: 'any',\n        action: 'Drop'\n    };\n\n    if(args.direction\
    \ === 'both' || args.direction === 'from'){\n        requestBody.name = args.rulename\
    \ + '-from-' + args.ip;\n        requestBody.source = args.ip;\n        requestBody.destination\
    \ = 'ANY';\n        result = sendRequest('add-access-rule', JSON.stringify(requestBody));\n\
    \        sendRequest('publish', '{}');\n        res = JSON.parse(result.Body);\n\
    \        md += tableToMarkdown('Blocked Source IP Table', prettify_rule_data(res));\n\
    \        temp.push(res);\n    }\n\n    if(args.direction === 'both' || args.direction\
    \ === 'to'){\n        requestBody.name = args.rulename + '-to-' + args.ip;\n \
    \       requestBody.destination = args.ip;\n        requestBody.source = 'ANY';\n\
    \        result = sendRequest('add-access-rule', JSON.stringify(requestBody));\n\
    \        sendRequest('publish', '{}');\n        res = JSON.parse(result.Body);\n\
    \        md += tableToMarkdown('Blocked Destination IP Table', prettify_rule_data(res));\n\
    \        temp.push(res);\n    }\n\n    context = {CheckpointFWRule : jsonToEntity(temp,entityDict.CheckpointFWRule)};\n\
    \n    return {\n        Type: entryTypes.note,\n        Contents: result,\n  \
    \      ContentsFormat: formats.json,\n        HumanReadable: md,\n        EntryContext:\
    \ context\n    };\n}\n\n\nfunction show_hosts() {\n    var context = {};\n   \
    \ var res;\n    var body = {limit: args.limit, offset: args.offset, order: args.order};\n\
    \    var result = sendRequest('show-hosts', JSON.stringify(body));\n    try{\n\
    \        res = JSON.parse(result.Body);\n    } catch(err){\n        return result.Body;\n\
    \    }\n    context.Endpoint = jsonToEntity(res.objects, entityDict.Endpoint);\n\
    \    var md = tableToMarkdown('Hosts table', prettify_show_hosts(res.objects),\
    \ ['UID', 'Name', 'IPV4', 'Domain']);\n\n    return {\n        Type: entryTypes.note,\n\
    \        Contents: result,\n        ContentsFormat: formats.json,\n        HumanReadable:\
    \ md,\n        EntryContext: context\n    };\n}\n\n\nfunction task_status() {\n\
    \    var result = sendRequest('show-task', JSON.stringify({'task-id':args.task_id}));\n\
    \    var res =  JSON.parse(result.Body);\n\n    var md = tableToMarkdown('Task\
    \ Status Table', res.tasks);\n    var context = {CheckpointFWTask : jsonToEntity(res.tasks,\
    \ entityDict.CheckpointFWTask)};\n\n    return {\n        Type: entryTypes.note,\n\
    \        Contents: result,\n        ContentsFormat: formats.json,\n        HumanReadable:\
    \ md,\n        EntryContext: context\n    };\n}\n\n\nfunction set_rule() {\n \
    \   var result;\n    if(args.uid || args.name || args.rule_number){\n        var\
    \ body = {\n            uid : args.uid,\n            name: args.name,\n      \
    \      'rule-number': args.rule_number,\n            layer: args.layer,\n    \
    \        enabled: args.enabled\n        };\n        result = sendRequest('set-access-rule',\
    \ JSON.stringify(body));\n        sendRequest('publish', '{}');\n    }\n    else{\n\
    \        logout();\n        throw 'Set rule requires at least one of the following\
    \ arguments - uid, name, rule_number';\n    }\n\n    var res =  JSON.parse(result.Body);\n\
    \    var md = tableToMarkdown('Set Rule', prettify_rule_data(res));\n    var context\
    \ = {CheckpointFWRule : jsonToEntity(res, entityDict.CheckpointFWRule)};\n\n \
    \   return {\n        Type: entryTypes.note,\n        Contents: result,\n    \
    \    ContentsFormat: formats.json,\n        HumanReadable: md,\n        EntryContext:\
    \ context\n    };\n}\n\n\nfunction delete_rule() {\n    var res;\n    if(args.uid\
    \ || args.name || args.rule_number){\n        var body = {\n            uid :\
    \ args.uid,\n            name: args.name,\n            'rule-number': args.rule_number,\n\
    \            layer: args.layer\n        };\n        res = sendRequest('delete-access-rule',\
    \ JSON.stringify(body));\n        sendRequest('publish', '{}');\n    }\n    else{\n\
    \        logout();\n        throw 'Delete rule requires at least one of the following\
    \ arguments - uid, name, rule_number';\n    }\n    return JSON.parse(res.Body);\n\
    }\n\n\nfunction show_access_rule_base() {\n    var result = sendRequest('show-access-rulebase',\
    \ JSON.stringify({name:args.name}));\n    var res = JSON.parse(result.Body);\n\
    \    var md = tableToMarkdown('Access rulebase table', prettify_rule_base(res.rulebase),\
    \ ['Rule Number', 'Name', 'UID', 'Action', 'Enabled', 'Content'])\n    var context\
    \ = {CheckpointFWRule : jsonToEntity(res.rulebase, entityDict.CheckpointFWRule)};\n\
    \    return {\n        Type: entryTypes.note,\n        Contents: res,\n      \
    \  ContentsFormat: formats.json,\n        HumanReadable: md,\n        EntryContext:\
    \ context\n    };\n}\n\n\nfunction checkpoint() {\n    var res;\n    var cmd =\
    \ args.command;\n    if(!cmd){\n        throw 'Missing API command name';\n  \
    \  }\n    delete args.command;\n    res = sendRequest(cmd, JSON.stringify(args));\n\
    \    sendRequest('publish', '{}');\n    return JSON.parse(res.Body);\n}\n\n//EXECUTION//\n\
    var answer;\nlogin();\nswitch (command) {\n    case 'test-module':\n        show_hosts();\n\
    \        logout();\n        return 'ok';\n    case 'checkpoint-block-ip':\n  \
    \      answer = block_ip();\n        break;\n    case 'checkpoint-show-hosts':\n\
    \        answer = show_hosts();\n        break;\n    case 'checkpoint-task-status':\n\
    \        answer = task_status();\n        break;\n    case 'checkpoint-show-access-rule-base':\n\
    \        answer = show_access_rule_base();\n        break;\n    case 'checkpoint-set-rule':\n\
    \        answer = set_rule();\n        break;\n    case 'checkpoint-delete-rule':\n\
    \        answer = delete_rule();\n        break;\n    case 'checkpoint':\n   \
    \    answer = checkpoint();\n        break;\n}\nlogout();\nreturn answer;"
  type: javascript
tests:
- CheckpointFW-test
toversion: 4.1.9
