category: Data Enrichment & Threat Intelligence
commonfields:
  id: MaxMind GeoIP2
  version: -1
configuration:
- defaultvalue: ''
  display: API Key
  name: apikey
  required: true
  type: 0
- defaultvalue: ''
  display: Account ID
  name: account
  required: true
  type: 0
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: city
  display: Service Version
  name: mode
  options:
  - country
  - city
  - insights
  required: true
  type: 15
- defaultvalue: https://geoip.maxmind.com/
  display: Base URL
  name: url
  required: true
  type: 0
description: Enriches IP addresses
display: MaxMind GeoIP2
name: MaxMind GeoIP2
script:
  commands:
  - arguments:
    - description: IP Address to be queried
      name: ip
      required: true
    description: Check IP reputation (when information is available, returns a JSON
      with details). Uses all configured Threat Intelligence feeds
    name: ip
    outputs:
    - contextPath: IP.Address
      description: The IP address
      type: string
    - contextPath: IP.Geo.Country
      description: The IP country
      type: string
    - contextPath: IP.Geo.Location
      description: The IP geographic location in coordinates
      type: string
    - contextPath: IP.ASN
      description: The IP ASN
      type: string
    - contextPath: MaxMind.Geo.TimeZone
      description: The time zone the IP is located
      type: string
    - contextPath: MaxMind.Geo.Accuracy
      description: The accuracy of the location
      type: number
    - contextPath: MaxMind.Geo.Continent
      description: The IP Continent
      type: string
    - contextPath: MaxMind.Geo.Subdivision
      description: The IP subdivision
      type: string
    - contextPath: MaxMind.Organization
      description: The IP organization
      type: string
    - contextPath: MaxMind.Tor
      description: Is IP a Tor exit node?
      type: boolean
    - contextPath: MaxMind.Host
      description: The IP host
      type: string
    - contextPath: MaxMind.Anonymous
      description: Is the IP anonymous?
      type: boolean
    - contextPath: MaxMind.UserType
      description: The IP user type
      type: string
    - contextPath: MaxMind.ISP
      description: The IP ISP
      type: string
    - contextPath: MaxMind.Domain
      description: The domain associated to the IP
      type: string
    - contextPath: MaxMind.ISO_Code
      description: ISO code for the country the IP is located
      type: string
    - contextPath: MaxMind.RegisteredCountry
      description: Country the IP is registered
      type: string
    - contextPath: MaxMind.City
      description: City the IP is located in
      type: string
  runonce: false
  script: ''
  subtype: python2
  type: python
tests:
- MaxMind Test
toversion: 4.1.9
