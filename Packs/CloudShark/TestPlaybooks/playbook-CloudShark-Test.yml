id: CloudShark - Test Playbook
inputs:
- description: ''
  key: File
  required: false
  value:
    simple: ${File.EntryID}
name: CloudShark - Test Playbook
outputs: []
starttaskid: '0'
tasks:
  '0':
    id: '0'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '17'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 89658211-3651-40bb-89f9-820a299ff30b
      iscommand: false
      name: ''
      version: -1
    taskid: 89658211-3651-40bb-89f9-820a299ff30b
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": -360\n  }\n}"
  '1':
    id: '1'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '2'
      - '3'
    note: false
    scriptarguments:
      additional_tags:
        simple: demisto,cloudshark,test
      file:
        simple: ${File.EntryID}
      filename:
        simple: demisto_integration_test.pcapng
    separatecontext: false
    task:
      brand: CloudShark
      description: Upload a capture file to CloudShark
      id: d3c88dfb-cf79-4445-89c0-e99bc38aece5
      iscommand: true
      name: cloudshark-upload
      script: CloudShark|||cloudshark-upload
      type: regular
      version: -1
    taskid: d3c88dfb-cf79-4445-89c0-e99bc38aece5
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 230\n  }\n}"
  '10':
    id: '10'
    ignoreworker: false
    nexttasks:
      'yes':
      - '9'
    note: false
    scriptarguments:
      value:
        simple: ${File}
    separatecontext: false
    task:
      brand: ''
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 52d55988-9e1d-44e4-8f33-fc4224cc1807
      iscommand: false
      name: Check  File Exists
      scriptName: Exists
      type: condition
      version: -1
    taskid: 52d55988-9e1d-44e4-8f33-fc4224cc1807
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 1050\n  }\n}"
  '11':
    id: '11'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '12'
    note: false
    scriptarguments:
      capture_id:
        simple: ${CloudShark.CaptureID}
      filename: {}
    separatecontext: false
    task:
      brand: CloudShark
      description: Retrieve meta-infomation of capture on CloudShark
      id: 91d6ab8a-30fb-4356-8fc8-0469c969ac10
      iscommand: true
      name: cloudshark-info
      script: CloudShark|||cloudshark-info
      type: regular
      version: -1
    taskid: 91d6ab8a-30fb-4356-8fc8-0469c969ac10
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 1430\n  }\n}"
  '12':
    id: '12'
    ignoreworker: false
    nexttasks:
      'yes':
      - '13'
    note: false
    scriptarguments:
      value:
        simple: ${CloudShark.CaptureInfo}
    separatecontext: false
    task:
      brand: ''
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 10e39b8b-b7ac-47e4-890b-94bae7a272e6
      iscommand: false
      name: Check Capture Info Exists
      scriptName: Exists
      type: condition
      version: -1
    taskid: 10e39b8b-b7ac-47e4-890b-94bae7a272e6
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 1610\n  }\n}"
  '13':
    id: '13'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '14'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 7a076e13-c043-4f37-86d3-5068e9fc010b
      iscommand: false
      name: CloudShark Delete
      type: title
      version: -1
    taskid: 7a076e13-c043-4f37-86d3-5068e9fc010b
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 1790\n  }\n}"
  '14':
    id: '14'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '15'
    note: false
    scriptarguments:
      capture_id:
        simple: ${CloudShark.CaptureID}
    separatecontext: false
    task:
      brand: CloudShark
      description: Delete capture file from CloudShark
      id: c84d6fa6-3f2c-4636-8f7b-9e94f8357bd7
      iscommand: true
      name: cloudshark-delete
      script: CloudShark|||cloudshark-delete
      type: regular
      version: -1
    taskid: c84d6fa6-3f2c-4636-8f7b-9e94f8357bd7
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 460,\n    \"y\": 1970\n  }\n}"
  '15':
    id: '15'
    ignoreworker: false
    nexttasks:
      'yes':
      - '16'
    note: false
    scriptarguments:
      value:
        simple: ${CloudShark.Result}
    separatecontext: false
    task:
      brand: ''
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 0b23c917-f209-4ea0-8490-53f7b5f8ae47
      iscommand: false
      name: Check Delete Result Exists
      scriptName: Exists
      type: condition
      version: -1
    taskid: 0b23c917-f209-4ea0-8490-53f7b5f8ae47
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 460,\n    \"y\": 2150\n  }\n}"
  '16':
    id: '16'
    ignoreworker: false
    note: false
    scriptarguments:
      assetid: {}
      closeNotes: {}
      closeReason: {}
      emailclassification: {}
      id:
        simple: ${incident.id}
      phishingsubtype: {}
    separatecontext: false
    task:
      brand: Builtin
      description: Close the current incident
      id: 9ce9beea-8d84-42d3-89dc-e169713bbaee
      iscommand: true
      name: closeInvestigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 9ce9beea-8d84-42d3-89dc-e169713bbaee
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 460,\n    \"y\": 2340\n  }\n}"
  '17':
    id: '17'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '5'
    note: false
    scriptarguments:
      body: {}
      filename:
        simple: capture.pcap
      headers: {}
      insecure: {}
      method:
        simple: GET
      password: {}
      proxy: {}
      saveAsFile:
        simple: 'yes'
      unsecure: {}
      url:
        simple: https://github.com/demisto/content/raw/master/TestData/TestPcapPost.pcap
      username: {}
    separatecontext: false
    task:
      brand: ''
      description: Sends http request. Returns the response as json.
      id: e428256d-7286-4f65-8cc0-b064edc66f9b
      iscommand: false
      name: Download Test PCAP
      scriptName: http
      type: regular
      version: -1
    taskid: e428256d-7286-4f65-8cc0-b064edc66f9b
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": -180\n  }\n}"
  '2':
    id: '2'
    ignoreworker: false
    nexttasks:
      'yes':
      - '6'
    note: false
    scriptarguments:
      value:
        simple: ${CloudShark.CaptureID}
    separatecontext: false
    task:
      brand: ''
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: f12eed24-fb82-4565-8153-c93dcaa7baa4
      iscommand: false
      name: Check Capture ID Exists
      scriptName: Exists
      type: condition
      version: -1
    taskid: f12eed24-fb82-4565-8153-c93dcaa7baa4
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 120,\n    \"y\": 430\n  }\n}"
  '3':
    id: '3'
    ignoreworker: false
    nexttasks:
      'yes':
      - '6'
    note: false
    scriptarguments:
      value:
        simple: ${URL.Data}
    separatecontext: false
    task:
      brand: ''
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 6661ea6f-ea95-4997-8042-077389806c7f
      iscommand: false
      name: Check URL Exists
      scriptName: Exists
      type: condition
      version: -1
    taskid: 6661ea6f-ea95-4997-8042-077389806c7f
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 780,\n    \"y\": 430\n  }\n}"
  '5':
    id: '5'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '1'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 8b5f2a6b-d1a9-4731-88f1-a1b2d92f3eda
      iscommand: false
      name: CloudShark Upload
      type: title
      version: -1
    taskid: 8b5f2a6b-d1a9-4731-88f1-a1b2d92f3eda
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 30\n  }\n}"
  '6':
    id: '6'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '7'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 010a4065-ebbd-42c6-87b7-6604521255ec
      iscommand: false
      name: CloudShark Download
      type: title
      version: -1
    taskid: 010a4065-ebbd-42c6-87b7-6604521255ec
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 680\n  }\n}"
  '7':
    id: '7'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '10'
    note: false
    scriptarguments:
      capture_id:
        simple: ${CloudShark.CaptureID}
    separatecontext: false
    task:
      brand: CloudShark
      description: Download a capture file from CloudShark
      id: 6cc07b81-765f-4da5-82ca-e932c70be3de
      iscommand: true
      name: cloudshark-download
      script: CloudShark|||cloudshark-download
      type: regular
      version: -1
    taskid: 6cc07b81-765f-4da5-82ca-e932c70be3de
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 860\n  }\n}"
  '9':
    id: '9'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '11'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 7ea53467-1762-4ea1-848b-deec6860306a
      iscommand: false
      name: CloudShark Info
      type: title
      version: -1
    taskid: 7ea53467-1762-4ea1-848b-deec6860306a
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 1260\n  }\n}"
toversion: 4.1.9
version: -1
view: "{\n  \"linkLabelsPosition\": {},\n  \"paper\": {\n    \"dimensions\": {\n \
  \     \"height\": 2795,\n      \"width\": 1040,\n      \"x\": 120,\n      \"y\"\
  : -360\n    }\n  }\n}"
