category: Data Enrichment & Threat Intelligence
commonfields:
  id: CloudShark
  version: -1
configuration:
- defaultvalue: ''
  display: CS Enterprise URL
  name: url
  required: true
  type: 0
- defaultvalue: ''
  display: API Token
  name: apikey
  required: true
  type: 4
- defaultvalue: 'false'
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- defaultvalue: 'false'
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
description: Use the CloudShark integration to upload, share, and collaborate on network
  packet capture files using your on-premises CS Enterprise system.
display: CloudShark
name: CloudShark
script:
  commands:
  - arguments:
    - description: Capture ID of the capture in CS Enterprise.
      name: capture_id
    description: Deletes a capture file from CS Enterprise.
    name: cloudshark-delete
    outputs:
    - contextPath: CloudShark.Result
      description: Result of the delete command.
  - arguments:
    - description: Capture ID of the capture in CS Enterprise.
      name: capture_id
    description: Downloads a capture file from CS Enterprise.
    name: cloudshark-download
    outputs:
    - contextPath: File
      description: The file downloaded from CS Enterprise
  - arguments:
    - description: Capture ID of the capture in CS Enterprise.
      name: capture_id
      required: true
    description: Retrieves meta-information about a capture file from CS Enterprise.
    name: cloudshark-info
    outputs:
    - contextPath: CloudShark.CaptureInfo.CaptureID
      description: Capture ID of the capture.
      type: string
    - contextPath: CloudShark.CaptureInfo.GroupWrite
      description: Group permission setting.
      type: boolean
    - contextPath: CloudShark.CaptureInfo.Size
      description: Size of the capture file.
      type: number
    - contextPath: CloudShark.CaptureInfo.DataByteRate
      description: Data byte rate.
      type: string
    - contextPath: CloudShark.CaptureInfo.TagList
      description: List of the capture file's tags.
      type: string
    - contextPath: CloudShark.CaptureInfo.DataBitRate
      description: Data bit rate
      type: string
    - contextPath: CloudShark.CaptureInfo.FileName
      description: Filename
      type: string
    - contextPath: CloudShark.CaptureInfo.SHA1
      description: SHA1 hash of the capture file.
      type: string
    - contextPath: CloudShark.CaptureInfo.AvgPacketRate
      description: Average packet rate.
      type: string
    - contextPath: CloudShark.CaptureInfo.StartTime
      description: Start time of the capture.
      type: date
    - contextPath: CloudShark.CaptureInfo.CreatedAt
      description: When the capture file was added.
      type: date
    - contextPath: CloudShark.CaptureInfo.AvgPacketSize
      description: Average packet size.
      type: string
    - contextPath: CloudShark.CaptureInfo.User
      description: Owner of the capture file.
      type: string
    - contextPath: CloudShark.CaptureInfo.LastAccessed
      description: When the capture was last accessed.
      type: date
    - contextPath: CloudShark.CaptureInfo.DisableAutodelete
      description: Whether autodelete is enabled or disabled.
      type: boolean
    - contextPath: CloudShark.CaptureInfo.CapFileID
      description: Capture file ID.
      type: number
    - contextPath: CloudShark.CaptureInfo.EndTime
      description: End time of the capture.
      type: date
    - contextPath: CloudShark.CaptureInfo.NumPackets
      description: Number of packets in the capture.
      type: number
    - contextPath: CloudShark.CaptureInfo.Encapsulation
      description: Encapsulation type.
      type: string
    - contextPath: CloudShark.CaptureInfo.Duration
      description: Duration of the capture.
      type: string
    - contextPath: CloudShark.CaptureInfo.Comments
      description: Comments for the capture.
      type: string
    - contextPath: CloudShark.CaptureInfo.Public
      description: Whether permission settings are public.
      type: boolean
    - contextPath: CloudShark.CaptureInfo.DataSize
      description: Size of data in the capture.
      type: number
    - contextPath: CloudShark.CaptureInfo.File
      description: Location of capture file on disk
      type: string
    - contextPath: CloudShark.CaptureInfo.FileType
      description: File type
      type: string
    - contextPath: CloudShark.CaptureInfo.FileSource
      description: Source of capture file
      type: string
    - contextPath: CloudShark.CaptureInfo.Truncated
      description: Whether the capture file is truncated.
      type: string
    - contextPath: CloudShark.CaptureInfo.Group
      description: Group with which the capture file is shared.
      type: string
  - arguments:
    - description: EntryID of the network capture file to upload.
      name: file
      required: true
    - description: A comma-separated list of tags to apply to the capture file.
      name: additional_tags
    - description: The filename of the capture in CS Enterprise.
      name: filename
    description: Uploads a capture file into CS Enterprise
    name: cloudshark-upload
    outputs:
    - contextPath: URL.Data
      description: URL of the capture file in CS Enterprise.
      type: string
    - contextPath: CloudShark.CaptureID
      description: Capture ID of the capture in CS Enterprise.
      type: string
  dockerimage: demisto/python3:3.7.3.286
  runonce: false
  script: ''
  subtype: python3
  type: python
tests:
- CloudShark - Test Playbook
toversion: 4.1.9
