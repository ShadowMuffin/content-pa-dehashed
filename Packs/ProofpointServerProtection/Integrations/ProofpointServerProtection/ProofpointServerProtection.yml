beta: true
category: Email Gateway
commonfields:
  id: Proofpoint Server Protection
  version: -1
configuration:
- defaultvalue: ''
  display: Server URL (e.g., https://192.168.0.1:10000)
  name: server
  required: true
  type: 0
- defaultvalue: ''
  display: Username
  name: credentials
  required: true
  type: 9
- display: Proofpoint Protection Server Version (e.g., 8.14.2)
  name: version
  required: false
  type: 0
- display: Trust any certificate (not secure)
  name: unsecure
  required: false
  type: 8
- display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Proofpoint email security appliance.
display: Proofpoint Protection Server (Beta)
name: Proofpoint Server Protection
script:
  commands:
  - arguments:
    - default: true
      description: Email message ID to download.
      name: message_id
      required: true
    description: Download quarantine email message by ID.
    name: proofpoint-download-email
  - arguments:
    - description: Folder name to quarantine.
      name: folder
    - description: Messages from sender to quarantine.
      name: sender
    - description: Messages subject to quarantine.
      name: subject
    - description: Messages to recipient to quarantine.
      name: recipient
    description: Retrieves quarantined email messages.
    name: proofpoint-quarantine-messages
    outputs:
    - contextPath: Proofpoint.Quarantine.Message.ID
      description: Message ID
      type: string
    - contextPath: Proofpoint.Quarantine.Message.Date
      description: Message date
      type: date
    - contextPath: Proofpoint.Quarantine.Message.Recipient
      description: Message recipient
      type: string
    - contextPath: Proofpoint.Quarantine.Message.Sender
      description: Message sender
      type: string
    - contextPath: Proofpoint.Quarantine.Message.Subject
      description: Message subject
      type: string
    - contextPath: Proofpoint.Quarantine.Message.Folder
      description: Message folder
      type: string
  - arguments:
    - description: Email sender.
      name: sender
    - description: Email recipient.
      name: recipient
    - description: Email subject.
      name: subject
    - auto: PREDEFINED
      defaultValue: '100'
      description: Max results
      name: process
      predefined:
      - '1'
      - '2'
      - '3'
      - '4'
      - '5'
      - '100'
      - '200'
      - '500'
      - '1000'
    - description: Sender hostname/IP address
      name: sender_hostname
    - description: Attachment name
      name: attachment
    - description: QID
      name: qid
    - auto: PREDEFINED
      defaultValue: Last24Hours
      description: Time period in which the email was recieved.
      name: time
      predefined:
      - Last15Minutes
      - Last60Minutes
      - Last3Hours
      - Last24Hours
      - Last7Days
      - Last15Days
      - Last30Days
      - Last90Days
    - description: Email message ID.
      name: message_id
    - description: Virus name.
      name: virus_name
    - description: SID
      name: sid
    - description: GUID
      name: guid
    description: Searches for emails.
    name: proofpoint-smart-search
    outputs:
    - contextPath: Proofpoint.SmartSearch.SMIMERecipients
      description: Search results SMIME recipients
      type: string
    - contextPath: Proofpoint.SmartSearch.FID
      description: Search results FID
      type: string
    - contextPath: Proofpoint.SmartSearch.MessageID
      description: Search results email message ID
      type: string
    - contextPath: Proofpoint.SmartSearch.Suborg
      description: Search results sub organization
      type: string
    - contextPath: Proofpoint.SmartSearch.Agent
      description: Search results email agent
      type: string
    - contextPath: Proofpoint.SmartSearch.AttachmentNames
      description: Search results email attachment names
      type: string
    - contextPath: Proofpoint.SmartSearch.MoudleID
      description: Search results module ID
      type: string
    - contextPath: Proofpoint.SmartSearch.MessageSize
      description: Search results email message size
      type: string
    - contextPath: Proofpoint.SmartSearch.SpamScore
      description: Search results email spam score
      type: string
    - contextPath: Proofpoint.SmartSearch.GUID
      description: Search results GUID
      type: string
    - contextPath: Proofpoint.SmartSearch.QuarantineRule
      description: Search results email message quarantine rule
      type: string
    - contextPath: Proofpoint.SmartSearch.VirusNames
      description: Search results virus names
      type: string
    - contextPath: Proofpoint.SmartSearch.Subject
      description: Search results email subject
      type: string
    - contextPath: Proofpoint.SmartSearch.QID
      description: Search results QID
      type: string
    - contextPath: Proofpoint.SmartSearch.FinalAction
      description: Search results email final action
      type: string
    - contextPath: Proofpoint.SmartSearch.DispositionAction
      description: Search results email disposition action
      type: string
    - contextPath: Proofpoint.SmartSearch.SID
      description: Search results SID
      type: string
    - contextPath: Proofpoint.SmartSearch.SendmailToStat
      description: Search results sent email to stats
      type: string
    - contextPath: Proofpoint.SmartSearch.Date
      description: Search results date
      type: date
    - contextPath: Proofpoint.SmartSearch.PERecipients
      description: Search results email PE recipients
      type: string
    - contextPath: Proofpoint.SmartSearch.FQIN
      description: Search results email FQIN
      type: string
    - contextPath: Proofpoint.SmartSearch.FinalRule
      description: Search results email final rule
      type: string
    - contextPath: Proofpoint.SmartSearch.SendmailStat
      description: Search results email stats
      type: string
    - contextPath: Proofpoint.SmartSearch.MessageSplit
      description: Search results email split message
      type: string
    - contextPath: Proofpoint.SmartSearch.Duration
      description: Search results duration time
      type: string
    - contextPath: Proofpoint.SmartSearch.SendmailAction
      description: Search results sent mail action
      type: string
    - contextPath: Proofpoint.SmartSearch.Sender
      description: Search results email sender
      type: string
    - contextPath: Proofpoint.SmartSearch.SendmailIPAddress
      description: Search results send mail IP address
      type: string
    - contextPath: Proofpoint.SmartSearch.SendmailTo
      description: Search results send mail to
      type: string
    - contextPath: Proofpoint.SmartSearch.Recipients
      description: Search results recipients
      type: string
    - contextPath: Proofpoint.SmartSearch.SendmailRawLog
      description: Search results send mail raw log
      type: string
    - contextPath: Proofpoint.SmartSearch.TLS
      description: Search results TLS
      type: string
    - contextPath: Proofpoint.SmartSearch.QuarantineFolder
      description: Search results quarantine folder
      type: string
    - contextPath: Proofpoint.SmartSearch.RawLog
      description: Search results raw log
      type: string
    - contextPath: Proofpoint.SmartSearch.DispositionSmtpProfile
      description: Search results disposition SMTP profile
      type: string
    - contextPath: Proofpoint.SmartSearch.PolicyRoutes
      description: Search results policy routes
      type: string
    - contextPath: Proofpoint.SmartSearch.MessageEncrypted
      description: Search results encrypted message
      type: string
    - contextPath: Proofpoint.SmartSearch.SenderHost
      description: Search results sender hosr
      type: string
    - contextPath: Proofpoint.SmartSearch.SMIMRecipientsSigned
      description: Search results SMIME recipient signed
      type: string
  - arguments: []
    description: Returns a list of quarantined folders.
    name: proofpoint-quarantine-folders
    outputs:
    - contextPath: Proofpoint.Quarantine.Folder.Name
      description: Folder name
      type: string
  - arguments:
    - description: Email message ID to release.
      name: message_id
      required: true
    - description: Email folder to release.
      name: folder
      required: true
    description: Release email with virus scan
    name: proofpoint-release-email
  - arguments:
    - description: Email to add to blocked senders list
      name: email
      required: true
    description: Adds an email address to blocked senders list.
    name: proofpoint-add-to-blocked-senders-list
  - arguments:
    - description: Email to add to safe senders list
      name: email
      required: true
    description: Adds an email address to safe senders list.
    name: proofpoint-add-to-safe-senders-list
  - arguments:
    - description: Email to remove from blocked senders list
      name: email
      required: true
    description: Removes an email address from blocked senders list.
    name: proofpoint-remove-from-blocked-senders-list
  - arguments:
    - description: Email to remove from safe senders list
      name: email
      required: true
    description: Removes an email address from safe senders list.
    name: proofpoint-remove-from-safe-senders-list
  dockerimage: demisto/bs4:1.0.0.8854
  runonce: false
  script: ''
  subtype: python2
  type: python
tests:
- no test
toversion: 4.1.9
