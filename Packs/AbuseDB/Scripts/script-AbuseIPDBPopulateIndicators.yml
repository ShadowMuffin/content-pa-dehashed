args:
- defaultValue: '30'
  description: Time range to return reports for (in days), default is 30
  name: days
- defaultValue: '200'
  description: 'Maximum number of IPs to retrieve, default is 50 '
  name: limit
comment: Extracts blacklisted IP addresses from AbuseIPDB, and Populates Indicators
  accordingly.
commonfields:
  id: AbuseIPDBPopulateIndicators
  version: -1
dependson:
  must:
  - '|||abuseipdb-get-blacklist'
  - Builtin|||createNewIndicator
enabled: true
name: AbuseIPDBPopulateIndicators
runas: DBotWeakRole
runonce: false
script: "BLACKLISTED = \"Bad\"\nres = demisto.executeCommand(\"abuseipdb-get-blacklist\"\
  , {\n    \"days\" : demisto.args().get(\"days\"),\n    \"limit\" : demisto.args().get(\"\
  limit\")\n})\nips = res[0]['Contents']\n\nif not ips or \"Too many requests\" in\
  \ ips:\n    return_error(\"No Indicators were created (possibly bad API key)\")\n\
  \n# Extract IPs into new Indicators\nfor ip in ips:\n    demisto.executeCommand(\"\
  createNewIndicator\", {\n        \"type\" : 'ip',\n        \"value\" : ip,\n   \
  \     \"source\" : 'AbuseIPDB',\n        \"reputation\" : BLACKLISTED,\n       \
  \ \"seenNow\" : \"true\",\n    });\n\ndemisto.results(\"All Indicators were created\
  \ successfully\")"
scripttarget: 0
subtype: python2
tags: []
tests:
- AbuseIPDB PopulateIndicators Test
timeout: 900ns
toversion: 4.1.9
type: python
