args:
- description: Show more detailed output
  name: verbose
comment: List Carbon Black sessions
commonfields:
  id: CBSessions
  version: -1
dependson:
  must:
  - cb-list-sessions
name: CBSessions
script: "//Show a list of carbon black sessions.\n//Argument: Verbose = true, to show\
  \ all properties.\nvar output = [];\nvar entries = executeCommand(\"cb-list-sessions\"\
  , {});\nvar array = entries[0].Contents;\nvar outTable = [];\nfor (var index in\
  \ array) {\n    var item = array[index];\n    var outItem = {};\n    if (args.verbose\
  \ === \"true\") {\n        for (var name in item) {\n            var value = item[name];\n\
  \            if (typeof (value) !== \"object\") {\n                outItem[name]\
  \ = value;\n            }\n        }\n    } else {\n        outItem[\"status\"]\
  \ = item[\"status\"];\n        outItem[\"id\"] = item[\"id\"];\n        outItem[\"\
  sensor\"]=item[\"sensor_id\"];\n    }\n    outTable.push(outItem);\n}\noutput.push({ContentsFormat:\
  \ formats.table, Type: entryTypes.note, Contents: outTable});\nreturn output;"
scripttarget: 0
system: true
tags:
- carbon-black
- endpoint
timeout: 0s
toversion: 4.1.9
type: javascript
