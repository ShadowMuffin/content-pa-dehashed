contentitemexportablefields:
  contentitemfields:
    propagationLabels:
    - all
elasticcommonfields: {}
id: ParseEmailFiles-test
inputs: []
name: ParseEmailFiles-test
outputs: []
starttaskid: '0'
tasks:
  '0':
    id: '0'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '1'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      elasticcommonfields: {}
      id: 09df6d36-e6fe-40a1-bf53-2bed8fb5e836
      iscommand: false
      name: ''
      version: -1
    taskid: 09df6d36-e6fe-40a1-bf53-2bed8fb5e836
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": -590\n  }\n}"
  '1':
    id: '1'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '19'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      key: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      elasticcommonfields: {}
      id: 7381a945-8c3c-41b1-94a4-4485e21ca7cb
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 7381a945-8c3c-41b1-94a4-4485e21ca7cb
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": -450\n  }\n}"
  '11':
    id: '11'
    ignoreworker: false
    nexttasks:
      'yes':
      - '12'
    note: false
    quietmode: 0
    results:
    - AreValuesEqual
    scriptarguments:
      left:
        complex:
          accessor: MD5
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: pdf
          root: File
      right:
        simple: 9060c2d4f48745de19a5690d8e6cabe1
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      elasticcommonfields: {}
      id: d8273a10-7918-4414-812a-8fa34aec2dc2
      iscommand: false
      name: AreValuesEqual - verify pdf attachment
      scriptName: AreValuesEqual
      type: condition
      version: -1
    taskid: d8273a10-7918-4414-812a-8fa34aec2dc2
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 1213,\n    \"y\": 769\n  }\n}"
  '12':
    id: '12'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '15'
      - '16'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      elasticcommonfields: {}
      id: 14eaef4a-e640-4f48-9fdc-eff9ef04e83b
      iscommand: false
      name: Validate Non-Unicode parsing
      type: title
      version: -1
    taskid: 14eaef4a-e640-4f48-9fdc-eff9ef04e83b
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 400,\n    \"y\": 1107\n  }\n}"
  '13':
    id: '13'
    ignoreworker: false
    nexttasks:
      'yes':
      - '12'
    note: false
    quietmode: 0
    results:
    - AreValuesEqual
    scriptarguments:
      left:
        complex:
          accessor: MD5
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Extension
              operator: isEqualString
              right:
                value:
                  simple: docx
          root: File
      right:
        simple: b842aa8664f41a2dd7fe0d47a9fd4724
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Check whether the values provided in arguments are equal. If either
        of the arguments are missing, no is returned.
      elasticcommonfields: {}
      id: 51076fa9-c71e-4298-b024-387a844613f5
      iscommand: false
      name: AreValuesEqual - verify docx attachment
      scriptName: AreValuesEqual
      type: condition
      version: -1
    taskid: 51076fa9-c71e-4298-b024-387a844613f5
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 780,\n    \"y\": 769\n  }\n}"
  '14':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Email.From
          operator: containsGeneral
          right:
            value:
              simple: shachar@demisto.com
      label: 'yes'
    id: '14'
    ignoreworker: false
    nexttasks:
      'yes':
      - '12'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      elasticcommonfields: {}
      id: eeb3b83a-f91e-46e1-b287-769f05052b8d
      iscommand: false
      name: VerifyContext - From
      type: condition
      version: -1
    taskid: eeb3b83a-f91e-46e1-b287-769f05052b8d
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": -558,\n    \"y\": 769\n  }\n}"
  '15':
    id: '15'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '18'
    note: false
    quietmode: 0
    scriptarguments:
      body: {}
      filename:
        simple: EmailWithNonAsciiSubject.eml
      headers: {}
      insecure: {}
      method:
        simple: GET
      password: {}
      proxy: {}
      saveAsFile:
        simple: 'yes'
      unsecure: {}
      url:
        simple: https://github.com/demisto/content/raw/master/TestData/EmailWithNonAsciiSubject.eml
      username: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      elasticcommonfields: {}
      id: ce5c0ae8-3607-4bbd-b58d-6aab0a411457
      iscommand: false
      name: Non Unicode Subject
      scriptName: http
      type: regular
      version: -1
    taskid: ce5c0ae8-3607-4bbd-b58d-6aab0a411457
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 400,\n    \"y\": 1280\n  }\n}"
  '16':
    id: '16'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '17'
    note: false
    quietmode: 0
    scriptarguments:
      body: {}
      filename:
        simple: EmailWithNonAsciiAttachmentName.eml
      headers: {}
      insecure: {}
      method:
        simple: GET
      password: {}
      proxy: {}
      saveAsFile:
        simple: 'yes'
      unsecure: {}
      url:
        simple: https://github.com/demisto/content/raw/master/TestData/EmailWithNonAsciiAttachmentName.eml
      username: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      elasticcommonfields: {}
      id: 6d001256-2782-4613-bda2-8d71993f16b6
      iscommand: false
      name: Non Unicode Attachment Name
      scriptName: http
      type: regular
      version: -1
    taskid: 6d001256-2782-4613-bda2-8d71993f16b6
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 880,\n    \"y\": 1280\n  }\n}"
  '17':
    id: '17'
    ignoreworker: false
    note: false
    quietmode: 0
    results:
    - AttachmentName
    scriptarguments:
      entryid:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: EmailWithNonAsciiAttachmentName.eml
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Parse an email from an eml or msg file and populate all relevant
        context data to investigate the email. Also extracts inner attachments and
        returns them to the war room. The incident labels themselves are preserved
        and not modified - only the "Label/x" context items that originated from the
        labels, and the best practice is to rely on these for the remainder of the
        playbook. Requires pip and access to python repository to install "olefile"
        package.
      elasticcommonfields: {}
      id: d3f60ede-0ba2-4cb2-82a4-379c5c1f2fc3
      iscommand: false
      name: ParseEmailFiles
      scriptName: ParseEmailFiles
      type: regular
      version: -1
    taskid: d3f60ede-0ba2-4cb2-82a4-379c5c1f2fc3
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 880,\n    \"y\": 1470\n  }\n}"
  '18':
    id: '18'
    ignoreworker: false
    note: false
    quietmode: 0
    results:
    - AttachmentName
    scriptarguments:
      entryid:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: EmailWithNonAsciiSubject.eml
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Parse an email from an eml or msg file and populate all relevant
        context data to investigate the email. Also extracts inner attachments and
        returns them to the war room. The incident labels themselves are preserved
        and not modified - only the "Label/x" context items that originated from the
        labels, and the best practice is to rely on these for the remainder of the
        playbook. Requires pip and access to python repository to install "olefile"
        package.
      elasticcommonfields: {}
      id: 2405e94d-168b-407e-8bd2-7fa706812a70
      iscommand: false
      name: ParseEmailFiles
      scriptName: ParseEmailFiles
      type: regular
      version: -1
    taskid: 2405e94d-168b-407e-8bd2-7fa706812a70
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 430,\n    \"y\": 1470\n  }\n}"
  '19':
    id: '19'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '20'
    note: false
    quietmode: 0
    scriptarguments:
      body: {}
      filename:
        simple: ParseEmailFiles_test_email.eml
      headers: {}
      insecure: {}
      method:
        simple: GET
      password: {}
      proxy: {}
      saveAsFile:
        simple: 'yes'
      unsecure: {}
      url:
        simple: https://raw.githubusercontent.com/demisto/content/master/TestData/no_content_type.eml
      username: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Sends http request. Returns the response as json.
      elasticcommonfields: {}
      id: fbdbe706-ef6c-4680-98a3-467885925628
      iscommand: false
      name: http (No Content Type)
      scriptName: http
      type: regular
      version: -1
    taskid: fbdbe706-ef6c-4680-98a3-467885925628
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": -270\n  }\n}"
  '2':
    id: '2'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '3'
    note: false
    quietmode: 0
    scriptarguments:
      body: {}
      filename:
        simple: ParseEmailFiles_test_email.eml
      headers: {}
      insecure: {}
      method:
        simple: GET
      password: {}
      proxy: {}
      saveAsFile:
        simple: 'yes'
      unsecure: {}
      url:
        simple: https://raw.githubusercontent.com/demisto/content/master/TestData/ParseEmailFiles_test_email.eml
      username: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Sends http request. Returns the response as json.
      elasticcommonfields: {}
      id: 5f589e03-1a0f-4ffe-adec-5876e4775538
      iscommand: false
      name: http
      scriptName: http
      type: regular
      version: -1
    taskid: 5f589e03-1a0f-4ffe-adec-5876e4775538
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 410\n  }\n}"
  '20':
    id: '20'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '22'
    note: false
    quietmode: 0
    results:
    - AttachmentName
    scriptarguments:
      entryid:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: ParseEmailFiles_test_email.eml
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
      max_depth: {}
      parse_only_headers: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Parse an email from an eml or msg file and populate all relevant
        context data to investigate the email. Also extracts inner attachments and
        returns them to the war room. The incident labels themselves are preserved
        and not modified - only the "Label/x" context items that originated from the
        labels, and the best practice is to rely on these for the remainder of the
        playbook. Requires pip and access to python repository to install "olefile"
        package.
      elasticcommonfields: {}
      id: 7e05848f-0995-4d02-8bc7-bb75f6405d1f
      iscommand: false
      name: ParseEmailFiles With No Content Type
      scriptName: ParseEmailFiles
      type: regular
      version: -1
    taskid: 7e05848f-0995-4d02-8bc7-bb75f6405d1f
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": -100\n  }\n}"
  '21':
    id: '21'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '2'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      key: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      elasticcommonfields: {}
      id: 10f32685-6df8-4cdc-a3e7-a1989ce0aada
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 10f32685-6df8-4cdc-a3e7-a1989ce0aada
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 245\n  }\n}"
  '22':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Email.Headers.value
          operator: isEqualString
          right:
            value:
              simple: '"woo@demisto.com" <woo@demisto.com>'
      - - left:
            iscontext: true
            value:
              simple: Email.Headers.value
          operator: isEqualString
          right:
            value:
              simple: '"Demisto Dbot" <woo@demisto.com>'
      - - left:
            iscontext: true
            value:
              simple: Email.Headers.value
          operator: isEqualString
          right:
            value:
              simple: from prod.outlook.com
      label: 'yes'
    id: '22'
    ignoreworker: false
    nexttasks:
      'yes':
      - '21'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      elasticcommonfields: {}
      id: e69e1657-20f4-4ee1-924c-e0ead483b145
      iscommand: false
      name: Verify Headers
      type: condition
      version: -1
    taskid: e69e1657-20f4-4ee1-924c-e0ead483b145
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 60\n  }\n}"
  '3':
    id: '3'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '4'
      - '8'
      - '11'
      - '13'
      - '14'
    note: false
    quietmode: 0
    results:
    - AttachmentName
    scriptarguments:
      entryid:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.Name
              operator: isEqualString
              right:
                value:
                  simple: ParseEmailFiles_test_email.eml
          root: File
          transformers:
          - args:
              field:
                value:
                  simple: EntryID
            operator: getField
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Parse an email from an eml or msg file and populate all relevant
        context data to investigate the email. Also extracts inner attachments and
        returns them to the war room. The incident labels themselves are preserved
        and not modified - only the "Label/x" context items that originated from the
        labels, and the best practice is to rely on these for the remainder of the
        playbook. Requires pip and access to python repository to install "olefile"
        package.
      elasticcommonfields: {}
      id: 2ad26187-6981-4269-a49b-0199f03bcf27
      iscommand: false
      name: ParseEmailFiles
      scriptName: ParseEmailFiles
      type: regular
      version: -1
    taskid: 2ad26187-6981-4269-a49b-0199f03bcf27
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 450,\n    \"y\": 590\n  }\n}"
  '4':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Email.To
          operator: containsGeneral
          right:
            value:
              simple: shachar@demisto.com, yaakovi@demisto.com
      label: 'yes'
    id: '4'
    ignoreworker: false
    nexttasks:
      'yes':
      - '12'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      elasticcommonfields: {}
      id: 22f26baf-4a07-4352-88d8-eae1809982b1
      iscommand: false
      name: VerifyContext - To
      type: condition
      version: -1
    taskid: 22f26baf-4a07-4352-88d8-eae1809982b1
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 352,\n    \"y\": 769\n  }\n}"
  '8':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Email.Subject
          operator: containsGeneral
          right:
            value:
              simple: ParseEmail test email
      label: 'yes'
    id: '8'
    ignoreworker: false
    nexttasks:
      'yes':
      - '12'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      elasticcommonfields: {}
      id: 65a3c21b-82dd-4698-863b-c819a9b193e5
      iscommand: false
      name: VerifyContext - Subject
      type: condition
      version: -1
    taskid: 65a3c21b-82dd-4698-863b-c819a9b193e5
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": -120,\n    \"y\": 769\n  }\n}"
toversion: 4.1.9
version: -1
view: "{\n  \"linkLabelsPosition\": {},\n  \"paper\": {\n    \"dimensions\": {\n \
  \     \"height\": 2155,\n      \"width\": 2151,\n      \"x\": -558,\n      \"y\"\
  : -590\n    }\n  }\n}"
