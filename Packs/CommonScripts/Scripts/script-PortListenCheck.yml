args:
- description: hostname to check
  name: host
  required: true
- description: port to check
  name: port
comment: Checks whether a port was open on given host
commonfields:
  id: PortListenCheck
  version: -1
enabled: true
name: PortListenCheck
outputs:
- contextPath: portOpen
  description: Returns true if given port on host was open
  type: boolean
script: "import socket\nsock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)\n\
  port = int(demisto.args()[\"port\"])\nhost = demisto.args()[\"host\"]\nresult =\
  \ sock.connect_ex((host,port))\nopenPort = False\nif result == 0:\n   resp = \"\
  Port \"+str(port)+\" is open on host:\"+host\n   openPort = True\nelse:\n   resp\
  \ = \"Port \"+str(port)+\" is not open on host:\"+host\n\ndemisto.results({'Type'\
  \ : entryTypes['note'],\n    'Contents': resp,\n    'ContentsFormat' : formats['json'],\n\
  \    'HumanReadable': resp,\n    'ReadableContentsFormat' : formats['markdown'],\n\
  \    'EntryContext' : {\"portOpen\":openPort}})"
scripttarget: 0
subtype: python2
tags: []
toversion: 4.1.9
type: python
