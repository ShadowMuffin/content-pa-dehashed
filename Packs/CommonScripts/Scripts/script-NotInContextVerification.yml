args:
- default: true
  description: Command or Automation script to execute each while loop iteration
  name: cmdToRun
  required: true
- description: 'comma separated list of command/automation arguments and values to
    run: key=val,key=val,key=val'
  name: cmdArguments
  required: true
- description: watch this key, if it is equal to value argument (${key}==value) then
    exit while loop, otherwise continue to next loop iteration (will run command again)
  name: keyToWatch
  required: true
comment: "Not in context verification is a script that executes the given command\
  \ and verifies that the specified field is not in the context after execution. \n"
commonfields:
  id: NotInContextVerification
  version: -1
enabled: true
name: NotInContextVerification
script: "var val = invContext.keyToWatch;\nvar argumentsVal = args.cmdArguments;\n\
  var argsArr = argumentsVal.split(\",\");\n\nvar argsToCmd = {};\nfor (i = 0; i <\
  \ argsArr.length ; i++) {\n    var keyval = argsArr[i].split(\"=\");\n    if (keyval.length\
  \ == 2) {\n        argsToCmd[keyval[0].trim()] = keyval[1];\n    }\n}\n\nvar entry\
  \ = executeCommand(args.cmdToRun, argsToCmd);\nif(!entry[0].EntryContext[args.keyToWatch]){\n\
  \    return entry;\n}\nelse{\n    throw args.keyToWatch + ' in context is not empty';\n\
  }\n\n\n"
scripttarget: 0
tags:
- Utility
timeout: 900ns
toversion: 4.1.9
type: javascript
