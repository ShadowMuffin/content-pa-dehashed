args:
- default: true
  description: Entry ID to get the comments from
  name: entryId
  required: true
- description: Context key to store comments into
  name: contextKey
  required: true
- description: If value is list - provide list seperator
  name: listSeperator
comment: "Takes the comments of a given entry ID and stores them in the incident context,\
  \ under a provided context key. \nFor accessing the last executed task's comments,\
  \ provide ${lastCompletedTaskEntries.[0]} as the value for the entryId input parameter."
commonfields:
  id: commentsToContext
  version: -1
enabled: true
name: commentsToContext
script: "var entry = executeCommand(\"getEntry\", {\"id\":args.entryId});\nvar key=args.contextKey;\n\
  var comments=entry[0].Contents;\n\nvar md =  'Comments set to context - '+key+':'\
  \ + comments + '\\n';\nvar ec={};\nif (args.listSeperator) {\n    ec[key]=[];\n\
  \    var list = comments.split(args.listSeperator);\n    for (var i=0;i<list.length;i++)\
  \ {\n        ec[key].push(list[i].trim());\n    }\n} else {\n    ec[key]=comments;\n\
  }\n\nreturn {Type: entryTypes.note, Contents: entry, ContentsFormat: formats.json,\
  \ HumanReadable: md, EntryContext: ec};"
scripttarget: 0
tags:
- Utility
toversion: 4.1.9
type: javascript
