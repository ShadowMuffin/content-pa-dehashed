args:
- description: IP addresses to exclude (separated by commas)
  name: excludedIps
comment: Gets all IP addresses in context, excluding ones given.
commonfields:
  id: ContextGetIps
  version: -1
enabled: true
name: ContextGetIps
script: "var excludedIps;\nif (args.excludedIps) {\n    excludedIps = args.excludedIps.split(',');\n\
  }\nvar flat = {};\nvar res = [];\nvar currentValue;\nflattenFields(invContext,undefined,flat);\n\
  keysArr = Object.keys(flat);\nfor (var i = 0; i < keysArr.length; i++) {\n    currentValue=flat[keysArr[i]];\n\
  \    if (ipRegex.test(currentValue) && res.indexOf(currentValue) === -1) {\n   \
  \     if (excludedIps) {\n            if (excludedIps.indexOf(currentValue) ===\
  \ -1) {\n                res.push(currentValue);\n            }\n        } else\
  \ {\n            res.push(currentValue);\n        }\n    }\n}\n\nvar md = '### IP\
  \ addresses in context\\n';\nfor (var i = 0; i<res.length; i++) {\n    md += '-\
  \ ' + res[i] + '\\n';\n}\nreturn {\n        Type: entryTypes.note,\n        Contents:\
  \ res,\n        ContentsFormat: formats.json,\n        HumanReadable: md\n     \
  \   };\n\n"
scripttarget: 0
tags: []
toversion: 4.1.9
type: javascript
