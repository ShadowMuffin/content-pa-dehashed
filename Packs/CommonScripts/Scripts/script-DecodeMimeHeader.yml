args:
- description: The header value to decode.
  name: value
comment: Decode MIME base64 headers.
commonfields:
  id: DecodeMimeHeader
  version: -1
dockerimage: demisto/python:2.7.17.3066
dockerimage45: null
enabled: true
name: DecodeMimeHeader
outputs:
- contextPath: DecodedMimeHeader
  description: The result of decoded value.
  type: string
runonce: false
script: "from email.header import decode_header\n\ndef decode(s):\n    dh = decode_header(s.strip())\n\
  \    default_charset = 'ASCII'\n    res = ''.join([ unicode(t[0], t[1] or default_charset)\
  \ for t in dh ])\n    return res\n\ns = demisto.args()['value']\n\nif s.startswith('\"\
  '):\n    s = s[1:]\n\nif s.endswith('\"'):\n    s = s[:-1]\n\nlines = []\nfor line\
  \ in  s.split(\"\\n\"):\n    try:\n        lines.append(decode(line))\n    except\
  \ Exception:\n        lines.append(line)\n\n\nres = \"\\n\".join(lines)\nresult\
  \ = res.encode('utf-8')\ndemisto.results({'ContentsFormat': formats['text'],\n \
  \                      'Type': entryTypes['note'],\n                       'Contents':\
  \ result,\n                       'EntryContext': {'DecodedMimeHeader': result}\n\
  })"
scripttarget: 0
subtype: python2
tags: []
toversion: 4.1.9
type: python
