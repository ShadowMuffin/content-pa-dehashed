args:
- defaultValue: Investigation Summary
  description: Name of the report to generate.
  name: name
- defaultValue: pdf
  description: Report type to generate.
  name: type
- description: Incident IDs for which to generate.
  isArray: true
  name: ids
  required: true
comment: Generate report summaries for the passed incidents.
commonfields:
  id: GenerateSummaryReports
  version: -1
enabled: true
fromversion: 4.1.0
name: GenerateSummaryReports
outputs:
- contextPath: SummaryReports.IncidentID
  description: Incident ID of each generated report.
  type: number
- contextPath: SummaryReports.ReportName
  description: The report name.
  type: string
- contextPath: SummaryReports.File
  description: File name of the report file.
  type: string
- contextPath: SummaryReports.FileID
  description: File ID of the generated report.
  type: string
runas: DBotWeakRole
runonce: false
script: "var res = [];\nvar ids = argToList(args.ids);\nif(!Array.isArray(ids)) {\n\
  \    ids = [ids]; //single element case\n}\nids = ids.filter(function(value, index,\
  \ self) { // make sure array is unique\n    return self.indexOf(value) === index;\n\
  });\nvar ec = {SummaryReports: []};\nids.forEach(function(id) {\n    var reportEntries\
  \ =  executeCommand(\"generateSummaryReport\", {name: args.name, type: args.type,\
  \ incidentId: id});\n    res = res.concat(reportEntries);\n    if(reportEntries[0]\
  \ && reportEntries[0].File) {\n        ec.SummaryReports.push({IncidentID: id, ReportName:\
  \ args.name, File: reportEntries[0].File, FileID: reportEntries[0].FileID})\n  \
  \  }\n    wait(1); //required to avoid generated file name conflicts\n});\nif(ec.SummaryReports.length\
  \ > 0) {\n    res.push({\n        Type: entryTypes.note,\n        Contents: ec,\n\
  \        ContentsFormat: formats.json,\n        HumanReadable: tableToMarkdown(\"\
  Summary Reports\", ec.SummaryReports),\n        EntryContext: ec\n    });\n}\nreturn\
  \ res;\n"
scripttarget: 0
tags:
- Utility
tests:
- Send Investigation Summary Reports - Test
toversion: 4.1.9
type: javascript
