args:
- default: true
  description: URL to resolve
  name: url
  required: true
comment: Resolve the original URL from the given shortened URL and place it in both
  as output and in the context of a playbook. (https://unshorten.me/api)
commonfields:
  id: ResolveShortenedURL
  version: -1
enabled: true
name: ResolveShortenedURL
outputs:
- contextPath: URL.Data
  description: Shortened URL
script: "import urllib2\nimport re\n\nheaders = {\n    'User-Agent': 'Mozilla/5.0\
  \ (X11; Linux x86_64) AppleWebKit/537.11 (KHTML, like Gecko) Chrome/23.0.1271.64\
  \ Safari/537.11',\n    'Accept': 'text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8',\n\
  \    'Accept-Charset': 'ISO-8859-1,utf-8;q=0.7,*;q=0.3',\n    'Accept-Encoding':\
  \ 'none',\n    'Accept-Language': 'en-US,en;q=0.8',\n    'Connection': 'keep-alive'\n\
  }\n\nurl = demisto.args()['url']\n\nreq = urllib2.Request('https://unshorten.me/json/'+url,\
  \ headers=headers)\npage = urllib2.urlopen(req)\ncontent = json.loads(page.read())\n\
  if content['success'] == True:\n    resolvedUrl = content['resolved_url']\n    shortenedUrl\
  \ = content['requested_url']\n    usageCount = content['usage_count']\n    ec =\
  \ {};\n    ec['URL.Data'] = [resolvedUrl]\n    demisto.results({\n      'Type':\
  \ entryTypes['note'],\n      'Contents': [resolvedUrl],\n      'ContentsFormat':\
  \ formats['json'],\n      'HumanReadable': tableToMarkdown('Shorten URL results',\
  \ [{\n          'Shortened URL': shortenedUrl,\n          'Resolved URL': resolvedUrl,\n\
  \          'Usage count': usageCount\n      }]),\n      'EntryContext': ec\n   \
  \ })\nelse:\n    demisto.results('Provided URL could not be un-shortened')\n"
scripttarget: 0
subtype: python2
tags:
- Utility
tests:
- No test
toversion: 4.1.9
type: python
