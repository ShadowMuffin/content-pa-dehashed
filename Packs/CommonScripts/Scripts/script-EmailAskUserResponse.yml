args:
- default: true
  description: Entry ID where EmailAskUser will complete when user replies
  name: responseEntryId
  required: true
comment: Extract user's response from EmailAskUser reply. Returns the first textual
  response line of the provided entry that contains the reply body. Use ${lastCompletedTaskEntries}
  to analyze the previous playbook task containing the user's reply.
commonfields:
  id: EmailAskUserResponse
  version: -1
enabled: true
name: EmailAskUserResponse
script: "var res = executeCommand(\"getEntry\", {\"id\":args.responseEntryId});\n\n\
  if (res[0].Type==entryTypes.note) {\n    text = res[0].Contents;\n    text = text.replace(/<br\\\
  /?>/gi,'\\n')\n                .replace(/\\n/g,'__NL__')\n                .replace(/<script\
  \ .+?<\\/script>/g,'')\n                .replace(/<style .+?<\\/style>/g,'')\n \
  \               .replace(/__NL____NL__/g,'')\n                .replace(/__NL__/g,'\\\
  n');\n    response = text.replace(/<(?:.|\\n)*?>/gm, '').trim(\"\\n\").split(\"\\\
  n\")[0].trim();\n    setContext('EmailAskUserResponse', response);\n    return response;\n\
  } else {\n    return res;\n}\n"
scripttarget: 0
tags:
- Condition
toversion: 4.1.9
type: javascript
