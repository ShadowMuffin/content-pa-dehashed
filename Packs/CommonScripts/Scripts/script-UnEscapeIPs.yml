args:
- description: ip(s) to unescape
  isArray: true
  name: input
comment: 'Remove escaping chars from IP

  127[.]0[.]0[.]1 -> 127.0.0.1'
commonfields:
  id: UnEscapeIPs
  version: -1
enabled: true
name: UnEscapeIPs
runas: DBotWeakRole
runonce: false
script: "function format_ip(ip) {\n    return ip.replace(/\\[\\.\\]/g,'.');\n}\n\n\
  function format_ip_list(ip_list) {\n    var len = ip_list.length;\n    var formatted_ips\
  \ = new Array(len);\n    ip_list.forEach(function(the_ip, index) {\n        formatted_ips[index]\
  \ = format_ip(the_ip.trim());\n    });\n    return formatted_ips;\n}\n\nvar ips;\n\
  // It is assumed that args.input is a string\nvar unformatted_ips = argToList(args.input);\n\
  ips = format_ip_list(unformatted_ips);\nreturn ips;"
scripttarget: 0
tags:
- indicator-format
tests:
- UnEscapeIPs-Test
toversion: 4.1.9
type: javascript
