id: TestUptycs
inputs: []
name: TestUptycs
outputs: []
starttaskid: '0'
tasks:
  '0':
    id: '0'
    nexttasks:
      '#none#':
      - '1'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 0aea6eab-6243-459d-8469-cee492a09c50
      iscommand: false
      name: ''
      version: -1
    taskid: 0aea6eab-6243-459d-8469-cee492a09c50
    type: start
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 50\n  }\n}"
  '1':
    id: '1'
    nexttasks:
      '#none#':
      - '2'
    note: false
    scriptarguments:
      asset_id: {}
      code: {}
      end_window: {}
      host_name_is: {}
      host_name_like: {}
      limit: {}
      start_window: {}
      time_ago:
        simple: 1 month
    separatecontext: false
    task:
      brand: ''
      description: return events from Uptycs DB
      id: 2179207f-c4fd-4ca3-8ac7-49def7d88001
      iscommand: true
      name: uptycs-get-events
      script: '|||uptycs-get-events'
      type: regular
      version: -1
    taskid: 2179207f-c4fd-4ca3-8ac7-49def7d88001
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 195\n  }\n}"
  '10':
    id: '10'
    nexttasks:
      '#none#':
      - '14'
    note: false
    scriptarguments:
      asset_id: {}
      host_name_is: {}
      host_name_like: {}
      name:
        simple: ${Uptycs.SavedQueries.name}
      query_id: {}
      variable_arguments:
        simple: '''{":name": "\''osqueryd\''"}'''
    separatecontext: false
    task:
      brand: ''
      id: 910ab9c3-cc14-480b-82c9-b480e6f2b113
      iscommand: true
      name: uptycs-run-saved-query
      script: '|||uptycs-run-saved-query'
      type: regular
      version: -1
    taskid: 910ab9c3-cc14-480b-82c9-b480e6f2b113
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3170\n  }\n}"
  '11':
    id: '11'
    nexttasks:
      '#none#':
      - '12'
    note: false
    scriptarguments:
      description:
        simple: this is a test saved query from demisto playbook
      execution_type:
        simple: global
      grouping: {}
      name:
        simple: process_query
      query:
        simple: select * from processes where name = :name limit 10
      type:
        simple: default
    separatecontext: false
    task:
      brand: ''
      id: 897535f8-f53f-4b9e-85ff-d1dbe8062fea
      iscommand: true
      name: uptycs-post-saved-query
      script: '|||uptycs-post-saved-query'
      type: regular
      version: -1
    taskid: 897535f8-f53f-4b9e-85ff-d1dbe8062fea
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2470\n  }\n}"
  '12':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Uptycs.PostedQuery.name
          operator: isNotEmpty
      label: 'yes'
    id: '12'
    nexttasks:
      'yes':
      - '9'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 08919ff4-5888-4ff9-8c8f-114a6e161c34
      iscommand: false
      name: Validate Outputs
      type: condition
      version: -1
    taskid: 08919ff4-5888-4ff9-8c8f-114a6e161c34
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2645\n  }\n}"
  '13':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Uptycs.SavedQueries.name
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.SavedQueries.id
          operator: isNotEmpty
      label: 'yes'
    id: '13'
    nexttasks:
      'yes':
      - '10'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 57192133-f578-4746-8e0d-3d1d2cf25976
      iscommand: false
      name: Validate Outputs
      type: condition
      version: -1
    taskid: 57192133-f578-4746-8e0d-3d1d2cf25976
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2995\n  }\n}"
  '14':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Uptycs.RunQuery
          operator: isExists
      label: 'yes'
    id: '14'
    nexttasks:
      'yes':
      - '19'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 4c2ab15d-270e-4dae-8e44-d53b03ce01e0
      iscommand: false
      name: Validate Outputs
      type: condition
      version: -1
    taskid: 4c2ab15d-270e-4dae-8e44-d53b03ce01e0
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3345\n  }\n}"
  '15':
    id: '15'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 2cf69bae-9fca-488d-8f4f-30150d244b68
      iscommand: false
      name: Test Success
      type: title
      version: -1
    taskid: 2cf69bae-9fca-488d-8f4f-30150d244b68
    type: title
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4920\n  }\n}"
  '16':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Uptycs.ProcEvent.pid
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.ProcEvent.upt_time
          operator: isNotEmpty
      label: 'yes'
    id: '16'
    nexttasks:
      'yes':
      - '11'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 64103f1d-7aef-4247-81f5-4da1a7d6a4c9
      iscommand: false
      name: Validate Outputs
      type: condition
      version: -1
    taskid: 64103f1d-7aef-4247-81f5-4da1a7d6a4c9
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2295\n  }\n}"
  '17':
    id: '17'
    nexttasks:
      '#none#':
      - '18'
    note: false
    scriptarguments:
      limit: {}
    separatecontext: false
    task:
      brand: ''
      id: 4bc60a5d-c988-4363-8f4e-66624514b1c2
      iscommand: true
      name: uptycs-get-asset-groups
      script: '|||uptycs-get-asset-groups'
      type: regular
      version: -1
    taskid: 4bc60a5d-c988-4363-8f4e-66624514b1c2
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1070\n  }\n}"
  '18':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Uptycs.AssetGroups.id
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.AssetGroups.createdAt
          operator: isNotEmpty
      label: 'yes'
    id: '18'
    nexttasks:
      'yes':
      - '25'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: e852366a-bce8-49fd-84d5-23d83a312507
      iscommand: false
      name: Validate Outputs
      type: condition
      version: -1
    taskid: e852366a-bce8-49fd-84d5-23d83a312507
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1245\n  }\n}"
  '19':
    id: '19'
    nexttasks:
      '#none#':
      - '20'
    note: false
    scriptarguments:
      asset_id:
        simple: ${Uptycs.Assets.id}
      end_window: {}
      host_name_is: {}
      host_name_like: {}
      limit: {}
      start_window: {}
      time: {}
      time_ago: {}
    separatecontext: false
    task:
      brand: ''
      id: 7b371f0c-d029-4722-80b3-81eac195daa8
      iscommand: true
      name: uptycs-get-process-open-files
      script: '|||uptycs-get-process-open-files'
      type: regular
      version: -1
    taskid: 7b371f0c-d029-4722-80b3-81eac195daa8
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3520\n  }\n}"
  '2':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Events
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Events.host_name
                root: Uptycs
                transformers:
                - operator: uniq
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Events.description
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Events.upt_asset_id
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Events.code
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Events.value
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Events.key
          operator: isNotEmpty
      label: 'yes'
    id: '2'
    nexttasks:
      'yes':
      - '3'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 3e5f12ec-68e6-436d-83b4-92cd29bc9f16
      iscommand: false
      name: Validate Outputs
      type: condition
      version: -1
    taskid: 3e5f12ec-68e6-436d-83b4-92cd29bc9f16
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 370\n  }\n}"
  '20':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Files
          operator: isExists
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Files.pid
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Files.path
          operator: isNotEmpty
      label: 'yes'
    id: '20'
    nexttasks:
      'yes':
      - '22'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 40b8fb58-c0ed-42ca-89de-71580d3f23c6
      iscommand: false
      name: Validate Outputs
      type: condition
      version: -1
    taskid: 40b8fb58-c0ed-42ca-89de-71580d3f23c6
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3695\n  }\n}"
  '22':
    id: '22'
    nexttasks:
      '#none#':
      - '23'
    note: false
    scriptarguments:
      indicator: {}
      limit: {}
    separatecontext: false
    task:
      brand: ''
      id: 235783f1-c71c-4578-80eb-fe4e690e6af7
      iscommand: true
      name: uptycs-get-threat-indicators
      script: '|||uptycs-get-threat-indicators'
      type: regular
      version: -1
    taskid: 235783f1-c71c-4578-80eb-fe4e690e6af7
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3870\n  }\n}"
  '23':
    id: '23'
    nexttasks:
      '#none#':
      - '24'
    note: false
    scriptarguments:
      limit: {}
    separatecontext: false
    task:
      brand: ''
      id: db842179-e616-49b9-8915-f6043c460434
      iscommand: true
      name: uptycs-get-threat-sources
      script: '|||uptycs-get-threat-sources'
      type: regular
      version: -1
    taskid: db842179-e616-49b9-8915-f6043c460434
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4045\n  }\n}"
  '24':
    id: '24'
    nexttasks:
      '#none#':
      - '26'
    note: false
    scriptarguments:
      limit: {}
    separatecontext: false
    task:
      brand: ''
      id: d9f7ad86-372c-4eb5-8433-b9807f414a5d
      iscommand: true
      name: uptycs-get-threat-vendors
      script: '|||uptycs-get-threat-vendors'
      type: regular
      version: -1
    taskid: d9f7ad86-372c-4eb5-8433-b9807f414a5d
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4220\n  }\n}"
  '25':
    id: '25'
    nexttasks:
      '#none#':
      - '7'
    note: false
    scriptarguments:
      asset_group_id:
        simple: ${Uptycs.AssetGroups.id}
    separatecontext: false
    task:
      brand: ''
      id: 357c43cc-5adc-499f-89d9-3deeda6761b9
      iscommand: true
      name: uptycs-get-user-asset-groups
      script: '|||uptycs-get-user-asset-groups'
      type: regular
      version: -1
    taskid: 357c43cc-5adc-499f-89d9-3deeda6761b9
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1420\n  }\n}"
  '26':
    id: '26'
    nexttasks:
      '#none#':
      - '27'
    note: false
    scriptarguments:
      limit: {}
    separatecontext: false
    task:
      brand: ''
      id: 055e4ed3-9061-4a88-8d7a-c8972b03ac55
      iscommand: true
      name: uptycs-get-users
      script: '|||uptycs-get-users'
      type: regular
      version: -1
    taskid: 055e4ed3-9061-4a88-8d7a-c8972b03ac55
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4395\n  }\n}"
  '27':
    id: '27'
    nexttasks:
      '#none#':
      - '28'
    note: false
    scriptarguments:
      user_id:
        simple: ${Uptycs.Users.id}
    separatecontext: false
    task:
      brand: ''
      id: 4ce6e75f-08db-4229-86c3-4534311691f9
      iscommand: true
      name: uptycs-get-user-information
      script: '|||uptycs-get-user-information'
      type: regular
      version: -1
    taskid: 4ce6e75f-08db-4229-86c3-4534311691f9
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4570\n  }\n}"
  '28':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Uptycs.UserInfo
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.UserInfo.id
          operator: isNotEmpty
      label: 'yes'
    id: '28'
    nexttasks:
      'yes':
      - '15'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: a96366bd-b770-4038-8f38-c9c82db71903
      iscommand: false
      name: Validate Outputs
      type: condition
      version: -1
    taskid: a96366bd-b770-4038-8f38-c9c82db71903
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4745\n  }\n}"
  '29':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Alerts.pid
          operator: isNotEmpty
      label: 'yes'
    id: '29'
    nexttasks:
      'yes':
      - '6'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 944bced6-d846-439b-8534-fb61eadf4828
      iscommand: false
      name: Check for pid
      type: condition
      version: -1
    taskid: 944bced6-d846-439b-8534-fb61eadf4828
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1945\n  }\n}"
  '3':
    id: '3'
    nexttasks:
      '#none#':
      - '4'
    note: false
    scriptarguments:
      asset_group_id: {}
      asset_id: {}
      host_name_is:
        complex:
          accessor: Events.host_name
          root: Uptycs
          transformers:
          - args:
              index:
                value:
                  simple: '0'
            operator: atIndex
      host_name_like: {}
      limit: {}
      os: {}
    separatecontext: false
    task:
      brand: ''
      description: return assets enrolled with Uptycs
      id: 0e948beb-5d95-41e2-8712-3933c391d987
      iscommand: true
      name: uptycs-get-assets
      script: '|||uptycs-get-assets'
      type: regular
      version: -1
    taskid: 0e948beb-5d95-41e2-8712-3933c391d987
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 545\n  }\n}"
  '4':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Assets.os
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Assets.host_name
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Assets.osquery_version
          operator: isNotEmpty
      label: 'yes'
    id: '4'
    nexttasks:
      'yes':
      - '5'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: d844c052-6cfd-4a5d-882a-522bec28f62d
      iscommand: false
      name: Validate Outputs
      type: condition
      version: -1
    taskid: d844c052-6cfd-4a5d-882a-522bec28f62d
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 720\n  }\n}"
  '5':
    id: '5'
    nexttasks:
      '#none#':
      - '17'
    note: false
    scriptarguments:
      asset_id:
        simple: ${Uptycs.Assets.id}
    separatecontext: false
    task:
      brand: ''
      description: Retrieve a list of tags for a particular asset
      id: 6982e748-464b-4475-845c-775c50d8f171
      iscommand: true
      name: uptycs-get-asset-tags
      script: '|||uptycs-get-asset-tags'
      type: regular
      version: -1
    taskid: 6982e748-464b-4475-845c-775c50d8f171
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 895\n  }\n}"
  '6':
    id: '6'
    loop:
      exitCondition: ''
      iscommand: false
      wait: 1
    nexttasks:
      '#none#':
      - '16'
    note: false
    scriptarguments:
      alert_id:
        complex:
          accessor: Alerts.id
          root: Uptycs
          transformers:
          - args:
              index:
                value:
                  simple: '0'
            operator: atIndex
    separatecontext: true
    task:
      brand: ''
      description: Get information about processes which open connections to known
        Bad IP's
      id: 51478857-d76f-41da-8ced-8feea4e75878
      iscommand: false
      name: Uptycs - Outbound Connection to Threat IOC Incident
      playbookName: Uptycs - Outbound Connection to Threat IOC Incident
      type: playbook
      version: -1
    taskid: 51478857-d76f-41da-8ced-8feea4e75878
    type: playbook
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2120\n  }\n}"
  '7':
    id: '7'
    nexttasks:
      '#none#':
      - '8'
    note: false
    scriptarguments:
      alert_id: {}
      asset_id:
        complex:
          accessor: Assets.id
          root: Uptycs
          transformers:
          - operator: uniq
      code:
        simple: OUTBOUND_CONNECTION_TO_THREAT_IOC
      end_window: {}
      host_name_is: {}
      host_name_like: {}
      limit: {}
      start_window: {}
      time_ago:
        simple: 90 days
      value: {}
    separatecontext: false
    task:
      brand: ''
      description: return alerts from Uptycs DB
      id: eb9ab91a-f09a-4529-818f-136ad6915a1b
      iscommand: true
      name: uptycs-get-alerts
      script: '|||uptycs-get-alerts'
      type: regular
      version: -1
    taskid: eb9ab91a-f09a-4529-818f-136ad6915a1b
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1595\n  }\n}"
  '8':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Alerts.description
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Alerts.upt_asset_id
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Alerts.code
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Alerts.alert_time
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Alerts.value
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Alerts.key
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              simple: Uptycs.Alerts.pid
          operator: isNotEmpty
      label: 'yes'
    id: '8'
    nexttasks:
      'yes':
      - '29'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 670d6dd1-1a4f-4be5-8a41-e13e84090ccd
      iscommand: false
      name: Validate Outputs
      type: condition
      version: -1
    taskid: 670d6dd1-1a4f-4be5-8a41-e13e84090ccd
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1770\n  }\n}"
  '9':
    id: '9'
    nexttasks:
      '#none#':
      - '13'
    note: false
    scriptarguments:
      limit:
        simple: '1'
      name:
        simple: ${Uptycs.PostedQuery.name}
      query_id: {}
    separatecontext: false
    task:
      brand: ''
      id: 5a46f65f-1dba-4d88-8251-3ef93f1eb683
      iscommand: true
      name: uptycs-get-saved-queries
      script: '|||uptycs-get-saved-queries'
      type: regular
      version: -1
    taskid: 5a46f65f-1dba-4d88-8251-3ef93f1eb683
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2820\n  }\n}"
toversion: 4.1.9
version: -1
view: "{\n  \"linkLabelsPosition\": {},\n  \"paper\": {\n    \"dimensions\": {\n \
  \     \"height\": 4935,\n      \"width\": 380,\n      \"x\": 50,\n      \"y\": 50\n\
  \    }\n  }\n}"
