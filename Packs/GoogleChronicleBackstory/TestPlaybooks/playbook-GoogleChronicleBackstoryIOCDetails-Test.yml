description: This playbook uses the Google Chronicle Backstory integration and tests
  the various scenarios of the "gcb-list-ioc-details" command.
id: Google Chronicle Backstory IOC Details - Test
inputs: []
name: Google Chronicle Backstory IOC Details - Test
outputs: []
starttaskid: '0'
tasks:
  '0':
    id: '0'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '1'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: af4c4eb9-320d-4489-885d-f7fd7d5d8520
      iscommand: false
      name: ''
      version: -1
    taskid: af4c4eb9-320d-4489-885d-f7fd7d5d8520
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 50\n  }\n}"
  '1':
    id: '1'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '2'
      - '4'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: d2c0ce65-7a89-40f2-81b8-c8573e6078c7
      iscommand: false
      name: Delete Context
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: d2c0ce65-7a89-40f2-81b8-c8573e6078c7
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 195\n  }\n}"
  '10':
    id: '10'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '6'
    note: false
    scriptarguments:
      assetid: {}
      closeNotes: {}
      closeReason: {}
      emailclassification: {}
      id: {}
      phishingsubtype: {}
    separatecontext: false
    task:
      brand: Builtin
      description: Close the current incident
      id: ff8ae790-9b12-442d-85d3-6fe3b1df1730
      iscommand: true
      name: Close Investigation
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: ff8ae790-9b12-442d-85d3-6fe3b1df1730
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 895\n  }\n}"
  '2':
    id: '2'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '3'
    note: false
    scriptarguments:
      artifact_value:
        simple: bing.com
    separatecontext: false
    task:
      brand: Google Chronicle Backstory
      description: Use this Command to submit an artifact indicator and return any
        IoCs associated with that artifact. The IoC information is drawn from your
        enterprise security systems and from the Chronicle's IoC partners (for example,
        the DHS threat feed, ET Intelligence).
      id: 838d40fb-2f47-4af9-84b3-1e69842520ec
      iscommand: true
      name: Get IoC details of Domain
      script: Google Chronicle Backstory|||gcb-ioc-details
      type: regular
      version: -1
    taskid: 838d40fb-2f47-4af9-84b3-1e69842520ec
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 370\n  }\n}"
  '3':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Name
                root: Domain
                transformers:
                - operator: uniq
          operator: isEqualString
          right:
            value:
              simple: bing.com
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IocDetails.IoCQueried
                root: GoogleChronicleBackstory
                transformers:
                - operator: uniq
          operator: isEqualString
          right:
            value:
              simple: bing.com
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IocDetails.Sources.Address.Domain
                root: GoogleChronicleBackstory
                transformers:
                - operator: uniq
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IocDetails.Sources.Category
                root: GoogleChronicleBackstory
                transformers:
                - operator: uniq
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IocDetails.Sources.Category
                root: GoogleChronicleBackstory
                transformers:
                - operator: uniq
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IocDetails.Sources.ConfidenceScore
                root: GoogleChronicleBackstory
                transformers:
                - operator: uniq
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IocDetails.Sources.FirstAccessedTime
                root: GoogleChronicleBackstory
                transformers:
                - operator: uniq
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IocDetails.Sources.LastAccessedTime
                root: GoogleChronicleBackstory
                transformers:
                - operator: uniq
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IocDetails.Sources.Severity
                root: GoogleChronicleBackstory
                transformers:
                - operator: uniq
          operator: isExists
      label: 'yes'
    id: '3'
    ignoreworker: false
    nexttasks:
      'yes':
      - '9'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 566efe37-602d-40dc-8152-6107e4e7ffa3
      iscommand: false
      name: Verify result for Domain
      type: condition
      version: -1
    taskid: 566efe37-602d-40dc-8152-6107e4e7ffa3
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 545\n  }\n}"
  '4':
    id: '4'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '5'
    note: false
    scriptarguments:
      artifact_value:
        simple: 23.20.239.12
    separatecontext: false
    task:
      brand: Google Chronicle Backstory
      description: Use this Command to submit an artifact indicator and return any
        IoCs associated with that artifact. The IoC information is drawn from your
        enterprise security systems and from the Chronicle's IoC partners (for example,
        the DHS threat feed, ET Intelligence).
      id: 1e73b1e8-2a05-4208-8bb1-8560bad65046
      iscommand: true
      name: Get IoC details of IP
      script: Google Chronicle Backstory|||gcb-ioc-details
      type: regular
      version: -1
    taskid: 1e73b1e8-2a05-4208-8bb1-8560bad65046
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 370\n  }\n}"
  '5':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Address
                root: IP
                transformers:
                - operator: toUpperCase
          operator: isEqualString
          right:
            value:
              simple: 23.20.239.12
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IocDetails.IoCQueried
                root: GoogleChronicleBackstory
                transformers:
                - operator: uniq
          operator: isEqualString
          right:
            value:
              simple: 23.20.239.12
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IocDetails.Sources.Category
                root: GoogleChronicleBackstory
                transformers:
                - operator: uniq
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IocDetails.Sources.ConfidenceScore
                root: GoogleChronicleBackstory
                transformers:
                - operator: uniq
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IocDetails.Sources.FirstAccessedTime
                root: GoogleChronicleBackstory
                transformers:
                - operator: uniq
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IocDetails.Sources.LastAccessedTime
                root: GoogleChronicleBackstory
                transformers:
                - operator: uniq
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: IocDetails.Sources.Severity
                root: GoogleChronicleBackstory
                transformers:
                - operator: uniq
          operator: isExists
      label: 'yes'
    id: '5'
    ignoreworker: false
    nexttasks:
      'yes':
      - '9'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 96e46c75-a6c5-4c04-88b8-dc3a8bcdb80b
      iscommand: false
      name: Verify result of IP
      type: condition
      version: -1
    taskid: 96e46c75-a6c5-4c04-88b8-dc3a8bcdb80b
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 545\n  }\n}"
  '6':
    id: '6'
    ignoreworker: false
    note: false
    separatecontext: false
    task:
      brand: ''
      id: bf142691-a438-4a08-8a3b-990f102cf115
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: bf142691-a438-4a08-8a3b-990f102cf115
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 1070\n  }\n}"
  '9':
    id: '9'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '10'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: befac927-c1c2-46f1-8ca0-b84beb7e505e
      iscommand: false
      name: Delete Context
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: befac927-c1c2-46f1-8ca0-b84beb7e505e
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 720\n  }\n}"
toversion: 4.1.9
version: -1
view: "{\n  \"linkLabelsPosition\": {\n    \"3_9_yes\": 0.39,\n    \"5_9_yes\": 0.45\n\
  \  },\n  \"paper\": {\n    \"dimensions\": {\n      \"height\": 1085,\n      \"\
  width\": 810,\n      \"x\": 50,\n      \"y\": 50\n    }\n  }\n}"
