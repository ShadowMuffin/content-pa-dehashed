args:
- default: true
  description: Path to memory dump file on the system being used
  name: memdump
  required: true
- description: System with Volatility installed to be used for the analysis
  name: system
  required: true
comment: Use Volatility to run common memory image analysis commands
commonfields:
  id: AnalyzeMemImage
  version: -1
dependson: {}
name: AnalyzeMemImage
script: "var imginfo = executeCommand('Vol', {file:args.memdump, system: args.system,\
  \ cmd:'imageinfo'});\nif (imginfo) {\n   imginfo[0].Contents = '================\
  \ Image Info for ' + args.memdump + '==============\\n' + imginfo[0].Contents;\n\
  }\nvar pstree = executeCommand('Vol', {file:args.memdump, system: args.system, cmd:'pstree'});\n\
  if (pstree) {\n   pstree[0].Contents = '================ Process Tree for ' + args.memdump\
  \ + '==============\\n' + pstree[0].Contents;\n}\nvar connscan = executeCommand('Vol',\
  \ {file:args.memdump, system: args.system, cmd:'connscan'});\nif (connscan) {\n\
  \   connscan[0].Contents = '================ Past Network Connections for ' + args.memdump\
  \ + '==============\\n' + connscan[0].Contents;\n}\nvar res = [];\nres.push(imginfo);\n\
  res.push(pstree);\nres.push(connscan);\nreturn res;"
scripttarget: 0
system: true
tags:
- memory
- forensics
- volatility
- server
timeout: 0s
toversion: 4.1.9
type: javascript
