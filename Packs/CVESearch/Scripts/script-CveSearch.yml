args:
- default: true
  description: CVE ID to search
  name: cveId
  required: true
comment: Search vulnerability information based on CVE ID
commonfields:
  id: c99e196b-e05e-41f2-82cb-6798f33cb653
  version: -1
dependson:
  must:
  - cve-search
deprecated: true
name: cveSearch
script: "\nvar resCmd = executeCommand('cve-search', args);\n\nfunction markdownTableHeader(columnNames)\
  \ {\n    var header=\"|\";\n    var divider=\"|\"\n    for (var idx=0;idx<columnNames.length;idx++)\
  \ {\n        header += columnNames[idx] + \"|\";\n        divider+= \"-|\";\n  \
  \  }\n    return header+\"\\n\"+divider+\"\\n\";\n}\nvar data=resCmd[0].Contents;\n\
  var cvss = (data.cvss) ? \"(CVSS: \"+data.cvss+\")\" : \"\";\nvar res = \"### \"\
  +args.cveId+\" \"+ cvss + \"\\n\";\nres += \"#### Description\\n\"\nres += data.summary\
  \ + \"\\n\";\nres += \"#### Vulnerable Configurations\\n\"\n\nif (!data.vulnerable_configuration\
  \ || data.vulnerable_configuration.length==0) {\n    res += \"None reported\\n\"\
  ;\n} else {\n    var tmpConfig=\"\";\n    for (var idx=0;idx<data.vulnerable_configuration.length;idx++)\
  \ {\n        tmpConfig += data.vulnerable_configuration[idx].title + \" ; \";\n\
  \    }\n    res += tmpConfig.substring(0,tmpConfig.length-2) + \"\\n\";\n}\n\nres\
  \ += \"#### External references\\n\"\nres += \"- [https://cve.mitre.org/cgi-bin/cvename.cgi?name=\"\
  +args.cveId+\"](https://cve.mitre.org/cgi-bin/cvename.cgi?name=\"+args.cveId+\"\
  )\\n\";\nfor (var idx=0;idx<data.references.length;idx++) {\n    res += \"- [\"\
  \ + data.references[idx] + \"](\"+data.references[idx]+\")\\n\";\n}\n\nreturn {\
  \ ContentsFormat: formats.markdown, Type: entryTypes.note, Contents: res } ;\n"
scripttarget: 0
system: true
tags:
- cve
- enhancement
tests:
- No tests (auto formatted)
timeout: 0s
toversion: 4.1.9
type: javascript
