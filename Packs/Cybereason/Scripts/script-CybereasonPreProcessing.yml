comment: 'Preprocessing script to run when fetching Cybereason malops.

  Will check if malop was already fetched, and will then update the existing incident,
  otherwise will create a new incident.'
commonfields:
  id: CybereasonPreProcessingExample
  version: -1
enabled: true
name: CybereasonPreProcessingExample
runonce: false
script: "res = True\nincident = demisto.incidents()[0]\nmalop_guid = ''\nfor label\
  \ in incident['labels']:\n    if label['type'] == 'guidString':\n        malop_guid\
  \ = label['value']\n\nresponse = demisto.executeCommand('getIncidents', {'query':\
  \ '-status:Closed and malopguid: {}'.format(malop_guid)})\nmalop_incident = response[0]['Contents']['data']\n\
  \nif malop_incident:\n    # Malop was already fetched - updating the relevant incident\n\
  \    res = False\n    malop_incident = malop_incident[0]\n    incident['id'] = malop_incident['id']\n\
  \    demisto.executeCommand('setIncident', incident)\n\ndemisto.results(res)"
scripttarget: 0
subtype: python2
tags:
- preProcessing
- Cybereason
- example
tests:
- No test
toversion: 4.1.9
type: python
