description: Test playbook for Tenable.sc integration
id: tenable-sc-test
inputs: []
name: Tenable.sc Test
outputs: []
starttaskid: '0'
tasks:
  '0':
    id: '0'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '11'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 0b14d100-9b12-4dcf-883e-abaf290abb6b
      iscommand: false
      name: ''
      version: -1
    taskid: 0b14d100-9b12-4dcf-883e-abaf290abb6b
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 50\n  }\n}"
  '1':
    id: '1'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '2'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 3c8f30ed-0f96-4046-8e46-1076e457960e
      iscommand: false
      name: Create a scan and delete it
      type: title
      version: -1
    taskid: 3c8f30ed-0f96-4046-8e46-1076e457960e
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1040\n  }\n}"
  '10':
    id: '10'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '13'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: a98ac779-301a-41ec-86cf-422411461075
      iscommand: false
      name: Launch scan
      type: title
      version: -1
    taskid: a98ac779-301a-41ec-86cf-422411461075
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3110\n  }\n}"
  '11':
    id: '11'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '22'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 47e71a20-a9cb-475d-8b76-a7f2cbb1d8c4
      iscommand: false
      name: Delete Context
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 47e71a20-a9cb-475d-8b76-a7f2cbb1d8c4
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 195\n  }\n}"
  '12':
    id: '12'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '10'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 03f0c2b1-4758-4244-8e28-5e2a6fae9826
      iscommand: false
      name: Delete Context
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 03f0c2b1-4758-4244-8e28-5e2a6fae9826
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2935\n  }\n}"
  '13':
    id: '13'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '14'
    note: false
    scriptarguments:
      manageable:
        simple: 'true'
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Get a list of Tenable.sc existing scans
      id: a220c3d4-32b9-43c8-8525-40204f341b42
      iscommand: true
      name: List scans
      script: Tenable.sc|||tenable-sc-list-scans
      type: regular
      version: -1
    taskid: a220c3d4-32b9-43c8-8525-40204f341b42
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3255\n  }\n}"
  '14':
    id: '14'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '15'
    note: false
    scriptarguments:
      diagnostic_password: {}
      diagnostic_target: {}
      scan_id:
        complex:
          accessor: Scan
          root: TenableSC
          transformers:
          - args:
              equalTo:
                value:
                  simple: my_test_scan
              field:
                value:
                  simple: Name
              getField:
                value:
                  simple: ID
            operator: WhereFieldEquals
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Launch an existing scan from Tenable.sc
      id: 3de16a42-65f7-4e41-86bc-4a8cdcaaf937
      iscommand: true
      name: Launch my_test_scan
      script: Tenable.sc|||tenable-sc-launch-scan
      type: regular
      version: -1
    taskid: 3de16a42-65f7-4e41-86bc-4a8cdcaaf937
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3430\n  }\n}"
  '15':
    id: '15'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '16'
    note: false
    scriptarguments:
      scan_results_id:
        simple: ${TenableSC.ScanResults.ID}
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Get the status of a specific scan in Tenable.sc
      id: 00eade45-4bc5-46eb-8c5a-b5a0daba85b4
      iscommand: true
      name: Get scan status
      script: Tenable.sc|||tenable-sc-get-scan-status
      type: regular
      version: -1
    taskid: 00eade45-4bc5-46eb-8c5a-b5a0daba85b4
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3605\n  }\n}"
  '16':
    id: '16'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '17'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 4f9d0c3c-d033-40d5-8cea-e31770cb8192
      iscommand: false
      name: Delete Context
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 4f9d0c3c-d033-40d5-8cea-e31770cb8192
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3780\n  }\n}"
  '17':
    id: '17'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '43'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 5f23837f-f6a9-44e4-8aff-2f7749adf33f
      iscommand: false
      name: Get scan results
      type: title
      version: -1
    taskid: 5f23837f-f6a9-44e4-8aff-2f7749adf33f
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3955\n  }\n}"
  '18':
    id: '18'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '19'
    note: false
    scriptarguments:
      scan_results_id:
        complex:
          accessor: ScanResults
          root: TenableSC
          transformers:
          - args:
              equalTo:
                value:
                  simple: '7330'
              field:
                value:
                  simple: ID
              getField:
                value:
                  simple: ID
            operator: WhereFieldEquals
      vulnerability_severity:
        simple: Medium,Low,Info
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Get a report with a Tenable.sc scan results
      id: 80973b58-0bae-47ef-8bae-b8dea8452f3f
      iscommand: true
      name: Get report from a complete scan
      script: Tenable.sc|||tenable-sc-get-scan-report
      type: regular
      version: -1
    taskid: 80973b58-0bae-47ef-8bae-b8dea8452f3f
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4275\n  }\n}"
  '19':
    id: '19'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '20'
    note: false
    scriptarguments:
      scan_results_id:
        complex:
          accessor: ScanResults
          root: TenableSC
          transformers:
          - args:
              equalTo:
                value:
                  simple: '7330'
              field:
                value:
                  simple: ID
              getField:
                value:
                  simple: ID
            operator: WhereFieldEquals
      vulnerability_id:
        complex:
          accessor: ScanResults.Vulnerability
          root: TenableSC
          transformers:
          - args:
              equalTo:
                value:
                  simple: '10539'
              field:
                value:
                  simple: ID
              getField:
                value:
                  simple: ID
            operator: WhereFieldEquals
    separatecontext: false
    task:
      brand: Tenable.sc
      description: 'Get details about a given vulnerability from a given Tenable.sc
        scan '
      id: e32002da-0b30-48c1-86a6-7c8c8b35109b
      iscommand: true
      name: Get scan vulnerability
      script: Tenable.sc|||tenable-sc-get-vulnerability
      type: regular
      version: -1
    taskid: e32002da-0b30-48c1-86a6-7c8c8b35109b
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4450\n  }\n}"
  '2':
    id: '2'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '3'
    note: false
    scriptarguments:
      manageable:
        simple: 'true'
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Get a list of Tenable.sc scan policies
      id: d08058fd-fba5-46ca-879c-071c54236e94
      iscommand: true
      name: Get manageable policies
      script: Tenable.sc|||tenable-sc-list-policies
      type: regular
      version: -1
    taskid: d08058fd-fba5-46ca-879c-071c54236e94
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1185\n  }\n}"
  '20':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: ScanResults.Vulnerability.Hosts.Port
                root: TenableSC
          operator: isExists
      label: 'yes'
    id: '20'
    ignoreworker: false
    nexttasks:
      'yes':
      - '45'
    note: false
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 75042a50-8100-4da6-8c55-a8284d084472
      iscommand: false
      name: Verify get vulnerability
      type: condition
      version: -1
    taskid: 75042a50-8100-4da6-8c55-a8284d084472
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4625\n  }\n}"
  '21':
    id: '21'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '27'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 5d6fa634-9f08-49a3-825e-0cebce4a0708
      iscommand: false
      name: Delete Context
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 5d6fa634-9f08-49a3-825e-0cebce4a0708
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4975\n  }\n}"
  '22':
    id: '22'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '23'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: a1dea0eb-dd8b-487f-88e3-2e101a938bb9
      iscommand: false
      name: Create asset
      type: title
      version: -1
    taskid: a1dea0eb-dd8b-487f-88e3-2e101a938bb9
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 370\n  }\n}"
  '23':
    id: '23'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '25'
    note: false
    scriptarguments:
      contextKey: {}
      date: {}
      dateFormat: {}
      hoursAgo: {}
      minutesAgo: {}
      monthsAgo: {}
    separatecontext: false
    task:
      brand: ''
      description: 'Retrieves the current date and time.

        '
      id: 5441f6c7-c4c5-4188-83d6-f21dfb1f8711
      iscommand: false
      name: Get current time for name
      scriptName: GetTime
      type: regular
      version: -1
    taskid: 5441f6c7-c4c5-4188-83d6-f21dfb1f8711
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 515\n  }\n}"
  '24':
    id: '24'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '1'
    note: false
    scriptarguments:
      description:
        simple: desc
      ip_list:
        simple: 10.0.0.1
      name:
        simple: test_asset_${TimeNow}
      owner_id:
        simple: ${TenableSC.User.ID}
      tag: {}
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Create an Asset in Tenable.sc with provided IP addresses
      id: a418d595-7260-4a01-88ef-d5930df51efa
      iscommand: true
      name: Create asset
      script: Tenable.sc|||tenable-sc-create-asset
      type: regular
      version: -1
    taskid: a418d595-7260-4a01-88ef-d5930df51efa
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 865\n  }\n}"
  '25':
    id: '25'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '24'
    note: false
    scriptarguments:
      email: {}
      id: {}
      username:
        simple: API55
    separatecontext: false
    task:
      brand: Tenable.sc
      description: List users in Tenable.sc
      id: 7354a486-e978-49c6-8acf-55c75e4bde15
      iscommand: true
      name: Get user
      script: Tenable.sc|||tenable-sc-list-users
      type: regular
      version: -1
    taskid: 7354a486-e978-49c6-8acf-55c75e4bde15
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 690\n  }\n}"
  '26':
    id: '26'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '12'
    note: false
    scriptarguments:
      asset_id:
        simple: ${TenableSC.Asset.ID}
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Delete the Asset with the given ID from Tenable.sc
      id: 3a9d8b7c-528e-4bed-8ccc-5543bab14cac
      iscommand: true
      name: Delete the asset
      script: Tenable.sc|||tenable-sc-delete-asset
      type: regular
      version: -1
    taskid: 3a9d8b7c-528e-4bed-8ccc-5543bab14cac
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2760\n  }\n}"
  '27':
    id: '27'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '28'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 979a3870-6ef4-4430-8ab6-cb6780cd0239
      iscommand: false
      name: Alerts
      type: title
      version: -1
    taskid: 979a3870-6ef4-4430-8ab6-cb6780cd0239
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 5150\n  }\n}"
  '28':
    id: '28'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '29'
    note: false
    scriptarguments:
      manageable:
        simple: 'true'
    separatecontext: false
    task:
      brand: Tenable.sc
      description: List alerts from Tenable.sc
      id: ec34c2dd-8fd7-4975-8519-642c56b117c7
      iscommand: true
      name: Get manageable alerts
      script: Tenable.sc|||tenable-sc-list-alerts
      type: regular
      version: -1
    taskid: ec34c2dd-8fd7-4975-8519-642c56b117c7
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 5295\n  }\n}"
  '29':
    id: '29'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '41'
    note: false
    scriptarguments:
      alert_id:
        simple: ${TenableSC.Alert.ID}
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Get information about a given alert in tenabel.sc
      id: 47cb6e45-a9ac-4d0e-8428-0817de5ba3d7
      iscommand: true
      name: Get alert
      script: Tenable.sc|||tenable-sc-get-alert
      type: regular
      version: -1
    taskid: 47cb6e45-a9ac-4d0e-8428-0817de5ba3d7
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 5470\n  }\n}"
  '3':
    id: '3'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '4'
    note: false
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Get a list of Tenable.sc scan repositories
      id: 07a442ad-d44c-415b-8fa8-da47691d362e
      iscommand: true
      name: Get repositories
      script: Tenable.sc|||tenable-sc-list-repositories
      type: regular
      version: -1
    taskid: 07a442ad-d44c-415b-8fa8-da47691d362e
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1360\n  }\n}"
  '30':
    id: '30'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '33'
    note: false
    scriptarguments:
      instance_name:
        complex:
          accessor: name
          filters:
          - - left:
                iscontext: true
                value:
                  simple: modules.brand
              operator: isEqualString
              right:
                value:
                  simple: Tenable.sc
          root: modules
    separatecontext: false
    task:
      brand: ''
      id: 40ad21b4-4727-4559-8914-f8c810f88f1a
      iscommand: false
      name: FetchFromInstance
      scriptName: FetchFromInstance
      type: regular
      version: -1
    taskid: 40ad21b4-4727-4559-8914-f8c810f88f1a
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 5820\n  }\n}"
  '31':
    id: '31'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '32'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: b46887d4-2770-4a82-862b-1aceda14fe7a
      iscommand: false
      name: List items
      type: title
      version: -1
    taskid: b46887d4-2770-4a82-862b-1aceda14fe7a
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 6170\n  }\n}"
  '32':
    id: '32'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '35'
    note: false
    scriptarguments:
      manageable:
        simple: 'true'
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Get a list of Tenable.sc Assets
      id: 384a8536-7c96-4ba0-8dee-c4d93834d69f
      iscommand: true
      name: List assets
      script: Tenable.sc|||tenable-sc-list-assets
      type: regular
      version: -1
    taskid: 384a8536-7c96-4ba0-8dee-c4d93834d69f
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 6315\n  }\n}"
  '33':
    id: '33'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '31'
    note: false
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 6de2620e-554f-4c04-8ac4-aa997d3fff46
      iscommand: false
      name: Delete Context
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 6de2620e-554f-4c04-8ac4-aa997d3fff46
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 5995\n  }\n}"
  '35':
    id: '35'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '36'
    note: false
    scriptarguments:
      dnsName: {}
      ip:
        simple: 10.0.0.4
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Gets the device information from the current user in Tenable.sc
      id: e8b94844-9b91-414c-8ae4-8f4de3cbabc7
      iscommand: true
      name: Get device
      script: Tenable.sc|||tenable-sc-get-device
      type: regular
      version: -1
    taskid: e8b94844-9b91-414c-8ae4-8f4de3cbabc7
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 6490\n  }\n}"
  '36':
    id: '36'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '37'
    note: false
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Retrieve licensing information from Tenable.sc
      id: 2504a6f6-3dbc-4ff8-8593-d02b4bcb59f8
      iscommand: true
      name: Get licensing
      script: Tenable.sc|||tenable-sc-get-system-licensing
      type: regular
      version: -1
    taskid: 2504a6f6-3dbc-4ff8-8593-d02b4bcb59f8
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 6665\n  }\n}"
  '37':
    id: '37'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '38'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: Status,Device,Asset
      path:
        simple: TenableSC
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: c53774e0-71ab-4047-8057-2df69b5804d1
      iscommand: false
      name: Verify lists
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: c53774e0-71ab-4047-8057-2df69b5804d1
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 6840\n  }\n}"
  '38':
    id: '38'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '42'
    note: false
    scriptarguments:
      expectedValue:
        simple: 10.0.0.4
      fields: {}
      path:
        simple: Endpoint.IPAddress
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 958d2282-4915-479e-854a-265135a0f7ae
      iscommand: false
      name: Verify Endpoint
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 958d2282-4915-479e-854a-265135a0f7ae
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 7015\n  }\n}"
  '4':
    id: '4'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '5'
    note: false
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Get a list of Tenable.sc scan zones
      id: 44e47ec4-1efd-4c86-8dcb-5adedf49a1a2
      iscommand: true
      name: Get zones
      script: Tenable.sc|||tenable-sc-list-zones
      type: regular
      version: -1
    taskid: 44e47ec4-1efd-4c86-8dcb-5adedf49a1a2
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1535\n  }\n}"
  '40':
    id: '40'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '26'
    note: false
    scriptarguments:
      asset_id:
        simple: ${TenableSC.Asset.ID}
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Get details for a given asset in Tenable.sc
      id: 8ecf6b40-a8f9-4f0a-8443-88c0dee34226
      iscommand: true
      name: Get the asset
      script: Tenable.sc|||tenable-sc-get-asset
      type: regular
      version: -1
    taskid: 8ecf6b40-a8f9-4f0a-8443-88c0dee34226
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2585\n  }\n}"
  '41':
    id: '41'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '30'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: Actions,Action
      path:
        simple: TenableSC.Alert
    separatecontext: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 38c5d789-d4f4-4d9b-8205-f9203fdd3ca5
      iscommand: false
      name: Verify Alert
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 38c5d789-d4f4-4d9b-8205-f9203fdd3ca5
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 5645\n  }\n}"
  '42':
    id: '42'
    ignoreworker: false
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 668a3d13-4f9f-4832-8605-abec07b7a497
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: 668a3d13-4f9f-4832-8605-abec07b7a497
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 7190\n  }\n}"
  '43':
    id: '43'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '18'
    note: false
    scriptarguments:
      manageable: {}
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Get all scan results in Tenable.sc
      id: 45bbd549-7c07-4b6e-8993-5addfebee830
      iscommand: true
      name: Get all scan results
      script: Tenable.sc|||tenable-sc-get-all-scan-results
      type: regular
      version: -1
    taskid: 45bbd549-7c07-4b6e-8993-5addfebee830
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4100\n  }\n}"
  '45':
    id: '45'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '21'
    note: false
    scriptarguments:
      expectedValue: {}
      fields:
        simple: ID
      path:
        simple: CVE
    separatecontext: false
    task:
      brand: ''
      description: 'Deprecated, use playbook filters instead.

        Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 41673689-90ac-442e-854b-14684447e1fe
      iscommand: false
      name: Verify CVE
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 41673689-90ac-442e-854b-14684447e1fe
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4800\n  }\n}"
  '5':
    id: '5'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '6'
    note: false
    scriptarguments:
      manageable: {}
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Get a list of Tenable.sc credentials
      id: b229268d-c93b-4e35-837d-c0ee5066ef1c
      iscommand: true
      name: Get credentials
      script: Tenable.sc|||tenable-sc-list-credentials
      type: regular
      version: -1
    taskid: b229268d-c93b-4e35-837d-c0ee5066ef1c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1710\n  }\n}"
  '6':
    id: '6'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '8'
    note: false
    scriptarguments:
      contextKey: {}
      date: {}
      dateFormat: {}
      hoursAgo: {}
      minutesAgo: {}
      monthsAgo: {}
    separatecontext: false
    task:
      brand: ''
      description: 'Retrieves the current date and time.

        '
      id: d0ad26c8-45d7-49fb-8f24-205d2bf7757c
      iscommand: false
      name: Get current time for name
      scriptName: GetTime
      type: regular
      version: -1
    taskid: d0ad26c8-45d7-49fb-8f24-205d2bf7757c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1885\n  }\n}"
  '7':
    id: '7'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '9'
    note: false
    scriptarguments:
      asset_ids:
        simple: ${TenableSC.Asset.ID}
      credentials:
        complex:
          accessor: Credential
          root: TenableSC
          transformers:
          - args:
              equalTo:
                value:
                  simple: Test
              field:
                value:
                  simple: Name
              getField:
                value:
                  simple: ID
            operator: WhereFieldEquals
      dependent_id: {}
      description:
        simple: Test scan
      dhcp_tracking:
        simple: 'true'
      ip_list:
        simple: 10.0.0.1
      max_scan_time:
        simple: '2'
      name:
        simple: test_scan_${TimeNowUnix}
      policy_id:
        complex:
          accessor: ScanPolicy.ID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: TenableSC.ScanPolicy.Type
              operator: isEqualString
              right:
                value:
                  simple: Host Discovery
          root: TenableSC
      report_ids:
        complex:
          accessor: ReportDefinition
          root: TenableSC
          transformers:
          - args:
              equalTo:
                value:
                  simple: Critical and Exploitable Vulnerabilities Report
              field:
                value:
                  simple: Name
              getField:
                value:
                  simple: ID
            operator: WhereFieldEquals
      repository_id:
        complex:
          accessor: ScanRepository
          root: TenableSC
          transformers:
          - args:
              equalTo:
                value:
                  simple: repo
              field:
                value:
                  simple: Name
              getField:
                value:
                  simple: ID
            operator: WhereFieldEquals
      rollover_type: {}
      scan_virtual_hosts:
        simple: 'false'
      schedule:
        simple: never
      timeout_action: {}
      zone_id:
        complex:
          accessor: ScanZone.ID
          filters:
          - - left:
                iscontext: true
                value:
                  simple: TenableSC.ScanZone.ID
              operator: isNotEqualString
              right:
                value:
                  simple: '0'
          root: TenableSC
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Create a scan on Tenable.sc
      id: 44cadbfe-ab32-4055-8211-d8ee00a20d8d
      iscommand: true
      name: Create scan
      script: Tenable.sc|||tenable-sc-create-scan
      type: regular
      version: -1
    taskid: 44cadbfe-ab32-4055-8211-d8ee00a20d8d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2235\n  }\n}"
  '8':
    id: '8'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '7'
    note: false
    scriptarguments:
      manageable:
        simple: 'true'
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Get a list of Tenable.sc report definitions
      id: 147bec15-2ee3-41bf-87a5-1c8d59416f80
      iscommand: true
      name: Get manageable report definitions
      script: Tenable.sc|||tenable-sc-list-report-definitions
      type: regular
      version: -1
    taskid: 147bec15-2ee3-41bf-87a5-1c8d59416f80
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2060\n  }\n}"
  '9':
    id: '9'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '40'
    note: false
    scriptarguments:
      scan_id:
        simple: ${TenableSC.Scan.ID}
    separatecontext: false
    task:
      brand: Tenable.sc
      description: Delete a scan in Tenable.sc
      id: de65b08e-3b48-4949-8c6b-a6775bda66f7
      iscommand: true
      name: Delete the scan
      script: Tenable.sc|||tenable-sc-delete-scan
      type: regular
      version: -1
    taskid: de65b08e-3b48-4949-8c6b-a6775bda66f7
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2410\n  }\n}"
toversion: 4.1.9
version: -1
view: "{\n  \"linkLabelsPosition\": {},\n  \"paper\": {\n    \"dimensions\": {\n \
  \     \"height\": 7205,\n      \"width\": 380,\n      \"x\": 50,\n      \"y\": 50\n\
  \    }\n  }\n}"
