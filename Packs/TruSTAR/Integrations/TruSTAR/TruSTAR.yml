category: Data Enrichment & Threat Intelligence
commonfields:
  id: TruSTAR
  version: -1
configuration:
- defaultvalue: https://api.trustar.co
  display: Server URL (e.g. https://192.168.0.1)
  name: server
  required: true
  type: 0
- defaultvalue: ''
  display: TruSTAR API Key
  name: key
  required: true
  type: 0
- defaultvalue: ''
  display: TruSTAR API Secret
  name: secret
  required: true
  type: 4
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: 'false'
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- defaultvalue: MEDIUM
  display: File Threshold (LOW, MEDIUM, HIGH). Minimum TruSTAR priority level to consider
    the file malicious
  name: file_threshold
  required: false
  type: 0
- defaultvalue: MEDIUM
  display: URL Threshold (LOW, MEDIUM, HIGH). Minimum TruSTAR priority level to consider
    the URL malicious
  name: url_threshold
  required: false
  type: 0
- defaultvalue: MEDIUM
  display: IP Threshold (LOW, MEDIUM, HIGH). Minimum TruSTAR priority level to consider
    the IP malicious
  name: ip_threshold
  required: false
  type: 0
- defaultvalue: MEDIUM
  display: Domain Threshold (LOW, MEDIUM, HIGH). Minimum TruSTAR priority level to
    consider the domain malicious
  name: domain_threshold
  required: false
  type: 0
deprecated: true
description: Deprecated - We recommend using TruSTAR v2 instead.
display: TruSTAR (Deprecated)
name: TruSTAR
script:
  commands:
  - arguments:
    - default: true
      description: Indicator value of any type; i.e. an IP address, email address,
        URL, MD5, SHA1, SHA256, Registry Key, Malware name, etc.
      name: indicators
      required: true
    - description: "Comma-separated list of enclave ids; only indicators found in\
        \ reports from these enclaves will be returned (defaults to all of user\u2019\
        s enclaves). Defaults is all enclaves the user has READ access to."
      name: enclave-ids
    - defaultValue: '0'
      description: Which page of the result set to get
      name: page-number
    - defaultValue: '25'
      description: The number of results per page.
      name: page-size
    description: "Search all TruSTAR incident reports for provided indicators and\
      \ return all correlated indicators from search results. Two indicators are considered\
      \ \u201Ccorrelated\u201D if they can be found in a common report."
    name: trustar-related-indicators
    outputs:
    - contextPath: File.Name
      description: File name
      type: string
    - contextPath: File.MD5
      description: File MD5
      type: string
    - contextPath: File.SHA1
      description: File SHA1
      type: string
    - contextPath: File.SHA256
      description: File SHA256
      type: string
    - contextPath: File.priorityLevel
      description: File priority level
      type: string
    - contextPath: URL.Address
      description: URL address
      type: string
    - contextPath: URL.priorityLevel
      description: URL priority level
      type: string
    - contextPath: IP.Address
      description: IP address
      type: string
    - contextPath: IP.priorityLevel
      description: IP priority level
      type: string
    - contextPath: Account.Email.Address
      description: Email address
      type: string
    - contextPath: Account.Email.priorityLevel
      description: Email priority level
      type: string
    - contextPath: RegistryKey.Path
      description: Registry key path
      type: string
    - contextPath: RegistryKey.priorityLevel
      description: Registry key priority level
      type: string
    - contextPath: CVE.ID
      description: CVE ID
      type: string
    - contextPath: CVE.priorityLevel
      description: CVE priority level
      type: string
  - arguments:
    - auto: PREDEFINED
      defaultValue: other
      description: The types of indicators to be returned. If other, then all indicator
        types except for CVE and MALWARE will be returned.
      name: type
      predefined:
      - CVE
      - MALWARE
      - other
    - defaultValue: '3'
      description: The number of days back to count correlations for.
      name: days-back
    description: Returns the 10 indicators that have recently appeared in the most
      community reports. This is analogous to the Community Trends section of the
      dashboard on Station.
    name: trustar-trending-indicators
    outputs:
    - contextPath: File.Name
      description: File name
      type: string
    - contextPath: File.MD5
      description: File MD5
      type: string
    - contextPath: File.SHA1
      description: File SHA1
      type: string
    - contextPath: File.SHA256
      description: File SHA256
      type: string
    - contextPath: URL.Address
      description: URL address
      type: string
    - contextPath: IP.Address
      description: IP address
      type: string
    - contextPath: Account.Email.Address
      description: Email address
      type: string
    - contextPath: RegistryKey.Path
      description: Registry key path
      type: string
    - contextPath: CVE.ID
      description: CVE ID
      type: string
  - arguments:
    - default: true
      description: The term to search for
      name: search-term
      required: true
    - description: "Comma-separated list of enclave ids; only indicators found in\
        \ reports from these enclaves will be returned (defaults to all of user\u2019\
        s enclaves). Defaults is all enclaves the user has READ access to."
      name: enclave-ids
    - defaultValue: '0'
      description: Which page of the result set to get
      name: page-number
    - defaultValue: '25'
      description: The number of results per page.
      name: page-size
    description: Searches for all indicators that contain the given search term.
    name: trustar-search-indicators
    outputs:
    - contextPath: File.Name
      description: File name
      type: string
    - contextPath: File.MD5
      description: File MD5
      type: string
    - contextPath: File.SHA1
      description: File SHA1
      type: string
    - contextPath: File.SHA256
      description: File SHA256
      type: string
    - contextPath: URL.Address
      description: URL address
      type: string
    - contextPath: IP.Address
      description: IP address
      type: string
    - contextPath: Account.Email.Address
      description: Email address
      type: string
    - contextPath: RegistryKey.Path
      description: Registry key path
      type: string
    - contextPath: CVE.ID
      description: CVE ID
      type: string
  - arguments:
    - description: Title of the report
      name: title
      required: true
    - description: Text content of report
      name: report-body
      required: true
    - description: CSV of TruSTAR-generated enclave ids. Use the enclave ID, NOT the
        enclave name. Mandatory if the distribution type is ENCLAVE.
      name: enclave-ids
    - auto: PREDEFINED
      defaultValue: ENCLAVE
      description: Distribution type of the report
      name: distribution-type
      predefined:
      - COMMUNITY
      - ENCLAVE
    - description: URL for the external report that this originated from, if one exists.
        Limit 500 alphanumeric characters. Must be unique across all reports for a
        given company.
      name: external-url
    - description: ISO-8601 formatted incident time with timezone, e.g. 2016-09-22T11:38:35+00:00.
        Default is current time.
      name: time-began
    description: "Submit a new incident report, and receive the ID it has been assigned\
      \ in TruSTAR\u2019s system."
    name: trustar-submit-report
    outputs:
    - contextPath: TruSTAR.Report.reportTitle
      description: Title of the report
      type: string
    - contextPath: TruSTAR.Report.reportBody
      description: Body of the report
      type: string
    - contextPath: TruSTAR.Report.id
      description: ID of the report
      type: string
  - arguments:
    - description: TruSTAR report id or external tracking id.
      name: report-id
      required: true
    - description: Title of the report
      name: title
      required: true
    - description: Text content of report
      name: report-body
      required: true
    - description: CSV of TruSTAR-generated enclave ids. Use the enclave ID, NOT the
        enclave name. Mandatory if the distribution type is ENCLAVE.
      name: enclave-ids
    - description: URL for the external report that this originated from, if one exists.
        Limit 500 alphanumeric characters. Must be unique across all reports for a
        given company.
      name: external-url
    - auto: PREDEFINED
      defaultValue: ENCLAVE
      description: Distribution type of the report
      name: distribution-type
      predefined:
      - COMMUNITY
      - ENCLAVE
    - description: ISO-8601 formatted incident time with timezone, e.g. 2016-09-22T11:38:35+00:00.
        Default is current time.
      name: time-began
    description: Update the report with the specified ID. Either the internal TruSTAR
      report ID or an external tracking ID can be used. Only the fields passed will
      be updated. All others will be left unchanged.
    name: trustar-update-report
    outputs:
    - contextPath: TruSTAR.Report.reportTitle
      description: Title of the report
      type: string
    - contextPath: TruSTAR.Report.reportBody
      description: Body of the report
      type: string
    - contextPath: TruSTAR.Report.id
      description: ID of the report
      type: string
  - arguments:
    - description: Finds a report by its internal or external id.
      name: report-id
      required: true
    - auto: PREDEFINED
      defaultValue: internal
      description: Type of report ID
      name: id-type
      predefined:
      - internal
      - external
    description: Finds a report by its internal or external id.
    name: trustar-report-details
    outputs:
    - contextPath: TruSTAR.Report.reportTitle
      description: Title of the report
      type: string
    - contextPath: TruSTAR.Report.reportBody
      description: Body of the report
      type: string
    - contextPath: TruSTAR.Report.id
      description: ID of the report
      type: string
  - arguments:
    - description: Finds a report by its internal or external id.
      name: report-id
      required: true
    - auto: PREDEFINED
      defaultValue: internal
      description: Type of report ID
      name: id-type
      predefined:
      - internal
      - external
    description: Deletes a report as specified by given id (id can be TruSTAR report
      id or external id).
    name: trustar-delete-report
  - arguments:
    - description: Start of time window (format is YY-MM-DD HH:MM:SS, i.e. 2018-01-01
        10:30:00). Based on updated time, and not created time. Default is 1 day ago.
      name: from
    - description: End of time window (format is YY-MM-DD HH:MM:SS, i.e. 2018-01-01
        10:30:00). Based on updated time, and not created time. Default is current
        time.
      name: to
    - auto: PREDEFINED
      defaultValue: ENCLAVE
      description: Whether to search for reports in the community, or only in enclaves
      name: distribution-type
      predefined:
      - ENCLAVE
      - COMMUNITY
    - description: Comma separated list of enclave ids to search for reports in. Even
        if distributionType is COMMUNITY, these enclaves will still be searched as
        well. Default is All enclaves the user has READ access to.
      name: enclave-ids
    - description: a list of names of tags to filter by; only reports containing ALL
        of these tags will be returned
      name: tags
    - description: reports containing ANY of these tags will be excluded from the
        results.
      name: excluded-tags
    description: 'Returns incident reports matching the specified filters. All parameters
      are optional: if nothing is specified, the latest 25 reports accessible by the
      user will be returned (matching the view the user would have by logging into
      Station).'
    name: trustar-get-reports
    outputs:
    - contextPath: TruSTAR.Report.reportTitle
      description: Title of the report
    - contextPath: TruSTAR.Report.reportBody
      description: Body of the report
    - contextPath: TruSTAR.Report.id
      description: ID of the report
  - arguments:
    - description: Indicator value of any type; i.e. an IP address, email address,
        URL, MD5, SHA1, SHA256, Registry Key, Malware name, etc.
      name: indicators
      required: true
    - description: "Comma-separated list of enclave ids; only indicators found in\
        \ reports from these enclaves will be returned (defaults to all of user\u2019\
        s enclaves). Defaults is all enclaves the user has READ access to."
      name: enclave-ids
    - defaultValue: '0'
      description: Which page of the result set to get
      name: page-number
    - defaultValue: '25'
      description: The number of results per page.
      name: page-size
    - auto: PREDEFINED
      defaultValue: ENCLAVE
      description: Distribution type of the report
      name: distribution-type
      predefined:
      - COMMUNITY
      - ENCLAVE
    description: Returns a paginated list of all reports that contain any of the provided
      indicator values.
    name: trustar-correlated-reports
  - arguments:
    - default: true
      description: The term to search for
      name: search-term
      required: true
    - description: "Comma-separated list of enclave ids; only indicators found in\
        \ reports from these enclaves will be returned (defaults to all of user\u2019\
        s enclaves)"
      name: enclave-ids
    description: Searches for all reports that contain the given search term.
    name: trustar-search-reports
  - arguments:
    - default: true
      description: CSV of indicators to whitelist, i.e. evil.com,101.43.52.224
      name: indicators
      required: true
    description: "Whitelist a list of indicator values for the user\u2019s company."
    name: trustar-add-to-whitelist
  - arguments:
    - description: The value of the indicator to delete.
      name: indicator
      required: true
    - auto: PREDEFINED
      description: The type of the indicator to delete.
      name: indicator-type
      predefined:
      - URL
      - IP
      - SHA256
      - SHA1
      - MD5
      - SOFTWARE
      - EMAIL_ADDRESS
      - BITCOIN_ADDRESS
      - CIDR_BLOCK
      - CVE
      - REGISTRY_KEY
      required: true
    description: "Delete an indicator from the user\u2019s company whitelist."
    name: trustar-remove-from-whitelist
  - arguments: []
    description: Returns the list of all enclaves that the user has access to, as
      well as whether they can read, create, and update reports in that enclave.
    name: trustar-get-enclaves
  - arguments:
    - description: File hash - MD5, SHA1 or SHA256
      name: file
      required: true
    - auto: PREDEFINED
      description: If ThreatScore is greater or equal than the threshold, then ip
        will be considered malicious
      name: threshold
      predefined:
      - LOW
      - MEDIUM
      - HIGH
    deprecated: true
    description: Check file reputation on TruSTAR
    name: file
    outputs:
    - contextPath: File.MD5
      description: File MD5
      type: string
    - contextPath: File.SHA1
      description: File SHA1
      type: string
    - contextPath: File.SHA256
      description: File SHA256
      type: string
    - contextPath: File.Malicious.Vendor
      description: For malicious files, the vendor that made the decision
      type: string
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
      type: string
    - contextPath: DBotScore.Type
      description: The type of the indicator
      type: string
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
      type: string
    - contextPath: DBotScore.Score
      description: The actual score
      type: number
    - contextPath: TruSTAR.File.Value
      description: Indicator value
      type: string
    - contextPath: TruSTAR.File.Whitelisted
      description: Is the indicator whitelisted
      type: boolean
    - contextPath: TruSTAR.File.Priority
      description: Indicator's priority level by TruSTAR - LOW, MEDIUM or HIGH
      type: string
    - contextPath: File.Malicious.Description
      description: For malicious files, the reason for the vendor to make the decision
  - arguments:
    - description: IP address (e.g. 8.8.8.8) or a CIDR (e.g. 1.1.1.0/18)
      name: ip
      required: true
    - auto: PREDEFINED
      description: If ThreatScore is greater or equal than the threshold, then ip
        will be considered malicious
      name: threshold
      predefined:
      - LOW
      - MEDIUM
      - HIGH
    deprecated: true
    description: Check IP Reputation on TruSTAR
    name: ip
    outputs:
    - contextPath: IP.Address
      description: IP Address
      type: string
    - contextPath: IP.Malicious.Vendor
      description: For malicious IPs, the vendor that made the decision
      type: string
    - contextPath: IP.Malicious.Description
      description: For malicious IPs, the reason for the vendor to make the decision
      type: string
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
      type: string
    - contextPath: DBotScore.Type
      description: The type of the indicator
      type: string
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
      type: string
    - contextPath: DBotScore.Score
      description: The actual score
      type: string
    - contextPath: TruSTAR.IP.Value
      description: Indicator value
      type: string
    - contextPath: TruSTAR.IP.Whitelisted
      description: Is the indicator whitelisted
      type: boolean
    - contextPath: TruSTAR.IP.Priority
      description: Indicator's priority level by TruSTAR - LOW, MEDIUM or HIGH
  - arguments:
    - description: Enter a URL to search
      name: url
      required: true
    - auto: PREDEFINED
      description: If ThreatScore is greater or equal than the threshold, then ip
        will be considered malicious
      name: threshold
      predefined:
      - LOW
      - MEDIUM
      - HIGH
    deprecated: true
    description: Check URL reputation on TruSTAR
    name: url
    outputs:
    - contextPath: URL.Data
      description: URL data
      type: string
    - contextPath: URL.Malicious.Vendor
      description: For malicious URLs, the vendor that made the decision
      type: string
    - contextPath: URL.Malicious.Description
      description: For malicious URLs, the reason for the vendor to make the decision
      type: string
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
      type: string
    - contextPath: DBotScore.Type
      description: The type of the indicator
      type: string
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
      type: string
    - contextPath: DBotScore.Score
      description: The actual score
      type: string
    - contextPath: TruSTAR.URL.Value
      description: Indicator value
      type: string
    - contextPath: TruSTAR.URL.Whitelisted
      description: Is the indicator whitelisted
      type: boolean
    - contextPath: TruSTAR.URL.Priority
      description: Indicator's priority level by TruSTAR - LOW, MEDIUM or HIGH
      type: string
  - arguments:
    - description: Enter domain name to search
      name: domain
      required: true
    - auto: PREDEFINED
      description: If ThreatScore is greater or equal than the threshold, then ip
        will be considered malicious
      name: threshold
      predefined:
      - LOW
      - MEDIUM
      - HIGH
    deprecated: true
    description: Check Domain reputation on TruStar
    name: domain
    outputs:
    - contextPath: Domain.Name
      description: Domain Name
      type: string
    - contextPath: Domain.Malicious.Vendor
      description: For malicious domains, the vendor that made the decision
      type: string
    - contextPath: Domain.Malicious.Description
      description: For malicious domains, the reason for the vendor to make the decision
      type: string
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
      type: string
    - contextPath: DBotScore.Type
      description: The type of the indicator
      type: string
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
      type: string
    - contextPath: DBotScore.Score
      description: The actual score
      type: string
    - contextPath: TruSTAR.Domain.Value
      description: Indicator value
      type: string
    - contextPath: TruSTAR.Domain.Whitelisted
      description: Is the indicator whitelisted
      type: boolean
    - contextPath: TruSTAR.Domain.Priority
      description: Indicator's priority level by TruSTAR - LOW, MEDIUM or HIGH
      type: string
  - arguments:
    - defaultValue: -1,0,1,2,3
      description: Score of email submission
      isArray: true
      name: priority_event_score
    - description: Start of time window (defaults to 24 hours ago) (YYYY-MM-DD HH:MM:SS)
      name: from_time
    - description: End of time window (defaults to current time) (YYYY-MM-DD HH:MM:SS)
      name: to_time
    - auto: PREDEFINED
      defaultValue: UNRESOLVED
      description: A list of triage statuses for submissions (UNRESOLVED,CONFIRMED,IGNORED);
        only email submissions marked with at least one of these statuses will be
        returned
      isArray: true
      name: status
      predefined:
      - UNRESOLVED
      - CONFIRMED
      - IGNORED
    description: Fetches all phishing submissions that fit the given criteria
    name: trustar-get-phishing-submissions
    outputs:
    - contextPath: TruSTAR.PhishingSubmission.submissionId
      description: The submission ID
      type: string
    - contextPath: TruSTAR.PhishingSubmission.title
      description: Submission title
      type: string
    - contextPath: TruSTAR.PhishingSubmission.priorityEventScore
      description: Submission triage score
      type: number
    - contextPath: TruSTAR.PhishingSubmission.context.indicatorType
      description: Indicator type
      type: string
    - contextPath: TruSTAR.PhishingSubmission.context.sourceKey
      description: Indicator source
      type: string
    - contextPath: TruSTAR.PhishingSubmission.context.normalizedIndicatorScore
      description: Indicator score
      type: number
    - contextPath: TruSTAR.PhishingSubmission.context.originalIndicatorScore.name
      description: Original Indicator score name
      type: string
    - contextPath: TruSTAR.PhishingSubmission.context.originalIndicatorScore.value
      description: Original Indicator score value
      type: string
  - arguments:
    - description: ID of the email submission
      name: submission_id
      required: true
    - auto: PREDEFINED
      description: Submission status
      name: status
      predefined:
      - CONFIRMED
      - IGNORED
      required: true
    description: Marks a phishing email submission with one of the phishing namespace
      tags
    name: trustar-set-triage-status
  - arguments:
    - defaultValue: -1,0,1,2,3
      description: Intel score of the indicator
      isArray: true
      name: normalized_indicator_score
    - defaultValue: -1,0,1,2,3
      description: Score of email submission
      isArray: true
      name: priority_event_score
    - description: Start of time window (defaults to 24 hours ago) (YYYY-MM-DD HH:MM:SS)
      name: from_time
    - description: End of time window (defaults to current time) (YYYY-MM-DD HH:MM:SS)
      name: to_time
    - auto: PREDEFINED
      defaultValue: UNRESOLVED,CONFIRMED,IGNORED
      description: A list of triage statuses for submissions; only email submissions
        marked with at least one of these statuses will be returned. Options are 'UNRESOLVED',
        'CONFIRMED', 'IGNORED'
      isArray: true
      name: status
      predefined:
      - UNRESOLVED
      - CONFIRMED
      - IGNORED
    description: Get phishing indicators that match the given criteria.
    name: trustar-get-phishing-indicators
    outputs:
    - contextPath: TruSTAR.PhishingIndicator.indicatorType
      description: Indicator Type
      type: string
    - contextPath: TruSTAR.PhishingIndicator.normalizedIndicatorScore
      description: Indicator normalized score
      type: number
    - contextPath: TruSTAR.PhishingIndicator.originalIndicatorScore.name
      description: Indicator original score name
      type: string
    - contextPath: TruSTAR.PhishingIndicator.originalIndicatorScore.value
      description: Indicator original score value
      type: string
    - contextPath: TruSTAR.PhishingIndicator.sourceKey
      description: Indicator source key
      type: string
    - contextPath: TruSTAR.PhishingIndicator.value
      description: Indicator value
      type: string
  dockerimage: demisto/trustar:20.1.0.8039
  dockerimage45: demisto/trustar:latest
  runonce: false
  script: ''
  subtype: python2
  type: python
toversion: 4.1.9
