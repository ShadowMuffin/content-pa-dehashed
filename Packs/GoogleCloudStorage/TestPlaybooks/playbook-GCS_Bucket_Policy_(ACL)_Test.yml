id: GCS Bucket Policy (ACL) - Test
inputs: []
name: GCS Bucket Policy (ACL) - Test
outputs: []
starttaskid: '0'
tasks:
  '0':
    id: '0'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '19'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: f763dc30-c134-4569-8ad8-58ef2372ecbb
      iscommand: false
      name: ''
      version: -1
    taskid: f763dc30-c134-4569-8ad8-58ef2372ecbb
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 50\n  }\n}"
  '10':
    id: '10'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '11'
    note: false
    scriptarguments:
      bucket_name:
        simple: demisto-test-3
      force: {}
    separatecontext: false
    task:
      brand: Google Cloud Storage
      description: Permanently deletes a bucket
      id: e6be78e2-9ee6-4ea0-8cb7-e7e50ea64e0d
      iscommand: true
      name: Delete bucket
      script: Google Cloud Storage|||gcs-delete-bucket
      type: regular
      version: -1
    taskid: e6be78e2-9ee6-4ea0-8cb7-e7e50ea64e0d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4070\n  }\n}"
  '11':
    id: '11'
    ignoreworker: false
    note: false
    separatecontext: false
    task:
      brand: ''
      id: f225e484-724b-4803-8f10-fae3987d0ec3
      iscommand: false
      name: Done
      type: title
      version: -1
    taskid: f225e484-724b-4803-8f10-fae3987d0ec3
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4245\n  }\n}"
  '12':
    id: '12'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '28'
    note: false
    scriptarguments:
      all: {}
      index: {}
      key:
        simple: GCS
      keysToKeep: {}
      subplaybook:
        simple: 'yes'
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: d1f24ab2-357b-4859-852c-b1eef6b50951
      iscommand: false
      name: Clear context
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: d1f24ab2-357b-4859-852c-b1eef6b50951
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 162.5,\n    \"y\": 720\n  }\n}"
  '13':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: BucketPolicy.Entity
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: GCS.BucketPolicy.Entity
                    operator: isEqualString
                    right:
                      value:
                        simple: allUsers
                root: GCS
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: BucketPolicy.Bucket
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: GCS.BucketPolicy.Entity
                    operator: isEqualString
                    right:
                      value:
                        simple: allUsers
                root: GCS
          operator: isEqualString
          right:
            value:
              simple: demisto-test-3
      - - left:
            iscontext: true
            value:
              complex:
                accessor: BucketPolicy.Role
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: GCS.BucketPolicy.Entity
                    operator: isEqualString
                    right:
                      value:
                        simple: allUsers
                root: GCS
          operator: isEqualString
          right:
            value:
              simple: READER
      label: 'yes'
    id: '13'
    ignoreworker: false
    nexttasks:
      'yes':
      - '24'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 19e4ff1b-9181-4704-8ebe-491da60fa96d
      iscommand: false
      name: Verify publicRead ACL (entity allUsers should have role READER)
      type: condition
      version: -1
    taskid: 19e4ff1b-9181-4704-8ebe-491da60fa96d
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1565\n  }\n}"
  '14':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: BucketPolicy.Entity
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: GCS.BucketPolicy.Entity
                    operator: isEqualString
                    right:
                      value:
                        simple: allAuthenticatedUsers
                root: GCS
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: BucketPolicy.Bucket
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: GCS.BucketPolicy.Entity
                    operator: isEqualString
                    right:
                      value:
                        simple: allAuthenticatedUsers
                root: GCS
          operator: isEqualString
          right:
            value:
              simple: demisto-test-3
      - - left:
            iscontext: true
            value:
              complex:
                accessor: BucketPolicy.Role
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: GCS.BucketPolicy.Entity
                    operator: isEqualString
                    right:
                      value:
                        simple: allAuthenticatedUsers
                root: GCS
          operator: isEqualString
          right:
            value:
              simple: WRITER
      label: 'yes'
    id: '14'
    ignoreworker: false
    nexttasks:
      'yes':
      - '25'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: b90483db-8196-4472-84cd-fd1f8bb76726
      iscommand: false
      name: Verify permission was added
      type: condition
      version: -1
    taskid: b90483db-8196-4472-84cd-fd1f8bb76726
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2235\n  }\n}"
  '16':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: BucketPolicy.Entity
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: GCS.BucketPolicy.Entity
                    operator: isEqualString
                    right:
                      value:
                        simple: allAuthenticatedUsers
                root: GCS
          operator: isNotExists
      label: 'yes'
    id: '16'
    ignoreworker: false
    nexttasks:
      'yes':
      - '27'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 9e2c3868-abb3-4f6d-8b8e-4ea7f9e68a90
      iscommand: false
      name: Verify permission was removed
      type: condition
      version: -1
    taskid: 9e2c3868-abb3-4f6d-8b8e-4ea7f9e68a90
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3750\n  }\n}"
  '17':
    id: '17'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '9'
    note: false
    scriptarguments:
      all: {}
      index: {}
      key:
        simple: GCS
      keysToKeep: {}
      subplaybook:
        simple: 'yes'
    separatecontext: false
    task:
      brand: ''
      description: Delete field from context
      id: 5963cf74-aef9-4bc1-865b-b1016391213d
      iscommand: false
      name: Clear context
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 5963cf74-aef9-4bc1-865b-b1016391213d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3400\n  }\n}"
  '18':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: BucketPolicy.Entity
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: GCS.BucketPolicy.Entity
                    operator: isEqualString
                    right:
                      value:
                        simple: allAuthenticatedUsers
                root: GCS
          operator: isExists
      - - left:
            iscontext: true
            value:
              complex:
                accessor: BucketPolicy.Bucket
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: GCS.BucketPolicy.Entity
                    operator: isEqualString
                    right:
                      value:
                        simple: allAuthenticatedUsers
                root: GCS
          operator: isEqualString
          right:
            value:
              simple: demisto-test-3
      - - left:
            iscontext: true
            value:
              complex:
                accessor: BucketPolicy.Role
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: GCS.BucketPolicy.Entity
                    operator: isEqualString
                    right:
                      value:
                        simple: allAuthenticatedUsers
                root: GCS
          operator: isEqualString
          right:
            value:
              simple: OWNER
      label: 'yes'
    id: '18'
    ignoreworker: false
    nexttasks:
      'yes':
      - '26'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: c4114704-7aa1-4239-8b05-47d75dd7e7a1
      iscommand: false
      name: Verify permission was modified
      type: condition
      version: -1
    taskid: c4114704-7aa1-4239-8b05-47d75dd7e7a1
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2905\n  }\n}"
  '19':
    id: '19'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '20'
    note: false
    separatecontext: false
    task:
      brand: Google Cloud Storage
      description: Retrieves the list of buckets in the project
      id: 86dc42db-a43a-4f45-82f0-e9eb14c49a86
      iscommand: true
      name: List buckets
      script: Google Cloud Storage|||gcs-list-buckets
      type: regular
      version: -1
    taskid: 86dc42db-a43a-4f45-82f0-e9eb14c49a86
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 195\n  }\n}"
  '2':
    id: '2'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '3'
    note: false
    scriptarguments:
      bucket_acl:
        simple: publicRead
      bucket_name:
        simple: demisto-test-3
      default_object_acl: {}
    separatecontext: false
    task:
      brand: Google Cloud Storage
      description: Creates a new bucket
      id: 636b762e-e59a-428d-87a8-f016bb87a6a4
      iscommand: true
      name: Create bucket demisto-test-3 with ACL = publicRead
      script: Google Cloud Storage|||gcs-create-bucket
      type: regular
      version: -1
    taskid: 636b762e-e59a-428d-87a8-f016bb87a6a4
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1215\n  }\n}"
  '20':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: GCS.Bucket.Name
          operator: isEqualString
          right:
            value:
              simple: demisto-test-3
      label: 'yes'
    id: '20'
    ignoreworker: false
    nexttasks:
      '#default#':
      - '22'
      'yes':
      - '21'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: cb7c50b2-f482-425a-8b5b-df249a727909
      iscommand: false
      name: Bucket demisto-test-3 exists?
      type: condition
      version: -1
    taskid: cb7c50b2-f482-425a-8b5b-df249a727909
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 370\n  }\n}"
  '21':
    id: '21'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '12'
    note: false
    scriptarguments:
      bucket_name:
        simple: demisto-test-3
      force:
        simple: 'true'
    separatecontext: false
    task:
      brand: Google Cloud Storage
      description: Permanently deletes a bucket
      id: afbe87c9-55e9-4913-8911-2933ba468d4c
      iscommand: true
      name: Delete bucket
      script: Google Cloud Storage|||gcs-delete-bucket
      type: regular
      version: -1
    taskid: afbe87c9-55e9-4913-8911-2933ba468d4c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 162.5,\n    \"y\": 545\n  }\n}"
  '22':
    id: '22'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '2'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 89e6b502-5ce0-4d86-86ab-7796705eb771
      iscommand: false
      name: 'Test: Create Bucket with Predefined ACL + Get Bucket ACL'
      type: title
      version: -1
    taskid: 89e6b502-5ce0-4d86-86ab-7796705eb771
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1070\n  }\n}"
  '24':
    id: '24'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '4'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 603ea222-7627-4dac-800d-fb0dde4b550f
      iscommand: false
      name: 'Test: Add Entry to Bucket ACL'
      type: title
      version: -1
    taskid: 603ea222-7627-4dac-800d-fb0dde4b550f
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1740\n  }\n}"
  '25':
    id: '25'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '6'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 9018e414-94c2-4c70-8f1b-eb9c475a7720
      iscommand: false
      name: 'Test: Update Entry in Bucket ACL'
      type: title
      version: -1
    taskid: 9018e414-94c2-4c70-8f1b-eb9c475a7720
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2410\n  }\n}"
  '26':
    id: '26'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '8'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 59780055-bbbd-4413-810e-7c91bcca65f5
      iscommand: false
      name: 'Test: Remove Entry from Bucket ACL'
      type: title
      version: -1
    taskid: 59780055-bbbd-4413-810e-7c91bcca65f5
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3080\n  }\n}"
  '27':
    id: '27'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '10'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 06fdf501-1155-434d-85ef-693cd2a2fc3e
      iscommand: false
      name: Cleanup
      type: title
      version: -1
    taskid: 06fdf501-1155-434d-85ef-693cd2a2fc3e
    timertriggers: []
    type: title
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3925\n  }\n}"
  '28':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: GCS
          operator: isNotExists
      label: 'yes'
    id: '28'
    ignoreworker: false
    nexttasks:
      'yes':
      - '22'
    note: false
    separatecontext: false
    task:
      brand: ''
      id: 61f832c7-d100-4e45-8a94-809bac4320c3
      iscommand: false
      name: Test sanity - verify context cleared
      type: condition
      version: -1
    taskid: 61f832c7-d100-4e45-8a94-809bac4320c3
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 162.5,\n    \"y\": 895\n  }\n}"
  '3':
    id: '3'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '13'
    note: false
    scriptarguments:
      bucket_name:
        simple: demisto-test-3
    separatecontext: false
    task:
      brand: Google Cloud Storage
      description: Retrieves the access control list of a bucket
      id: 960ce08e-4a56-4daf-80a9-1f53061ae05c
      iscommand: true
      name: Get bucket ACL
      script: Google Cloud Storage|||gcs-list-bucket-policy
      type: regular
      version: -1
    taskid: 960ce08e-4a56-4daf-80a9-1f53061ae05c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1390\n  }\n}"
  '4':
    id: '4'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '5'
    note: false
    scriptarguments:
      bucket_name:
        simple: demisto-test-3
      entity:
        simple: allAuthenticatedUsers
      role:
        simple: WRITER
    separatecontext: false
    task:
      brand: Google Cloud Storage
      description: 'Adds a new entity to a bucket''s access control list

        Note: use gcs-put-bucket-policy to update an existing entry'
      id: d3f42e27-14e1-4fb6-81a9-dddd336a17aa
      iscommand: true
      name: Add allAuthenticatedUsers to bucket ACL as WRITER
      script: Google Cloud Storage|||gcs-create-bucket-policy
      type: regular
      version: -1
    taskid: d3f42e27-14e1-4fb6-81a9-dddd336a17aa
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1885\n  }\n}"
  '5':
    id: '5'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '14'
    note: false
    scriptarguments:
      bucket_name:
        simple: demisto-test-3
    separatecontext: false
    task:
      brand: Google Cloud Storage
      description: Retrieves the access control list of a bucket
      id: d88c5d75-e7ea-4b00-8977-323935928c13
      iscommand: true
      name: Get bucket ACL
      script: Google Cloud Storage|||gcs-list-bucket-policy
      type: regular
      version: -1
    taskid: d88c5d75-e7ea-4b00-8977-323935928c13
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2060\n  }\n}"
  '6':
    id: '6'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '7'
    note: false
    scriptarguments:
      bucket_name:
        simple: demisto-test-3
      entity:
        simple: allAuthenticatedUsers
      role:
        simple: OWNER
    separatecontext: false
    task:
      brand: Google Cloud Storage
      description: 'Updates an existing entity in a bucket''s access control list

        Note: use gcs-create-bucket-policy to create a new entry'
      id: 49f36ba8-03c0-4d92-8f6c-45055ffd6a5b
      iscommand: true
      name: Change allAuthenticatedUsers to OWNER
      script: Google Cloud Storage|||gcs-put-bucket-policy
      type: regular
      version: -1
    taskid: 49f36ba8-03c0-4d92-8f6c-45055ffd6a5b
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2555\n  }\n}"
  '7':
    id: '7'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '18'
    note: false
    scriptarguments:
      bucket_name:
        simple: demisto-test-3
    separatecontext: false
    task:
      brand: Google Cloud Storage
      description: Retrieves the access control list of a bucket
      id: f034922e-4be6-49ac-84ad-62b575cdca80
      iscommand: true
      name: Get bucket ACL
      script: Google Cloud Storage|||gcs-list-bucket-policy
      type: regular
      version: -1
    taskid: f034922e-4be6-49ac-84ad-62b575cdca80
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2730\n  }\n}"
  '8':
    id: '8'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '17'
    note: false
    scriptarguments:
      bucket_name:
        simple: demisto-test-3
      entity:
        simple: allAuthenticatedUsers
    separatecontext: false
    task:
      brand: Google Cloud Storage
      description: Removes an entity from a bucket's access control list
      id: 6e89906c-24c4-4b82-8802-a91e416c8071
      iscommand: true
      name: Remove allAuthenticatedUsers from bucket ACL
      script: Google Cloud Storage|||gcs-delete-bucket-policy
      type: regular
      version: -1
    taskid: 6e89906c-24c4-4b82-8802-a91e416c8071
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3225\n  }\n}"
  '9':
    id: '9'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '16'
    note: false
    scriptarguments:
      bucket_name:
        simple: demisto-test-3
    separatecontext: false
    task:
      brand: Google Cloud Storage
      description: Retrieves the access control list of a bucket
      id: 8ea1b28f-7be9-40d1-8cd6-dac5c0178c9e
      iscommand: true
      name: Get bucket ACL
      script: Google Cloud Storage|||gcs-list-bucket-policy
      type: regular
      version: -1
    taskid: 8ea1b28f-7be9-40d1-8cd6-dac5c0178c9e
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3575\n  }\n}"
toversion: 4.1.9
version: -1
view: "{\n  \"linkLabelsPosition\": {},\n  \"paper\": {\n    \"dimensions\": {\n \
  \     \"height\": 4260,\n      \"width\": 492.5,\n      \"x\": 50,\n      \"y\"\
  : 50\n    }\n  }\n}"
