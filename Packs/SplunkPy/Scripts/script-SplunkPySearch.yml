args:
- default: true
  description: Splunk query to execute
  name: query
  required: true
- defaultValue: '10'
  description: Return up to X first rows. If omitted, defaults to 10.
  name: rows
comment: Run a query through Splunk and format the results as a table
commonfields:
  id: SplunkPySearch
  version: -1
dependson:
  must:
  - splunk-search
deprecated: true
enabled: true
name: SplunkPySearch
script: "query = demisto.args()['query']\nrows = demisto.args()['rows']\n\nheaders\
  \ = \"\"\nquery = query + ' | head ' + rows\nres = demisto.executeCommand('splunk-search',{'using-brand':\
  \ 'splunkpy', 'query': query})\ncontents = res[0]['Contents']\n\nif isError(res[0]):\n\
  \    return_error(\"Error occured. \" + str(contents))\n\nif (res and len(res)>0\
  \ and contents):\n    if not isinstance(contents[0], dict):\n        headers = \"\
  results\"\n    demisto.results({\"Type\": 1, \"Contents\": contents, \"ContentsFormat\"\
  : \"json\", \"EntryContext\": {},\n        \"HumanReadable\": tableToMarkdown(\"\
  Splunk Search results for: \" + query, contents, headers)})\nelse:\n    demisto.results('No\
  \ results.')"
scripttarget: 0
subtype: python2
tags:
- enhancement
- splunk
toversion: 4.1.9
type: python
