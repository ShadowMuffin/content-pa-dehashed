category: Analytics & SIEM
commonfields:
  id: Devo_v2
  version: -1
configuration:
- defaultvalue: https://apiv2-us.devo.com/search/query
  display: Query Server Endpoint (e.g. https://apiv2-us.devo.com/search/query)
  name: reader_endpoint
  required: true
  type: 0
- defaultvalue: ''
  display: OAuth Token (Preferred method)
  name: reader_oauth_token
  required: true
  type: 4
- defaultvalue: ''
  display: Writer relay to connect to (e.g. us.elb.relay.logtrust.net)
  name: writer_relay
  required: false
  type: 0
- defaultvalue: ''
  display: Writer JSON credentials
  name: writer_credentials
  required: false
  type: 4
- defaultvalue: https://us.devo.com/welcome
  display: Devo base domain
  name: linq_link_base
  required: false
  type: 0
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
- defaultvalue: ''
  display: Fetch incidents alert filter (Same filters for get-alerts)
  name: fetch_incidents_filters
  required: false
  type: 12
- defaultvalue: ''
  display: Deduplication parameters JSON if required
  name: fetch_incidents_deduplication
  required: false
  type: 12
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Use the Devo v2 integration to query Devo for alerts, lookup tables,
  and to write to lookup tables.
display: Devo v2
name: Devo_v2
script:
  commands:
  - arguments:
    - description: A LINQ query to run in Devo.
      name: query
      required: true
    - description: Start datetime for the specified query. This argument supports
        natural language (e.g., 2 day, 3 week), Unix timestamps, Python datetime objects,
        and string datetimes.
      name: from
      required: true
    - description: End datetime for specified query. If provided must be in same format
        as "from" argument. This argument is ignored in a date range.
      name: to
    - defaultValue: 'true'
      description: Whether to write results to context. Can be "true" or "false".
        The default value is "true".
      name: writeToContext
    description: Queries Devo based on the specified LINQ query.
    name: devo-run-query
    outputs:
    - contextPath: Devo.QueryResults
      description: List of dictionary alerts from the specified time range.
      type: unknown
    - contextPath: Devo.QueryLink
      description: The link to the Devo table for executed query.
  - arguments:
    - description: Start datetime for alerts to fetch.
      name: from
      required: true
    - description: End datetime for alerts to fetch.
      name: to
    - description: Key value filter to apply to retrieve the specified alerts. For
        more information, see the Devo documentation.
      isArray: true
      name: filters
    - defaultValue: 'true'
      description: Whether to write results to context. Can be "true" or "false".
        The default value is "true".
      name: writeToContext
    description: Queries alerts in the specified timeframe.
    name: devo-get-alerts
    outputs:
    - contextPath: Devo.AlertsResults
      description: List of dictionary alerts from the specified time range.
    - contextPath: Devo.QueryLink
      description: The link to the Devo table for the executed query.
  - arguments:
    - description: A list of table names to check for the searchToken.
      isArray: true
      name: tables
      required: true
    - description: A string to search for in the specified tables (in any column).
      name: searchToken
      required: true
    - description: Start datetime for the specified query. This argument supports
        natural language (e.g., 2 day, 3 week), Unix timestamps, Python datetime objects,
        and string datetimes
      name: from
      required: true
    - description: End datetime for specified query. If provided must be in same format
        as "from" argument. This argument is ignored in a date range.
      name: to
    - defaultValue: 'true'
      description: Whether to write results to context. Can be "true" or "false".
        The default value is "true".
      name: writeToContext
    description: Queries multiple tables for a given token and returns relevant results.
    name: devo-multi-table-query
    outputs:
    - contextPath: Devo.MultiResults
      description: A list of dictionary results.
  - arguments:
    - description: The name of the table to write to.
      name: tableName
      required: true
    - description: Records to write to the specified table.
      isArray: true
      name: records
      required: true
    description: Writes records to a specified Devo table.
    execution: true
    name: devo-write-to-table
    outputs:
    - contextPath: Devo.RecordsWritten
      description: Records written to specified Devo table.
      type: unknown
    - contextPath: Devo.LinqQuery
      description: The LINQ query to use to see your data in Devo.
    - contextPath: Devo.QueryLink
      description: The link to the Devo table for the executed query.
  - arguments:
    - description: The lookup table name to write to.
      name: lookupTableName
      required: true
    - description: Headers for lookup table control.
      isArray: true
      name: headers
      required: true
    - description: Records to write to the specified table.
      isArray: true
      name: records
      required: true
    description: Writes lookup table entry records to a specified Devo table.
    execution: true
    name: devo-write-to-lookup-table
    outputs:
    - contextPath: Devo.RecordsWritten
      description: Lookup records written to the lookup table.
      type: unknown
  dockerimage: demisto/devo:1.0.0.7027
  isfetch: true
  runonce: false
  script: ''
  subtype: python3
  type: python
tests:
- No test - no instance
toversion: 4.1.9
