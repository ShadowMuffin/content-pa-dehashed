category: Utilities
commonfields:
  id: Server Message Block (SMB)
  version: -1
configuration:
- display: Server IP / Hostname (e.g. 1.2.3.4)
  name: hostname
  required: false
  type: 0
- defaultvalue: '445'
  display: Port
  name: port
  required: true
  type: 0
- display: Server NetBIOS (AD) Name
  name: nbname
  required: false
  type: 0
- display: Domain
  name: domain
  required: false
  type: 0
- display: Username
  name: credentials
  required: true
  type: 9
- defaultvalue: 'false'
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: File exchange with an SMB server.
display: Server Message Block (SMB)
name: Server Message Block (SMB)
script:
  commands:
  - arguments:
    - default: false
      description: 'Server IP address / hostname, for example: 1.2.3.4.'
      name: hostname
    - default: false
      description: Server NetBIOS (AD) name.
      name: nbname
    - default: false
      description: The host domain
      name: domain
    - default: true
      description: 'The path to the file, starting from the share, for example: Share/Folder/File.'
      name: file_path
      required: true
    - auto: PREDEFINED
      default: false
      defaultValue: 'yes'
      description: If "yes", the file is downloaded and attached. If "no", only the
        output is attached. Default is yes".
      name: download_and_attach
      predefined:
      - 'yes'
      - 'no'
    deprecated: false
    description: Downloads a file from the SMB server.
    execution: false
    name: smb-download
    outputs:
    - contextPath: File.Size
      description: File size.
      type: number
    - contextPath: File.SHA1
      description: SHA1 hash of the file.
      type: string
    - contextPath: File.SHA256
      description: SHA256 hash of the file.
      type: string
    - contextPath: File.Name
      description: File name.
      type: string
    - contextPath: File.SSDeep
      description: SSDeep hash of the file.
      type: string
    - contextPath: File.EntryID
      description: File entry ID.
      type: string
    - contextPath: File.Info
      description: Information about the file.
      type: string
    - contextPath: File.Type
      description: File type.
      type: string
    - contextPath: File.MD5
      description: MD5 hash of the file.
      type: string
  - arguments:
    - default: false
      description: 'Server IP address / hostname, for example: 1.2.3.4.'
      name: hostname
    - default: false
      description: Server NetBIOS (AD) name.
      name: nbname
    - default: false
      description: The host domain
      name: domain
    - default: false
      description: 'The path to the file, starting from the share, for example: Share/Folder/File.'
      name: file_path
      required: true
    - default: false
      description: EntryID of the file to send to the share.
      name: entryID
    - default: false
      description: File content to send to the share. Ignored if EntryID argument
        is specified.
      name: content
    deprecated: false
    description: Uploads a file to the SMB server.
    execution: false
    name: smb-upload
  dockerimage: demisto/smb:1.0.0.7685
  dockerimage45: demisto/pysmb
  isfetch: false
  runonce: false
  script: '-'
  subtype: python2
  type: python
tests:
- SMB test
toversion: 4.1.9
