description: 'Test playbook for vt.


  vt has a quota of requests per minute that we exceed in the test playbook.


  Sleep for 60 seconds.


  https://support.virustotal.com/hc/en-us/articles/115002118525-The-4-requests-minute-limitation-of-the-Public-API-is-too-low-for-me-how-can-I-have-access-to-a-higher-quota-

  '
id: virusTotal-test-playbook
inputs: []
name: virusTotal-test-playbook
outputs: []
starttaskid: '0'
tasks:
  '0':
    id: '0'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '1'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: d4748b8a-5e9a-499c-8f38-7839c3b77f05
      iscommand: false
      name: ''
      version: -1
    taskid: d4748b8a-5e9a-499c-8f38-7839c3b77f05
    timertriggers: []
    type: start
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 50\n  }\n}"
  '1':
    id: '1'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '51'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      key: {}
      keysToKeep: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: 995fb4e2-6a42-4b82-8590-4968c34b46ea
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 995fb4e2-6a42-4b82-8590-4968c34b46ea
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 185\n  }\n}"
  '10':
    id: '10'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '27'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      key: {}
      keysToKeep: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: 866c3dab-fa54-44f1-87e2-45caaf2bc3b6
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 866c3dab-fa54-44f1-87e2-45caaf2bc3b6
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 4045\n  }\n}"
  '14':
    continueonerror: true
    id: '14'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '79'
    note: false
    quietmode: 0
    scriptarguments:
      long:
        simple: 'true'
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold: {}
      url:
        simple: www.demisto.com
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the reputation of a URL.
      id: d3274bf5-3472-404c-88a3-e8c25c19dd7a
      iscommand: true
      name: url long demisto.com
      script: VirusTotal|||url
      type: regular
      version: -1
    taskid: d3274bf5-3472-404c-88a3-e8c25c19dd7a
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 8420\n  }\n}"
  '15':
    id: '15'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '16'
    note: false
    quietmode: 0
    scriptarguments:
      expectedValue:
        simple: www.demisto.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: e2019911-8b71-4dc8-844f-5c784e8c725a
      iscommand: false
      name: VerifyContext
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: e2019911-8b71-4dc8-844f-5c784e8c725a
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 8770\n  }\n}"
  '16':
    id: '16'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '42'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      key: {}
      keysToKeep: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: 3a5692a0-7ed1-4530-84a0-2da041efd878
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 3a5692a0-7ed1-4530-84a0-2da041efd878
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 8945\n  }\n}"
  '2':
    continueonerror: true
    id: '2'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '60'
    note: false
    quietmode: 0
    scriptarguments:
      fullResponse: {}
      ip:
        simple: 8.8.8.8
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the reputation of an IP address.
      id: b5f5a1ce-2963-4be3-81cf-94d9bf09f495
      iscommand: true
      name: ip
      script: VirusTotal|||ip
      type: regular
      version: -1
    taskid: b5f5a1ce-2963-4be3-81cf-94d9bf09f495
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 1770\n  }\n}"
  '20':
    continueonerror: true
    id: '20'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '68'
    note: false
    quietmode: 0
    scriptarguments:
      file:
        simple: d41d8cd98f00b204e9800998ecf8427e
      long: {}
      retries: {}
      threshold: {}
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the file reputation of the specified hash.
      id: af074911-abad-442a-8d4e-affb076a05e8
      iscommand: true
      name: file (second hash)
      script: VirusTotal|||file
      type: regular
      version: -1
    taskid: af074911-abad-442a-8d4e-affb076a05e8
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 280,\n    \"y\": 4920\n  }\n}"
  '21':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: MD5
                root: File
          operator: isEqualString
          right:
            value:
              simple: d41d8cd98f00b204e9800998ecf8427e
      - - left:
            iscontext: true
            value:
              simple: File.VirusTotal.vtLink
          operator: isExists
      label: 'yes'
    id: '21'
    ignoreworker: false
    nexttasks:
      'yes':
      - '22'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 19dd3349-d6f5-48a1-8ebc-6343af27e78e
      iscommand: false
      name: VerifyContext
      type: condition
      version: -1
    taskid: 19dd3349-d6f5-48a1-8ebc-6343af27e78e
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 5270\n  }\n}"
  '22':
    id: '22'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '23'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      key: {}
      keysToKeep: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: 61b388fb-47a4-4cca-8ca3-9b9a825da5be
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 61b388fb-47a4-4cca-8ca3-9b9a825da5be
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 5445\n  }\n}"
  '23':
    continueonerror: true
    id: '23'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '72'
    note: false
    quietmode: 0
    scriptarguments:
      file:
        simple: d41d8cd98f00b204e9800998ecf8427e
      long:
        simple: 'true'
      retries: {}
      threshold: {}
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the file reputation of the specified hash.
      id: e9241585-430a-4772-8e04-9dbcd73d467c
      iscommand: true
      name: file long (second hash)
      script: VirusTotal|||file
      type: regular
      version: -1
    taskid: e9241585-430a-4772-8e04-9dbcd73d467c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 5620\n  }\n}"
  '24':
    id: '24'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '30'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      key: {}
      keysToKeep: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: f2c5004a-ac46-4a88-8aef-501f5faa9788
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: f2c5004a-ac46-4a88-8aef-501f5faa9788
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 6145\n  }\n}"
  '25':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: MD5
                root: File
          operator: isEqualString
          right:
            value:
              simple: d41d8cd98f00b204e9800998ecf8427e
      label: 'yes'
    id: '25'
    ignoreworker: false
    nexttasks:
      'yes':
      - '24'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: fc324caf-d5a9-4b75-86a4-d358a8722561
      iscommand: false
      name: VerifyContext
      type: condition
      version: -1
    taskid: fc324caf-d5a9-4b75-86a4-d358a8722561
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 5970\n  }\n}"
  '27':
    continueonerror: true
    id: '27'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '66'
    note: false
    quietmode: 0
    scriptarguments:
      file:
        simple: 7657fcb7d772448a6d8504e4b20168b8
      long:
        simple: 'true'
      retries: {}
      threshold: {}
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the file reputation of the specified hash.
      id: e48fea20-7aff-4bb5-8111-5711ebd81ad4
      iscommand: true
      name: file long
      script: VirusTotal|||file
      type: regular
      version: -1
    taskid: e48fea20-7aff-4bb5-8111-5711ebd81ad4
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 4220\n  }\n}"
  '28':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: MD5
                root: File
          operator: isEqualString
          right:
            value:
              simple: 7657fcb7d772448a6d8504e4b20168b8
      label: 'yes'
    id: '28'
    ignoreworker: false
    nexttasks:
      'yes':
      - '29'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: dd9b5725-e2b1-4dcd-8dd8-37bc7d2ea969
      iscommand: false
      name: VerifyContext
      type: condition
      version: -1
    taskid: dd9b5725-e2b1-4dcd-8dd8-37bc7d2ea969
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 4570\n  }\n}"
  '29':
    id: '29'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '20'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      key: {}
      keysToKeep: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: f6c6f5ae-e3e3-4e2b-8435-9a173dc75567
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: f6c6f5ae-e3e3-4e2b-8435-9a173dc75567
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 4745\n  }\n}"
  '3':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: DBotScore.Indicator
          operator: isEqualString
          right:
            value:
              simple: 8.8.8.8
      - - left:
            iscontext: true
            value:
              simple: IP.Geo.Country
          operator: isEqualString
          right:
            value:
              simple: US
      label: 'yes'
    id: '3'
    ignoreworker: false
    nexttasks:
      'yes':
      - '83'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 801d8f74-ed83-4f42-84ba-c066df977c4b
      iscommand: false
      name: VerifyContext
      type: condition
      version: -1
    taskid: 801d8f74-ed83-4f42-84ba-c066df977c4b
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 2120\n  }\n}"
  '30':
    continueonerror: true
    id: '30'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '73'
    note: false
    quietmode: 0
    scriptarguments:
      long: {}
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold:
        simple: '0'
      url:
        simple: http://coffeedoesgood.com
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the reputation of a URL.
      id: 75814240-a785-486d-8ef3-69816336276d
      iscommand: true
      name: url coffedoesgood.com
      script: VirusTotal|||url
      type: regular
      version: -1
    taskid: 75814240-a785-486d-8ef3-69816336276d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 6320\n  }\n}"
  '31':
    id: '31'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '32'
    note: false
    quietmode: 0
    scriptarguments:
      expectedValue:
        simple: http://coffeedoesgood.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 0cb12db3-e987-43cd-8843-93e6d728388b
      iscommand: false
      name: VerifyContext
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 0cb12db3-e987-43cd-8843-93e6d728388b
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 6670\n  }\n}"
  '32':
    id: '32'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '33'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      key: {}
      keysToKeep: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: 738e4faf-f075-4798-879b-b2f299b84d73
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 738e4faf-f075-4798-879b-b2f299b84d73
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 6845\n  }\n}"
  '33':
    continueonerror: true
    id: '33'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '75'
    note: false
    quietmode: 0
    scriptarguments:
      long:
        simple: 'true'
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold:
        simple: '0'
      url:
        simple: http://coffeedoesgood.com
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the reputation of a URL.
      id: 36e4ab0b-6329-47f4-87de-c9c4c419511c
      iscommand: true
      name: url long coffedoesgood.com
      script: VirusTotal|||url
      type: regular
      version: -1
    taskid: 36e4ab0b-6329-47f4-87de-c9c4c419511c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 7020\n  }\n}"
  '34':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: DBotScore.Indicator
          operator: isEqualString
          right:
            value:
              simple: http://coffeedoesgood.com
      - - left:
            iscontext: true
            value:
              simple: URL.DetectionEngines
          operator: isEqualNumber
          right:
            value:
              simple: '70'
      - - left:
            iscontext: true
            value:
              simple: URL.PositiveDetections
          operator: isEqualNumber
          right:
            value:
              simple: '4'
      label: 'yes'
    id: '34'
    ignoreworker: false
    nexttasks:
      'yes':
      - '35'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: f939fd59-f18a-49c9-8a43-e363815bf477
      iscommand: false
      name: VerifyContext
      type: condition
      version: -1
    taskid: f939fd59-f18a-49c9-8a43-e363815bf477
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 7370\n  }\n}"
  '35':
    id: '35'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '36'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      key: {}
      keysToKeep: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: 13bedd49-7bb9-4a03-8b6b-234d28d42cd2
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 13bedd49-7bb9-4a03-8b6b-234d28d42cd2
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 7545\n  }\n}"
  '36':
    continueonerror: true
    id: '36'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '77'
    note: false
    quietmode: 0
    scriptarguments:
      long: {}
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold: {}
      url:
        simple: www.demisto.com
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the reputation of a URL.
      id: c1c2768f-388c-4a57-8fb8-5d6de0f098ce
      iscommand: true
      name: url demisto.com
      script: VirusTotal|||url
      type: regular
      version: -1
    taskid: c1c2768f-388c-4a57-8fb8-5d6de0f098ce
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 7720\n  }\n}"
  '37':
    id: '37'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '38'
    note: false
    quietmode: 0
    scriptarguments:
      expectedValue:
        simple: www.demisto.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 2742dbc1-7866-4999-888e-0f67980b1137
      iscommand: false
      name: VerifyContext
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 2742dbc1-7866-4999-888e-0f67980b1137
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 8070\n  }\n}"
  '38':
    id: '38'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '14'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      key: {}
      keysToKeep: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: c80c3dc0-e864-4085-897d-7198e22a0a55
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: c80c3dc0-e864-4085-897d-7198e22a0a55
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 8245\n  }\n}"
  '4':
    id: '4'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '7'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      key: {}
      keysToKeep: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: 5d0fb28d-ec14-4e8f-8ca1-dbcac35a0b8c
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 5d0fb28d-ec14-4e8f-8ca1-dbcac35a0b8c
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 2645\n  }\n}"
  '42':
    continueonerror: true
    id: '42'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '81'
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: demisto.com
      fullResponse: {}
      long: {}
      retries: {}
      sampleSize: {}
      threshold:
        simple: '0'
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the reputation of a domain.
      id: fa24cc24-feb8-4445-8cd3-cf627bc182f3
      iscommand: true
      name: domain
      script: VirusTotal|||domain
      type: regular
      version: -1
    taskid: fa24cc24-feb8-4445-8cd3-cf627bc182f3
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 9130\n  }\n}"
  '43':
    id: '43'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '44'
    note: false
    quietmode: 0
    scriptarguments:
      expectedValue:
        simple: demisto.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 6e61b708-4c62-48d8-87b2-94515a92fb42
      iscommand: false
      name: VerifyContext
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 6e61b708-4c62-48d8-87b2-94515a92fb42
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 9470\n  }\n}"
  '44':
    id: '44'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '93'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      key: {}
      keysToKeep: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: 51214195-80d2-437e-8361-abb5e555cc30
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 51214195-80d2-437e-8361-abb5e555cc30
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 9645\n  }\n}"
  '5':
    id: '5'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '6'
    note: false
    quietmode: 0
    scriptarguments:
      expectedValue:
        simple: demisto.com
      fields: {}
      path:
        simple: DBotScore.Indicator
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: 7878f1ec-9f4c-46da-8340-3c397fbcaf47
      iscommand: false
      name: VerifyContext
      scriptName: VerifyContext
      type: regular
      version: -1
    taskid: 7878f1ec-9f4c-46da-8340-3c397fbcaf47
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3170\n  }\n}"
  '51':
    id: '51'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '52'
    note: false
    quietmode: 0
    scriptarguments:
      append: {}
      key:
        simple: File.SHA1
      value:
        simple: 3395856ce81f2b7382dee72602f798b642f14140
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Sets a value into the context with the given context key
      id: 897f8585-a6f4-4548-85e5-bddd3a03e4e1
      iscommand: false
      name: Set
      scriptName: Set
      type: regular
      version: -1
    taskid: 897f8585-a6f4-4548-85e5-bddd3a03e4e1
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 370\n  }\n}"
  '52':
    id: '52'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '53'
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: 'true'
      key:
        simple: File.SHA1
      value:
        simple: cf8bd9dfddff007f75adf4c2be48005cea317c62
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Sets a value into the context with the given context key
      id: 0d0da4f7-15b8-4521-84d3-cc401ca76f3f
      iscommand: false
      name: Set2
      scriptName: Set
      type: regular
      version: -1
    taskid: 0d0da4f7-15b8-4521-84d3-cc401ca76f3f
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 545\n  }\n}"
  '53':
    continueonerror: true
    id: '53'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '58'
    note: false
    quietmode: 0
    scriptarguments:
      file:
        complex:
          accessor: SHA1
          root: File
          transformers:
          - args:
              index:
                value:
                  simple: '0'
            operator: atIndex
      long: {}
      retries: {}
      threshold:
        simple: '1'
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the file reputation of the specified hash.
      id: 03c969d5-6a6c-405c-8b90-e3f6ff8917c2
      iscommand: true
      name: File (1 call)
      script: VirusTotal|||file
      type: regular
      version: -1
    taskid: 03c969d5-6a6c-405c-8b90-e3f6ff8917c2
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 720\n  }\n}"
  '54':
    id: '54'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '85'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      index: {}
      key: {}
      keysToKeep: {}
      subplaybook: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: 343a7192-0d56-480f-8284-1a830db02667
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 343a7192-0d56-480f-8284-1a830db02667
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 1420\n  }\n}"
  '56':
    id: '56'
    ignoreworker: false
    nexttasks:
      'yes':
      - '57'
    note: false
    quietmode: 0
    scriptarguments:
      value:
        complex:
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.MD5
              operator: isEqualString
              right:
                value:
                  simple: 44d88612fea8a8f36de82e1278abb02f
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: 6673cf1b-e726-4db3-8811-fd90ed2769f2
      iscommand: false
      name: Exists
      scriptName: Exists
      type: condition
      version: -1
    taskid: 6673cf1b-e726-4db3-8811-fd90ed2769f2
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1070\n  }\n}"
  '57':
    id: '57'
    ignoreworker: false
    nexttasks:
      'yes':
      - '54'
    note: false
    quietmode: 0
    scriptarguments:
      value:
        complex:
          accessor: MD5
          filters:
          - - left:
                iscontext: true
                value:
                  simple: File.MD5
              operator: isEqualString
              right:
                value:
                  simple: 44d88612fea8a8f36de82e1278abb02f
          root: File
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Check if a given value exists in the context. Will return 'no'
        for empty empty arrays. To be used mostly with DQ and selectors.
      id: f4a30eb7-63cf-42d3-8e02-a81faadbf8e2
      iscommand: false
      name: Exists2
      scriptName: Exists
      type: condition
      version: -1
    taskid: f4a30eb7-63cf-42d3-8e02-a81faadbf8e2
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 1245\n  }\n}"
  '58':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isExists
      label: 'yes'
    id: '58'
    ignoreworker: false
    nexttasks:
      '#default#':
      - '56'
      'yes':
      - '59'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: a1d173cd-e1e4-485d-8725-79ea43996d9a
      iscommand: false
      name: Check for error
      type: condition
      version: -1
    taskid: a1d173cd-e1e4-485d-8725-79ea43996d9a
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 895\n  }\n}"
  '59':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isEqualString
          right:
            value:
              simple: No content received. Possible API rate limit reached.
      label: 'yes'
    id: '59'
    ignoreworker: false
    nexttasks:
      'yes':
      - '54'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 991f36f2-dfcf-49cf-807f-9d74456634aa
      iscommand: false
      name: Check if error is API-RATE
      type: condition
      version: -1
    taskid: 991f36f2-dfcf-49cf-807f-9d74456634aa
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 1245\n  }\n}"
  '6':
    id: '6'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '8'
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      key: {}
      keysToKeep: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: 2b653488-9328-4e52-84ea-d68e91b25e2d
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: 2b653488-9328-4e52-84ea-d68e91b25e2d
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 3345\n  }\n}"
  '60':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isExists
      label: 'yes'
    id: '60'
    ignoreworker: false
    nexttasks:
      '#default#':
      - '3'
      'yes':
      - '61'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 510a4c04-9bc3-4b87-8293-dd73932a42d2
      iscommand: false
      name: Check for error
      type: condition
      version: -1
    taskid: 510a4c04-9bc3-4b87-8293-dd73932a42d2
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 1945\n  }\n}"
  '61':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isEqualString
          right:
            value:
              simple: No content received. Possible API rate limit reached.
      label: 'yes'
    id: '61'
    ignoreworker: false
    nexttasks:
      'yes':
      - '83'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 4070efc2-d697-4285-8283-236a833e7cd9
      iscommand: false
      name: Check if error is API-RATE
      type: condition
      version: -1
    taskid: 4070efc2-d697-4285-8283-236a833e7cd9
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 2120\n  }\n}"
  '62':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isExists
      label: 'yes'
    id: '62'
    ignoreworker: false
    nexttasks:
      '#default#':
      - '5'
      'yes':
      - '63'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 15af7fd7-7666-4ab6-8d82-a3bc54053f13
      iscommand: false
      name: Check for error
      type: condition
      version: -1
    taskid: 15af7fd7-7666-4ab6-8d82-a3bc54053f13
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 2995\n  }\n}"
  '63':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isEqualString
          right:
            value:
              simple: No content received. Possible API rate limit reached.
      label: 'yes'
    id: '63'
    ignoreworker: false
    nexttasks:
      'yes':
      - '6'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 09fc3aa5-45ad-427f-841d-5cfebd29634f
      iscommand: false
      name: Check if error is API-RATE
      type: condition
      version: -1
    taskid: 09fc3aa5-45ad-427f-841d-5cfebd29634f
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 3170\n  }\n}"
  '64':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isEqualString
          right:
            value:
              simple: No content received. Possible API rate limit reached.
      label: 'yes'
    id: '64'
    ignoreworker: false
    nexttasks:
      'yes':
      - '10'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: c7ae112c-e00f-4eec-84ae-b56524768737
      iscommand: false
      name: Check if error is API-RATE
      type: condition
      version: -1
    taskid: c7ae112c-e00f-4eec-84ae-b56524768737
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 3870\n  }\n}"
  '65':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isExists
      label: 'yes'
    id: '65'
    ignoreworker: false
    nexttasks:
      '#default#':
      - '9'
      'yes':
      - '64'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 495269d2-826c-4cb9-86b9-660417e9ebd8
      iscommand: false
      name: Check for error
      type: condition
      version: -1
    taskid: 495269d2-826c-4cb9-86b9-660417e9ebd8
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 3695\n  }\n}"
  '66':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isExists
      label: 'yes'
    id: '66'
    ignoreworker: false
    nexttasks:
      '#default#':
      - '28'
      'yes':
      - '67'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 69cebfaa-db9d-4765-88e3-81f2e56fecab
      iscommand: false
      name: Check for error
      type: condition
      version: -1
    taskid: 69cebfaa-db9d-4765-88e3-81f2e56fecab
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 4395\n  }\n}"
  '67':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isEqualString
          right:
            value:
              simple: No content received. Possible API rate limit reached.
      label: 'yes'
    id: '67'
    ignoreworker: false
    nexttasks:
      'yes':
      - '29'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 12434655-4d73-42fe-833d-8572e284dc00
      iscommand: false
      name: Check if error is API-RATE
      type: condition
      version: -1
    taskid: 12434655-4d73-42fe-833d-8572e284dc00
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 4570\n  }\n}"
  '68':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isExists
      label: 'yes'
    id: '68'
    ignoreworker: false
    nexttasks:
      '#default#':
      - '21'
      'yes':
      - '69'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 8b9bc3bc-9982-40d8-81a4-c339326ae262
      iscommand: false
      name: Check for error
      type: condition
      version: -1
    taskid: 8b9bc3bc-9982-40d8-81a4-c339326ae262
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 5095\n  }\n}"
  '69':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isEqualString
          right:
            value:
              simple: No content received. Possible API rate limit reached.
      label: 'yes'
    id: '69'
    ignoreworker: false
    nexttasks:
      'yes':
      - '22'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 3f2dfcea-f289-47b3-8dfc-657dac985dcc
      iscommand: false
      name: Check if error is API-RATE
      type: condition
      version: -1
    taskid: 3f2dfcea-f289-47b3-8dfc-657dac985dcc
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 5270\n  }\n}"
  '7':
    continueonerror: true
    id: '7'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '62'
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: demisto.com
      fullResponse: {}
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the reputation of a domain.
      id: 82e394e7-d191-4435-83da-bc2d106f9f0f
      iscommand: true
      name: domain
      script: VirusTotal|||domain
      type: regular
      version: -1
    taskid: 82e394e7-d191-4435-83da-bc2d106f9f0f
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 2820\n  }\n}"
  '71':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isEqualString
          right:
            value:
              simple: No content received. Possible API rate limit reached.
      label: 'yes'
    id: '71'
    ignoreworker: false
    nexttasks:
      'yes':
      - '24'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 900d62e2-3e32-4d86-8742-f9ad5fb89313
      iscommand: false
      name: Check if error is API-RATE
      type: condition
      version: -1
    taskid: 900d62e2-3e32-4d86-8742-f9ad5fb89313
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 5970\n  }\n}"
  '72':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isExists
      label: 'yes'
    id: '72'
    ignoreworker: false
    nexttasks:
      '#default#':
      - '25'
      'yes':
      - '71'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: a19f8bcc-4caf-410b-87f7-08f1b3f6dcc6
      iscommand: false
      name: Check for error
      type: condition
      version: -1
    taskid: a19f8bcc-4caf-410b-87f7-08f1b3f6dcc6
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 5795\n  }\n}"
  '73':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isExists
      label: 'yes'
    id: '73'
    ignoreworker: false
    nexttasks:
      '#default#':
      - '31'
      'yes':
      - '74'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 5faf3a73-9431-4dfb-869e-f3532af2100f
      iscommand: false
      name: Check for error
      type: condition
      version: -1
    taskid: 5faf3a73-9431-4dfb-869e-f3532af2100f
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 6495\n  }\n}"
  '74':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isEqualString
          right:
            value:
              simple: No content received. Possible API rate limit reached.
      label: 'yes'
    id: '74'
    ignoreworker: false
    nexttasks:
      'yes':
      - '32'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: a8ef6d72-794d-4f02-8003-8241133cb019
      iscommand: false
      name: Check if error is API-RATE
      type: condition
      version: -1
    taskid: a8ef6d72-794d-4f02-8003-8241133cb019
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 6670\n  }\n}"
  '75':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isExists
      label: 'yes'
    id: '75'
    ignoreworker: false
    nexttasks:
      '#default#':
      - '34'
      'yes':
      - '76'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 8d1f736e-c622-46e6-854e-3a53ed0f4131
      iscommand: false
      name: Check for error
      type: condition
      version: -1
    taskid: 8d1f736e-c622-46e6-854e-3a53ed0f4131
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 7195\n  }\n}"
  '76':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isEqualString
          right:
            value:
              simple: No content received. Possible API rate limit reached.
      label: 'yes'
    id: '76'
    ignoreworker: false
    nexttasks:
      'yes':
      - '35'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 5566aaf0-1a6b-4ba9-8ea7-2432895158a1
      iscommand: false
      name: Check if error is API-RATE
      type: condition
      version: -1
    taskid: 5566aaf0-1a6b-4ba9-8ea7-2432895158a1
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 7370\n  }\n}"
  '77':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isExists
      label: 'yes'
    id: '77'
    ignoreworker: false
    nexttasks:
      '#default#':
      - '37'
      'yes':
      - '78'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 1ad6d7fa-f070-41cd-8ab4-2127178b64b6
      iscommand: false
      name: Check for error
      type: condition
      version: -1
    taskid: 1ad6d7fa-f070-41cd-8ab4-2127178b64b6
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 7895\n  }\n}"
  '78':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isEqualString
          right:
            value:
              simple: No content received. Possible API rate limit reached.
      label: 'yes'
    id: '78'
    ignoreworker: false
    nexttasks:
      'yes':
      - '38'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: c0e80e60-3464-4832-80c0-c8250c0ad864
      iscommand: false
      name: Check if error is API-RATE
      type: condition
      version: -1
    taskid: c0e80e60-3464-4832-80c0-c8250c0ad864
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 8070\n  }\n}"
  '79':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isExists
      label: 'yes'
    id: '79'
    ignoreworker: false
    nexttasks:
      '#default#':
      - '15'
      'yes':
      - '80'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 321e2167-1cbe-4469-8cc6-462679fd895a
      iscommand: false
      name: Check for error
      type: condition
      version: -1
    taskid: 321e2167-1cbe-4469-8cc6-462679fd895a
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 8595\n  }\n}"
  '8':
    continueonerror: true
    id: '8'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '65'
    note: false
    quietmode: 0
    scriptarguments:
      file:
        simple: 7657fcb7d772448a6d8504e4b20168b8
      long: {}
      retries: {}
      threshold: {}
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the file reputation of the specified hash.
      id: f6967db6-a526-4d4f-86d9-b500cc3415d3
      iscommand: true
      name: file
      script: VirusTotal|||file
      type: regular
      version: -1
    taskid: f6967db6-a526-4d4f-86d9-b500cc3415d3
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 3520\n  }\n}"
  '80':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isEqualString
          right:
            value:
              simple: No content received. Possible API rate limit reached.
      label: 'yes'
    id: '80'
    ignoreworker: false
    nexttasks:
      'yes':
      - '16'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 1a5b7fdb-93c6-498e-8c60-44e5451bc931
      iscommand: false
      name: Check if error is API-RATE
      type: condition
      version: -1
    taskid: 1a5b7fdb-93c6-498e-8c60-44e5451bc931
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 8770\n  }\n}"
  '81':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isExists
      label: 'yes'
    id: '81'
    ignoreworker: false
    nexttasks:
      '#default#':
      - '43'
      'yes':
      - '82'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: d8f39838-e45d-455a-845b-33668ad5706f
      iscommand: false
      name: Check for error
      type: condition
      version: -1
    taskid: d8f39838-e45d-455a-845b-33668ad5706f
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 9295\n  }\n}"
  '82':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: ${Error}
          operator: isEqualString
          right:
            value:
              simple: No content received. Possible API rate limit reached.
      label: 'yes'
    id: '82'
    ignoreworker: false
    nexttasks:
      'yes':
      - '44'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 4d51b910-e7bc-4f84-8df4-8b8e5b1fd70f
      iscommand: false
      name: Check if error is API-RATE
      type: condition
      version: -1
    taskid: 4d51b910-e7bc-4f84-8df4-8b8e5b1fd70f
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 480,\n    \"y\": 9470\n  }\n}"
  '83':
    id: '83'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '84'
    note: false
    quietmode: 0
    scriptarguments:
      fullResponse: {}
      ip:
        simple: 8.8.8.8
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the reputation of an IP address.
      id: d301b2f3-f2b3-4b3a-863e-efd0039e7568
      iscommand: true
      name: ip
      script: VirusTotal|||ip
      type: regular
      version: -1
    taskid: d301b2f3-f2b3-4b3a-863e-efd0039e7568
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 2295\n  }\n}"
  '84':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Address
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: IP.Address
                    operator: hasLength
                    right:
                      value:
                        simple: '1'
                root: IP
          operator: isExists
      label: 'yes'
    id: '84'
    ignoreworker: false
    nexttasks:
      'yes':
      - '4'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: b7314577-fd22-4245-848f-e7f8a8fb3c35
      iscommand: false
      name: Verify no duplicates
      type: condition
      version: -1
    taskid: b7314577-fd22-4245-848f-e7f8a8fb3c35
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 2470\n  }\n}"
  '85':
    id: '85'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '2'
    note: false
    quietmode: 0
    scriptarguments:
      seconds:
        simple: '61'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Sleep for X seconds
      id: 51a40df6-7113-4083-8370-c8bec5d7e9ce
      iscommand: false
      name: Sleep
      scriptName: Sleep
      type: regular
      version: -1
    taskid: 51a40df6-7113-4083-8370-c8bec5d7e9ce
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 1595\n  }\n}"
  '86':
    continueonerror: true
    id: '86'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '87'
    note: false
    quietmode: 0
    scriptarguments:
      fullResponse: {}
      ip:
        simple: 103.225.52.112,8.8.8.8
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the reputation of an IP address.
      id: 4bb76e1f-9cad-44b5-873c-d4405d710fe1
      iscommand: true
      name: ip_with_CSV
      script: VirusTotal|||ip
      type: regular
      version: -1
    taskid: 4bb76e1f-9cad-44b5-873c-d4405d710fe1
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 9930\n  }\n}"
  '87':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: IP.Address
          operator: containsGeneral
          right:
            value:
              simple: 8.8.8.8
      - - left:
            iscontext: true
            value:
              simple: IP.Address
          operator: containsGeneral
          right:
            value:
              simple: 103.225.52.112
      label: 'yes'
    id: '87'
    ignoreworker: false
    nexttasks:
      'yes':
      - '88'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 88b98d70-da03-4b61-84d9-41fbae76db2b
      iscommand: false
      name: verify_ip_csv
      type: condition
      version: -1
    taskid: 88b98d70-da03-4b61-84d9-41fbae76db2b
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 10080\n  }\n}"
  '88':
    id: '88'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '89'
    note: false
    quietmode: 0
    scriptarguments:
      long: {}
      retries: {}
      sampleSize: {}
      submitWait: {}
      threshold: {}
      url:
        simple: https://demisto.com,https://mail.google.com/mail/u/0/?pli=1#inbox
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the reputation of a URL.
      id: 585ec7fc-c513-4d89-870d-e3a77429adf0
      iscommand: true
      name: url_with_csv
      script: VirusTotal|||url
      type: regular
      version: -1
    taskid: 585ec7fc-c513-4d89-870d-e3a77429adf0
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 10240\n  }\n}"
  '89':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: URL.Data
          operator: containsGeneral
          right:
            value:
              simple: https://demisto.com
      - - left:
            iscontext: true
            value:
              simple: URL.Data
          operator: containsGeneral
          right:
            value:
              simple: https://mail.google.com/mail/u/0/?pli=1#inbox
      label: 'yes'
    id: '89'
    ignoreworker: false
    nexttasks:
      'yes':
      - '94'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: 67bf877d-8433-44ae-8d9e-fcf5593254a2
      iscommand: false
      name: verify_url_csv
      type: condition
      version: -1
    taskid: 67bf877d-8433-44ae-8d9e-fcf5593254a2
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 10400\n  }\n}"
  '9':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: File.MD5
          operator: isEqualString
          right:
            value:
              simple: 7657fcb7d772448a6d8504e4b20168b8
      - - left:
            iscontext: true
            value:
              simple: File.DetectionEngines
          operator: isEqualNumber
          right:
            value:
              simple: '72'
      - - left:
            iscontext: true
            value:
              simple: File.PositiveDetections
          operator: isEqualString
          right:
            value:
              simple: '69'
      label: 'yes'
    id: '9'
    ignoreworker: false
    nexttasks:
      'yes':
      - '10'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: 'Verifies path in context:

        - Verifies path existence

        - If matching object is an array: verify fields exists in each of the objects
        in the array

        - If matching object is not an array: verify fields exists in matching object

        - if ''expectedValue'' is given: ensure that the given value is equal to the
        context path'
      id: ac33cd85-2239-4cf5-812e-8da005b1099f
      iscommand: false
      name: VerifyContext
      type: condition
      version: -1
    taskid: ac33cd85-2239-4cf5-812e-8da005b1099f
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 50,\n    \"y\": 3870\n  }\n}"
  '90':
    id: '90'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '91'
    note: false
    quietmode: 0
    scriptarguments:
      domain:
        simple: demisto.com,google.com
      fullResponse: {}
      long: {}
      retries: {}
      sampleSize: {}
      threshold: {}
      wait: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: VirusTotal
      description: Checks the reputation of a domain.
      id: 16b8616e-59a1-4510-8c2e-f289453d29fa
      iscommand: true
      name: domain_with_csv
      script: VirusTotal|||domain
      type: regular
      version: -1
    taskid: 16b8616e-59a1-4510-8c2e-f289453d29fa
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 10700\n  }\n}"
  '91':
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              simple: Domain.Name
          operator: containsGeneral
          right:
            value:
              simple: demisto.com
      - - left:
            iscontext: true
            value:
              simple: Domain.Name
          operator: containsGeneral
          right:
            value:
              simple: google.com
      label: 'yes'
    id: '91'
    ignoreworker: false
    nexttasks:
      'yes':
      - '92'
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      id: ab3acc0c-b6b7-4407-809b-e8a8772eb9eb
      iscommand: false
      name: verify_domain_csv
      type: condition
      version: -1
    taskid: ab3acc0c-b6b7-4407-809b-e8a8772eb9eb
    timertriggers: []
    type: condition
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 10880\n  }\n}"
  '92':
    id: '92'
    ignoreworker: false
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: 'yes'
      key: {}
      keysToKeep: {}
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Delete field from context
      id: f3472ec8-75a5-4c53-8756-0a3fe284cb80
      iscommand: false
      name: DeleteContext
      scriptName: DeleteContext
      type: regular
      version: -1
    taskid: f3472ec8-75a5-4c53-8756-0a3fe284cb80
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 11065\n  }\n}"
  '93':
    id: '93'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '86'
    note: false
    quietmode: 0
    scriptarguments:
      seconds:
        simple: '61'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Sleep for X seconds
      id: dd13848f-75e5-4c31-8d83-a1ca233fdb37
      iscommand: false
      name: Sleep
      scriptName: Sleep
      type: regular
      version: -1
    taskid: dd13848f-75e5-4c31-8d83-a1ca233fdb37
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 9790\n  }\n}"
  '94':
    id: '94'
    ignoreworker: false
    nexttasks:
      '#none#':
      - '90'
    note: false
    quietmode: 0
    scriptarguments:
      seconds:
        simple: '61'
    separatecontext: false
    skipunavailable: false
    task:
      brand: ''
      description: Sleep for X seconds
      id: 4cfda401-5673-4bff-83e2-f782970c1b92
      iscommand: false
      name: Sleep
      scriptName: Sleep
      type: regular
      version: -1
    taskid: 4cfda401-5673-4bff-83e2-f782970c1b92
    timertriggers: []
    type: regular
    view: "{\n  \"position\": {\n    \"x\": 265,\n    \"y\": 10550\n  }\n}"
toversion: 4.1.9
version: -1
view: "{\n  \"linkLabelsPosition\": {},\n  \"paper\": {\n    \"dimensions\": {\n \
  \     \"height\": 11110,\n      \"width\": 810,\n      \"x\": 50,\n      \"y\":\
  \ 50\n    }\n  }\n}"
