args:
- description: Full XML contents of the Nexpose report. If not provided, it will be
    taken from the Incident Details.
  name: report
comment: Parse a specific server nexpose response in to a table of vulnerabilities.
commonfields:
  id: NexposeVulnExtractor
  version: -1
dependson:
  must:
  - nexpose
name: NexposeVulnExtractor
script: "var report = args.report ? args.report : incidents[0].details;\nvar res =\
  \ report.match(/(<test .*>)/g);\nvar contents = [];\nfor (var i =0; i < res.length;\
  \ i++) {\n    var current = /(<test id=\"(.*)\" key=\"(.*)\" status=\"(.*)\" scan-id=\"\
  (.*)\" vulnerable-since=\"(.*)\" pci-compliance-status=\"(.*)\">)/g.exec(res[i]);\n\
  \    contents.push({Name: current[2], Status: current[4], Since: current[6], Compliance:\
  \ current[7]});\n}\nreturn {Contents: contents,\n         ContentsFormat: formats.table,\n\
  \         Type: entryTypes.note};"
scripttarget: 0
system: true
tags:
- nexpose
timeout: 0s
toversion: 4.1.9
type: javascript
