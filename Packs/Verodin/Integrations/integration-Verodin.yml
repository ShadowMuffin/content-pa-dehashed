category: Network Security
commonfields:
  id: Verodin
  version: -1
configuration:
- defaultvalue: ''
  display: Server URL (e.g. https://192.168.0.1)
  name: server
  required: true
  type: 0
- defaultvalue: ''
  display: Port
  name: port
  required: true
  type: 0
- defaultvalue: ''
  display: Username
  name: credentials
  required: false
  type: 9
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
description: Verodin simulations and topology
display: Verodin
hidden: false
image: data:image/png;base64,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
name: Verodin
script:
  commands:
  - arguments: []
    description: Lists all Nodes and their details
    name: verodin-get-topology-nodes
    outputs:
    - contextPath: Verodin.Nodes.ID
      description: Node id
    - contextPath: Verodin.Nodes.CommMode
      description: Node comm mode
    - contextPath: Verodin.Nodes.CodeType
      description: Node code type
    - contextPath: Verodin.Nodes.Description
      description: Node description
    - contextPath: Verodin.Nodes.Gateway
      description: Node getaway
    - contextPath: Verodin.Nodes.Hostname
      description: Node hostname
    - contextPath: Verodin.Nodes.LastComms
      description: Node last comms
    - contextPath: Verodin.Nodes.LastUpdate
      description: Node last update
    - contextPath: Verodin.Nodes.Location
      description: Node location
    - contextPath: Verodin.Nodes.Tags
      description: Node tags
    - contextPath: Verodin.Nodes.MmgmtIP
      description: Node mmgmt ip
    - contextPath: Verodin.Nodes.Name
      description: Node name
    - contextPath: Verodin.Nodes.SecurityZoneID
      description: Node security zone id
    - contextPath: Verodin.Nodes.Version
      description: Node version
    - contextPath: Verodin.Nodes.NetMask
      description: Node net mask
    - contextPath: Verodin.Nodes.OrganizationID
      description: Node organization id
    - contextPath: Verodin.Nodes.OS.Type
      description: Node os type
    - contextPath: Verodin.Nodes.OS.Architecture
      description: Node os architecture
    - contextPath: Verodin.Nodes.OS.Full
      description: Node os full
    - contextPath: Verodin.Nodes.Processor
      description: Node processor
  - arguments: []
    description: Lists Security Zones, Nodes within those Zones, and their connectivity
      to other Zones
    name: verodin-get-topology-map
    outputs:
    - contextPath: Verodin.Topolody.Device.ID
      description: Device ID
    - contextPath: Verodin.Topolody.Device.Updated
      description: Device update
    - contextPath: Verodin.Topolody.Device.OrganizationID
      description: Device organization id
    - contextPath: Verodin.Topolody.Device.NetworkDeviceID
      description: Device network device id
    - contextPath: Verodin.Topolody.Device.IP
      description: Device ip
    - contextPath: Verodin.Topolody.Nodes.MgmtIP
      description: Node mgmt ip
    - contextPath: Verodin.Topolody.Nodes.Name
      description: Node name
    - contextPath: Verodin.Topolody.Nodes.OS
      description: Node os
    - contextPath: Verodin.Topolody.Zones.Description
      description: Zone name
    - contextPath: Verodin.Topolody.Zones.Name
      description: Zone description
    - contextPath: Verodin.Topolody.Zone.Devices.Interfaces.Edges.From
      description: Edge name
    - contextPath: Verodin.Topolody.Zone.Devices.Interfaces.To
      description: Edge to
    - contextPath: Verodin.Topolody.Zone.Devices.Interfaces.Edges.Type
      description: Edge type
    - contextPath: Verodin.Topolody.Zone.Devices.Interfaces.Edges.Through
      description: Edge through
    - contextPath: Verodin.Topolody.Zone.Devices.Edges.To
      description: Edge to
    - contextPath: Verodin.Topolody.Zone.Devices.Edges.Type
      description: Edge type
    - contextPath: Verodin.Topolody.Zone.Devices.Edges.Through
      description: Edge through
    - contextPath: Verodin.Topolody.Zone.Devices.Edges.From
      description: Edge from
  - arguments: []
    description: Gets an array of all Actions and their details
    name: verodin-manage-sims-actions
    outputs:
    - contextPath: Verodin.Simulations.Actions.ID
      description: Simulation action id
    - contextPath: Verodin.Simulations.Actions.Type
      description: Simulation action type
    - contextPath: Verodin.Simulations.Actions.Created
      description: Simulation action created
    - contextPath: Verodin.Simulations.Actions.Disabled
      description: Simulation action disabled
    - contextPath: Verodin.Simulations.Actions.Name
      description: Simulation action name
    - contextPath: Verodin.Simulations.Actions.OrganizationID
      description: Simulation action organization id
    - contextPath: Verodin.Simulations.Actions.RequireEndpoint
      description: Simulation action require endpoint
    - contextPath: Verodin.Simulations.Actions.Updated
      description: Simulation action updated
    - contextPath: Verodin.Simulations.Actions.Tags.User
      description: Simulation action user tags
    - contextPath: Verodin.Simulations.Actions.Tags.Verodin
      description: Simulation action verodin tags
    - contextPath: Verodin.Simulations.Actions.Tags.Vid
      description: Simulation action vid
  - arguments:
    - description: "Action\u2019s ID number"
      name: id
      required: true
    - description: ID number of source Node
      name: attack_node_id_1
    - description: ID number of destination Node
      name: target_node_id_1
    description: Executes the specified Action
    name: verodin-manage-sims-actions-run
    outputs:
    - contextPath: Verodin.Jobs.ID
      description: Job id
    - contextPath: Verodin.Jobs.Description
      description: Job description
    - contextPath: Verodin.Jobs.Created
      description: Job created
    - contextPath: Verodin.Jobs.Name
      description: Job name
    - contextPath: Verodin.Jobs.OrganizationID
      description: Job organization id
    - contextPath: Verodin.Jobs.Updated
      description: Job updated
    - contextPath: Verodin.Jobs.NodeActionQueueID
      description: Job node action queue id
    - contextPath: Verodin.Jobs.PlanID
      description: Job plan id
    - contextPath: Verodin.Jobs.Tags.Verodin
      description: Job verodin tags
    - contextPath: Verodin.Jobs.Progress
      description: Job progress
    - contextPath: Verodin.Jobs.SimulationID
      description: Job simulation id
    - contextPath: Verodin.Jobs.Status
      description: Job status
    - contextPath: Verodin.Jobs.UserID
      description: Job user id
  - arguments: []
    description: Returns an array of all Security Zones and their details
    name: verodin-get-security-zones
    outputs:
    - contextPath: Verodin.Zones.ID
      description: Zone id
    - contextPath: Verodin.Zones.Description
      description: Zone description
    - contextPath: Verodin.Zones.Created
      description: Zone created
    - contextPath: Verodin.Zones.Disabled
      description: Zone disabled
    - contextPath: Verodin.Zones.Name
      description: Zone name
    - contextPath: Verodin.Zones.OrganizationID
      description: Zone organization ID
    - contextPath: Verodin.Zones.Updated
      description: Zone updated
  - arguments:
    - description: Security Zone ID number
      name: id
      required: true
    description: Gets details on the specified Security Zone
    name: verodin-get-security-zone
    outputs:
    - contextPath: Verodin.Zones.ID
      description: Zone id
    - contextPath: Verodin.Zones.Description
      description: Zone description
    - contextPath: Verodin.Zones.Created
      description: Zone created
    - contextPath: Verodin.Zones.Disabled
      description: Zone disabled
    - contextPath: Verodin.Zones.Name
      description: Zone name
    - contextPath: Verodin.Zones.OrganizationID
      description: Zone organization ID
    - contextPath: Verodin.Zones.Updated
      description: Zone updated
  - arguments:
    - description: Security Zone ID number
      name: id
      required: true
    description: Deletes the specified Security Zone
    name: verodin-delete-security-zone
  - arguments:
    - auto: PREDEFINED
      description: Simulation type
      name: sim_type
      predefined:
      - sequence
      - eval
      required: true
    description: Gets an array of all Sequences or Evaluations
    name: verodin-get-sims-of-type
    outputs:
    - contextPath: Verodin.Simulations.ID
      description: Simulation id
    - contextPath: Verodin.Simulations.Type
      description: Simulation type
    - contextPath: Verodin.Simulations.Created
      description: Simulation created
    - contextPath: Verodin.Simulations.Disabled
      description: Simulation disabled
    - contextPath: Verodin.Simulations.Name
      description: Simulation name
    - contextPath: Verodin.Simulations.OrganizationID
      description: Simulation organization id
    - contextPath: Verodin.Simulations.RequireEndpoint
      description: Simulation require endpoint
    - contextPath: Verodin.Simulations.Updated
      description: Simulation updated
    - contextPath: Verodin.Simulations.Tags.User
      description: Simulation user tags
    - contextPath: Verodin.Simulations.Tags.Verodin
      description: Simulation verodin tags
    - contextPath: Verodin.Simulations.Vid
      description: Simulation vid
    - contextPath: Verodin.Simulations.StopOnError
      description: Simulation stop on error
  - arguments:
    - description: Job ID number
      name: id
      required: true
    description: Gets details regarding the specified Job
    name: verodin-get-sim
    outputs:
    - contextPath: Verodin.Simulations.ID
      description: Simulation id
    - contextPath: Verodin.Simulations.Type
      description: Simulation type
    - contextPath: Verodin.Simulations.Created
      description: Simulation created
    - contextPath: Verodin.Simulations.Disabled
      description: Simulation disabled
    - contextPath: Verodin.Simulations.Name
      description: Simulation name
    - contextPath: Verodin.Simulations.OrganizationID
      description: Simulation organization id
    - contextPath: Verodin.Simulations.StopOnError
      description: Simulation stop on error
    - contextPath: Verodin.Simulations.Updated
      description: Simulation updated
    - contextPath: Verodin.Simulations.Actions
      description: Simulation actions
    - contextPath: Verodin.Simulations.Tags.User
      description: Simulation user tags
    - contextPath: Verodin.Simulations.Tags.Verodin
      description: Simulation verodin tags
    - contextPath: Verodin.Simulations.Vid
      description: Simulation vid
    - contextPath: Verodin.Simulations.Step.Order
      description: Simulation step Order
    - contextPath: Verodin.Simulations.Step.Name
      description: Simulation step name
    - contextPath: Verodin.Simulations.Step.Created
      description: Simulation step created
    - contextPath: Verodin.Simulations.Step.Updated
      description: Simulation step updated
    - contextPath: Verodin.Simulations.Step.Action.IDs
      description: Simulation step actions ids
  - arguments:
    - description: Job ID number
      name: id
      required: true
    description: Deletes the specified Job
    name: verodin-delete-sim
  - arguments: []
    description: Gets an array of all Jobs and their statuses
    name: verodin-get-jobs
    outputs:
    - contextPath: Verodin.Jobs.ID
      description: Job id
    - contextPath: Verodin.Jobs.Description
      description: Job description
    - contextPath: Verodin.Jobs.Created
      description: Job created
    - contextPath: Verodin.Jobs.Name
      description: Job name
    - contextPath: Verodin.Jobs.OrganizationID
      description: Job organization id
    - contextPath: Verodin.Jobs.Updated
      description: Job updated
    - contextPath: Verodin.Jobs.NodeActionQueueID
      description: Job node action queue id
    - contextPath: Verodin.Jobs.PlanID
      description: Job plan id
    - contextPath: Verodin.Jobs.Tags.Verodin
      description: Job verodin tags
    - contextPath: Verodin.Jobs.Progress
      description: Job progress
    - contextPath: Verodin.Jobs.SimulationID
      description: Job simulation id
    - contextPath: Verodin.Jobs.Status
      description: Job status
    - contextPath: Verodin.Jobs.UserID
      description: Job user id
  - arguments:
    - description: Job id
      name: id
      required: true
    description: Gets details on the specified Job and its status
    name: verodin-get-job
    outputs:
    - contextPath: Verodin.Jobs.ID
      description: Job id
    - contextPath: Verodin.Jobs.Description
      description: Job description
    - contextPath: Verodin.Jobs.Created
      description: Job created
    - contextPath: Verodin.Jobs.Name
      description: Job name
    - contextPath: Verodin.Jobs.OrganizationID
      description: Job organization id
    - contextPath: Verodin.Jobs.Updated
      description: Job updated
    - contextPath: Verodin.Jobs.NodeActionQueueID
      description: Job node action queue id
    - contextPath: Verodin.Jobs.PlanID
      description: Job plan id
    - contextPath: Verodin.Jobs.Tags.Verodin
      description: Job verodin tags
    - contextPath: Verodin.Jobs.Progress
      description: Job progress
    - contextPath: Verodin.Jobs.SimulationID
      description: Job simulation id
    - contextPath: Verodin.Jobs.Status
      description: Job status
    - contextPath: Verodin.Jobs.UserID
      description: Job user id
  - arguments:
    - description: ID number of previously-run Job
      name: id
      required: true
    description: Gets a new Job object with a new Job ID
    name: verodin-run-job-again
  - arguments:
    - description: 'ID number of previously-run Job '
      name: id
      required: true
    description: Gets summary of sim_action results from the specified job, including
      aggregate of individual Action passes and fails
    name: verodin-get-job-sim-actions
    outputs:
    - contextPath: Verodin.Jobs.ID
      description: Job id
    - contextPath: Verodin.Jobs.Actions.Label
      description: Job action label
    - contextPath: Verodin.Jobs.Actions.Value
      description: Job action value
  - arguments:
    - description: 'ID number of previously-run Job '
      name: id
      required: true
    description: Cancels the job specified by the Job ID
    name: verodin-job-cancel
  isfetch: true
  script: "baseUrl = params.server.replace(/[\\/]+$/, '') + ':' + params.port + '/';\n\
    commandDictionary = {\n    'test-module': {\n        url: 'topology/nodes.json',\n\
    \        method: 'GET',\n    },\n    'verodin-get-topology-nodes': {\n       \
    \ url: 'topology/nodes.json',\n        method: 'GET',\n        extended: true,\n\
    \        translator: [\n            {\n                contextPath: 'Verodin.Nodes(val.ID==obj.ID)',\n\
    \                title: 'Verodin nodes',\n                data: [\n          \
    \          {to: 'ID', from: 'id'},\n                    {to: 'CommMode', from:\
    \ 'comm_mode'},\n                    {to: 'CodeType', from: 'code_type'},\n  \
    \                  {to: 'Description', from: 'desc'},\n                    {to:\
    \ 'Gateway', from: 'gateway'},\n                    {to: 'Hostname', from: 'hostname'},\n\
    \                    {to: 'LastComms', from: 'last_comms'},\n                \
    \    {to: 'LastUpdate', from: 'last_update'},\n                    {to: 'Location',\
    \ from: 'location'},\n                    {to: 'Tags', from: 'user_tags'},\n \
    \                   {to: 'MmgmtIp', from: 'mgmt_ip'},\n                    {to:\
    \ 'Name', from: 'name'},\n                    {to: 'SecurityZoneID', from: 'security_zone_id'},\n\
    \                    {to: 'Version', from: 'node_version'},\n                \
    \    {to: 'NewMask', from: 'netmask'},\n                    {to: 'OrganizationID',\
    \ from: 'organization_id'},\n                    {to: 'OS-type', from: 'os_base'},\n\
    \                    {to: 'OS-Architecture', from: 'os_architecture'},\n     \
    \               {to: 'OS-Full', from: 'os_full'},\n                    {to: 'Processor',\
    \ from: 'processor'},\n                ]\n            }\n        ],\n    },\n\
    \    'verodin-get-topology-map': {\n        url: 'topology/map.json',\n      \
    \  method: 'GET',\n        extended: true,\n        translator: [\n          \
    \  {\n                contextPath: 'Verodin.Topolody.Device(val.ID==obj.ID)',\n\
    \                title: 'Verodin devices interfaces',\n                innerPath:\
    \ 'device_interfaces',\n                countingDict: true,\n                data:\
    \ [\n                    {to: 'ID', from: 'id'},\n                    {to: 'Updated',\
    \ from: 'updated_at'},\n                    {to: 'OrganizationID', from: 'organization_id'},\n\
    \                    {to: 'NetworkDeviceID', from: 'network_device_id'},\n   \
    \                 {to: 'IP', from: 'ip'},\n                ]\n            },\n\
    \            {\n                contextPath: 'Verodin.Topolody.Nodes(val.ID==obj.ID)',\n\
    \                title: 'Verodin nodes',\n                innerPath: 'nodes',\n\
    \                countingDict: true,\n                data: [\n              \
    \      {to: 'MgmtIP', from: 'mgmt_ip'},\n                    {to: 'Name', from:\
    \ 'name'},\n                    {to: 'OS', from: 'os'},\n                ]\n \
    \           },\n            {\n                contextPath: 'Verodin.Topolody.Node.Edges',\n\
    \                title: 'Verodin node edges',\n                innerPath: 'node_edges',\n\
    \                countingDict: true,\n                data: [\n              \
    \      {to: 'From', from: 'from'},\n                    {to: 'To', from: 'to'},\n\
    \                    {to: 'Type', from: 'type'},\n                ]\n        \
    \    },\n            {\n                contextPath: 'Verodin.Topolody.Zone.Devices.Edges',\n\
    \                title: 'Verodin edges',\n                innerPath: 'device_zone_edges',\n\
    \                countingDict: true,\n                data: [\n              \
    \      {to: 'From', from: 'from'},\n                    {to: 'To', from: 'to'},\n\
    \                    {to: 'Type', from: 'type'},\n                    {to: 'Through',\
    \ from: 'through'},\n                ]\n            },\n            {\n      \
    \          contextPath: 'Verodin.Topolody.Zone.Devices.Interfaces.Edges',\n  \
    \              title: 'Verodin edges',\n                innerPath: 'device_zone_edges',\n\
    \                countingDict: true,\n                data: [\n              \
    \      {to: 'From', from: 'from'},\n                    {to: 'To', from: 'to'},\n\
    \                    {to: 'Type', from: 'type'},\n                    {to: 'Through',\
    \ from: 'through'},\n                ]\n            },\n            {\n      \
    \          contextPath: 'Verodin.Topolody.Zones',\n                title: 'Verodin\
    \ zones',\n                innerPath: 'zones',\n                countingDict:\
    \ true,\n                data: [\n                    {to: 'Description', from:\
    \ 'desc'},\n                    {to: 'Name', from: 'name'},\n                ]\n\
    \            },\n        ],\n    },\n    'verodin-manage-sims-actions': {\n  \
    \      url: 'manage_sims/actions.json',\n        method: 'GET',\n        extended:\
    \ true,\n        translator: [\n            {\n                contextPath: 'Verodin.Simulations.Actions(val.ID==obj.ID)',\n\
    \                title: 'Verodin nodes',\n                data: [\n          \
    \          {to: 'ID', from: 'id'},\n                    {to: 'Type', from: 'action_type'},\n\
    \                    {to: 'Created', from: 'created_at'},\n                  \
    \  {to: 'Disabled', from: 'disabled'},\n                    {to: 'Name', from:\
    \ 'name'},\n                    {to: 'OrganizationID', from: 'organization_id'},\n\
    \                    {to: 'RequireEndpoint', from: 'require_endpoint'},\n    \
    \                {to: 'Updated', from: 'updated_at'},\n                    {to:\
    \ 'Tags-User', from: 'user_tags'},\n                    {to: 'Tags-Verodin', from:\
    \ 'verodin_tags'},\n                    {to: 'Vid', from: 'vid'},\n          \
    \      ]\n            }\n        ],\n    },\n    'verodin-manage-sims-actions-run':\
    \ {\n        url: 'manage_sims/actions/%id%/run.json',\n        method: 'POST',\n\
    \        defaultArgs: {\n            'schedule_run_now_selector': 'run_now',\n\
    \            'repeat_job_period_type': 'minutes',\n            'repeat_job_times_selector_1':\
    \ 'number',\n            'repeat_job_times_selector': 'number',\n            'repeat_job_count':\
    \ \"\",\n            'job_name': \"\",\n            'repeat_job_period_number_1':\
    \ \"\",\n            'repeat_job_count_1': \"\",\n            'attack_zone_id_1':\
    \ \"\",\n            'schedule_job_datetime': \"\",\n            'target_zone_id_1':\
    \ \"\",\n            'repeat_job_period_number': \"\",\n           'repeat_job_period_type_1':\
    \ \"\",\n        },\n        extended: true,\n        translator: [\n        \
    \    {\n                contextPath: 'Verodin.Jobs(val.ID==obj.ID)',\n       \
    \         title: 'Verodin run simulation - result job',\n                data:\
    \ [\n                    {to: 'ID', from: 'id'},\n                    {to: 'Description',\
    \ from: 'desc'},\n                    {to: 'Created', from: 'created_at'},\n \
    \                   {to: 'Name', from: 'name'},\n                    {to: 'OrganizationID',\
    \ from: 'organization_id'},\n                    {to: 'Updated', from: 'updated_at'},\n\
    \                    {to: 'NodeActionQueueID', from: 'node_action_queue_id'},\n\
    \                    {to: 'PlanID', from: 'plan_id'},\n                    {to:\
    \ 'Progress', from: 'progress'},\n                    {to: 'SimulationID', from:\
    \ 'simulation_id'},\n                    {to: 'Status', from: 'status'},\n   \
    \                 {to: 'UserID', from: 'user_id'},\n                ]\n      \
    \      }\n        ],\n    },\n    'verodin-get-security-zones': {\n        url:\
    \ 'security_zones.json',\n        method: 'GET',\n        extended: true,\n  \
    \      translator: [\n            {\n                contextPath: 'Verodin.Zones(val.ID==obj.ID)',\n\
    \                title: 'Verodin zones',\n                data: [\n          \
    \          {to: 'ID', from: 'id'},\n                    {to: 'Description', from:\
    \ 'desc'},\n                    {to: 'Created', from: 'created_at'},\n       \
    \             {to: 'Disabled', from: 'disabled'},\n                    {to: 'Name',\
    \ from: 'name'},\n                    {to: 'OrganizationID', from: 'organization_id'},\n\
    \                    {to: 'Updated', from: 'updated_at'},\n                ]\n\
    \            }\n        ],\n    },\n    'verodin-get-security-zone': {\n     \
    \   url: 'security_zones/%id%.json',\n        method: 'GET',\n        extended:\
    \ true,\n        translator: [\n            {\n                contextPath: 'Verodin.Zones(val.ID==obj.ID)',\n\
    \                title: 'Verodin zones',\n                data: [\n          \
    \          {to: 'ID', from: 'id'},\n                    {to: 'Description', from:\
    \ 'desc'},\n                    {to: 'Created', from: 'created_at'},\n       \
    \             {to: 'Disabled', from: 'disabled'},\n                    {to: 'Name',\
    \ from: 'name'},\n                    {to: 'OrganizationID', from: 'organization_id'},\n\
    \                    {to: 'Updated', from: 'updated_at'},\n                ]\n\
    \            }\n        ],\n    },\n    'verodin-delete-security-zone': {\n  \
    \      url: 'security_zones/%id%',\n        method: 'DELETE',\n    },\n    'verodin-get-sims-of-type':\
    \ {\n        url: 'simulations.json',\n        method: 'GET',\n        extended:\
    \ true,\n        translator: [\n            {\n                contextPath: 'Verodin.Simulations(val.ID==obj.ID)',\n\
    \                title: 'Verodin nodes',\n                data: [\n          \
    \          {to: 'ID', from: 'id'},\n                    {to: 'Type', from: 'simulation_type'},\n\
    \                    {to: 'Created', from: 'created_at'},\n                  \
    \  {to: 'Disabled', from: 'disabled'},\n                    {to: 'Name', from:\
    \ 'name'},\n                    {to: 'OrganizationID', from: 'organization_id'},\n\
    \                    {to: 'StopOnError', from: 'stop_on_error'},\n           \
    \         {to: 'Updated', from: 'updated_at'},\n                    {to: 'Actions',\
    \ from: 'sim_actions=val.split(\",\")'},\n                    {to: 'Tags-User',\
    \ from: 'user_tags'},\n                    {to: 'Tags-Verodin', from: 'verodin_tags'},\n\
    \                    {to: 'Vid', from: 'vid'},\n                ]\n          \
    \  }\n        ],\n    },\n    'verodin-get-sim': {\n        url: 'simulations/%id%.json',\n\
    \        method: 'GET',\n        extended: true,\n        translator: [\n    \
    \        {\n                contextPath: 'Verodin.Simulations(val.ID==obj.ID)',\n\
    \                title: 'Verodin nodes',\n                data: [\n          \
    \          {to: 'ID', from: 'id'},\n                    {to: 'Type', from: 'simulation_type'},\n\
    \                    {to: 'Created', from: 'created_at'},\n                  \
    \  {to: 'Disabled', from: 'disabled'},\n                    {to: 'Name', from:\
    \ 'name'},\n                    {to: 'OrganizationID', from: 'organization_id'},\n\
    \                    {to: 'StopOnError', from: 'stop_on_error'},\n           \
    \         {to: 'Updated', from: 'updated_at'},\n                    {to: 'Actions',\
    \ from: 'sim_actions=val.split(\",\")'},\n                    {to: 'Tags-User',\
    \ from: 'user_tags'},\n                    {to: 'Tags-Verodin', from: 'verodin_tags'},\n\
    \                    {to: 'Vid', from: 'vid'},\n                    {to: 'Step-Name',\
    \ from: 'steps.name'},\n                    {to: 'Step-Order', from: 'steps.order'},\n\
    \                    {to: 'Step-Created', from: 'steps.created_at'},\n       \
    \             {to: 'Step-Updated', from: 'steps.updated_at'},\n              \
    \      {to: 'Step-Action-IDs', from: 'steps.sim_actions.id'},\n              \
    \  ]\n            }\n        ],\n    },\n    'verodin-delete-sim': {\n       \
    \ url: 'simulations/%id%',\n        method: 'DELETE',\n    },\n    'verodin-get-jobs':\
    \ {\n        url: 'jobs.json',\n        method: 'GET',\n        extended: true,\n\
    \        translator: [\n            {\n                contextPath: 'Verodin.Jobs(val.ID==obj.ID)',\n\
    \                title: 'Verodin nodes',\n                data: [\n          \
    \          {to: 'ID', from: 'id'},\n                    {to: 'Description', from:\
    \ 'desc'},\n                    {to: 'Created', from: 'created_at'},\n       \
    \             {to: 'Name', from: 'name'},\n                    {to: 'OrganizationID',\
    \ from: 'organization_id'},\n                    {to: 'Updated', from: 'updated_at'},\n\
    \                    {to: 'NodeActionQueueID', from: 'node_action_queue_id'},\n\
    \                    {to: 'PlanID', from: 'plan_id'},\n                    {to:\
    \ 'Progress', from: 'steps.name'},\n                    {to: 'Step-Order', from:\
    \ 'progress'},\n                    {to: 'SimulationID', from: 'simulation_id'},\n\
    \                    {to: 'Status', from: 'status'},\n                    {to:\
    \ 'UserID', from: 'user_id'},\n                ]\n            }\n        ],\n\
    \    },\n    'verodin-get-job': {\n        url: 'jobs/%id%.json',\n        method:\
    \ 'GET',\n        extended: true,\n        translator: [\n            {\n    \
    \            contextPath: 'Verodin.Jobs(val.ID==obj.ID)',\n                title:\
    \ 'Verodin nodes',\n                data: [\n                    {to: 'ID', from:\
    \ 'id'},\n                    {to: 'Description', from: 'desc'},\n           \
    \         {to: 'Created', from: 'created_at'},\n                    {to: 'Name',\
    \ from: 'name'},\n                    {to: 'OrganizationID', from: 'organization_id'},\n\
    \                    {to: 'Updated', from: 'updated_at'},\n                  \
    \  {to: 'NodeActionQueueID', from: 'node_action_queue_id'},\n                \
    \    {to: 'PlanID', from: 'plan_id'},\n                    {to: 'Progress', from:\
    \ 'progress'},\n                    {to: 'SimulationID', from: 'simulation_id'},\n\
    \                    {to: 'Status', from: 'status'},\n                    {to:\
    \ 'UserID', from: 'user_id'},\n                ]\n            }\n        ],\n\
    \    },\n    'verodin-run-job-again': {\n        url: 'jobs/%id%/run_again',\n\
    \        method: 'GET',\n    },\n    'verodin-get-job-sim-actions': {\n      \
    \  url: 'jobs/%id%/sim_actions.json',\n        method: 'GET',\n        extended:\
    \ true,\n        translator: [\n            {\n                contextPath: 'Verodin.Jobs(val.ID==obj.ID)',\n\
    \                title: 'Verodin nodes',\n                data: [\n          \
    \          {to: 'Actions-Label', from: 'label'},\n                    {to: 'Actions-Value',\
    \ from: 'value'},\n                ]\n            }\n        ],\n    },\n    'verodin-job-cancel':\
    \ {\n        url: 'jobs/%id%/cancel',\n        method: 'GET',\n    },\n};\n\n\
    function createContext(data, id) {\n    var createContextSingle = function(obj)\
    \ {\n        var res = {};\n        var keys = Object.keys(obj);\n        keys.forEach(function(k)\
    \ {\n            var values = k.split('-');\n            var current = res;\n\
    \            for (var j = 0; j<values.length - 1; j++) {\n                if (!current[values[j]])\
    \ {\n                    current[values[j]] = {};\n                }\n       \
    \         current = current[values[j]];\n            }\n            current[values[j]]\
    \ = obj[k];\n        });\n        if (!res.ID && id) {\n            res.ID = id;\n\
    \        }\n        return res;\n    };\n    if (data instanceof Array) {\n  \
    \      var res = [];\n        for (var j=0; j < data.length; j++) {\n        \
    \    res.push(createContextSingle(data[j]));\n        }\n        return res;\n\
    \    }\n    return createContextSingle(data);\n}\n\nfunction mapObjFunction(mapFields,\
    \ filter) {\n    var transformSingleObj= function(obj) {\n        var res = {};\n\
    \        mapFields.forEach(function(f) {\n            res[f.to] = dq(obj, f.from);\n\
    \        });\n        if (filter && !filter(res)) {\n            return undefined;\n\
    \        }\n        return res;\n    };\n    return function(obj) {\n        if\
    \ (obj instanceof Array) {\n            var res = [];\n            for (var j=0;\
    \ j < obj.length; j++) {\n                var current = transformSingleObj(obj[j]);\n\
    \                if (current) {\n                    res.push(current);\n    \
    \            }\n            }\n            return res;\n        }\n        return\
    \ transformSingleObj(obj);\n    };\n}\n\n\nvar sendRequest = function(url, method,\
    \ args) {\n    var httpParams = {\n       Method: method,\n       Headers: {\n\
    \            'Content-Type': ['application/json']\n       },\n       Username:\
    \ params.credentials.identifier,\n       Password: params.credentials.password,\n\
    \       Body: method !== 'GET' ? JSON.stringify(args) : undefined\n    };\n  \
    \  var res = http(\n            baseUrl + url + (method === 'GET' && method ?\
    \ encodeToURLQuery(args) : ''),\n            httpParams,\n            params.insecure,\n\
    \            params.proxy,\n            false\n        );\n\n    if (res.StatusCode\
    \ < 200 || res.StatusCode >= 300) {\n        throw 'Request ' + url + ' failed,\
    \ request status code: ' + res.StatusCode + ' and Body: ' + res.Body + '.';\n\
    \    }\n    if (!res.Body) {\n        return 'Done';\n    }\n    try {\n     \
    \   return JSON.parse(res.Body);\n    }\n    catch (ex) {\n        throw 'Failed\
    \ to create JSON from response ' + res.Body + ', exception is ' + ex;\n    }\n\
    }\n\nvar toArray = function(obj) {\n    res = [];\n    keys = Object.keys(obj);\n\
    \    for (var k in keys) {\n        res.push(obj[keys[k]]);\n    }\n    return\
    \ res;\n}\n\nvar createIncidentFromJob = function(incident) {\n    var keys =\
    \ Object.keys(incident);\n    var labels = [];\n    for (var i = 0; i<keys.length;\
    \ i++) {\n        labels.push({'type': keys[i], 'value': String(incident[keys[i]])});\n\
    \    }\n    return {\n        \"name\": incident.id + ' ' + incident.desc,\n \
    \       \"labels\": labels,\n        \"rawJSON\": JSON.stringify(incident),\n\
    \    }\n}\n\nif (command === 'fetch-incidents') {\n    var lastRun = getLastRun();\n\
    \    var lastID = lastRun && lastRun.startID ? lastRun.startID : 0;\n    var startID\
    \ = lastID;\n    currentCommand = commandDictionary['verodin-get-jobs'];\n   \
    \ var res = sendRequest(replaceInTemplatesAndRemove(currentCommand.url, args),\
    \ currentCommand.method, args);\n    var incidents = [];\n    for (var i = 0;\
    \ i < res.length; i++) {\n        if (res[i].id > lastID) {\n            startID\
    \ = Math.max(startID, res[i].id);\n            incidents.push(createIncidentFromJob(res[i]));\n\
    \        }\n    }\n    setLastRun({startID: startID});\n    return JSON.stringify(incidents);\n\
    }\n\nvar id = args.id;\ncurrentCommand = commandDictionary[command];\nif (currentCommand.defaultArgs)\
    \ {\n    keys = Object.keys(currentCommand.defaultArgs);\n    for (var k in keys)\
    \ {\n        if (!args[keys[k]]) {\n            args[keys[k]] = currentCommand.defaultArgs[keys[k]];\n\
    \        }\n    }\n}\nvar result = sendRequest(replaceInTemplatesAndRemove(currentCommand.url,\
    \ args), currentCommand.method, args);\nif (command === 'test-module') {\n   \
    \ return 'ok';\n}\nvar entries = [];\nif (currentCommand.extended) {\n    for\
    \ (var j in currentCommand.translator) {\n        var current = currentCommand.translator[j];\n\
    \        var entry = {\n            Type: entryTypes.note,\n            Contents:\
    \ result,\n            ContentsFormat: formats.json,\n        };\n        var\
    \ currentContent = current.innerPath ? dq(result, current.innerPath) : result;\n\
    \        var translated = mapObjFunction(current.data) (current.countingDict ?\
    \ toArray(currentContent) : currentContent);\n        entry.ReadableContentsFormat\
    \ = formats.markdown;\n        entry.HumanReadable = tableToMarkdown(current.title,translated);\n\
    \        entry.EntryContext = {};\n        var context = createContext(translated,\
    \ id);\n        entry.EntryContext[current.contextPath] = context;\n        entries.push(entry);\n\
    \    }\n} else {\n    return result;\n}\nreturn entries;"
  type: javascript
tests:
- no test
toversion: 4.1.9
versionedfields: {}
