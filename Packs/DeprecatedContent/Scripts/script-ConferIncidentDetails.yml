comment: Display the incident details retrieved from Confer in a readable format
commonfields:
  id: ConferIncidentDetails
  version: -1
dependson:
  must:
  - confer
deprecated: true
name: ConferIncidentDetails
script: "import time\ndef formatDate(t):\n    if t:\n        return time.ctime(t /\
  \ 1000)\n    return ''\nincDetails = demisto.incidents()[0]['details']\nif incDetails:\n\
  \    try:\n        inc = json.loads(incDetails)\n        res = '## Confer Incident\
  \ Details'\n        res += '\\n\\nID: **' + demisto.gets(inc, 'threatInfo.incidentId')\
  \ + '**'\n        res += '\\nTime: **' + formatDate(demisto.get(inc, 'eventTime'))\
  \ + '**'\n        res += '\\nType: **' + demisto.gets(inc, 'type') + '**'\n    \
  \    res += '\\nEvent ID: **' + demisto.gets(inc, 'eventId') + '**'\n        res\
  \ += '\\nScore: **' + demisto.gets(inc, 'threatInfo.score') + '**'\n        res\
  \ += '\\nURL: **' + demisto.gets(inc, 'url') + '**'\n        res += '\\n### Indicators'\n\
  \        ind = demisto.get(inc, 'threatInfo.indicators')\n        if ind:\n    \
  \        res += '\\nIndicator Name | Application Name | SHA256'\n            res\
  \ += '\\n-------------- | ---------------- | ------'\n            for i in ind:\n\
  \                res += '\\n ' + demisto.gets(i, 'indicatorName') + ' | ' + demisto.gets(i,\
  \ 'applicationName') + ' | ' + demisto.gets(i, 'sha256Hash')\n        dev = demisto.get(inc,\
  \ 'deviceInfo')\n        if dev:\n            res += '\\n### Device Info'\n    \
  \        res += '\\nID | Type | Name | Version | Email | Priority | Group Name |\
  \ External IP'\n            res += '\\n-- | ---- | ---- | ------- | ----- | --------\
  \ | ---------- | -----------'\n            res += '\\n' + demisto.gets(dev, 'deviceId')\
  \ + ' | ' + demisto.gets(dev, 'deviceType') + ' | ' + demisto.gets(dev, 'deviceName')\
  \ + ' | ' + \\\n                   demisto.gets(dev, 'deviceVersion') + ' | ' +\
  \ demisto.gets(dev, 'email') + ' | ' + demisto.gets(dev, 'targetPriorityType') +\
  \ ' | ' + \\\n                   demisto.gets(dev, 'groupName') + ' | ' + demisto.gets(dev,\
  \ 'externalIpAddress')\n        demisto.results({'ContentsFormat': formats['markdown'],\
  \ 'Type': entryTypes['note'], 'Contents': res})\n    except:\n        demisto.results('Incident\
  \ details are not JSON')\nelse:\n    demisto.results('No details were found for\
  \ the incident')"
scripttarget: 0
subtype: python2
system: true
tags:
- confer
timeout: 0s
toversion: 4.1.9
type: python
