args:
- default: true
  description: Username for query
  name: username
  required: true
comment: This script is deprecated. Use the Exabeam integration instead.
commonfields:
  id: XBTimeline
  version: -1
dependson:
  must:
  - xb-timeline
deprecated: true
name: XBTimeline
script: "import time\nres = []\nentry = demisto.executeCommand('xb-timeline', {'username':\
  \ demisto.args()['username']})[0]\nif entry['Type'] != entryTypes['error'] and entry['ContentsFormat']\
  \ == formats['json']:\n    entities = demisto.get(entry, 'Contents.entities')\n\
  \    if entities:\n        for e in entities:\n            res.append({'1.ID': demisto.get(e,\
  \ 'id'), '2.Type': demisto.get(e, 'tp'), '3.Start': time.ctime(demisto.get(e, 'st')\
  \ / 1000.0), '4.End': time.ctime(demisto.get(e, 'et') / 1000.0), \\\n          \
  \              '5.Initial Risk': str(demisto.get(e, 'irs')), '6.Risk': str(demisto.get(e,\
  \ 'rs')), '7.OS': str(demisto.get(e, 'os')), '8.OE': str(demisto.get(e, 'oe'))})\n\
  \    demisto.results({'ContentsFormat': formats['table'], 'Type': entryTypes['note'],\
  \ 'Contents': res})\nelse:\n    demisto.results(entry)"
scripttarget: 0
subtype: python2
system: true
tags:
- server
- analytics
- exabeam
timeout: 0s
toversion: 4.1.9
type: python
