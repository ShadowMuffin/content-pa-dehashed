args:
- default: true
  description: The username of the user whose password should be expired
  name: username
  required: true
- description: The password to set for the user
  name: password
  required: true
  secret: true
comment: 'Set a new password for an Active Directory user

  '
commonfields:
  id: ADSetNewPassword
  version: -1
dependson:
  must:
  - ad-set-new-password
deprecated: true
name: ADSetNewPassword
script: "resSet = demisto.executeCommand(\"ad-set-new-password\", demisto.args())\n\
  if isError(resSet[0]) and ('LDAP Result Code 53 \"Unwilling To Perform\"' in resSet[0]['Contents']\
  \ or 'WILL_NOT_PERFORM' in resSet[0]['Contents']):\n    myErrorText = \"An LDAP\
  \ error occurred while trying to set the new password. This sometimes happens when\
  \ the new password is not allowed by the Domain's Password Policy, especially password\
  \ complexity requirements.\\n\"\n    myErrorText += \"Please ensure that the user\
  \ account you have configured to integrate with Active Directory Querying has permissions\
  \ to change passwords and that the password you specified adheres to the Password\
  \ Policy.\\n\"\n    myErrorText += \"LDAP returned the following error:\\n\" + str(resSet[0]['Contents'])\n\
  \    demisto.results( { \"Type\" : entryTypes[\"error\"], \"ContentsFormat\" : formats[\"\
  text\"], \"Contents\" : myErrorText } )\nelse:\n    demisto.results(resSet)\n\n"
scripttarget: 0
subtype: python2
system: true
tags:
- active directory
timeout: 0s
toversion: 4.1.9
type: python
