args:
- default: true
  description: Item to check
  name: item
  required: true
- defaultValue: Indicators Whitelist
  description: Name of whitelist to check
  name: whitelistname
comment: Check whether the given item is in the whitelist
commonfields:
  id: CheckWhitelist
  version: -1
dependson: {}
deprecated: true
name: CheckWhitelist
outputs:
- contextPath: WhitelistCheck
  description: Returns a dictionary of indicators mapped to True if found in whitelist,
    or False otherwise.
script: "res = demisto.executeCommand(\"getList\", {\"listName\": demisto.args()[\"\
  whitelistname\"]})\nif isError(res[0]):\n    demisto.results(res)\nelse:\n    whitelist\
  \ = res[0]['Contents']\n    result = False\n    answer = 'no'\n    if demisto.args()['item']\
  \ in whitelist:\n        answer = 'yes'\n        result = True\n    contextKey =\
  \ \"WhitelistCheck\"\n    contextValue = demisto.get(demisto.context(), contextKey)\n\
  \    contextDic = { demisto.args()['item']: result }\n    if contextValue:\n   \
  \     contextValue.update(contextDic)\n        demisto.setContext(contextKey, contextValue)\n\
  \    else:\n        demisto.setContext(contextKey, contextDic)\n    demisto.results(answer)\n"
scripttarget: 0
subtype: python2
system: true
tags:
- whitelist
timeout: 0s
toversion: 4.1.9
type: python
