comment: Use Active Directory to retrieve the email address associated with all users.
commonfields:
  id: ADGetAllUsersEmail
  version: -1
dependson:
  must:
  - ad-search
deprecated: true
name: ADGetAllUsersEmail
outputs:
- contextPath: Mailboxes
  description: List of all users mailbox addresses
script: "mails = []\nMAIL_CONTEXT_KEY = \"Mailboxes\"\n\nattrs = 'mail'\nfilterstr\
  \ = r\"(&(objectClass=User))\"\nresp = demisto.executeCommand( 'ad-search' , { 'filter'\
  \ : filterstr, 'attributes' : attrs } )\nif isError(resp[0]):\n    demisto.results(resp)\n\
  else:\n    data = demisto.get(resp[0], \"Contents\")\n    for item in data:\n  \
  \      mails += [item[\"mail\"]] if item[\"mail\"] else []\n\n    demisto.setContext(MAIL_CONTEXT_KEY,\
  \ \",\".join(mails))\n"
scripttarget: 0
subtype: python2
system: true
tags:
- active directory
timeout: 0s
toversion: 4.1.9
type: python
