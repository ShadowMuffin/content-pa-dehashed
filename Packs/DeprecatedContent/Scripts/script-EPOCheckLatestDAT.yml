comment: Check latest version of the DAT AV signature update.
commonfields:
  id: EPOCheckLatestDAT
  version: -1
dependson: {}
deprecated: true
name: EPOCheckLatestDAT
script: "import urllib2\nMCAFEE_DELTAAVV_INI_URL = \"http://update.nai.com/products/commonupdater/gdeltaavv.ini\"\
  \n# Another option is to use avvdat.ini - provided here in case any additional data\
  \ from that file is needed in the future\n#MCAFEE_AVVDAT_INI_URL = \"http://update.nai.com/Products/CommonUpdater/avvdat.ini\"\
  \n\niniText = '<Could not fetch INI>'\nlatestDATVersion = None\ntry:\n    iniText\
  \ = urllib2.urlopen(MCAFEE_DELTAAVV_INI_URL).read()\n    contentsSection = [section\
  \ for section in iniText.split('\\r\\n\\r\\n') if section.startswith('[Contents]\\\
  r\\n')][0]\n    demisto.log('** Extracted Contents section:\\n' + contentsSection\
  \ + '\\n')\n    latestDATVersion = [line.split('=')[1] for line in contentsSection.split('\\\
  r\\n') if line.startswith('CurrentVersion=')][0]\n    demisto.log('** McAfee website\
  \ ini reports latest available DAT version ' + latestDATVersion)\n    demisto.setContext('latestdat',\
  \ latestDATVersion)\nexcept Exception as ex:\n    demisto.results({\"Type\": entryTypes[\"\
  error\"], \"ContentsFormat\": formats[\"text\"],\n                \"Contents\":\
  \ \"Error occurred while retrieving DAT version from McAfee website. Exception info:\\\
  n\" + str(ex) + \"\\n\\nRetrieved iniText for debugging:\\n\" + str(iniText)})\n"
scripttarget: 0
subtype: python2
system: true
tags:
- epo
timeout: 0s
toversion: 4.1.9
type: python
