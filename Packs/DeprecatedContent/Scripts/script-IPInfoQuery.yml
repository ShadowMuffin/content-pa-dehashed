args:
- description: (Optional) only retrieve a specific field
  name: field
- default: true
  description: IP address to query. E.g. !ip 1.1.1.1
  name: ip
  required: true
comment: Query ipinfo.io regarding an IP address. Returns a table, or if a specific
  field is selected, just the value for that field as a string.
commonfields:
  id: IPInfoQuery
  version: -1
dependson:
  must:
  - ipinfo_field
deprecated: true
name: IPInfoQuery
script: "field = demisto.get(demisto.args(), 'field')\nif field:\n    demisto.results(demisto.executeCommand(\"\
  ipinfo_field\", demisto.args()))\nelse:\n    dArgs = demisto.args()\n    dArgs['using-brand']\
  \ = 'ipinfo'\n    resp = demisto.executeCommand(\"ip\", dArgs)\n    if isError(resp[0]):\n\
  \        demisto.results(resp)\n    else:\n        demisto.results( {'ContentsFormat':\
  \ formats['table'], 'Type': entryTypes['note'], 'Contents': flattenRow(resp[0]['Contents'])\
  \ } )\n\n\n"
scripttarget: 0
subtype: python2
system: true
tags:
- ipinfo
timeout: 0s
toversion: 4.1.9
type: python
