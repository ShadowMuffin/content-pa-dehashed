args:
- default: true
  description: URL to look up
  name: input
  required: true
- auto: PREDEFINED
  defaultValue: 'no'
  description: Whether to calculate reputation even if it is manual set - yes/no
  name: forceCalc
  predefined:
  - 'yes'
  - 'no'
comment: Evaluate reputation of a URL and return a score between 0 and 3 (0 - unknown,
  1 - known good, 2 - suspicious, 3 - known bad). If the indicator reputation was
  manually set, the manual value will be returned.
commonfields:
  id: DataURLReputation
  version: -1
dependson:
  should:
  - url
  - pt-malware
deprecated: true
enabled: true
fromversion: 3.1.0
name: DataURLReputation
script: "var score = -1;\nvar res = executeCommand(\"findIndicators\", {\"query\"\
  : \"type:URL and value:\\\"\" + args.input + \"\\\" and manualScore:T\"})\nif (args.forceCalc\
  \ != 'yes' && res[0] && res[0].Contents[0]) {\n    score = res[0].Contents[0].score;\n\
  } else {\n    var rep = executeCommand('url', {url: args.input});\n    var scores\
  \ = dq(rep, 'EntryContext.DBotScore.Score');\n    for (var i = 0; scores && i <\
  \ scores.length; i++) {\n        if (scores[i] && score < scores[i]) {\n       \
  \   score = scores[i];\n        }\n    }\n}\nreturn score < 0 ? 0 : score;"
scripttarget: 0
tags:
- reputation
tests:
- No Tests
timeout: 0s
toversion: 4.1.9
type: javascript
