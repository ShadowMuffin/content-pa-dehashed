args:
- description: Exchange query to match against emails
  name: query
  required: true
- description: Destination mailbox
  name: toMailbox
  required: true
- description: Folder within destination mailbox in which to place matched emails
  name: toFolder
  required: true
- description: Hostname of the Exchange server
  name: server
comment: This script is deprecated. Please use the Exchange 2016 Compliance Search
  integration instead.
commonfields:
  id: ExchangeSearchMailbox
  version: -1
dependson: {}
deprecated: true
name: ExchangeSearchMailbox
script: "//+ exchange/search.ps1\n//Params:\n//See here: https://technet.microsoft.com/en-us/library/dd298173(v=exchg.160).aspx\n\
  //query is the string provided to the -SearchQuery parameter\n//to-mailbox is the\
  \ string provided to -TargetMailbox parameter\n//to-folder is the string provided\
  \ to -TargetFolder parameter\n//if server is provided, it'll be used as -ServerFQDN\
  \ parameter to Connect-ExchangeServer cmdlet\nif ((env.ARCH !== \"amd64\") && (env.OS\
  \ !== \"windows\")) {\n    throw(\"Script can ran only in 64bit Windows Agents\"\
  );\n}\nvar command = [];\ncommand.push(\"powershell.exe\");\ncommand.push(\"-version\
  \ 2.0\");\ncommand.push(\"-NonInteractive\");\ncommand.push(\"-NoLogo\");\ncommand.push(which(\"\
  search.ps1\"));\ncommand.push(\"-query\");\ncommand.push(args.query);\ncommand.push(\"\
  -targetmbx\");\ncommand.push(args[\"to-mailbox\"]);\ncommand.push(\"-targetFolder\"\
  );\ncommand.push(args[\"to-folder\"]);\nif (typeof (args.server) !== \"undefined\"\
  ) {\n    command.push(\"-server\");\n    command.push(args.server);\n}\npack(execute(command.join(\"\
  \ \")), 'table');"
scripttarget: 1
system: true
tags:
- exchange
- email
timeout: 0s
toversion: 4.1.9
type: javascript
