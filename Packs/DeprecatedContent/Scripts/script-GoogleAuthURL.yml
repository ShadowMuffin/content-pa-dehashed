args:
- description: The comma-separated list of scopes we will use with the token
  name: scopes
  required: true
- auto: PREDEFINED
  defaultValue: 'true'
  description: Should we use system proxy settings
  name: proxy
  predefined:
  - 'true'
  - 'false'
comment: This script is deprecated. The demistobot endpoint is no longer supported.
commonfields:
  id: GoogleAuthURL
  version: -1
deprecated: true
enabled: true
name: GoogleAuthURL
outputs:
- contextPath: GoogleAuth.URL
  description: The newly generated URL for authentication
script: "var scopes = argToList(args.scopes);\nvar res = http('https://demistobot.demisto.com/google-oauth'\
  \ + encodeToURLQuery({scopes: scopes.join(',')}),\n    {\n        Headers: {'Accept':\
  \ ['application/json']},\n        Method: 'GET'\n    }, false, args.proxy == 'true');\n\
  if (res.StatusCode < 200 || res.StatusCode > 299) {\n    throw 'Failed to perform\
  \ request. Request status code: ' + res.StatusCode + ' (' + res.Body + ')';\n}\n\
  if (res.Body === '') {\n    throw 'No content received.';\n}\nvar obj;\ntry {\n\
  \    obj = JSON.parse(res.Body);\n} catch (ex) {\n    throw 'Error parsing reply\
  \ - ' + res.Body + ' - ' + ex;\n}\nvar md = 'To authenticate, please follow this\
  \ [link](' + obj.url + ')';\nreturn {Type: entryTypes.note, Contents: res.Body,\
  \ ContentsFormat: formats.json, HumanReadable: md,\n    EntryContext: {'GoogleAuth.URL':\
  \ obj.url}};\n"
scripttarget: 0
tags:
- google apps
toversion: 4.1.9
type: javascript
