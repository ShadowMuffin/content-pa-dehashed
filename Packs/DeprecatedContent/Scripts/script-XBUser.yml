args:
- default: true
  description: Username for query
  name: username
  required: true
comment: This script is deprecated. Use the Exabeam integration instead.
commonfields:
  id: XBUser
  version: -1
dependson:
  must:
  - xb-user
deprecated: true
name: XBUser
script: "import time\nres = '## Exabeam User Info'\nentry = demisto.executeCommand('xb-userinfo',\
  \ {'username': demisto.args()['username']})[0]\nif entry['Type'] != entryTypes['error']\
  \ and entry['ContentsFormat'] == formats['json']:\n    info = demisto.get(entry,\
  \ 'Contents.userInfo.info')\n    if info:\n        res += '\\n\\n\\n![photo](data:image/png;base64,'\
  \ +  demisto.get(info, 'photo').replace('\\n', '') + ')'\n        res += '\\n|Account|Email|Name|Title|Department|Devision|DN|Location|Manager|Office|Cell|Group|First\
  \ Seen|Last Seen|'\n        res += '\\n|-------|-----|----|-----|----------|--------|--|--------|-------|------|----|-----|----------|---------|'\n\
  \        res += '\\n| ' + demisto.get(info, 'accountId') + ' | ' + demisto.get(info,\
  \ 'email') + ' | ' + demisto.get(info, 'fullName') + ' | ' + \\\n              \
  \ demisto.get(info, 'title') + ' | ' + demisto.get(info, 'department') + ' | ' +\
  \ demisto.get(info, 'division') + ' | ' + \\\n               demisto.get(info, 'dn')\
  \ + ' | ' + demisto.get(info, 'location') + ', ' + demisto.get(info, 'country')\
  \ + ' | ' + \\\n               demisto.get(info, 'manager') + ' | ' + demisto.get(info,\
  \ 'phoneOffice') + ' | ' + demisto.get(info, 'phoneCell') + ' | ' + \\\n       \
  \        demisto.get(info, 'group') + ' | ' + time.ctime(demisto.get(entry, 'Contents.userInfo.firstSeen')\
  \ / 1000.0) + ' | ' + time.ctime(demisto.get(entry, 'Contents.userInfo.lastSeen')\
  \ / 1000.0) + ' |'\n    res += '\\nScore: **' + str(demisto.get(entry, 'Contents.userInfo.riskScore'))\
  \ + '**, On watch: ' + str(demisto.get(entry, 'Contents.isOnWatchlist'))\n    res\
  \ += '\\n\\n### Manager Info'\n    info = demisto.get(entry, 'Contents.managerInfo.info')\n\
  \    if info:\n        res += '\\n\\n\\n![photo](data:image/png;base64,' +  demisto.get(info,\
  \ 'photo').replace('\\n', '') + ')'\n        res += '\\n|Account|Email|Name|Title|Department|Devision|DN|Location|Manager|Office|Cell|Group|First\
  \ Seen|Last Seen|'\n        res += '\\n|-------|-----|----|-----|----------|--------|--|--------|-------|------|----|-----|----------|---------|'\n\
  \        res += '\\n| ' + demisto.get(info, 'accountId') + ' | ' + demisto.get(info,\
  \ 'email') + ' | ' + demisto.get(info, 'fullName') + ' | ' + \\\n              \
  \ demisto.get(info, 'title') + ' | ' + demisto.get(info, 'department') + ' | ' +\
  \ demisto.get(info, 'division') + ' | ' + \\\n               demisto.get(info, 'dn')\
  \ + ' | ' + demisto.get(info, 'location') + ', ' + demisto.get(info, 'country')\
  \ + ' | ' + \\\n               demisto.get(info, 'manager') + ' | ' + demisto.get(info,\
  \ 'phoneOffice') + ' | ' + demisto.get(info, 'phoneCell') + ' | ' + \\\n       \
  \        demisto.get(info, 'group') + ' | ' + time.ctime(demisto.get(entry, 'Contents.managerInfo.firstSeen')\
  \ / 1000.0) + ' | ' + time.ctime(demisto.get(entry, 'Contents.managerInfo.lastSeen')\
  \ / 1000.0) + ' |'\n    res += '\\nScore: **' + str(demisto.get(entry, 'Contents.managerInfo.riskScore'))\
  \ + '**'\n    demisto.results({'ContentsFormat': formats['markdown'], 'Type': entryTypes['note'],\
  \ 'Contents': res})\nelse:\n    demisto.results(entry)"
scripttarget: 0
subtype: python2
system: true
tags:
- server
- analytics
- exabeam
timeout: 0s
toversion: 4.1.9
type: python
