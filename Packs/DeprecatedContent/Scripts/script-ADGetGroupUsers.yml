args:
- description: Active Directory Distinguished Name for the desired group
  name: groupdn
  required: true
- description: Include these AD attributes of the resulting objects in addition to
    the default ones
  name: attributes
comment: 'Use Active Directory to retrieve the list of users who are members of the
  specified group. Group must be given by its AD Distinguished Name. The "attributes"
  argument receives a comma-separated list of additional attributes you wish to be
  displayed in the results.

  Example usage: !ADGetGroupUsers groupdn="CN=Domain Admins,CN=Users,DC=demisto,DC=com"
  attributes=badPwdCount,memberOf '
commonfields:
  id: ADGetGroupUsers
  version: -1
dependson:
  must:
  - ad-search
deprecated: true
name: ADGetGroupUsers
script: "# Optional arguments and default values\nattrs = 'name,displayname'\nif demisto.get(demisto.args(),\
  \ 'attributes'):\n    attrs += \",\" + demisto.args()['attributes']\nfilterstr =\
  \ r\"(&(objectCategory=User)(memberof=\" + demisto.args()['groupdn'] + \"))\"\n\
  demisto.results( demisto.executeCommand( 'AdSearch', { 'filter' : filterstr, 'attributes'\
  \ : attrs } ) )"
scripttarget: 0
subtype: python2
system: true
tags:
- active directory
timeout: 0s
toversion: 4.1.9
type: python
