args:
- default: true
  description: The text to extract ip from
  name: text
  required: true
comment: Extract IPs from the given text and place them both as output and in the
  context of a playbook
commonfields:
  id: IPExtract
  version: -1
dependson: {}
deprecated: true
name: IPExtract
script: "import re\nimport socket\ndef is_valid_ipv4_address(address):\n    try:\n\
  \        socket.inet_pton(socket.AF_INET, address)\n    except AttributeError: \
  \ # no inet_pton here, sorry\n        try:\n            socket.inet_aton(address)\n\
  \        except socket.error:\n            return False\n        return address.count('.')\
  \ == 3\n    except socket.error:  # not a valid address\n        return False\n\
  \    return True\nres = []\nips = []\ndata = demisto.args()['text']\nfor m in re.finditer(r'\\\
  b(?:[0-9]{1,3}\\.){3}[0-9]{1,3}\\b', data, re.I):\n    ip = m.group(0)\n    if ip\
  \ in ips:\n        continue\n    if not is_valid_ipv4_address(ip):\n        continue\n\
  \    ips.append(ip)\nres.append('IPs found:\\n' + '\\n'.join(ips))\nappendContext('ips',\
  \ ips)\ndemisto.results(res)"
scripttarget: 0
subtype: python2
system: true
tags:
- ip
- infra
timeout: 0s
toversion: 4.1.9
type: python
