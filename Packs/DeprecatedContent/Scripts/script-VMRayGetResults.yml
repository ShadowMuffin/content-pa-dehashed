args:
- default: true
  description: Job sample id
  name: sample_id
  required: true
comment: Deprecated, use "Detonate File - VMRay playbook instead"
commonfields:
  id: 9364c36f-b1d6-4233-88c2-75008b106c31
  version: -1
dependson:
  must:
  - VMRay|||get_job_sample
deprecated: true
enabled: true
name: vmray_getResults
script: "import json\ndArgs = {}\ndArgs[\"sample_id\"] = demisto.args()[\"sample_id\"\
  ]\nres_jobs = demisto.executeCommand(\"get_job_sample\", dArgs)[0]['Contents']['data']\n\
  if not res_jobs:\n  demisto.results(\"Hurray no jobs found, maybe the analysis is\
  \ completed. Let's see!\")\n  my_data = demisto.executeCommand(\"get_results\",\
  \ dArgs)[0]['Contents']['data']\n\n  parent_id = demisto.parentEntry()[\"id\"]\n\
  \  if my_data:\n      res = '## VMRay Analysed info'\n      tmp_data = {}\n    \
  \  tmp_data[\"vti-score\"] = []\n      tmp_data[\"analysis-id\"] = []\n      for\
  \ entry in my_data:\n          tmp_data[\"vti-score\"].append(entry['analysis_id'])\n\
  \          tmp_data[\"analysis-id\"].append(entry['analysis_vti_score'])\n     \
  \     if tmp_data:\n              res += '\\nAnalysed-ID: ' + str(entry['analysis_id'])\n\
  \              res += '\\nVTI-Score:   ' + str(entry['analysis_vti_score'])\n  \
  \        else:\n              res.append({\"Type\": entryTypes[\"error\"], \"ContentsFormat\"\
  : formats[\"text\"],\n                          \"Contents\": \"Could not extract\
  \ result list from response: \" + json.dumps(entry[\"Contents\"])})\n      demisto.executeCommand(\"\
  scheduleEntry\", {\"id\":parent_id, \"cancel\":\"cancel\"})\n\n      demisto.results({'ContentsFormat':\
  \ formats['markdown'], 'Type': entryTypes['note'], 'Contents': res})"
scripttarget: 0
subtype: python2
tags: []
tests:
- No tests
timeout: 0s
toversion: 4.1.9
type: python
