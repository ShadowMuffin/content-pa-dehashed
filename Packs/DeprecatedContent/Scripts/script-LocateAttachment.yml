args:
- description: (Optional) Substring of the filetype to match
  name: typefilter
- default: true
  description: (Optional) Substring of the file name to match
  name: namefilter
comment: Identify whether the incident includes an attached file. Optional typefilter
  argument can be used to only match if the filetype includes that string. Same for
  filename. Filetype is according to the linux "file" command (filemagic format identification).
commonfields:
  id: LocateAttachment
  version: -1
dependson: {}
deprecated: true
name: LocateAttachment
outputs:
- contextPath: true
  description: if there incident has an attached file
- contextPath: false
  description: if incident does not contain an attached file
script: "entries = demisto.executeCommand('getEntries', {})\ntypefilter = demisto.get(demisto.args(),\
  \ 'typefilter')\nnamefilter = demisto.get(demisto.args(), 'namefilter')\nfor e in\
  \ entries:\n    filetype = demisto.get(e, 'FileMetadata.info')\n    filename = demisto.get(e,\
  \ 'File')\n    if filetype:\n        if typefilter and not typefilter.lower() in\
  \ filetype.lower():\n            continue\n        if namefilter and not namefilter.lower()\
  \ in filename.lower():\n            continue\n        demisto.setContext('AttachmentEntryID',\
  \ e['ID'])\n        demisto.setContext('AttachmentMD5', demisto.get(e, 'FileMetadata.md5'))\n\
  \        demisto.setContext('AttachmentFileType', demisto.get(e, 'FileMetadata.info'))\n\
  \        demisto.results('yes')\n        sys.exit()\ndemisto.results('no')"
scripttarget: 0
subtype: python2
system: true
tags:
- email
- Condition
timeout: 0s
toversion: 4.1.9
type: python
