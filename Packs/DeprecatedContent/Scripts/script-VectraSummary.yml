comment: 'Summarize a Vectra  incident (after incident was put into context)

  The script extract malicious ip''s and hashes if exists '
commonfields:
  id: VectraSummary
  version: -1
dependson:
  must:
  - vec-health
deprecated: true
name: VectraSummary
script: "import json\n\nres = []\nctx = demisto.context()\nsummary, details = None,\
  \ None\ntry:\n    summary = demisto.get(ctx, \"Label/summary\")\n    if summary:\n\
  \        summary = json.loads(ctx[\"Label/summary\"])\n        if summary:\n   \
  \         summary = {k: formatCell(summary[k]) for k in summary}\n\n    details\
  \ = demisto.get(ctx, \"Label/detection_detail_set\")\n    if details:\n        details\
  \ = json.loads(ctx[\"Label/detection_detail_set\"])\n        if details:\n     \
  \       details = {k: formatCell(details[0][k]) for k in details[0]}\n\n    bad_ips\
  \ = None\n    if details:\n        bad_ips = details[\"dst_ip\"]\n\n    demisto.setContext('bad_ips',\
  \ bad_ips)\n    demisto.setContext('hashes', \"\")\n\n    res.append({'ContentsFormat':\
  \ formats['table'], 'Type': entryTypes['note'], 'Contents': summary})\n    res.append({'ContentsFormat':\
  \ formats['table'], 'Type': entryTypes['note'], 'Contents': details})\n\n    demisto.results(res)\n\
  except Exception, ex:\n    demisto.results( { 'Type' : entryTypes['error'], 'ContentsFormat'\
  \ : formats['text'], 'Contents' : 'Error occurred while parsing Vectra incident\
  \ labels. Exception info:\\n' + str(ex) } )\n\n"
scripttarget: 0
subtype: python2
system: true
tags:
- Vectra
timeout: 0s
toversion: 4.1.9
type: python
