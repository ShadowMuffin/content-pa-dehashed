args:
- default: true
  description: MD5 Hash to look up
  name: md5
- description: Hash to look up
  name: hash
comment: Deprecated. Use the "wildfire-report" command instead.
commonfields:
  id: WildfireReport
  version: -1
dependson:
  must:
  - wildfire-report
deprecated: true
name: WildfireReport
script: "var results = [];\nvar raws = [];\nif (args.md5) {\n    md5s = argToList(args.md5);\n\
  \    for(var i=0; i<md5s.length;i++)\n        raws.push(executeCommand('wildfire-report',\
  \ {md5: md5s[i]}));\n} else if (args.hash) {\n    hashes = argToList(args.hash);\n\
  \    for(var i=0; i<hashes.length;i++)\n        raws.push(executeCommand('wildfire-report',\
  \ {hash: hashes[i]}));\n} else {\n    return 'no';\n}\nfor(var i=0; i<raws.length;i++)\
  \ {\n    raw = raws[i];\n    if (!raw[0] || !raw[0].Contents || !raw[0].Contents.wildfire\
  \ || !raw[0].Contents.wildfire.file_info) {\n        results.push(raw);\n    } else\
  \ {\n        var item = raw[0].Contents.wildfire.file_info;\n        results.push({Contents:\
  \ {\n            Type: item.filetype,\n            Malware: item.malware,\n    \
  \        MD5: item.md5,\n            SHA256: item.sha256,\n            Size: item.size},\n\
  \            ContentsFormat: formats.table,\n            Type: entryTypes.note});\n\
  \    }\n}\nreturn results;"
scripttarget: 0
system: true
tags:
- enhancement
- wildfire
- sandbox
tests:
- No tests
timeout: 0s
toversion: 4.1.9
type: javascript
