args:
- default: true
  description: ElasticSearch query to execute
  name: query
  required: true
- description: Index to check (supports wildcards). Default is *.
  name: index
- description: What fields should be included. DO NOT SET IF YOU WANT ALL FIELDS!
  name: fields
comment: 'Deprecated. Use the Elasticsearch v2 integration instead.


  Runs an Elasticsearch query and displays results in a table.'
commonfields:
  id: ElasticSearchDisplay
  version: -1
dependson:
  must:
  - elasticsearch|||search
deprecated: true
enabled: true
name: ElasticSearchDisplay
script: "var index = args.index ? args.index : '*';\nvar query = args.query;\nvar\
  \ params = {'using-brand': 'elasticsearch', query: query, index: index};\nif (args.fields)\
  \ {\n    params.fields = args.fields;\n} else {\n    params.fields = 'text';\n}\n\
  var res = executeCommand('search', params);\nif (res && res.length > 0 && res[0].Type\
  \ !== entryTypes.error) {\n    var collectFields = function(f) {\n        if (fields[f]\
  \ && fields[f].length && fields[f].length > 0) {\n            hit[f] = fields[f][0];\n\
  \        }\n    };\n    var hits = res[0].Contents.hits;\n    var results = {Type:\
  \ entryTypes.note, ContentsFormat: formats.table, Contents: []};\n    for (var i=0;\
  \ i<hits.length; i++) {\n        var hit = {};\n        var fields = hits[i].fields;\n\
  \        if (fields) {\n            Object.keys(fields).forEach(collectFields);\n\
  \            results.Contents.push(hit);\n        } else if (hits[i]._source) {\n\
  \            results.Contents.push({source: hits[i]._source});\n        } else {\n\
  \            results.Contents.push({ID: hits[i]._id, data: 'No fields found'});\n\
  \        }\n    }\n    return results;\n}\nreturn res;"
scripttarget: 0
tags:
- Elasticsearch
tests:
- No test - deprecated
timeout: 0s
toversion: 4.1.9
type: javascript
