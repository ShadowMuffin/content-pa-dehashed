args: []
comment: Inserts incident info and labels into context for use inside playbooks.
commonfields:
  id: IncidentToContext
  version: -1
dependson: {}
deprecated: true
name: IncidentToContext
script: "# These comments are required to make sure that all pre-defined labels are\
  \ selectable in the playbook\n# demisto.setContext('Label/Application', '')\n# demisto.setContext('Label/Database',\
  \ '')\n# demisto.setContext('Label/Directory', '')\n# demisto.setContext('Label/Email',\
  \ '')\n# demisto.setContext('Label/Email/cc', '')\n# demisto.setContext('Label/Email/from',\
  \ '')\n# demisto.setContext('Label/Email/format', '')\n# demisto.setContext('Label/Email/html',\
  \ '')\n# demisto.setContext('Label/Email/text', '')\n# demisto.setContext('Label/Email/subject',\
  \ '')\n# demisto.setContext('Label/Email/attachments', '')\n# demisto.setContext('Label/Email/headers',\
  \ '')\n# demisto.setContext('Label/IP', '')\n# demisto.setContext('Label/System',\
  \ '')\n# demisto.setContext('Label/URL', '')\n# demisto.setContext('Label/User',\
  \ '')\n# demisto.setContext('Label/Brand', '')\n# demisto.setContext('Label/Instance',\
  \ '')\ni = demisto.incidents()[0]\ndemisto.setContext('id', i['id'])\ndemisto.setContext('created',\
  \ i['created'])\ndemisto.setContext('modified', i['modified'])\ndemisto.setContext('occurred',\
  \ i['occurred'])\ndemisto.setContext('dueDate', i['dueDate'])\ndemisto.setContext('name',\
  \ i['name'])\ndemisto.setContext('owner', i['owner'])\ndemisto.setContext('type',\
  \ i['type'])\ndemisto.setContext('severity', i['severity'])\ndemisto.setContext('phase',\
  \ i['phase'])\ndemisto.setContext('status', i['status'])\ndemisto.setContext('details',\
  \ i['details'])\n# Setting initial score based on severity. Severity \"Unknown\"\
  \ yields score 0.\nscore = i['severity'] * 25\ndemisto.setContext('score', score)\n\
  if 'labels' in i and i['labels']:\n    labels = {}\n    for l in i['labels']:\n\
  \        name = 'Label/' + l['type']\n        labels[name] = [l['value']] + (labels[name]\
  \ if name in labels else [])\n    for k, v in labels.iteritems():\n        demisto.setContext(k,\
  \ v if len(v) > 1 else v[0])\n\nif 'CustomFields' in i and i['CustomFields']:\n\
  \    for key in i['CustomFields'].keys():\n        demisto.setContext(key, i['CustomFields'][key])\n\
  \ndemisto.results('Incident context set')"
scripttarget: 0
subtype: python2
system: true
tags:
- infra
timeout: 0s
toversion: 4.1.9
type: python
