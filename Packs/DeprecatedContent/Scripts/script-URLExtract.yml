args:
- default: true
  description: The text to extract URLs from
  name: text
  required: true
comment: Extract URLs from the given text and place them both as output and in the
  context of a playbook
commonfields:
  id: URLExtract
  version: -1
dependson: {}
deprecated: true
name: URLExtract
script: "import re\nstrURLRegex = r'(?i)(?:(?:https?|ftp):\\/\\/|www\\.|ftp\\.)(?:\\\
  ([-A-Z0-9+&@#\\/%=~_|$?!:,.]*\\)|[-A-Z0-9+&@#\\/%=~_|$?!:,.])*(?:\\([-A-Z0-9+&@#\\\
  /%=~_|$?!:,.]*\\)|[A-Z0-9+&@#\\/%=~_|$])'\nres = []\nurls = []\nfiltered = ['http://schemas.microsoft.com/office/2004/12/omml',\
  \ 'http://www.w3.org/TR/REC-html40']\ndata = demisto.args()['text']\nfor m in re.finditer(strURLRegex,\
  \ data, re.I):\n    u = m.group(0)\n    if u in filtered:\n        continue\n  \
  \  if u in urls:\n        continue\n    if 'mailto:' in u:\n        continue\n \
  \   urls.append(u)\nres.append('URLs found:\\n' + '\\n'.join(urls))\nappendContext('urls',\
  \ urls, dedup = True)\ndemisto.results(res)"
scripttarget: 0
subtype: python2
system: true
tags:
- url
- infra
timeout: 0s
toversion: 4.1.9
type: python
