args: []
comment: Finds a CSV file in the war room and loads it into context.
commonfields:
  id: IngestCSV
  version: -1
dependson: {}
deprecated: true
name: IngestCSV
script: "# Find the CSV attachment\nentries = demisto.executeCommand('getEntries',\
  \ {})\ncsvEntry = None\nfor entry in entries:\n    fn = demisto.get(entry, 'File')\n\
  \    if type(fn) in [unicode, str] and fn.endswith('.csv'):\n        csvEntry =\
  \ entry\n        break\nif csvEntry:\n    res = demisto.executeCommand('getFilePath',\
  \ {'id': entry['ID']})\n    with open(res[0]['Contents']['path'], 'r') as f:\n \
  \       data = f.read()\n    if data:\n        demisto.setContext('csv', data)\n\
  \        demisto.results('Read %d bytes from CSV and inserted %d items into incident\
  \ context.' % (len(data), len(data.split(','))) )\n    else:\n        demisto.results(\
  \ { \"Type\" : entryTypes[\"error\"], \"ContentsFormat\" : formats[\"text\"], \"\
  Contents\" : 'No data could be read.' } )\nelse:\n    demisto.results( { \"Type\"\
  \ : entryTypes[\"error\"], \"ContentsFormat\" : formats[\"text\"], \"Contents\"\
  \ : 'No csv file found in the war room. Ensure the file was uploaded and the filename\
  \ ends in \".csv\".' } )\n\n"
scripttarget: 0
subtype: python2
system: true
tags:
- Utility
- ingestion
timeout: 0s
toversion: 4.1.9
type: python
