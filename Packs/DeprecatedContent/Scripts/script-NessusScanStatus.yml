args:
- default: true
  description: The Scan ID as it appears in Scan List (e.g. 6)
  name: scanId
comment: Retrieve current status for the specified scan.
commonfields:
  id: NessusScanStatus
  version: -1
dependson:
  must:
  - Nessus|||scan-details
deprecated: true
name: NessusScanStatus
script: "from time import ctime\nres = []\ndArgs = demisto.args()\nresCmd = demisto.executeCommand(\"\
  scan-details\", dArgs)\ntry:\n    for entry in resCmd:\n        if isError(entry):\n\
  \            res = resCmd\n            break\n        else:\n            status\
  \ = demisto.get(entry, 'Contents.info.status')\n            res.append({'ContentsFormat':\
  \ formats['text'], 'Type': entryTypes['note'], 'Contents': status if status else\
  \ 'ErrorFetchingScanStatus'})\nexcept Exception as ex:\n    res.append({\"Type\"\
  : entryTypes[\"error\"], \"ContentsFormat\": formats[\"text\"],\n              \
  \  \"Contents\": \"Error occurred while parsing output from command. Exception info:\\\
  n\" + str(ex) + \"\\n\\nInvalid output:\\n\" + str(resCmd)})\ndemisto.results(res)\n"
scripttarget: 0
subtype: python2
system: true
tags:
- nessus
timeout: 0s
toversion: 4.1.9
type: python
