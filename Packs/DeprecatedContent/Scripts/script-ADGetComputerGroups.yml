args:
- description: Active Directory Distinguished Name for the desired computer
  name: dn
- description: Name of the desired computer
  name: name
- description: Include these AD attributes of the resulting objects in addition to
    the default ones
  name: attributes
comment: Use Active Directory to retrieve the groups in which the specified computer
  is a member. The member computer can be specified by name or by DN.
commonfields:
  id: ADGetComputerGroups
  version: -1
dependson:
  must:
  - ad-search
deprecated: true
name: ADGetComputerGroups
script: "# Optional arguments and default values\nattrs = 'name'\nif demisto.get(demisto.args(),\
  \ 'attributes'):\n    attrs += \",\" + demisto.args()['attributes']\nmemberDN =\
  \ ''\nif demisto.get(demisto.args(), 'dn'):\n    memberDN = demisto.args()['dn']\n\
  elif demisto.get(demisto.args(), 'name'):\n    resp = demisto.executeCommand('AdSearch',\
  \ {'filter':\"(&(objectCategory=Computer)(name=\" + demisto.args()['name']+\"))\"\
  })\n    if type(resp)==list and len(resp)==1 and type(resp[0])==dict and 'Contents'\
  \ in resp[0] and type(resp[0]['Contents'])==list and len(resp[0]['Contents'])==1\
  \ and type(resp[0]['Contents'][0])==dict and 'dn' in resp[0]['Contents'][0]:\n \
  \       memberDN = resp[0]['Contents'][0]['dn']\n    else:\n        demisto.results(\
  \ { 'Type' : entryTypes['error'], 'ContentsFormat' : formats['text'], 'Contents'\
  \ : 'Unexpected output from ad command.' } )\n        sys.exit(0)\nelse:\n    demisto.results(\
  \ { 'Type' : entryTypes['error'], 'ContentsFormat' : formats['text'], 'Contents'\
  \ : 'You must provide either dn or name as argument!' } )\n    sys.exit(0)\nif memberDN:\n\
  \    filterstr = r\"(&(member=\" + memberDN + \")(objectcategory=group))\"\n   \
  \ demisto.results( demisto.executeCommand( 'AdSearch' , { 'filter' : filterstr,\
  \ 'attributes' : attrs } ) )\nelse:\n    demisto.results( { 'Type' : entryTypes['error'],\
  \ 'ContentsFormat' : formats['text'], 'Contents' : 'Computer not found.' } )"
scripttarget: 0
subtype: python2
system: true
tags:
- active directory
timeout: 0s
toversion: 4.1.9
type: python
