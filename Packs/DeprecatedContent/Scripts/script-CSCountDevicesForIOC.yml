args:
- default: true
  description: One of sha256, sha1, md5, domain
  name: type
  required: true
- description: The IOC to find
  name: value
  required: true
comment: 'List the number devices that match each IOC in query - limited to sha256,
  sha1, md5 and domain types

  '
commonfields:
  id: CSCountDevicesForIOC
  version: -1
dependson:
  must:
  - cs-device-count-ioc
deprecated: true
name: CSCountDevicesForIOC
script: "res = []\nt = []\nfor v in argToList(demisto.args()['value']):\n    e = demisto.executeCommand(\"\
  cs-device-count-ioc\", {\"type\": demisto.args()['type'], \"value\": v})[0]\n  \
  \  if isError(e):\n        if not '404 (Not Found)' in e['Contents']: # Skip 404\
  \ errors - it just means the IOC wasn't found\n            res += [e]\n    else:\n\
  \        myData = demisto.get(e, 'Contents.resources')\n        if myData:\n   \
  \         myData = [{k: formatCell(row[k]) for k in row} for row in myData]\n  \
  \          t += myData\nif t:\n    res.append({'ContentsFormat': formats['table'],\
  \ 'Type': entryTypes['note'], 'Contents': t} )\nelse:\n    res.append('No results.')\n\
  demisto.results(res)"
scripttarget: 0
subtype: python2
system: true
tags:
- crowdstrike
timeout: 0s
toversion: 4.1.9
type: python
