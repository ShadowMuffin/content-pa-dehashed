args:
- default: true
  description: Splunk query to execute
  name: query
  required: true
- description: Return up to X first rows. If omitted, defaults to 30.
  name: rows
comment: Run a query through Splunk and format the results as a table
commonfields:
  id: SplunkSearch
  version: -1
dependson:
  must:
  - splunk|||search
deprecated: true
name: SplunkSearch
script: "var rows = args.rows ? args.rows : 30;\nvar query = (args.query.indexOf('|')\
  \ > 0) ? args.query : args.query + ' | head ' + rows;\nvar res = executeCommand('search',\
  \ {'using-brand': 'splunk', query: query});\nvar table = {\n    Type: 1,\n    ContentsFormat:\
  \ 'table',\n    Contents: []\n};\nfor (var i=0; i<res[0].Contents.length; i++) {\n\
  \    data = res[0].Contents[i].result['_raw'];\n    table.Contents.push({Time: res[0].Contents[i].result['_time'],\
  \ Host: res[0].Contents[i].result['host'], Source: res[0].Contents[i].result['source'],\
  \ Data: data});\n}\nif (table.Contents.length > 0) {\n  return table;\n} else {\n\
  \  return 'No results.'\n}"
scripttarget: 0
system: true
tags:
- enhancement
- splunk
timeout: 0s
toversion: 4.1.9
type: javascript
