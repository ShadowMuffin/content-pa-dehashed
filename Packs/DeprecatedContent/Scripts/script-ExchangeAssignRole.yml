args:
- description: Username to whom to assign the role
  name: username
- description: Choose a different role to assign to the user. Default is 'Mailbox
    Import Export'.
  name: role
- description: Hostname of the Exchange server
  name: server
comment: This script is deprecated. Please use the Exchange 2016 Compliance Search
  integration instead.
commonfields:
  id: ExchangeAssignRole
  version: -1
dependson: {}
deprecated: true
name: ExchangeAssignRole
script: "//+ exchange/assign.ps1\n//Params:\n//See here: https://technet.microsoft.com/en-us/library/dd298173(v=exchg.160).aspx\n\
  //query is the string provided to the -SearchQuery parameter\n//to-mailbox is the\
  \ string provided to -TargetMailbox parameter\n//to-folder is the string provided\
  \ to -TargetFolder parameter\n//if server is provided, it'll be used as -ServerFQDN\
  \ parameter to Connect-ExchangeServer cmdlet\nif ((env.ARCH !== \"amd64\") && (env.OS\
  \ !== \"windows\")) {\n    throw(\"Script can run only in 64bit Windows Agents\"\
  );\n}\nvar command = [];\ncommand.push(\"powershell.exe\");\ncommand.push(\"-version\
  \ 2.0\");\ncommand.push(\"-NonInteractive\");\ncommand.push(\"-NoLogo\");\ncommand.push(which(\"\
  assign.ps1\"));\nif (typeof (args.role) !== \"undefined\") {\n    command.push(\"\
  -role\");\n    command.push(args.role);\n}\nif (typeof (args.username) !== \"undefined\"\
  ) {\n    command.push(\"-username\");\n    command.push(args.username);\n}\nif (typeof\
  \ (args.server) !== \"undefined\") {\n    command.push(\"-server\");\n    command.push(args.server);\n\
  }\npack(execute(command.join(\" \")), 'table');"
scripttarget: 1
system: true
tags:
- exchange
- email
timeout: 0s
toversion: 4.1.9
type: javascript
