args:
- default: true
  description: If provided, checks only files whose names are in the list. The names
    should be comma-separated.
  name: fileNames
comment: Iterate on all file artifacts in the investigation and return details of
  positives
commonfields:
  id: CheckFiles
  version: -1
dependson:
  must:
  - file
deprecated: true
name: CheckFiles
script: "var fileNames = [];\nif (args.fileNames) {\n  fileNames = args.fileNames.split(',');\n\
  }\nvar entries = executeCommand('getEntries', {});\nvar res = [];\nfor (var i=0;\
  \ i<entries.length; i++) {\n  if (entries[i].File && (fileNames.length === 0 ||\
  \ fileNames.indexOf(entries[i].File) >= 0)) {\n    var rep = executeCommand('file',\
  \ {file: entries[i].FileMetadata.MD5});\n    if (rep && Array.isArray(rep)) {\n\
  \      for (var r = 0; r < rep.length; r++) {\n        if (positiveFile(rep[r]))\
  \ {\n          res.push(shortFile(rep[r]));\n        }\n      }\n    }\n  }\n}\n\
  if (res.length > 0) {\n  res.push('yes');\n  return res;\n}\nreturn ['No suspicious\
  \ files found', 'no'];"
scripttarget: 0
system: true
tags:
- server
- threat-intel
timeout: 0s
toversion: 4.1.9
type: javascript
