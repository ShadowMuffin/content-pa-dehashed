args: []
comment: Display the list of folders and scans from Nessus.
commonfields:
  id: NessusListScans
  version: -1
dependson:
  must:
  - Nessus|||scans-list
deprecated: true
name: NessusListScans
script: "from time import ctime\nres = []\n\ndArgs = demisto.args()\nresScanList =\
  \ demisto.executeCommand(\"scans-list\", dArgs)\ntry:\n    for entry in resScanList:\n\
  \        if isError(entry):\n            res = resScanList\n            break\n\
  \        else:\n            mdResult = ''\n            ts = demisto.get(entry, 'Contents.timestamp')\n\
  \            folders = demisto.get(entry, 'Contents.folders')\n            scans\
  \ = demisto.get(entry, 'Contents.scans')\n            mdResult += '## Nessus Scan\
  \ List'\n            if ts:\n                mdResult += ' - ' + ctime(ts)\n   \
  \         mdResult += '\\n'\n            if folders:\n                mdResult +=\
  \ tblToMd(\"Folders\", folders)\n            if scans:\n                mdResult\
  \ += tblToMd(\"Scans\", scans)\n            res.append({'ContentsFormat': formats['markdown'],\
  \ 'Type': entryTypes['note'], 'Contents': mdResult})\nexcept Exception as ex:\n\
  \    res.append({\"Type\": entryTypes[\"error\"], \"ContentsFormat\": formats[\"\
  text\"],\n                \"Contents\": \"Error occurred while parsing output from\
  \ command. Exception info:\\n\" + str(ex) + \"\\n\\nInvalid output:\\n\" + str(resScanList)})\n\
  demisto.results(res)\n"
scripttarget: 0
subtype: python2
system: true
tags:
- nessus
timeout: 0s
toversion: 4.1.9
type: python
