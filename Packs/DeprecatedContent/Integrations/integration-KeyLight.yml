category: Case Management
commonfields:
  id: Lockpath KeyLight
  version: -1
configuration:
- defaultvalue: ''
  display: Server URL (e.g. https://192.168.0.1)
  name: server
  required: true
  type: 0
- defaultvalue: '4443'
  display: Port
  name: port
  required: true
  type: 0
- defaultvalue: ''
  display: Credentials
  name: credentials
  required: true
  type: 9
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Deprecated. Use LockPath KeyLight v2.
detaileddescription: For more information regarding thee integrations specific fields,
  please advise the Cylance API Guide for version 1.7.
display: Lockpath KeyLight
fromversion: 3.5.0
image: data:image/png;base64,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
name: Lockpath KeyLight
script:
  commands:
  - arguments: []
    deprecated: true
    description: Returns a complete list of all Keylight components available to the
      user based on account permissions
    name: kl-get-component-list
  - arguments:
    - default: true
      description: The ID of the desired component
      name: id
      required: true
    deprecated: true
    description: Retrieves a component specified by its ID
    name: kl-get-component
  - arguments:
    - default: true
      description: The Alias of the desired component
      name: alias
      required: true
    deprecated: true
    description: Retrieves a component specified by its Alias
    name: kl-get-component-by-alias
  - arguments:
    - default: true
      description: The ID of the desired component
      name: componentId
      required: true
    deprecated: true
    description: Retrieves detail field listing for a component specified by its ID
    name: kl-get-field-list
  - arguments:
    - default: true
      description: The field ID for the individual field within the component
      name: id
      required: true
    deprecated: true
    description: Retrieves details for a field specified by its ID
    name: kl-get-field
  - arguments:
    - default: true
      description: The ID of the desired component
      name: componentID
      required: true
    - description: Describes the field ID for the column that the records will be
        filtered on
      name: fieldPath
      required: true
    - description: Describes the ID for the filter being implemented
      name: filterType
      required: true
    - description: Matches value (if applicable)
      name: value
    deprecated: true
    description: ' Return the number of records in a given component'
    name: kl-get-record-count
  - arguments:
    - default: true
      description: ID of the desired component
      name: componentId
      required: true
    - description: ID for the individual record within the component
      name: recordId
    deprecated: true
    description: Returns the complete set of fields for a given record within a component
    name: kl-get-record
  - arguments:
    - description: The ID of the desired component
      name: componentID
      required: true
    - description: The index of the page of result to return. Must be > 0
      name: pageIndex
    - description: The size of the page results to return. Must be >= 1
      name: pageSize
    - description: Describes the field ID for the column that the records will be
        filtered on
      name: fieldPath
      required: true
    - description: Describes the ID for the filter being implemented
      name: filterType
      required: true
    - description: Matches value (if applicable)
      name: value
    deprecated: true
    description: Return the title/default field for a set of records within a chosen
      component
    name: kl-get-records
  - arguments:
    - description: ID of the desired component
      name: componentID
      required: true
    - description: ID for the individual record within the component
      name: recordId
      required: true
    deprecated: true
    description: Delete a selected record from within a chosen component
    name: kl-delete-record
  - arguments:
    - default: true
      description: The ID of the desired component
      name: componentId
      required: true
    - description: A list of key-value-type triplets in a JSON format. Type will be
        used only if value is not nil
      name: values
      required: true
    deprecated: true
    description: Create a new record within the specified component of the Keylight
      application
    name: kl-create-record
  - arguments:
    - default: true
      description: The ID of the desired component
      name: componentId
      required: true
    - description: A list of key-value-type triplets in a JSON format. Type will be
        used only if value is not nil
      name: values
      required: true
    - description: Record id
      name: id
      required: true
    deprecated: true
    description: Update an existing record within the specified component of the Keylight
      application
    name: kl-update-record
  - arguments:
    - default: true
      description: ID of the desired component
      name: componentID
      required: true
    - description: ID for the individual record within the component
      name: recordId
      required: true
    deprecated: true
    description: Retrieves record information based on the provided component ID and
      record ID, with lookup field report details
    name: kl-get-detail-record
  - arguments:
    - default: true
      description: ID of the desired lookup field
      name: lookupFieldId
      required: true
    - description: ID for the desired lookup field path
      name: fieldPathId
      required: true
    deprecated: true
    description: Gets the field information of each field in a field path that corresponds
      to a lookup report column
    name: kl-get-lookup-report-column-fields
  - arguments:
    - description: ID of the desired component
      name: componentID
      required: true
    - description: The index of the page of result to return. Must be > 0
      name: pageIndex
    - description: The size of the page results to return. Must be >= 1
      name: pageSize
    deprecated: true
    description: GetDetailRecords provides the ability to run a search with filters
      and paging (GetRecords) while returning a high level of detail for each record
      (GetRecord)
    name: kl-get-detail-records
  - arguments:
    - description: ID of the desired component
      name: componentID
      required: true
    - description: ID for the individual record within the component
      name: recordId
      required: true
    - description: ' ID for the individual field within the component'
      name: fieldId
      required: true
    deprecated: true
    description: Gets information for all attachments associated with the provided
      component ID, record ID, and Documents field id. No file data is returned, only
      file name, field ID, and document ID information
    name: kl-get-record-attachments
  - arguments:
    - default: true
      description: ID of the desired component
      name: componentID
      required: true
    - description: ID for the individual record within the component
      name: recordId
      required: true
    - description: ID for the individual field within the component
      name: fieldId
      required: true
    - description: ID for the individual document within the component
      name: documentId
      required: true
    deprecated: true
    description: Gets a single attachment associated with the provided component ID,
      record ID, documents field ID, and document ID
    name: kl-get-record-attachment
  - arguments:
    - default: true
      description: ID of the desired component
      name: componentID
      required: true
    - description: ID for the individual record within the component
      name: id
      required: true
    - description: ID for the individual field within the component
      name: fieldId
      required: true
    - description: ID for the individual attachment within the component
      name: attachmentId
      required: true
    deprecated: true
    description: Deletes the specified attachments from the provided document fields
      on a specific record
    name: kl-delete-record-attachments
  script: "var server = params.server.replace(/[\\/]+$/, '') + ':' + params.port +\
    \ '/';\n\nvar filtersFields = ['fieldPath', 'filterType', 'value'];\n\nvar urlDictionary\
    \ = {\n    'login' : 'SecurityService/Login',\n    'logout': 'SecurityService/Logout',\n\
    \    'kl-get-component-list': 'ComponentService/GetComponentList',\n    'kl-get-component':\
    \ 'ComponentService/GetComponent',\n    'kl-get-component-by-alias': 'ComponentService/GetComponentByAlias',\n\
    \    'kl-get-field-list': 'ComponentService/GetFieldList',\n    'kl-get-field':\
    \ 'ComponentService/GetFieldList',\n    'kl-get-record-count': 'ComponentService/GetRecordCount',\n\
    \    'kl-get-record': 'ComponentService/GetRecord',\n    'kl-get-records': 'ComponentService/GetRecords',\n\
    \    'kl-delete-record': 'ComponentService/DeleteRecord',\n    'kl-create-record':\
    \ 'ComponentService/CreateRecord',\n    'kl-update-record': 'ComponentService/UpdateRecord',\n\
    \    'kl-get-detail-record': 'ComponentService/GetDetailRecord',\n    'kl-get-lookup-report-column-fields':\
    \ 'ComponentService/GetLookupReportColumnFields',\n    'kl-get-detail-records':\
    \ 'ComponentService/GetDetailRecords',\n    'kl-get-record-attachment': 'ComponentService/GetRecordAttachment',\n\
    \    'kl-get-record-attachments': 'ComponentService/GetRecordAttachments',\n \
    \   'kl-delete-record-attachments': 'ComponentService/DeleteRecordAttachments'\n\
    };\n\nvar methodDictionary = {\n    'login': 'POST',\n    'logout': 'GET',\n \
    \   'kl-get-component-list': 'GET',\n    'kl-get-component': 'GET',\n    'kl-get-component-by-alias':\
    \ 'GET',\n    'kl-get-field-list': 'GET',\n    'kl-get-field': 'GET',\n    'kl-get-record-count':\
    \ 'POST',\n    'kl-get-record': 'GET',\n    'kl-get-records': 'POST',\n    'kl-delete-record':\
    \ 'DELETE',\n    'kl-create-record': 'POST',\n    'kl-update-record': 'POST',\n\
    \    'kl-get-detail-record': 'GET',\n    'kl-get-lookup-report-column-fields':\
    \ 'GET',\n    'kl-get-detail-records': 'GET',\n    'kl-get-record-attachment':\
    \ 'GET',\n    'kl-get-record-attachments': 'GET',\n    'kl-delete-record-attachments':\
    \ 'POST'\n};\n\nvar bodyDictionary = {\n    'login': '<Login><username>%username%</username><password>%password%</password></Login>',\n\
    \    'kl-get-record-count': '<GetRecordCount><componentId>%componentID%</componentId>%filters%</GetRecordCount>',\n\
    \    'kl-get-records': '<GetRecords><componentId>%componentID%</componentId><pageIndex>%pageIndex%</pageIndex><pageSize>%pageSize%</pageSize>%filters%</GetRecords>',\n\
    \    'kl-delete-record': '<DeleteRecord><componentId>%componentID%</componentId><recordId>%recordId%</recordId></DeleteRecord>',\n\
    \    'kl-create-record': '<CreateRecord><componentId>%componentID%</componentId>%values%</CreateRecord>',\n\
    \    'kl-update-record': '<UpdateRecord><componentId>%componentID%</componentId>%values%</UpdateRecord>',\n\
    \    'kl-delete-record-attachments': '<DeleteRecordAttachments><componentId>%componentID%</componentId>%values%</DeleteRecordAttachments>'\n\
    };\n\nvar filterFields = ['field-path', 'filter-type', 'value'];\n\nvar sendRequest\
    \ = function(method, url, body, authCookies, recursive) {\n    var httpParams\
    \ = {\n            Method: method,\n            Headers: {\n                'Content-Type':\
    \ ['application/xml;charset=utf-8']\n            }\n        };\n    if (authCookies)\
    \ {\n        httpParams.Cookies = authCookies;\n    }\n    if (method !== 'GET'\
    \ && body) {\n        httpParams.Body = body;\n    }\n    var res = http(server\
    \ + url, httpParams, params.insecure, params.proxy, undefined, true);\n    if\
    \ (res.StatusCode < 200 || res.StatusCode >= 300) {\n        if (authCookies &&\
    \ !recursive) {\n            sendRequest(\n                methodDictionary['logout'],\n\
    \                getUrl('logout'),\n                undefined,\n             \
    \   authCookies,\n                true);\n        }\n        throw 'Request to\
    \ KeyLight URL ' + url + ' Failed.\\nStatus code: ' + res.StatusCode + '.\\nBody:\
    \ ' + res.Body + '.';\n    }\n    return res;\n};\n\nvar createFiltersFromArgs\
    \ = function(args) {\n    var res = replaceInTemplates(!!args.value ?\n      \
    \      '<filters><SearchCriteriaItem><FieldPath><int>%field-path%</int>/FieldPath><FilterType>%filter-type%</FilterType></SearchCriteriaItem></filters>'\
    \ :\n            '<filters><SearchCriteriaItem><FieldPath><int>%field-path%</int>/FieldPath><FilterType>%filter-type%</FilterType><Value>%value%</Value></SearchCriteriaItem></filters>',\n\
    \        args)\n    for (var i = 0; i < filtersFields.length; i++) {\n       \
    \ delete(args[filtersFields[i]]);\n    }\n    return res;\n}\n\nvar createValuesFromArgs\
    \ = function(values, id) {\n    var res = '';\n    for (var i = 0; i < values.length;\
    \ i++) {\n        res += replaceInTemplates(values[i].value === 'nil' ?\n    \
    \            '<KeyValuePair><key>%key%</key><value i:nil=\"true\"/></KeyValuePair>'\
    \ :\n                '<KeyValuePair><key>%key%</key><value i:type=\"a:%type%\"\
    >%value%</value></KeyValuePair>',\n            args)\n    }\n    return '<dynamicRecord\
    \ xmlns:i=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:a=\"http://www.w3.org/2001/XMLSchema\"\
    >'+\n                '<FieldValues>'+\n                    (id ? '<Id>' + id +\
    \ '</Id>' : '')+\n                    res +\n                '</FieldValues>'+\n\
    \            '</dynamicRecord>';\n}\n\nvar includeRecord = ['kl-create-record',\
    \ 'kl-update-record', 'kl-delete-record-attachments'];\n\nvar buildBodyForCommand\
    \ = function(command, args) {\n    if (methodDictionary[command] === 'GET') {\n\
    \        return undefined;\n    }\n    var keys = Object.keys(args);\n    var\
    \ filters;\n    for (var j = 0; j < keys.length; j++) {\n        args[keys[j]]\
    \ = escapeXMLChars(args[keys[j]]);\n    }\n    for (var i = 0; i < filtersFields.length\
    \ && !filters; i++) {\n        if (keys.indexOf(filtersFields[i]) !== -1) {\n\
    \            filters = createFiltersFromArgs(args);\n            args.filters\
    \ = filters;\n        }\n    }\n    if (!args.filters) {\n        args.filters\
    \ = '';\n    }\n\n    if (includeRecord.indexOf(command) !== -1) {\n        var\
    \ values = args.values && JSON.parse(args.values);\n        if (command === 'kl-delete-record-attachments')\
    \ {\n            values = [{type: 'DynamicRecordList', key: args.fieldId, value:\
    \ '<Record><Id>' + args.attachmentId + '</Id></Record>'}];\n        }\n      \
    \  args.values = createValuesFromArgs(values, args.id);\n    }\n    return replaceInTemplates(bodyDictionary[command],\
    \ args);\n}\n\nvar getUrl = function(command, args) {\n    return urlDictionary[command]\
    \ + (methodDictionary[command] === 'GET' ? encodeToURLQuery(args) : '');\n}\n\n\
    var sendRequestAndParse = function(method, url, body, cookies) {\n    var res\
    \ = sendRequest(method, url, body, cookies).Body;\n    return JSON.parse(x2j(res));\n\
    }\n\nvar loginCookies = sendRequest(\n    methodDictionary['login'],\n    getUrl('login'),\n\
    \    buildBodyForCommand('login', {username: params.credentials.identifier, password:\
    \ params.credentials.password})\n    ).Cookies;\nvar result;\nswitch (command)\
    \ {\n    case 'test-module':\n        result = 'something is wrong';\n       \
    \ if (loginCookies) {\n            result = 'ok';\n        }\n        break;\n\
    \    case 'kl-get-record-attachment':\n        result = saveFile(sendRequest(\n\
    \                methodDictionary[command],\n                getUrl(command, args),\n\
    \                buildBodyForCommand(command, args),\n                loginCookies).\n\
    \            Bytes);\n        break;\n    default:\n        result = sendRequestAndParse(\n\
    \            methodDictionary[command],\n            getUrl(command, args),\n\
    \            buildBodyForCommand(command, args),\n            loginCookies);\n\
    }\nif (loginCookies) {\n    // if we managed to log in, log out\n    sendRequest(\n\
    \        methodDictionary['logout'],\n        getUrl('logout'),\n        undefined,\n\
    \        loginCookies);\n}\nreturn result;\n"
  type: javascript
system: true
tests:
- No test - Deprecated. Use Lockpath Keylight v2
toversion: 4.1.9
