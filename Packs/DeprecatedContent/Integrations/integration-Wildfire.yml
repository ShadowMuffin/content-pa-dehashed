category: Forensics & Malware Analysis
commonfields:
  id: WildFire
  version: -1
configuration:
- defaultvalue: https://wildfire.paloaltonetworks.com/publicapi
  display: Server URL (e.g. https://192.168.0.1)
  name: server
  required: true
  type: 0
- defaultvalue: ''
  display: API Key
  name: token
  required: true
  type: 4
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
deprecated: true
description: Perform malware dynamic analysis
detaileddescription: "Don\u2019t have a WildFire API key?\nGo to your WildFire account,\n\
  Login to: https://wildfire.paloaltonetworks.com/wildfire/account\nSelect the \u201C\
  Account\u201D tab\nCopy your API Key"
display: Palo Alto Networks WildFire (Deprecated)
fromversion: 4.0.0
image: data:image/png;base64,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
name: WildFire
script:
  commands:
  - arguments:
    - default: true
      description: file hash to check
      isArray: true
      name: file
    - description: md5 hash to check
      isArray: true
      name: md5
    - description: sha256 hash to check
      isArray: true
      name: sha256
    deprecated: true
    description: Retrieve results for a file hash using WildFire
    name: file
    outputs:
    - contextPath: File.Name
      description: Filename
      type: string
    - contextPath: File.Type
      description: File type e.g. "PE"
      type: string
    - contextPath: File.Size
      description: File size
      type: string
    - contextPath: File.MD5
      description: MD5 hash of the file
      type: string
    - contextPath: File.SHA1
      description: SHA1 hash of the file
      type: string
    - contextPath: File.SHA256
      description: SHA256 hash of the file
      type: string
    - contextPath: File.Malicious.Vendor
      description: For malicious files, the vendor that made the decision
      type: string
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
      type: string
    - contextPath: DBotScore.Type
      description: The type of the indicator
      type: string
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
      type: string
    - contextPath: DBotScore.Score
      description: The actual score
      type: number
    - contextPath: WildFire.Report.Status
      description: The status of the submission
      type: string
    - contextPath: WildFire.Report.SHA256
      description: SHA256 of the submission
      type: string
    - contextPath: InfoFile.EntryID
      description: The EntryID of the report file
    - contextPath: InfoFile.Extension
      description: The extension of the report file
      type: string
    - contextPath: InfoFile.Name
      description: The name of the report file
      type: string
    - contextPath: InfoFile.Info
      description: The info of the report file
      type: string
    - contextPath: InfoFile.Size
      description: The size of the report file
      type: number
    - contextPath: InfoFile.Type
      description: The type of the report file
      type: string
  - arguments:
    - description: ID of the entry containing the file to upload
      isArray: true
      name: upload
      required: true
    deprecated: true
    description: Upload file to WildFire for analysis
    name: wildfire-upload
    outputs:
    - contextPath: WildFire.Report.MD5
      description: MD5 of the submission
      type: string
    - contextPath: WildFire.Report.SHA256
      description: SHA256 of the submission
      type: string
    - contextPath: WildFire.Report.FileType
      description: The type of the submission
      type: string
    - contextPath: WildFire.Report.Size
      description: The size of the submission
      type: number
    - contextPath: WildFire.Report.Status
      description: The status of the submission
      type: string
  - arguments:
    - description: URL of remote file to be uploaded
      name: upload
      required: true
    deprecated: true
    description: URL of remote file to be uploaded
    name: wildfire-upload-file-url
    outputs:
    - contextPath: WildFire.Report.MD5
      description: MD5 of the submission
      type: string
    - contextPath: WildFire.Report.SHA256
      description: SHA256 of the submission
      type: string
  - arguments:
    - description: MD5 hash to check
      isArray: true
      name: md5
    - description: SHA256 hash to check
      isArray: true
      name: sha256
    - deprecated: true
      description: Deprecated - use sha256 argument
      isArray: true
      name: hash
    - auto: PREDEFINED
      defaultValue: pdf
      description: Optional - request a structured report (formatted as XML/PDF)
      name: format
      predefined:
      - xml
      - pdf
    - description: Receive extended information from WildFire
      name: verbose
    deprecated: true
    description: Retrieve results for a file hash using WildFire
    name: wildfire-report
    outputs:
    - contextPath: File.Name
      description: Filename
      type: string
    - contextPath: File.Type
      description: File type e.g. "PE"
      type: string
    - contextPath: File.Size
      description: File size
      type: number
    - contextPath: File.MD5
      description: MD5 hash of the file
      type: string
    - contextPath: File.SHA1
      description: SHA1 hash of the file
      type: string
    - contextPath: File.SHA256
      description: SHA256 hash of the file
      type: string
    - contextPath: File.Malicious.Vendor
      description: For malicious files, the vendor that made the decision
      type: string
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
      type: string
    - contextPath: DBotScore.Type
      description: The type of the indicator
      type: string
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
      type: string
    - contextPath: DBotScore.Score
      description: The actual score
      type: number
    - contextPath: WildFire.Report.Status
      description: The status of the submissiom
      type: string
    - contextPath: WildFire.Report.SHA256
      description: SHA256 of the submission
      type: string
    - contextPath: InfoFile.EntryID
      description: The EntryID of the report file
      type: string
    - contextPath: InfoFile.Extension
      description: The extension of the report file
      type: string
    - contextPath: InfoFile.Name
      description: The name of the report file
      type: string
    - contextPath: InfoFile.Info
      description: The info of the report file
      type: string
    - contextPath: InfoFile.Size
      description: The size of the report file
      type: number
    - contextPath: InfoFile.Type
      description: The type of the report file
      type: string
    - contextPath: WildFire.Report.Network.UDP.IP
      description: Submission related IPs in UDP protocol
      type: string
    - contextPath: WildFire.Report.Network.UDP.Port
      description: Submission related ports in UDP protocol
      type: string
    - contextPath: WildFire.Report.Network.TCP.IP
      description: Submission related IPs in TCP protocol
      type: string
    - contextPath: WildFire.Report.Network.TCP.Port
      description: Submission related ports in TCP protocol
      type: string
    - contextPath: WildFire.Report.Network.DNS.Query
      description: Submission DNS queries
      type: string
    - contextPath: WildFire.Report.Network.DNS.Response
      description: Submission DNS responses
      type: string
    - contextPath: WildFire.Report.Evidence.md5
      description: Submission evidence md5
      type: string
    - contextPath: WildFire.Report.Evidence.Text
      description: Submission evidence text
      type: string
  - arguments:
    - description: Hash to get verdict for
      isArray: true
      name: hash
      required: true
    deprecated: true
    description: Get a verdict regarding a hash
    name: wildfire-get-verdict
    outputs:
    - contextPath: WildFire.Verdicts.MD5
      description: File MD5
      type: string
    - contextPath: WildFire.Verdicts.SHA256
      description: File SHA256
      type: string
    - contextPath: WildFire.Verdicts.Verdict
      description: File verdict
      type: number
    - contextPath: WildFire.Verdicts.VerdictDescription
      description: File verdict description
      type: string
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
      type: string
    - contextPath: DBotScore.Type
      description: The type of the indicator
      type: string
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
      type: string
    - contextPath: DBotScore.Score
      description: The actual score
      type: number
  - arguments:
    - description: EntryID of the text file that contains multiple hashes. Limit is
        500 hashes.
      isArray: true
      name: EntryID
      required: true
    deprecated: true
    description: Get a verdict regarding multiple hashes, stored in a txt file
    name: wildfire-get-verdicts
    outputs:
    - contextPath: WildFire.Verdicts.MD5
      description: File MD5
      type: string
    - contextPath: WildFire.Verdicts.SHA256
      description: File SHA256
      type: string
    - contextPath: WildFire.Verdicts.Verdict
      description: File verdict
      type: number
    - contextPath: WildFire.Verdicts.VerdictDescription
      description: File verdict description
      type: string
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
      type: string
    - contextPath: DBotScore.Type
      description: The type of the indicator
      type: string
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
      type: string
    - contextPath: DBotScore.Score
      description: The actual score
      type: number
  - arguments:
    - description: MD5 hash to retrieve
      isArray: true
      name: md5
    - description: SHA256 hash to retrieve
      isArray: true
      name: sha256
    description: Retrieve a sample from WildFire
    name: wildfire-get-sample
    outputs:
    - contextPath: File.Size
      description: File size
      type: number
    - contextPath: File.SHA1
      description: SHA1 hash of the file
      type: string
    - contextPath: File.SHA256
      description: SHA256 hash of the file
      type: string
    - contextPath: File.Name
      description: The sample name
      type: string
    - contextPath: File.SSDeep
      description: SSDeep hash of the file
      type: string
    - contextPath: File.EntryID
      description: War-Room Entry ID of the file
      type: string
    - contextPath: File.Info
      description: Basic information of the file
      type: string
    - contextPath: File.Type
      description: File type e.g. "PE"
      type: string
    - contextPath: File MD5
      description: MD5 hash of the file
      type: string
    - contextPath: File.Extension
      description: File Extension
      type: string
  - arguments:
    - description: URL of remote file to be uploaded
      name: upload
      required: true
    deprecated: true
    description: Deprecated, use wildfire-upload-file-url instead
    name: wildfire-upload-file-remote
    outputs:
    - contextPath: WildFire.Report.MD5
      description: MD5 of the submission
      type: string
    - contextPath: WildFire.Report.SHA256
      description: SHA256 of the submission
      type: string
    - contextPath: WildFire.Report.FileType
      description: The type of the submission
      type: string
    - contextPath: WildFire.Report.Size
      description: The size of the submission
      type: number
    - contextPath: WildFire.Report.Status
      description: The status of the submission
      type: string
  - arguments:
    - description: ID of the entry containing the file to upload
      name: upload
      required: true
    - defaultValue: '7'
      description: Delay wait time between calls (in seconds)
      name: delay
    - defaultValue: '60'
      description: Total wait time (in seconds)
      name: timeout
    - auto: PREDEFINED
      description: Optional - request a structured report (formatted as XML/PDF)
      name: format
      predefined:
      - xml
      - pdf
    deprecated: true
    description: Deprecated, use detonate playbook instead.
    name: detonate-file
    outputs:
    - contextPath: File.Name
      description: Filename
    - contextPath: File.Type
      description: File type e.g. "PE"
    - contextPath: File.Size
      description: File size
    - contextPath: File.MD5
      description: MD5 hash of the file
    - contextPath: File.SHA1
      description: SHA1 hash of the file
    - contextPath: File.SHA256
      description: SHA256 hash of the file
    - contextPath: File.Malicious.Vendor
      description: For malicious files, the vendor that made the decision
    - contextPath: DBotScore.Indicator
      description: The indicator we tested
    - contextPath: DBotScore.Type
      description: The type of the indicator
    - contextPath: DBotScore.Vendor
      description: Vendor used to calculate the score
    - contextPath: DBotScore.Score
      description: The actual score
  - arguments:
    - description: URL of remote file to be uploaded
      name: upload
      required: true
    - defaultValue: '7'
      description: Delay wait time between calls (in seconds)
      name: delay
    - defaultValue: '60'
      description: Total wait time (in seconds)
      name: timeout
    - auto: PREDEFINED
      description: Optional - request a structured report (formatted as XML/PDF)
      name: format
      predefined:
      - xml
      - pdf
    deprecated: true
    description: Deprecated, use detonate playbook instead
    name: detonate-file-remote
  runonce: false
  script: "//DICTIONARIES//\nvar URL_DICT = {\n    verdict: '/get/verdict',\n    verdicts:\
    \ '/get/verdicts',\n    upload: '/submit/file',\n    uploadUrl: '/submit/link',\n\
    \    report: '/get/report',\n    remoteFile: '/submit/url',\n    getSample: '/get/sample'\n\
    };\n\nvar ERROR_DICT = {\n    401 : 'Unauthorized, API key invalid',\n    404\
    \ : 'Not Found, The report was not found',\n    405 : 'Method Not Allowed, Method\
    \ other than POST used',\n    413 : 'Request Entity Too Large, Sample file size\
    \ over max limit',\n    415 : 'Unsupported Media Type',\n    418 : 'Unsupported\
    \ File Type Sample, file type is not supported',\n    419 : 'Request quota exceeded',\n\
    \    420 : 'Insufficient arguments',\n    421 : 'Invalid arguments',\n    500\
    \ : 'Internal error',\n    502 : 'Bad Gateway',\n    513 : 'File upload failed'\n\
    };\n\nvar VERDICTS_DICT = {\n    '0': 'benign',\n    '1': 'malware',\n    '2':\
    \ 'grayware',\n    '4': 'phishing',\n    '-100': 'pending, the sample exists,\
    \ but there is currently no verdict',\n    '-101': 'error',\n    '-102': 'unknown,\
    \ cannot find sample record in the database',\n    '-103': 'invalid hash value'\n\
    };\n\nvar VERDICTS_TO_DBOTSCORE = {\n    '0': 1,\n    '1': 3,\n    '2': 2,\n \
    \   '4': 3,\n    '-100': 0,\n    '-101': 0,\n    '-102': 0,\n    '-103': 0\n};\n\
    \n//GLOBALS//\nvar URL = params.server.replace(/[\\/]+$/, '');\nvar DEFAULT_HEADERS\
    \ = {'Content-Type': ['application/x-www-form-urlencoded']};\nvar TOKEN = params.token;\n\
    \nvar MD5_REGEX = /\\b[a-fA-F\\d]{32}\\b/m;\nvar SHA1_REGEX = /\\b[a-fA-F\\d]{40}\\\
    b/m;\nvar SHA256_REGEX = /\\b[a-fA-F\\d]{64}\\b/m;\n\n//HELPERS//\nfunction sendRequest(url,\
    \ body, headers) {\n    url.replace(/[\\/]+$/, '');\n    var res = http(\n   \
    \     url,\n        {\n            Method: 'POST',\n            Body: body,\n\
    \            Headers: headers\n        },\n        params.insecure,\n        params.proxy\n\
    \    );\n\n    if (res.StatusCode !== 200) {\n        if (res.StatusCode === 404)\
    \ {\n            return undefined;\n        } else if (ERROR_DICT[res.StatusCode])\
    \ {\n            throw 'Request Failed.\\nStatus code: ' + res.StatusCode + '\
    \ ' + ERROR_DICT[res.StatusCode];\n        } else {\n            throw 'Request\
    \ Failed.\\nStatus code: ' + res.StatusCode + '.\\nBody: ' + JSON.stringify(res)\
    \ + '.';\n        }\n    }\n    return res;\n}\n\n\nfunction sendMultipartRequest(url,\
    \ headers, file, body) {\n    var res = httpMultipart(\n      url,\n      file,\n\
    \      {\n        Method: 'POST',\n        Headers: headers,\n      },\n     \
    \ body,\n      params.insecure,\n      params.proxy\n    );\n\n    if (res.StatusCode\
    \ !== 200) {\n        if (ERROR_DICT[res.StatusCode]) {\n            throw 'Request\
    \ Failed.\\nStatus code: ' + res.StatusCode + ' ' + ERROR_DICT[res.StatusCode];\n\
    \        } else {\n            throw 'Request Failed.\\nStatus code: ' + res.StatusCode\
    \ + '.\\nBody: ' + JSON.stringify(res) + '.';\n        }\n    }\n    return JSON.parse(x2j(res.Body));\n\
    }\n\n\nfunction prettifyUploadBody(body) {\n    var prettyUploadBody = {\n   \
    \     'MD5': body.md5,\n        'SHA256': body.sha256,\n        'Status': 'Pending'\n\
    \    };\n    if (body.filetype) {\n        prettyUploadBody.FileType = body.filetype;\n\
    \    }\n    if (body.size) {\n        prettyUploadBody.Size = body.size;\n   \
    \ }\n    if (body.url) {\n        prettyUploadBody.URL = body.url;\n    }\n  \
    \  return prettyUploadBody;\n}\n\n\nfunction prettifyVerdict(verdictData) {\n\
    \    var prettyVerdict = {};\n    if (verdictData.md5) {\n        prettyVerdict.MD5\
    \ = verdictData.md5;\n    }\n    if (verdictData.sha256) {\n        prettyVerdict.SHA256\
    \ = verdictData.sha256;\n    }\n    prettyVerdict.Verdict = Number(verdictData.verdict);\n\
    \    prettyVerdict.VerdictDescription = VERDICTS_DICT[verdictData.verdict];\n\n\
    \    return prettyVerdict;\n}\n\n\nfunction createDBotScoreFromVerdict(prettyVerdict)\
    \ {\n    if (!prettyVerdict.SHA256 && !prettyVerdict.MD5) {\n        throw 'Hash\
    \ is missing in WildFire verdict.';\n    }\n    if (VERDICTS_TO_DBOTSCORE[prettyVerdict.Verdict]\
    \ === undefined) {\n        throw 'This hash verdict is not mapped to a DBotScore.\
    \ Contact Demisto support for more information.';\n    }\n    var DbotScore =\
    \ {\n        'Indicator': prettyVerdict.SHA256? prettyVerdict.SHA256 : prettyVerdict.MD5,\n\
    \        'Type': 'hash',\n        'Vendor': 'WildFire',\n        'Score': VERDICTS_TO_DBOTSCORE[prettyVerdict.Verdict]\n\
    \    };\n    return DbotScore;\n}\n\n\nfunction prettifyVerdicts(verdictsData)\
    \ {\n    var prettyVerdictsArr = [];\n    for (var i = 0; i < verdictsData.length;\
    \ i++) {\n        var prettyVerdict = {};\n        if (verdictsData[i].md5) {\n\
    \            prettyVerdict.MD5 = verdictsData[i].md5;\n        }\n        if (verdictsData[i].sha256)\
    \ {\n            prettyVerdict.SHA256 = verdictsData[i].sha256;\n        }\n \
    \       prettyVerdict.Verdict = Number(verdictsData[i].verdict);\n        prettyVerdict.VerdictDescription\
    \ = VERDICTS_DICT[verdictsData[i].verdict];\n\n        prettyVerdictsArr.push(prettyVerdict);\n\
    \    }\n    return prettyVerdictsArr;\n}\n\n\nfunction createDBotScoreFromVerdicts(prettyVerdicts)\
    \ {\n    var DbotScoreArr = [];\n    for (var i = 0; i < prettyVerdicts.length;\
    \ i++) {\n        if (!prettyVerdicts[i].SHA256 && !prettyVerdicts[i].MD5) {\n\
    \            throw 'Hash is missing in WildFire verdict.';\n        }\n      \
    \  if (VERDICTS_TO_DBOTSCORE[prettyVerdicts[i].Verdict] === undefined) {\n   \
    \         throw 'This hash verdict is not mapped to a DBotScore. Contact Demisto\
    \ support for more information.';\n        }\n        var DbotScore = {\n    \
    \        'Indicator': prettyVerdicts[i].SHA256? prettyVerdicts[i].SHA256 : prettyVerdicts[i].MD5,\n\
    \            'Type': 'hash',\n            'Vendor': 'WildFire',\n            'Score':\
    \ VERDICTS_TO_DBOTSCORE[prettyVerdicts[i].Verdict]\n        };\n    DbotScoreArr.push(DbotScore);\n\
    \    }\n    return DbotScoreArr;\n}\n\n\nfunction createUploadEntry(body, title,\
    \ result) {\n    var md = tableToMarkdown(title, body);\n    return {\n      \
    \  Type: entryTypes.note,\n        Contents: result,\n        ContentsFormat:\
    \ formats.json,\n        HumanReadable: md,\n        ReadableContentsFormat: formats.markdown,\n\
    \        EntryContext: {\n            \"WildFire.Report(val.SHA256 === obj.SHA256\
    \ || val.MD5 === obj.MD5)\": prettifyUploadBody(body)\n        }\n    };\n}\n\n\
    \nfunction createEntry(body, title, result, verbose, report, ec) {\n    var md\
    \ = tableToMarkdown(title, body, Object.keys(body));\n    if (verbose) {\n   \
    \     for (var i = 0; i < report.length; i++) {\n            md += tableToMarkdown('Report\
    \ ' + i, report[i], Object.keys(report[i]));\n        }\n    }\n    return {\n\
    \        Type: entryTypes.note,\n        Contents: result,\n        ContentsFormat:\
    \ formats.json,\n        HumanReadable: md,\n        ReadableContentsFormat: formats.markdown,\n\
    \        EntryContext: ec\n    };\n}\n\n\nfunction hashArgsHandler(sha256, md5)\
    \ {\n    // sha256, md5 arguments are used in wildfire-report, wildfire-verdict\
    \ commands\n    var inputs = sha256? argToList(sha256) : argToList(md5);\n   \
    \ for (i = 0; i < inputs.length; i++) {\n        if (SHA256_REGEX.test(inputs[i])\
    \ || MD5_REGEX.test(inputs[i])) {\n            continue;\n        } else {\n \
    \           throw 'Invalid hash. Only SHA256 and MD5 are supported.';\n      \
    \  }\n    }\n    return inputs;\n}\n\nfunction fileArgsHandler(file, sha256, md5)\
    \ {\n    var inputs;\n    // file/md5/sha256 are used in file command\n    if\
    \ ((file && !md5 && !sha256) || (!file && md5 && !sha256) || (!file && md5 &&\
    \ !sha256)) {\n        if (file) {\n            inputs = argToList(file);\n  \
    \      } else if (md5) {\n            inputs = argToList(md5);\n        } else\
    \ {\n            inputs = argToList(sha256);\n        }\n        for (i = 0; i\
    \ < inputs.length; i++) {\n            if (SHA1_REGEX.test(inputs[i])) { // validate\
    \ hash is not sha1\n                inputs[i] = 'SHA1';\n            }\n     \
    \       else if (SHA256_REGEX.test(inputs[i]) || MD5_REGEX.test(inputs[i])) {\n\
    \                continue;\n            } else {\n                throw 'Invalid\
    \ hash. Only SHA256 and MD5 are supported.';\n            }\n        }\n    }\
    \ else {\n        throw 'Specify exactly 1 of the following arguments: file, sha256,\
    \ md5';\n    }\n\n    return inputs;\n}\n\n\n//COMMANDS//\nfunction uploadFile(upload)\
    \ {\n    uri = URL + URL_DICT.upload;\n    var body = {\n        'apikey': TOKEN,\n\
    \        'file' : upload\n    };\n    var result = sendMultipartRequest(uri, DEFAULT_HEADERS,\
    \ upload, body);\n    var uploadData = dq(result, 'wildfire.upload-file-info');\n\
    \    var returnObj = {\n        res: result,\n        data: uploadData\n    };\n\
    \    return returnObj;\n}\n\n\nfunction getVerdicts(EntryID) {\n    uri = URL\
    \ + URL_DICT.verdicts;\n    var body = {'apikey': TOKEN};\n    var result = sendMultipartRequest(uri,\
    \ DEFAULT_HEADERS, EntryID, body);\n\n    var verdictsData = dq(result, 'wildfire.get-verdict-info');\n\
    \n    var prettyVerdicts = prettifyVerdicts(verdictsData);\n    var md = tableToMarkdown('WildFire\
    \ Verdicts', prettyVerdicts);\n\n    var dbotScore = createDBotScoreFromVerdicts(prettyVerdicts);\n\
    \    var ec = {\n        \"WildFire.Verdicts(val.SHA256 === obj.SHA256 || val.MD5\
    \ === obj.MD5)\": prettyVerdicts,\n        \"DBotScore(val.Indicator === obj.Indicator)\"\
    : dbotScore\n    };\n\n    return {\n        Type: entryTypes.note,\n        Contents:\
    \ result,\n        ContentsFormat: formats.json,\n        HumanReadable: md,\n\
    \        ReadableContentsFormat: formats.markdown,\n        EntryContext: ec\n\
    \    };\n}\n\n\nfunction getVerdict(hash) {\n    var uri = URL + URL_DICT.verdict;\n\
    \n    var body = 'apikey='+TOKEN+'&hash='+hash;\n    var result = sendRequest(uri,\
    \ body, DEFAULT_HEADERS);\n    var jres = JSON.parse(x2j(result.Body));\n\n  \
    \  var verdictData = dq(jres, 'wildfire.get-verdict-info');\n\n    var prettyVerdict\
    \ = prettifyVerdict(verdictData);\n    var md = tableToMarkdown('WildFire Verdict',\
    \ prettyVerdict);\n\n    var dbotScore = createDBotScoreFromVerdict(prettyVerdict);\n\
    \    var ec = {\n        \"WildFire.Verdicts(val.SHA256 === obj.SHA256 || val.MD5\
    \ === obj.MD5)\": prettyVerdict,\n        \"DBotScore(val.Indicator === obj.Indicator)\"\
    : dbotScore\n    };\n\n    return {\n        Type: entryTypes.note,\n        Contents:\
    \ jres,\n        ContentsFormat: formats.json,\n        HumanReadable: md,\n \
    \       ReadableContentsFormat: formats.markdown,\n        EntryContext: ec\n\
    \    };\n}\n\n\nfunction uploadFileRemote(upload) {\n    var uri = URL + URL_DICT.remoteFile;\n\
    \n    var body = {\n        apikey: TOKEN,\n        url: upload\n    };\n    var\
    \ result = sendMultipartRequest(uri, DEFAULT_HEADERS, '', body);\n\n    var uploadData\
    \ = dq(result, 'wildfire.upload-file-info');\n\n    var returnObj = {\n      \
    \  res: result,\n        data: uploadData\n    };\n    return returnObj;\n}\n\n\
    \nfunction uploadUrl(upload) {\n   var uri = URL + URL_DICT.uploadUrl;\n\n   \
    \ var body = {\n        apikey: TOKEN,\n        link: upload\n    };\n    var\
    \ result = sendMultipartRequest(uri, DEFAULT_HEADERS, '', body);\n\n    var uploadData\
    \ = dq(result, 'wildfire.submit-link-info');\n\n    var returnObj = {\n      \
    \  res: result,\n        data: uploadData\n    };\n    return returnObj;\n}\n\n\
    \nfunction getSample(hash) {\n\n    var sampleUrl = URL + URL_DICT.getSample;\n\
    \n    var body = 'apikey='+TOKEN+'&hash='+hash;\n    var result = sendRequest(sampleUrl,\
    \ body, DEFAULT_HEADERS);\n\n    if (!result) {\n        return 'Sample was not\
    \ found. Grayware and benign samples are available for 14 days. For more information,\
    \ contact your WildFire representative.';\n    } else {\n        var fileName;\n\
    \        if (result.Headers['Content-Disposition']) {\n            var str = String(result.Headers['Content-Disposition']);\n\
    \            var n = str.lastIndexOf('filename=');\n            fileName = str.substring(n\
    \ + 9);\n        } else {\n            fileName = 'file_' + hash;\n        }\n\
    \n        var createdFileID = saveFile(result.Bytes);\n        return {\n    \
    \        Type: 3,\n            FileID: createdFileID,\n            File: fileName,\n\
    \            Contents: fileName\n        };\n    }\n}\n\n\n\nfunction getReport(hash)\
    \ {\n    var reportUrl = URL + URL_DICT.report;\n\n    var bodyXML = 'apikey='+TOKEN+'&format=xml&hash='+hash;\n\
    \    var resXML = sendRequest(reportUrl, bodyXML, DEFAULT_HEADERS);\n\n    if(!resXML){\n\
    \      return {error: 'Report not found'};\n    }\n    var resXMLBody = resXML.Body;\n\
    \    if(!resXMLBody){\n      return {error: 'No results yet'};\n    }\n\n    var\
    \ result = JSON.parse(x2j(resXMLBody));\n    var report =  dq(result, 'wildfire.task_info.report');\n\
    \    var file_info = dq(result, 'wildfire.file_info');\n    if (!report || !file_info)\
    \ {\n        return {error: 'No results yet'};\n    }\n\n    var returnObj = {\n\
    \        hash: hash,\n        result: result,\n        report: report,\n     \
    \   info: file_info\n    };\n    return returnObj;\n}\n\n\nfunction createReport(reportResponse,\
    \ format, verbose) {\n    var reportUrl = URL + URL_DICT.report;\n    var result\
    \ = reportResponse.result;\n    var report = reportResponse.report;\n    var file_info\
    \ = reportResponse.info;\n    var hash = reportResponse.hash;\n\n    udp_ip =\
    \ [];\n    udp_port = [];\n    tcp_ip = [];\n    tcp_port = [];\n    dns_query\
    \ = [];\n    dns_response = [];\n    evidence_md5 = [];\n    evidence_text = [];\n\
    \n    for (var i = 0; i < report.length; i++) {\n        if ('network' in report[i])\
    \ {\n            if (report[i].network) {\n                if ('UDP' in report[i].network)\
    \ {\n                    if ('-ip' in report[i].network.UDP) {\n             \
    \           udp_ip.push(report[i].network.UDP['-ip']);\n                    }\n\
    \                    if ('-port' in report[i].network.UDP) {\n               \
    \         udp_port.push(report[i].network.UDP['-port']);\n                   \
    \ }\n                }\n                if ('TCP' in report[i].network) {\n  \
    \                  if ('-ip' in report[i].network.TCP) {\n                   \
    \     tcp_ip.push(report[i].network.TCP['-ip']);\n                    }\n    \
    \                if ('-port' in report[i].network.TCP) {\n                   \
    \     tcp_port.push(report[i].network.TCP['-port']);\n                    }\n\
    \                }\n                if ('dns' in report[i].network) {\n      \
    \              for (var j = 0; j < report[i].network.dns.length; j++) {\n    \
    \                    if ('-query' in report[i].network.dns[j]) {\n           \
    \                 dns_query.push(report[i].network.dns[j]['-query']);\n      \
    \                  }\n                        if ('-response' in report[i].network.dns[j])\
    \ {\n                            dns_response.push(report[i].network.dns[j]['-response']);\n\
    \                        }\n                    }\n                }\n       \
    \     }\n        }\n        if ('evidence' in report[i]) {\n            if ('file'\
    \ in report[i].evidence) {\n                if (typeof report[i].evidence.file\
    \ == 'object' && 'entry' in report[i].evidence.file) {\n                    if\
    \ ('-md5' in report[i].evidence.file.entry) {\n                        evidence_md5.push(report[i].evidence.file.entry['-md5']);\n\
    \                    }\n                    if (typeof report[i].evidence.file\
    \ == 'object' && '-text' in report[i].evidence.file.entry) {\n               \
    \         evidence_text.push(report[i].evidence.file.entry['-text']);\n      \
    \              }\n                }\n            }\n        }\n    }\n\n    var\
    \ context = {\n        DBotScore: {Indicator: hash, Type: 'hash', Vendor: 'WildFire',\
    \ Score: 0 }\n    };\n\n    var outputs = {\n        'Status': 'Success',\n  \
    \      'SHA256': reportResponse.info.sha256,\n    };\n\n    if (udp_ip.length\
    \ || udp_port.length || tcp_ip.length || tcp_port.length || dns_query || dns_response)\
    \ {\n\n        outputs.Network = {};\n\n        if (udp_ip.length || udp_port.length)\
    \ {\n            outputs.Network.UDP = {};\n            if (udp_ip.length) {\n\
    \                outputs.Network.UDP.IP = udp_ip;\n            }\n           \
    \ if (udp_port.length) {\n                outputs.Network.UDP.Port = udp_port;\n\
    \            }\n        }\n        if (tcp_ip.length || tcp_port.length) {\n \
    \           outputs.Network.TCP = {};\n            if (tcp_ip.length) {\n    \
    \            outputs.Network.TCP.IP = tcp_ip;\n            }\n            if (tcp_port.length)\
    \ {\n                outputs.Network.TCP.Port = tcp_port;\n            }\n   \
    \     }\n        if (dns_query.length || dns_response.length) {\n            outputs.Network.DNS\
    \ = {};\n            if (dns_query.length) {\n                outputs.Network.DNS.Query\
    \ = dns_query;\n            }\n            if (dns_response.length) {\n      \
    \          outputs.Network.DNS.Response = dns_response;\n            }\n     \
    \   }\n    }\n\n    if (evidence_md5.length || evidence_text.length) {\n     \
    \   outputs.Evidence = {};\n        if (evidence_md5.length) {\n            outputs.Evidence.md5\
    \ = evidence_md5;\n        }\n        if (evidence_text.length) {\n          \
    \  outputs.Evidence.Text = evidence_text;\n        }\n    }\n\n    context[\"\
    WildFire.Report(val.SHA256 === obj.SHA256)\"] = outputs;\n\n    if (file_info)\
    \ {\n        if (file_info.malware === 'yes') {\n            context.DBotScore.Score\
    \ = 3;\n            addMalicious(context, outputPaths.file, {\n              \
    \  Type : file_info.filetype,\n                MD5 : file_info.md5,\n        \
    \        SHA1 : file_info.sha1,\n                SHA256 : file_info.sha256,\n\
    \                Size : file_info.size,\n                Name : file_info.filename,\n\
    \                Malicious: {Vendor: 'WildFire'}\n            });\n        } else\
    \ {\n            context.DBotScore.Score = 1;\n        }\n    }\n    if(format\
    \ === 'pdf'){\n        var bodyPDF = 'apikey=' + TOKEN + '&format=pdf&hash=' +\
    \ hash;\n        var resPDF = sendRequest(reportUrl, bodyPDF, DEFAULT_HEADERS).Bytes;\n\
    \        var currentTime = new Date();\n        var fileName = command + '_at_'\
    \ + currentTime.getTime();\n        return {\n            Type: 9,\n         \
    \   FileID: saveFile(resPDF),\n            File: fileName,\n            Contents:\
    \ fileName,\n            EntryContext: context\n        };\n    }\n    else{\n\
    \        return createEntry(file_info, 'WildFire Report', result, verbose, report,\
    \ context);\n    }\n}\n\n\nfunction doReports(inputs) {\n    var entries = [];\n\
    \    for (i=0; i < inputs.length; i++) {\n        if (inputs[i] == 'SHA1') {\n\
    \            entries.push({\n                Type: 11, // warning type\n     \
    \           Contents: 'WildFire file hash reputation supports only MD5, SHA256\
    \ hashes',\n                ContentsFormat: formats.markdown\n            });\n\
    \        } else {\n            var reportResponse = getReport(inputs[i]);\n  \
    \          if (reportResponse.error) {\n                return reportResponse.error;\n\
    \            }\n            entries.push(createReport(reportResponse, args.format,\
    \ args.verbose));\n        }\n    }\n    return entries;\n}\n\n\nfunction detonate(type,\
    \ upload, format, delay, timeout, verbose) {\n    var uploadData;\n    if (type\
    \ === 'file') {\n        uploadData = uploadFile(upload).data;\n    } else { //type\
    \ is remote file\n        uploadData = uploadFileRemote(upload).data;\n    }\n\
    \    var sha = uploadData.sha256;\n    delayTime = parseInt(delay);\n    timeOut\
    \ = parseInt(timeout);\n    var waitTime = delayTime;\n    wait(delayTime);\n\n\
    \    while (waitTime<timeOut) {\n        var reportResponse = getReport(undefined,\
    \ sha);\n        if (reportResponse.result) {\n            return createReport(reportResponse,\
    \ format, verbose);\n        } else {\n            waitTime = waitTime + delayTime;\n\
    \            wait(delayTime);\n        }\n    }\n    throw ('Timeout due to no\
    \ answer after ' + timeOut + ' seconds.');\n}\n\ntry {\n    switch (command) {\n\
    \        case 'test-module': // This is the call made when pressing the integration\
    \ test button.\n            testUrl = URL + URL_DICT.report;\n            var\
    \ res = http(\n                testUrl,\n                {\n                 \
    \   Method: 'POST',\n                    Body: 'apikey=' + TOKEN + '&format=xml&hash=7f638f13d0797ef9b1a393808dc93b94',\n\
    \                    Headers: DEFAULT_HEADERS\n                },\n          \
    \      params.insecure,\n                params.proxy\n                );\n  \
    \          if (res.StatusCode === 200) {\n                return 'ok';\n     \
    \       }\n            else {\n                return 'Something went wrong.\\\
    n Status code: ' + res.StatusCode + '\\nBody: '+ JSON.stringify(res) + '.';\n\
    \            }\n            break;\n\n        case 'file':\n            var inputs\
    \ = fileArgsHandler(args.file, args.md5, sha256);\n            return doReports(inputs);\n\
    \n        case 'wildfire-upload':\n            inputs = argToList(args.upload);\n\
    \            entries = [];\n            for (i=0; i < inputs.length; i++) {\n\
    \                var response = uploadFile(inputs[i]);\n                var uploadData\
    \ = response.data;\n                var result = response.res;\n             \
    \   entries.push(createUploadEntry(uploadData, 'WildFire Upload File', result));\n\
    \            }\n            return entries;\n\n        case 'wildfire-upload-file-remote':\
    \ //deprecated\n        case 'wildfire-upload-file-url':\n            var response\
    \ = uploadFileRemote(args.upload);\n            var uploadData = response.data;\n\
    \            var result = response.res;\n            return createUploadEntry(uploadData,\
    \ 'WildFire Upload File URL', result);\n\n        // case 'wildfire-upload-url':\n\
    \        //     inputs = argToList(args.upload);\n        //     entries = [];\n\
    \        //     for (i=0; i < inputs.length; i++) {\n        //         var response\
    \ = uploadUrl(inputs[i]);\n        //         var uploadData = response.data;\n\
    \        //         var result = response.res;\n        //         entries.push(createUploadEntry(uploadData,\
    \ 'WildFire Upload URL', result));\n        //     }\n        //     return entries;\n\
    \n        case 'wildfire-report':\n            var sha256 = args.sha256? args.sha256\
    \ : args.hash;\n            var inputs = hashArgsHandler(sha256, args.md5);\n\
    \            return doReports(inputs);\n\n        case 'wildfire-get-verdict':\n\
    \            var inputs = hashArgsHandler(args.hash, undefined);\n           \
    \ var entries = [];\n            for (i=0; i < inputs.length; i++) {\n       \
    \         var entry = getVerdict(inputs[i]);\n                entries.push(entry);\n\
    \            }\n            return entries;\n\n        case 'wildfire-get-verdicts':\n\
    \            var inputs = argToList(args.EntryID);\n            var entries =\
    \ [];\n            for (i=0; i < inputs.length; i++) {\n                var entry\
    \ = getVerdicts(inputs[i]);\n                entries.push(entry);\n          \
    \  }\n            return entries;\n\n        case 'wildfire-get-sample':\n   \
    \         var inputs = hashArgsHandler(args.sha256, args.md5);\n            var\
    \ entries = [];\n            for (i=0; i < inputs.length; i++) {\n           \
    \     var entry = getSample(inputs[i]);\n                entries.push(entry);\n\
    \            }\n            return entries;\n\n        case 'detonate-file': //deprecated,\
    \ please use WildFire Detonate playbook\n            return detonate('file', args.upload,\
    \ args.format, args.delay, args.timeout, args.verbose);\n\n        case 'detonate-file-remote':\
    \ //deprecated, please use WildFire Detonate playbook\n            return detonate('remoteFile',\
    \ args.upload, args.format, args.delay, args.timeout);\n    }\n} catch (err) {\n\
    \    return {\n        Type: entryTypes.error,\n        Contents: err,\n     \
    \   HumanReadable: err,\n        ReadableContentsFormat: formats.text,\n    };\n\
    }"
  type: javascript
tests:
- No test
toversion: 4.1.9
