category: Endpoint
commonfields:
  id: Cylance Protect
  version: -1
configuration:
- defaultvalue: ''
  display: Server URL (e.g. https://192.168.0.1)
  name: server
  required: true
  type: 0
- defaultvalue: v1
  display: API version
  name: version
  required: true
  type: 0
- defaultvalue: ''
  display: Credentials
  name: credentials
  required: true
  type: 9
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- defaultvalue: first_found
  display: Time Field
  name: timeField
  required: false
  type: 0
- defaultvalue: ''
  display: Extended Filter
  name: extendedFilter
  required: false
  type: 0
- display: Incident type
  name: incidentType
  required: false
  type: 13
deprecated: true
description: Manage Endpoints using Cylance protect
detaileddescription: 'For more information regarding the integration''s specific fields
  and filters, please see Cylance API Guide for version 1.7.

  Extended Filter example: {"Field":"last_found","Operator":"IsGreaterThan","Value":"2000-01-01T00:00:00Z"}.'
display: Cylance Protect (Deprecated)
fromversion: 2.0.1
hidden: false
image: data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAiCAYAAACUcR1DAAADTUlEQVR4Ae3ZA+xcSxTH8fe3nm3bthU826ht27Zt/q3atqPGtW1Pv0kmyWRyseqmtzlJPovZc2dmz2+91ymlxDXMuCIkYCEBCwlYSMBCAhYSsJCAJeAqG95Pw614HEMwHz3xNB5GgjQygAHrAAdjMwbhJyhDWxzEanTDvdLQYAVcAqWNwzdQ2hm0gDJ0l4YGK+BFUNpol4DPQWljQlnwwQcfTEa6ixSzNsT5MoPYePadgXQtTUvREhzqUyLpm1fA86G0UfjWJ+CRIdypP1CIHAf56GjVf4kuSHCZrx76W2P18XwUjX8T2RiK2z3qbsEwFOEpl5pn0NgaexyTkYsc5KIA+cjGRDxqHVPBo28FaBZtwBPwJZR2Hs1x3g7YpyFL8AYewEMO7raOuQ3jkI8bjfFE9MV03G8dMw4fRhhuFhbhSzTDUI/a6hiAX7EC9zvUvINsa6wfmls9eEx7HI8h1ai/D0vxvEvfHsad0Qa8DU9hLRRWowdUGAE/jPwIG98ei/EwkpGPUUh1qB2O9yJcpwF66ctJmIO3XWrbopy+XAbzcbNV8xbGWmMj8VEYe3oGOf61EQZsmIgXsRU9sCvMgB/UwSRH2PxyWIlP8YdzXeQBc8xdWIR7jLGvke9S3wqVjeuNUIwUn4CH44sw9vUUJuE21ERdrQZujV3AQCt8gWNQcQzYbGpvfT3WAXdDfYfxbHzjF7Ae64FRcQz4llgGfB6r8APqQ8XpJdqcoyJ6+dSMxOthzvs0ZiPL4bbXMB2pfgHr8bHooi+/hPFX60v0YijDUJTiBF7GaCjD2BA+ZC32+ZB1l88cNdHfp2YI6nus8aD1MpqE0fjdY85+qGaNdUANh9o0lKIhymC0w1zN/PYX5oesOyIJuABK24T2UNpaPIN9UFrnWH9Ncjj+W1Txe0kzvn7kWHIxCQ8Z9Q9gMBI85nwEg63G/4OvXepvwkgU4BXrtscwyWN/2Q5fk8pfia9Jj2EWFEqRB2V4BWuhMB53xOGHjkh/SDClIcF6BieGMF8KEuKxv7j80KFDTkYzTMBcKMPbyEZZXS+C+nchId6EIVCGF5ER/CZIwObfhnUxF/8gMfgNkICFBCwkYCEBCwlYSMBCApaAhQQsAuMypEm2YIZjn78AAAAASUVORK5CYII=
name: Cylance Protect
script:
  commands:
  - arguments:
    - auto: PREDEFINED
      default: true
      description: The type of list the file belongs to
      name: list_type
      predefined:
      - GlobalQuarantine
      - SafeList
      required: true
    - description: The page size
      name: page_size
    - description: The page number
      name: page_number
    - description: Array of the sore object (includes field name in Field, and Direction
        - either Ascending or Descending)
      name: sorts
    - description: Array of filters - either simple or composite (more information
        on filter usage can be found in Cylance API documentation)
      name: filters
    - description: The headers columns to show by order
      name: headers
    deprecated: true
    description: 'Gets one of two Global Lists: Safe List and Global Quarantine List'
    name: cylance-protect-get-list
    outputs:
    - contextPath: Cylance.List.Name
      description: Name of list
    - contextPath: Cylance.List.Type
      description: Type of list
    - contextPath: Cylance.List.SHA256
      description: List SHA256
    - contextPath: Cylance.List.MD5
      description: List MD5
    - contextPath: Cylance.List.RawScore
      description: List raw score
    - contextPath: Cylance.List.CylanceScore
      description: List Cylance score
    - contextPath: Cylance.List.VirusTotalThreat
      description: List VirusTotal threat
    - contextPath: Cylance.List.Reason
      description: List iteam readon
    - contextPath: Cylance.List.Classification
      description: classification
  - arguments:
    - description: The page size
      name: page_size
    - description: The page number
      name: page_number
    - description: Array of the sore object (includes field name in Field, and Direction
        - either Ascending or Descending)
      name: sorts
    - description: Array of filters - either simple or composite (more information
        on filter usage can be found in Cylance API documentation)
      name: filters
    - description: The headers columns to show by order
      name: headers
    deprecated: true
    description: Gets information about all the devices with CylancePROTECT Agent
      installed
    name: cylance-protect-get-devices
    outputs:
    - contextPath: Endpoint.OS
      description: Endpoint OS
    - contextPath: Endpoint.Hostname
      description: Endpoint Hostname
    - contextPath: Endpoint.SerialNumber
      description: Endpoint serial number
    - contextPath: Endpoint.IP
      description: List of endpoint IP addresses
    - contextPath: Endpoint.MAC
      description: List of endpoint MAC addresses
    - contextPath: Endpoint.DNSName
      description: Endpoint DNS name
  - arguments:
    - description: The page size
      name: page_size
    - description: The page number
      name: page_number
    - description: Array of the sore object (includes field name in Field, and Direction
        - either Ascending or Descending)
      name: sorts
    - description: Array of filters - either simple or composite (more information
        on filter usage can be found in Cylance API documentation)
      name: filters
    - description: The headers columns to show by order
      name: headers
    deprecated: true
    description: Gets information about Cylance protect threats
    name: cylance-protect-get-threats
  - arguments:
    - default: true
      description: The required sha256
      name: sha256
      required: true
    deprecated: true
    description: Download a file according to it's sha256
    name: cylance-protect-download-threat
    outputs:
    - contextPath: Cylance.Threat.ThreatName
      description: Threat Name
    - contextPath: Cylance.Threat.Classification
      description: Threat Classification
    - contextPath: Cylance.Threat.Subclassification
      description: Threat Subclassification
    - contextPath: Cylance.Threat.Sha256
      description: Threat Sha256
    - contextPath: Cylance.Threat.CylanceScore
      description: Threat CylanceScore
    - contextPath: Cylance.Threat.Status
      description: Threat Status
    - contextPath: Cylance.Threat.FilePaths
      description: Threat file paths
    - contextPath: Cylance.Threat.FirstFound
      description: Threat FirstFound
    - contextPath: Cylance.Threat.DetectedBy
      description: Threat Detected By
    - contextPath: Cylance.Threat.AutoRun
      description: Threat AutoRun
    - contextPath: Cylance.Threat.SerialNumber
      description: Threat SerialNumber
    - contextPath: Cylance.Threat.Running
      description: Threat Running
  - arguments:
    - default: true
      description: The required sha256
      name: sha256
      required: true
    - description: The headers columns to show by order
      name: headers
    deprecated: true
    description: Get details about a specific threat according to it's sha256
    name: cylance-protect-get-threat-details
  - arguments:
    - default: true
      description: The device serial number
      name: serial_number
      required: true
    deprecated: true
    description: Removes a device from Cylance protect
    name: cylance-protect-device-delete
  - arguments:
    - default: true
      description: The device serial number
      name: serial_number
      required: true
    - description: The page size
      name: page_size
    - description: The page number
      name: page_number
    - description: Array of the sore object (includes field name in Field, and Direction
        - either Ascending or Descending)
      name: sorts
    - description: Array of filters - either simple or composite (more information
        on filter usage can be found in Cylance API documentation)
      name: filters
    - description: The headers columns to show by order
      name: headers
    deprecated: true
    description: Gets threats for a specific device
    name: cylance-protect-get-device-threats
    outputs:
    - contextPath: Cylance.Threat.ThreatName
      description: Threat Name
    - contextPath: Cylance.Threat.Classification
      description: Threat Classification
    - contextPath: Cylance.Threat.SubClassification
      description: Threat SubClassification
    - contextPath: Cylance.Threat.Sha256
      description: Threat Sha256
    - contextPath: Cylance.Threat.Copyright
      description: Threat Copyright
    - contextPath: Cylance.Threat.CompanyName
      description: Threat Company Name
    - contextPath: Cylance.Threat.CertSubject
      description: Threat Cert Subject
    - contextPath: Cylance.Threat.SignatureStatus
      description: Threat Signature Status
    - contextPath: Cylance.Threat.Safelisted
      description: Threat Safe listed
    - contextPath: Cylance.Threat.LastFound
      description: Threat Last Found
    - contextPath: Cylance.Threat.CylanceScore
      description: Threat Cylance Score
    - contextPath: Cylance.Threat.PercentageFileStatusTenant
      description: Threat Percentage File Status Tenant
    - contextPath: Cylance.Threat.FirstFound
      description: Threat First Found
    - contextPath: Cylance.Threat.CertTimestamp
      description: Threat Cert Timestamp
    - contextPath: Cylance.Threat.GlobalQuarantined
      description: Threat Global Quarantined
    - contextPath: Cylance.Threat.PercentageFileStatusEveryone
      description: Threat Percentage File Status Everyone
    - contextPath: Cylance.Threat.CertPublisher
      description: Threat Cert Publisher
    - contextPath: Cylance.Threat.Version
      description: Threat Version
    - contextPath: Cylance.Threat.ProductName
      description: Threat Product Name
    - contextPath: Cylance.Threat.CertThumbprint
      description: Threat Cert Thumbprint
    - contextPath: Cylance.Threat.Signed
      description: Threat Signed
    - contextPath: Cylance.Threat.Description
      description: Threat Description
    - contextPath: Cylance.Threat.CertIssuer
      description: Threat Cert Issuer
    - contextPath: Cylance.Threat.FileSize
      description: Threat File Size
    - contextPath: Cylance.Threat.Md5
      description: Threat Md5
  - arguments:
    - default: true
      description: The device serial number
      name: serial_number
      required: true
    - auto: PREDEFINED
      description: The quarantine status
      name: quarantine_status
      predefined:
      - Quarantined
      - Waived
      required: true
    - description: The threat sha256
      name: sha256
      required: true
    - description: The headers columns to show by order
      name: headers
    deprecated: true
    description: Updates threats of a device
    name: cylance-protect-update-device-threats
  - arguments:
    - description: A list or single value of hash/es
      name: sha256
      required: true
    deprecated: true
    description: Delete hashes from lists
    name: cylance-protect-delete-hash-from-lists
  - arguments:
    - auto: PREDEFINED
      default: true
      description: The type of list the file belongs to
      name: list_type
      predefined:
      - GlobalQuarantine
      - SafeList
      required: true
    - description: A list or single value of hash/es
      name: sha256
      required: true
    - auto: PREDEFINED
      description: Category
      name: category
      predefined:
      - Admin Tool
      - Internal Application
      - Commercial Software
      - Operating System
      - Drivers
      - Security Software
      - None
      required: true
    - description: The reason why the file is in the list (65 chars limited)
      name: reason
      required: true
    deprecated: true
    description: Update hash in the lists
    name: cylance-protect-update-hash-at-lists
  - arguments:
    - default: true
      description: A list or single value of hash/es
      name: sha256
      required: true
    deprecated: true
    description: Allows to create an Upload request for a set of hashes that will
      be executed by endpoints eventually (not synced)
    name: cylance-protect-upload-threat
  - arguments:
    - default: true
      description: The sha256 value of the threat or file being queried
      name: sha256
      required: true
    - description: The page size
      name: page_size
    - description: The page number
      name: page_number
    - description: Array of the sore object (includes field name in Field, and Direction
        - either Ascending or Descending)
      name: sorts
    - description: Array of filters - either simple or composite (more information
        on filter usage can be found in Cylance API documentation)
      name: filters
    - description: The headers columns to show by order
      name: headers
    deprecated: true
    description: Given a threat, retrieve a list of all devices on which the threat
      was found
    name: cylance-protect-get-threated-devices
    outputs:
    - contextPath: Endpoint.OS
      description: Endpoint OS
    - contextPath: Endpoint.Hostname
      description: Endpoint Hostname
    - contextPath: Endpoint.SerialNumber
      description: Endpoint serial number
    - contextPath: Endpoint.IP
      description: List of endpoint IP addresses
    - contextPath: Endpoint.MAC
      description: List of endpoint MAC addresses
    - contextPath: Endpoint.DNSName
      description: Endpoint DNS name
    - contextPath: Endpoint.CylanceThreat.Abnormal
      description: Endpoint CylanceThreat Abnormal
    - contextPath: Endpoint.CylanceThreat.Added
      description: Endpoint CylanceThreat Added
    - contextPath: Endpoint.CylanceThreat.AgentVersion
      description: Endpoint CylanceThreat Agent Version
    - contextPath: Endpoint.CylanceThreat.AutoRun
      description: Endpoint CylanceThreat Auto Run
    - contextPath: Endpoint.CylanceThreat.BackgroundDetection
      description: Endpoint CylanceThreat Background Detection
    - contextPath: Endpoint.CylanceThreat.Detected By
      description: Endpoint CylanceThreat Detected By
    - contextPath: Endpoint.CylanceThreat.ExploitAttempts
      description: Endpoint CylanceThreat Exploit Attempts
    - contextPath: Endpoint.CylanceThreat.FilePaths
      description: Endpoint CylanceThreat File Paths
    - contextPath: Endpoint.CylanceThreat.FileQuarantineStatus
      description: Endpoint CylanceThreat File QuarantineStatus
    - contextPath: Endpoint.CylanceThreat.FilesAnalyzed
      description: Endpoint CylanceThreat Files Analyzed
    - contextPath: Endpoint.CylanceThreat.FirstFound
      description: Endpoint CylanceThreat First Found
    - contextPath: Endpoint.CylanceThreat.IsOffline
      description: Endpoint CylanceThreat Is Offline
    - contextPath: Endpoint.CylanceThreat.LastReportedUsers
      description: Endpoint CylanceThreat Last Reported Users
    - contextPath: Endpoint.CylanceThreat.OfflineDate
      description: Endpoint CylanceThreat Offline Date
    - contextPath: Endpoint.CylanceThreat.Policy
      description: Endpoint CylanceThreat Policy
    - contextPath: Endpoint.CylanceThreat.Quarantined
      description: Endpoint CylanceThreat Quarantined
    - contextPath: Endpoint.CylanceThreat.Running
      description: Endpoint CylanceThreat Running
    - contextPath: Endpoint.CylanceThreat.Unsafe
      description: Endpoint CylanceThreat Unsafe
    - contextPath: Endpoint.CylanceThreat.Waived
      description: Endpoint CylanceThreat Waived
    - contextPath: Endpoint.CylanceThreat.Zones
      description: Endpoint CylanceThreat Zones
  - arguments:
    - description: The headers columns to show by order
      name: headers
    deprecated: true
    description: Retrieves all zones
    name: cylance-protect-get-zones
    outputs:
    - contextPath: Cylance.Zone.ID
      description: Zone ID
    - contextPath: Cylance.Zone.Name
      description: Zone Name
  - arguments:
    - default: true
      description: "\uFFFC Name of the Zone. Cannot be Unzoned or the name of an existing\
        \ Zone. The maximum number of characters for a Zone Name is 32"
      name: zone_name
      required: true
    - description: The Policy ID associated with this Zone. If omitted, it will default
        to the Default Policy
      name: policy_id
    - description: "\uFFFC The name of the Zone Criticality, which can be Low, Normal\
        \ or Field Name \uFFFC\uFFFC\uFFFC Type \uFFFC\uFFFC Description \uFFFC\uFFFC\
        \ \uFFFC\uFFFC\uFFFC\uFFFC\uFFFCString, UUID \uFFFC\uFFFC\uFFFC\uFFFC\uFFFC\
        \ Field Name \uFFFC\uFFFC\uFFFC Type \uFFFC\uFFFC\uFFFC Description \uFFFC\
        \ String, UUID High. If omitted, it will default to Normal"
      name: zone_criticality
    - description: The headers columns to show by order
      name: headers
    deprecated: true
    description: Create a zone
    name: cylance-protect-create-zone
    outputs:
    - contextPath: Cylance.Zone.ID
      description: Zone ID
    - contextPath: Cylance.Zone.Name
      description: Zone Name
    - contextPath: DeviceCount
      description: Zone Device Count
    - contextPath: PolicyID
      description: Zone Policy ID
    - contextPath: PolicyName
      description: Zone Policy Name
    - contextPath: ThreatCount
      description: Zone Threat Count
  - arguments:
    - description: "\uFFFC Name of the Zone. Cannot be Unzoned or the name of an existing\
        \ Zone. The maximum number of characters for a Zone Name is 32"
      name: zone_name
      required: true
    - default: true
      description: The ID of the Zone to update
      name: zone_id
      required: true
    - description: The Policy ID associated with this Zone. If omitted, will default
        to the Default Policy
      name: policy_id
    - description: The name of the Zone Criticality, which can be Low, Normal or High.
        If omitted, it will default to Normal
      name: zone_criticality
    - description: Defaults to False. Tells whether or not to update the Zone Devices
        to use the new policy. This will only apply if this field is True
      name: apply_policy_change_to_devices
    - description: The headers columns to show by order
      name: headers
    deprecated: true
    description: Update a zone
    name: cylance-protect-update-zone
    outputs:
    - contextPath: Cylance.Zone.ID
      description: Zone ID
    - contextPath: Cylance.Zone.Name
      description: Zone Name
  - arguments: []
    deprecated: true
    description: Get all policies
    name: cylance-protect-get-policies
    outputs:
    - contextPath: Cylance.Policy.ID
      description: Policy ID
    - contextPath: Cylance.Policy.Name
      description: Policy Name
  - arguments:
    - description: The Policy ID. This information supersedes the Policy Name, if
        both are included
      name: policy_id
    - description: The Policy Name
      name: policy_name
    - description: The headers columns to show by order
      name: headers
    deprecated: true
    description: Get a specific policy details. If no args supplied, default policy
      is retrieved
    name: cylance-protect-get-policy-details
    outputs:
    - contextPath: Cylance.Policy.ID
      description: Policy ID
    - contextPath: Cylance.Policy.Name
      description: Policy Name
  - arguments:
    - auto: PREDEFINED
      default: true
      description: The type of list the file belongs to
      name: list_type
      predefined:
      - GlobalQuarantine
      - SafeList
      required: true
    - description: The page size
      name: page_size
    - description: The page number
      name: page_number
    - description: Array of the sore object (includes field name in Field, and Direction
        - either Ascending or Descending)
      name: sorts
    - description: Array of filters - either simple or composite (more information
        on filter usage can be found in Cylance API documentation)
      name: filters
    deprecated: true
    description: 'Gets one of two Global Lists: Safe List and Global Quarantine List'
    name: cp-get-list
  - arguments:
    - description: The page size
      name: page_size
    - description: The page number
      name: page_number
    - description: Array of the sore object (includes field name in Field, and Direction
        - either Ascending or Descending)
      name: sorts
    - description: Array of filters - either simple or composite (more information
        on filter usage can be found in Cylance API documentation)
      name: filters
    deprecated: true
    description: Gets information about all the devices with CylancePROTECT Agent
      installed
    name: cp-get-devices
  - arguments:
    - description: The page size
      name: page_size
    - description: The page number
      name: page_number
    - description: Array of the sore object (includes field name in Field, and Direction
        - either Ascending or Descending)
      name: sorts
    - description: Array of filters - either simple or composite (more information
        on filter usage can be found in Cylance API documentation)
      name: filters
    deprecated: true
    description: Gets information about Cylance protect threats
    name: cp-get-threats
  - arguments:
    - default: true
      description: The required sha256
      name: sha256
      required: true
    deprecated: true
    description: Download a file according to it's sha256
    name: cp-download-threat
  - arguments:
    - default: true
      description: The required sha256
      name: sha256
      required: true
    deprecated: true
    description: Get details about a specific threat according to it's sha256
    name: cp-get-threat-details
  - arguments:
    - default: true
      description: The device serial number
      name: serial_number
      required: true
    deprecated: true
    description: Removes a device from Cylance protect
    name: cp-device-delete
  - arguments:
    - default: true
      description: The device serial number
      name: serial_number
      required: true
    - description: The page size
      name: page_size
    - description: The page number
      name: page_number
    - description: Array of the sore object (includes field name in Field, and Direction
        - either Ascending or Descending)
      name: sorts
    - description: Array of filters - either simple or composite (more information
        on filter usage can be found in Cylance API documentation)
      name: filters
    deprecated: true
    description: Gets threats for a specific device
    name: cp-get-device-threats
  - arguments:
    - default: true
      description: The device serial number
      name: serial_number
      required: true
    - auto: PREDEFINED
      description: The quarantine status
      name: quarantine_status
      predefined:
      - Quarantined
      - Waived
      required: true
    - description: The threat sha256
      name: sha256
      required: true
    deprecated: true
    description: Updates threats of a device
    name: cp-update-device-threats
  - arguments:
    - description: A list or single value of hash/es
      name: sha256
    deprecated: true
    description: Delete hashes from lists
    name: cp-delete-hash-from-lists
  - arguments:
    - auto: PREDEFINED
      default: true
      description: The type of list the file belongs to
      name: list_type
      predefined:
      - GlobalQuarantine
      - SafeList
      required: true
    - description: A list or single value of hash/es
      name: sha256
      required: true
    - auto: PREDEFINED
      description: Category
      name: category
      predefined:
      - Admin Tool
      - Internal Application
      - Commercial Software
      - Operating System
      - Drivers
      - Security Software
      - None
      required: true
    - description: The reason why the file is in the list (65 chars limited)
      name: reason
      required: true
    deprecated: true
    description: Update hash in the lists
    name: cp-update-hash-at-lists
  - arguments:
    - default: true
      description: A list or single value of hash/es
      name: sha256
      required: true
    deprecated: true
    description: Allows to create an Upload request for a set of hashes that will
      be executed by endpoints eventually (not synced)
    name: cp-upload-threat
  - arguments:
    - default: true
      description: The sha256 value of the threat or file being queried
      name: sha256
      required: true
    - description: The page size
      name: page_size
    - description: The page number
      name: page_number
    - description: Array of the sore object (includes field name in Field, and Direction
        - either Ascending or Descending)
      name: sorts
    - description: Array of filters - either simple or composite (more information
        on filter usage can be found in Cylance API documentation)
      name: filters
    deprecated: true
    description: Given a threat, retrieve a list of all devices on which the threat
      was found
    name: cp-get-threated-devices
  - arguments: []
    deprecated: true
    description: Retrieves all zones
    name: cp-get-zones
  - arguments:
    - default: true
      description: "\uFFFC Name of the Zone. Cannot be Unzoned or the name of an existing\
        \ Zone. The maximum number of characters for a Zone Name is 32"
      name: zone_name
      required: true
    - description: The Policy ID associated with this Zone. If omitted, it will default
        to the Default Policy
      name: policy_id
    - description: "\uFFFC The name of the Zone Criticality, which can be Low, Normal\
        \ or Field Name \uFFFC\uFFFC\uFFFC Type \uFFFC\uFFFC Description \uFFFC\uFFFC\
        \ \uFFFC\uFFFC\uFFFC\uFFFC\uFFFCString, UUID \uFFFC\uFFFC\uFFFC\uFFFC\uFFFC\
        \ Field Name \uFFFC\uFFFC\uFFFC Type \uFFFC\uFFFC\uFFFC Description \uFFFC\
        \ String, UUID High. If omitted, it will default to Normal"
      name: zone_criticality
    deprecated: true
    description: Create a zone
    name: cp-create-zone
  - arguments:
    - description: "\uFFFC Name of the Zone. Cannot be Unzoned or the name of an existing\
        \ Zone. The maximum number of characters for a Zone Name is 32"
      name: zone_name
      required: true
    - default: true
      description: The ID of the Zone to update
      name: zone_id
      required: true
    - description: The Policy ID associated with this Zone. If omitted, will default
        to the Default Policy
      name: policy_id
    - description: The name of the Zone Criticality, which can be Low, Normal or High.
        If omitted, it will default to Normal
      name: zone_criticality
    - description: Defaults to False. Tells whether or not to update the Zone Devices
        to use the new policy. This will only apply if this field is True
      name: apply_policy_change_to_devices
    deprecated: true
    description: Update a zone
    name: cp-update-zone
  - arguments: []
    deprecated: true
    description: Get all policies
    name: cp-get-policies
  - arguments:
    - description: The Policy ID. This information supersedes the Policy Name, if
        both are included
      name: policy_id
    - description: The Policy Name
      name: policy_name
    deprecated: true
    description: Get a specific policy details. If no args supplied, default policy
      is retrieved
    name: cp-get-policy-details
  isfetch: true
  script: "var server = params.server.replace(/[\\/]+$/, '') + '/' + params.version\
    \ + '/';\nvar sendRequest = function(url, body, token) {\n    var httpParams =\
    \ {\n            Method: 'POST',\n            Headers: {\n                'Content-Type':\
    \ ['application/json'],\n                Authorization: ['Bearer ' + token]\n\
    \            }\n        };\n    if (!token) {\n        delete(httpParams.Headers.Authorization);\n\
    \    }\n    if (body) {\n        httpParams.Body = body;\n    }\n\n    var res\
    \ = http(server + url, httpParams, params.insecure, params.proxy, undefined, true);\n\
    \    if (res.StatusCode < 200 || res.StatusCode >= 300) {\n        throw 'Request\
    \ to Cylance protect Failed.\\nStatus code: ' + res.StatusCode + '.\\nBody: '\
    \ + JSON.stringify(res.Body) + '.';\n    }\n    // If we have a body, it should\
    \ have application/json content type.\n    if (res.Body &&\n        (!res.Headers['Content-Type']\
    \ || !res.Headers['Content-Type'][0] || res.Headers['Content-Type'][0].indexOf('application/json')\
    \ === -1)) {\n        throw 'Check your URL - got invalid content type, expected\
    \ application/json. Response body: ' + res.Body;\n    }\n    return res.Body ?\
    \ JSON.parse(res.Body) : 'empty';\n};\nvar commandsThatTakeSha256AsArray = ['cylance-protect-update-device-threats',\
    \ 'cylance-protect-delete-hash-from-lists', 'cylance-protect-update-hash-at-lists',\
    \ 'cylance-protect-upload-threat','cp-update-device-threats', 'cp-delete-hash-from-lists',\
    \ 'cp-update-hash-at-lists', 'cp-upload-threat'];\nvar buildBodyForCommand = function(command,\
    \ args) {\n    if (!args) {\n        return undefined;\n    }\n    var body =\
    \ {};\n    var keys = Object.keys(args);\n    var filterArgs = ['page_number',\
    \ 'page_size', 'sorts', 'filters'];\n    var filterCompositeArgs = ['sorts', 'filters'];\n\
    \    for (var i=0; i < keys.length; i++) {\n        if (keys[i] === 'apply_policy_change_to_devices')\
    \ {\n            args[keys[i]] = args[keys[i]].toLowerCase() === 'true';\n   \
    \     }\n        if (filterArgs.indexOf(keys[i]) !== -1) {\n            if (!body['query_options'])\
    \ {\n                body['query_options'] = {};\n            }\n            if\
    \ (filterCompositeArgs.indexOf(keys[i]) !== -1) {\n                body['query_options'][keys[i]]\
    \ = JSON.parse(args[keys[i]]);\n            } else {\n                body['query_options'][keys[i]]\
    \ = args[keys[i]];\n            }\n        } else {\n            body[keys[i]]\
    \ = commandsThatTakeSha256AsArray.indexOf(command) !== -1\n                &&\
    \ keys[i] === 'sha256'\n                && typeof(JSON.stringify(args[keys[i]]))\
    \ === 'string' ?\n                            [args[keys[i]]] :\n            \
    \                args[keys[i]];\n        }\n        delete(args[keys[i]]);\n \
    \   }\n    return JSON.stringify(body);\n}\nvar runAndParseCommand = function(command,\
    \ args, path, contextFunc) {\n    var headers = argToList(args.headers);\n   \
    \ var context = {};\n    c_args = JSON.parse(JSON.stringify(args));\n    var body\
    \ = sendRequest(\n        urlDictionary[command],\n        buildBodyForCommand(command,\
    \ c_args),\n        auth['access_token']\n        );\n    if (typeof body ===\
    \ \"string\") {\n        return body;\n    }\n    if (path) {\n        body =\
    \ jq(body,path);\n    }\n    if (Object.keys(body).length === 0) {\n        return\
    \ \"No results.\";\n    }\n    if (contextFunc) {\n        context = contextFunc(body);\n\
    \    }\n    md = tblToMd(command, body, headers);\n    return {Type: entryTypes.note,\
    \ Contents: body, ContentsFormat: formats.json, HumanReadable: md, ReadableContentsFormat:\
    \ formats.markdown, EntryContext: context};\n}\n\nvar parseEndpoint = function(body)\
    \ {\n    var context = {};\n    context[\"Endpoint(val.Hostname == obj.Hostname)\"\
    ] = [];\n    if (!(body instanceof Array)){\n        body = [body];\n    }\n \
    \   body.forEach(function(row){\n        var ep = {};\n        ep[\"OS\"] = jq(row,'os_version');\n\
    \        ep[\"Hostname\"] = jq(row,'device_name');\n        ep[\"SerialNumber\"\
    ] = jq(row,'serial_number');\n        ep[\"IP\"] = jq(row,'ip_addresses');\n \
    \       ep[\"MAC\"] = jq(row,'mac_addresses');\n        ep[\"DNSName\"] = jq(row,'dns_name');\n\
    \n        if (row.file_paths){\n            ep.CylanceThreat = {};\n         \
    \   ep.CylanceThreat.Abnormal = jq(row,'abnormal');\n            ep.CylanceThreat.Added\
    \ = jq(row,'added');\n            ep.CylanceThreat.AgentVersion = jq(row,'agent_version');\n\
    \            ep.CylanceThreat.AutoRun = jq(row,'auto_run');\n            ep.CylanceThreat.BackgroundDetection\
    \ = jq(row,'background_detection');\n            ep.CylanceThreat.DetectedBy =\
    \ jq(row,'detected_by');\n            ep.CylanceThreat.ExploitAttempts = jq(row,'exploit_attempts');\n\
    \            ep.CylanceThreat.FilePaths = jq(row,'file_paths');\n            ep.CylanceThreat.FileQuarantineStatus\
    \ = jq(row,'file_quarantine_status');\n            ep.CylanceThreat.FilesAnalyzed\
    \ = jq(row,'files_analyzed');\n            ep.CylanceThreat.FirstFound = jq(row,'first_found');\n\
    \            ep.CylanceThreat.IsOffline = jq(row,'is_offline');\n            ep.CylanceThreat.LastReportedUsers\
    \ = jq(row,'last_reported_users');\n            ep.CylanceThreat.OfflineDate =\
    \ jq(row,'offline_date');\n            ep.CylanceThreat.Policy = jq(row,'policy');\n\
    \            ep.CylanceThreat.Quarantined = jq(row,'quarantined');\n         \
    \   ep.CylanceThreat.Running = jq(row,'running');\n            ep.CylanceThreat.Unsafe\
    \ = jq(row,'unsafe');\n            ep.CylanceThreat.Waived = jq(row,'waived');\n\
    \            ep.CylanceThreat.Zones = jq(row,'zones');\n        }\n\n        context[\"\
    Endpoint(val.Hostname == obj.Hostname)\"].push(ep);\n    });\n\n    return context;\n\
    }\n\nvar parsePolicy = function(body) {\n    var context = {};\n    context.Cylance\
    \ = {};\n    context.Cylance.Policy = [];\n    if (!(body instanceof Array)){\n\
    \        body = [body];\n    }\n    body.forEach(function(row){\n        var l\
    \ = {};\n        l[\"ID\"] = jq(row,'policy_id');\n        l[\"Name\"] = jq(row,'policy_name');\n\
    \n        context.Cylance.Policy.push(l);\n    });\n\n    return context;\n}\n\
    \nvar parseGeneric = function(contextType) {\n    return function (body) {\n \
    \       var context = {};\n        context.Cylance = {};\n        context.Cylance[contextType]\
    \ = [];\n\n        if (!Array.isArray(body)) {\n            body = [body];\n \
    \       }\n\n        body.forEach(function(row){\n            var l = {};\n  \
    \          Object.keys(row).forEach(function(k){\n                nKey = underscoreToCamelCase(k)\n\
    \                l[nKey] = jq(row,k);\n            });\n            if(args.serial_number){\n\
    \                l[\"SerialNumber\"] = args.serial_number\n            }\n   \
    \         context.Cylance[contextType].push(l);\n        });\n        return context;\n\
    \    }\n}\n\nvar parseList = function(body) {\n    var context = {};\n    context.Cylance\
    \ = {};\n    context.Cylance.List = [];\n    if (!(body instanceof Array)){\n\
    \        body = [body];\n    }\n    body.forEach(function(row){\n        var l\
    \ = {};\n        l[\"Name\"] = jq(row,'name');\n        l[\"Type\"] = jq(row,'list_type');\n\
    \        l[\"SHA256\"] = jq(row,'sha256');\n        l[\"MD5\"] = jq(row,\"md5\"\
    );\n        l[\"RawScore\"] = jq(row,'raw_score');\n        l[\"CylanceScore\"\
    ] = jq(row,\"cylance_score\");\n        l[\"VirusTotalThreat\"] = jq(row,\"is_virus_total_threat\"\
    );\n        l[\"Reason\"] = jq(row,\"reason\");\n        l[\"Classification\"\
    ] = jq(row,\"classification\");\n        l[\"category\"] = jq(row,\"category\"\
    );\n        context.Cylance.List.push(l);\n    });\n\n    return context;\n}\n\
    \nvar parseZone = function(body) {\n    var context = {};\n    context.Cylance\
    \ = {};\n    context.Cylance.Zone = [];\n    if (!(body instanceof Array)){\n\
    \        body = [body];\n    }\n    body.forEach(function(row){\n        var l\
    \ = {};\n        l[\"ID\"] = jq(row,'zone_id');\n        l[\"Name\"] = jq(row,'zone_name');\n\
    \        l[\"DeviceCount\"] = jq(row,'device_count');\n        l[\"ThreatCount\"\
    ] = jq(row,\"threat_count\");\n        l[\"PolicyID\"] = jq(row,'policy_id');\n\
    \        l[\"PolicyName\"] = jq(row,\"policy_name\");\n        if(!l.Name && jq(args,\"\
    zone_name\")) {\n            l[\"Name\"] = jq(args,\"zone_name\");\n        }\n\
    \        context.Cylance.Zone.push(l);\n    });\n    return context;\n}\n\nvar\
    \ createIncidentFromThreat = function(threat) {\n    var incident = {\n      \
    \  name: threat.priority + ' ' + threat.name,\n        labels: [],\n        rawJSON:\
    \ JSON.stringify(threat)\n    };\n    delete(threat.name);\n    var keys = Object.keys(threat);\n\
    \    for (var i = 0; i<keys.length; i++) {\n        incident.labels.push({\n \
    \           type: keys[i],\n            value: String(threat[keys[i]]),\n    \
    \    });\n    }\n    return incident;\n}\nvar createFilters = function(lastCall,\
    \ firstQuery) {\n    var retObject = {\n                    Field: params.timeField,\n\
    \                    Operator: 'IsGreaterThan',\n                    Value: lastCall[params.timeField]\n\
    \                };\n    var userFilter;\n    if (params.extendedFilter) {\n \
    \       userFilter = JSON.parse(params.extendedFilter);\n    }\n    if (userFilter)\
    \ {\n        retObject = {\n            LogicalOperator: 'And',\n            Group:\
    \ [userFilter, retObject]\n        };\n    }\n    return JSON.stringify([retObject]);\n\
    }\nvar urlDictionary = {\n    'cylance-protect-get-list': 'globallist/get',\n\
    \    'cylance-protect-get-devices': 'device/get',\n    'cylance-protect-get-threats':\
    \ 'threat/get',\n    'cylance-protect-download-threat': 'threat/download',\n \
    \   'cylance-protect-get-threat-details': 'threatdetail/get',\n    'cylance-protect-device-delete':\
    \ 'device/delete',\n    'cylance-protect-get-device-threats': 'devicethreat/get',\n\
    \    'cylance-protect-update-device-threats': 'devicethreat/update',\n    'cylance-protect-delete-hash-from-lists':\
    \ 'globallist/delete',\n    'cylance-protect-update-hash-at-lists': 'globallist/update',\n\
    \    'cylance-protect-upload-threat': 'threat/upload',\n    'cylance-protect-get-threated-devices':\
    \ 'threatdevice/get',\n    'cylance-protect-get-zones': 'zone/get',\n    'cylance-protect-create-zone':\
    \ 'zone/create',\n    'cylance-protect-update-zone': 'zone/update',\n    'cylance-protect-get-policies':\
    \ 'policy/get',\n    'cylance-protect-get-policy-details': 'policydetail/get',\n\
    \    'cp-get-list': 'globallist/get',\n    'cp-get-devices': 'device/get',\n \
    \   'cp-get-threats': 'threat/get',\n    'cp-download-threat': 'threat/download',\n\
    \    'cp-get-threat-details': 'threatdetail/get',\n    'cp-device-delete': 'device/delete',\n\
    \    'cp-get-device-threats': 'devicethreat/get',\n    'cp-update-device-threats':\
    \ 'devicethreat/update',\n    'cp-delete-hash-from-lists': 'globallist/delete',\n\
    \    'cp-update-hash-at-lists': 'globallist/update',\n    'cp-upload-threat':\
    \ 'threat/upload',\n    'cp-get-threated-devices': 'threatdevice/get',\n    'cp-get-zones':\
    \ 'zone/get',\n    'cp-create-zone': 'zone/create',\n    'cp-update-zone': 'zone/update',\n\
    \    'cp-get-policies': 'policy/get',\n    'cp-get-policy-details': 'policydetail/get'\n\
    };\nvar auth = sendRequest('token/get',\n                        JSON.stringify({\n\
    \                            Username: params.credentials.identifier, Password:\n\
    \                            params.credentials.password\n                   \
    \     }));\nswitch (command) {\n    case 'test-module':\n        if (auth) {\n\
    \            if (params.extendedFilter) {\n                try {\n           \
    \         JSON.parse(params.extendedFilter);\n                }\n            \
    \    catch (ex) {\n                    return 'The filter you have provided is\
    \ not in a JSON format';\n                }\n            }\n            return\
    \ 'ok';\n        }\n        return 'something is wrong';\n    case 'cp-get-list':\
    \ //deprecated\n    case 'cylance-protect-get-list':\n        return runAndParseCommand(command,args,\"\
    \",parseList);\n    case 'cp-delete-hash-from-lists': //deprecated\n    case 'cylance-protect-delete-hash-from-lists':\n\
    \        return runAndParseCommand(command,args,\"\");\n    case 'cp-update-hash-at-lists':\
    \ //deprecated\n    case 'cylance-protect-update-hash-at-lists':\n        return\
    \ runAndParseCommand(command,args,\"\");\n    case 'cp-get-devices': //deprecated\n\
    \    case 'cylance-protect-get-devices':\n        return runAndParseCommand(command,args,\"\
    data\",parseEndpoint);\n    case 'cp-get-device-threats': //deprecated\n    case\
    \ 'cylance-protect-get-device-threats':\n        return runAndParseCommand(command,args,\"\
    data\",parseGeneric('Threat'));\n    case 'cp-get-threats': //deprecated\n   \
    \ case 'cylance-protect-get-threats':\n        return runAndParseCommand(command,args,\"\
    data\",parseGeneric('Threat'));\n    case 'cp-download-threat': //deprecated\n\
    \    case 'cylance-protect-download-threat':\n        return runAndParseCommand(command,args,\"\
    \",parseGeneric('Threat'));\n    case 'cp-get-threat-details': //deprecated\n\
    \    case 'cylance-protect-get-threat-details':\n        return runAndParseCommand(command,args,\"\
    \",parseGeneric('Threat'));\n    case 'cp-device-delete': //deprecated\n    case\
    \ 'cylance-protect-device-delete':\n        return runAndParseCommand(command,args,\"\
    \");\n    case 'cp-get-device-threats': //deprecated\n    case 'cylance-protect-get-device-threats':\n\
    \        return runAndParseCommand(command,args,\"\",parseEndpoint);\n    case\
    \ 'cp-upload-threat':\n    case 'cylance-protect-upload-threat':\n        return\
    \ runAndParseCommand(command,args,\"\");\n    case 'cp-get-threated-devices':\n\
    \    case 'cylance-protect-get-threated-devices':\n        return runAndParseCommand(command,args,\"\
    data\",parseEndpoint);\n    case 'cp-get-zones':\n    case 'cylance-protect-get-zones':\n\
    \        return runAndParseCommand(command,args,\"\",parseZone);\n    case 'cp-create-zone':\n\
    \    case 'cylance-protect-create-zone':\n        return runAndParseCommand(command,args,\"\
    \",parseZone);\n    case 'cp-update-zone':\n    case 'cylance-protect-update-zone':\n\
    \        return runAndParseCommand(command,args,\"\",parseZone);\n    case 'cp-get-policies':\n\
    \    case 'cylance-protect-get-policies':\n        return runAndParseCommand(command,args,\"\
    \",parsePolicy);\n    case 'cp-get-policy-details':\n    case 'cylance-protect-get-policy-details':\n\
    \        return runAndParseCommand(command,args,\"\",parsePolicy);\n    case 'fetch-incidents':\n\
    \        var fetchCommand = 'cylance-protect-get-threats';\n        var lastCall\
    \ = getLastRun();\n        var firstQuery = !lastCall || !lastCall[params.timeField];\n\
    \        if (firstQuery) {\n            lastCall[params.timeField] = '2000-01-01T00:00:00Z'\n\
    \        }\n        var newLastCall = lastCall;\n        var newIncidents = [];\n\
    \        var fetchArgs = {filters: createFilters(lastCall, firstQuery)};\n   \
    \     var response = sendRequest(\n            urlDictionary[fetchCommand],\n\
    \            buildBodyForCommand(fetchCommand, fetchArgs),\n            auth['access_token']\n\
    \            );\n        for (var i = 0; response.data && i < response.data.length;\
    \ i++) {\n            if (Date.parse(response.data[i]['first_found']) > Date.parse(newLastCall['first_found']))\
    \ {\n                newLastCall = response.data[i];\n                newIncidents.push(createIncidentFromThreat(response.data[i]));\n\
    \            }\n        }\n        setLastRun(newLastCall);\n        return JSON.stringify(newIncidents);\n\
    \    default:\n        return runAndParseCommand(command,args,\"\");\n}"
  type: javascript
system: true
toversion: 4.1.9
