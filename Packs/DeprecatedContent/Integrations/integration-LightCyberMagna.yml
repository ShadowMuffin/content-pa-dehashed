category: Network Security
commonfields:
  id: LightCyber Magna
  version: -1
configuration:
- defaultvalue: ''
  display: Server (e.g. https://3.4.5.6)
  name: server
  required: true
  type: 0
- defaultvalue: ''
  display: Authentication
  name: authentication
  required: true
  type: 9
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Fetch "Suspicious" indicators
  name: fetchsuspicious
  required: false
  type: 8
- display: Fetch incidents
  name: isFetch
  required: false
  type: 8
- display: Incident type
  name: incidentType
  required: false
  type: 13
deprecated: true
description: Magnifier Behavioral Analytics empowers organizations to quickly find
  and stop the stealthiest network threats.
detaileddescription: By default only Confirmed indicators trigger as Demisto incidents.
  Enable "Fetch Suspicious indicators" to also trigger "Suspicious" level LightCyber
  indicators.
display: Palo Alto Networks Magnifier (Deprecated)
hidden: false
image: data:image/png;base64,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
name: LightCyber Magna
script:
  commands:
  - arguments: []
    deprecated: true
    description: Show product version
    name: lcm-version
  - arguments: []
    deprecated: true
    description: Show all entities reported in alerts
    name: lcm-entities
  - arguments: []
    deprecated: true
    description: Show all indicators reported in alerts
    name: lcm-indicators
  - arguments: []
    deprecated: true
    description: Get a list of all hosts in the system which are a part of an indicator
      (either source or destination).
    name: lcm-hosts
  - arguments:
    - default: true
      description: IP address to find
      name: ip
      required: true
    deprecated: true
    description: Get a specific host record by IP address (similar to user "find host"
      feature)
    name: lcm-hostbyip
  - arguments:
    - default: true
      description: Name to find
      name: name
      required: true
    deprecated: true
    description: Get a specific host record by host name (similar to user "find host"
      feature)
    name: lcm-hostbyname
  - arguments:
    - default: true
      description: ID of host to scan
      name: id
      required: true
    deprecated: true
    description: Initiate a manual pathfinder scan on the host.
    name: lcm-pathfinder-scan
  - arguments:
    - default: true
      description: The md5 for which to retrieve the report
      name: md5
      required: true
    deprecated: true
    description: Download HTML sandbox report for the given MD5
    name: lcm-sandbox-report
  - arguments: []
    deprecated: true
    description: Returns the daily report (normally sent by email)
    name: lcm-daily-report
  - arguments:
    - default: true
      description: ID of the host whose suspicious artifacts to download.
      name: id
      required: true
    deprecated: true
    description: Download a zip containing the suspicious artifacts of the host.
    name: lcm-host-artifacts
  - arguments:
    - default: true
      description: The host's ID
      name: id
      required: true
    - description: Reason for resolving the host
      name: reason
    deprecated: true
    description: Resolve a host
    name: lcm-resolve-host
  - arguments:
    - default: true
      description: The host's ID
      name: id
      required: true
    deprecated: true
    description: Un-resolve a host
    name: lcm-unresolve-host
  - arguments:
    - default: true
      description: The host's ID
      name: id
      required: true
    - description: The new comment to set for the host
      name: comment
      required: true
    deprecated: true
    description: Change the host comment
    name: lcm-set-host-comment
  - arguments:
    - default: true
      description: The host's ID
      name: id
      required: true
    deprecated: true
    description: Acknowledge all changes on a host (resets purple track changes marks)
    name: lcm-acknowledge-host
  - arguments:
    - default: true
      description: User's name
      name: name
      required: true
    - description: Reason for resolving the user
      name: reason
    deprecated: true
    description: Resolve a user
    name: lcm-resolve-user
  - arguments:
    - default: true
      description: User's name
      name: name
      required: true
    deprecated: true
    description: Un-resolve a user
    name: lcm-unresolve-user
  - arguments:
    - default: true
      description: User's name
      name: name
      required: true
    - description: The new comment to set for the user
      name: comment
      required: true
    deprecated: true
    description: Change the user's comment
    name: lcm-set-user-comment
  - arguments:
    - default: true
      description: User's name
      name: name
      required: true
    deprecated: true
    description: Acknowledge all changes on a user (resets purple track changes marks)
    name: lcm-acknowledge-user
  - arguments:
    - default: true
      description: Domain name
      name: name
      required: true
    deprecated: true
    description: Get a specific domain record by domain name
    name: lcm-domain
  - arguments:
    - default: true
      description: Executable's md5
      name: md5
      required: true
    deprecated: true
    description: Get a specific executable record (by MD5)
    name: lcm-executablebymd5
  - arguments:
    - default: true
      description: Executable's name
      name: name
      required: true
    deprecated: true
    description: Get a specific executable record (by name)
    name: lcm-executablebyname
  - arguments:
    - default: true
      description: Host ID
      name: id
      required: true
    deprecated: true
    description: Get indicators for a specific detected host
    name: lcm-indicatorsforentity
  - arguments:
    - description: How to sort the results
      name: sort
    - description: Host id as presented in LightCyber Magna
      name: host_id
      required: true
    deprecated: true
    description: Shows the used ports in this host
    name: lcm-host-opened-ports
  - arguments:
    - defaultValue: final_score
      description: Sort results by this column
      name: sort
    - default: true
      description: Host id as presented in LightCyber Magna
      name: host_id
      required: true
    deprecated: true
    description: Returns all the suspicious artifacts of this host
    name: lcm-host-suspicious-artifacts
  - arguments:
    - description: Timestamp to search
      name: time
    - defaultValue: -score_e
      description: Sort results by this column
      name: sort
    - default: true
      description: Host id as presented in LightCyber Magna
      name: host_id
      required: true
    deprecated: true
    description: Returns all the running processes in the host
    name: lcm-host-processes
  - arguments:
    - defaultValue: final_score
      description: Sort results by this column
      name: sort
    - default: true
      description: Host id as presented in LightCyber Magna
      name: host_id
      required: true
    deprecated: true
    description: Returns all the modules of this host
    name: lcm-host-loaded-modules
  - arguments:
    - description: Timestamp to search
      name: time
    - defaultValue: process_sig
      description: Sort results by this column
      name: sort
    - default: true
      description: Host id as presented in LightCyber Magna
      name: src_host_id
      required: true
    deprecated: true
    description: Returns all the processes that established internet connection in
      this host
    name: lcm-host-processes-internet-connections
  - arguments:
    - defaultValue: final_score
      description: Sort results by this column
      name: sort
    - default: true
      description: Host id as presented in LightCyber Magna
      name: host_id
      required: true
    deprecated: true
    description: Returns all installed autoruns programs in this host
    name: lcm-host-autoruns
  isfetch: true
  script: "var fixUrl = function(base) {\n  res = base;\n  if (base && base[base.length\
    \ - 1] != '/') {\n      res = res + '/';\n  }\n  return res;\n};\n\nvar buildArgs\
    \ = function(args) {\n    sArgs = Object.keys(args).map(function(key) {\n    \
    \    return [key, args[key]].map(encodeURIComponent).join(\"=\");\n    }).join(\"\
    &\");\n    if (sArgs) {\n        return '?' + sArgs;\n    } else {\n        return\
    \ '';\n    }\n};\n\nvar parseResponse = function(resp) {\n  if (resp.StatusCode\
    \ === 200) {\n      try {\n          return JSON.parse(resp.Body);\n      } catch\
    \ (e) {\n          return resp.Body;\n      }\n  } else {\n    err = resp.Status;\n\
    \    if (resp.Body) {\n        err += '\\n' + resp.Body;\n    }\n    throw err;\n\
    \  }\n\n};\nvar Base64 = {\n  _keyStr: \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\"\
    ,\n  encode: function(input) {\n    var output = \"\";\n    var chr1, chr2, chr3,\
    \ enc1, enc2, enc3, enc4;\n    var i = 0;\n    while (i < input.length) {\n  \
    \    chr1 = input.charCodeAt(i++);\n      chr2 = input.charCodeAt(i++);\n    \
    \  chr3 = input.charCodeAt(i++);\n      enc1 = chr1 >> 2;\n      enc2 = ((chr1\
    \ & 3) << 4) | (chr2 >> 4);\n      enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);\n\
    \      enc4 = chr3 & 63;\n      if (isNaN(chr2)) {\n        enc3 = enc4 = 64;\n\
    \      } else if (isNaN(chr3)) {\n        enc4 = 64;\n      }\n      output =\
    \ output + this._keyStr.charAt(enc1) + this._keyStr.charAt(enc2) + this._keyStr.charAt(enc3)\
    \ + this._keyStr.charAt(enc4);\n    }\n\n    return output;\n  }\n};\n\n\nvar\
    \ loadCSV = function(csvData) {\n  var data = [];\n  var rows = csvData.split('\\\
    r\\n');\n  var headers = rows[0].split(',');\n  for(var i = 1; i < rows.length;\
    \ i++) {\n    var cells = rows[i].split(',');\n    if (cells.join('') === '')\
    \ {\n        continue;\n    }\n    var obj = {};\n    for(var j = 0; j < cells.length;\
    \ j++) {\n        obj[headers[j]] = cells[j];\n    }\n    data.push(obj);\n  }\n\
    \  return {results: data};\n};\n\nvar doGet = function(qArgs, qParams, auth, raw,\
    \ suffix) {\n  url = fixUrl(qParams.server) + suffix + buildArgs(qArgs);\n  res\
    \ = http(\n      url,\n      {\n          Method: 'GET',\n          Headers: {'Authorization':\
    \ [auth]}\n      },\n      qParams.insecure\n  );\n  if (raw) {\n      return\
    \ res;\n  } else {\n      return parseResponse(res);\n  }\n};\n\nvar doGetCSV\
    \ = function(qArgs, qParams, auth, suffix) {\n  url = fixUrl(qParams.server) +\
    \ suffix + encodeToURLQuery(qArgs);\n  resp = http(\n      url,\n      {\n   \
    \       Method: 'GET',\n          Headers: {'Authorization': [auth]}\n      },\n\
    \      qParams.insecure\n  );\n\n  if (resp.StatusCode === 200) {\n    return\
    \ loadCSV(resp.Body);\n  } else {\n    err = resp.Status;\n    if (resp.Body)\
    \ {\n        err += '\\n' + resp.Body;\n    }\n    throw err;\n  }\n};\n\nvar\
    \ doPost = function(body, qParams, auth, raw, suffix) {\n  var url = fixUrl(qParams.server)\
    \ + suffix;\n  var res = http(\n      url, // URL\n      { // HTTP Request Headers\n\
    \          Method: 'POST',\n          Headers: {'Authorization': [auth]},\n  \
    \        Body: ((body && body !== '') ? (JSON.stringify(body)) : '')\n      },\n\
    \      qParams.insecure\n  );\n  if (raw) {\n      return res;\n  } else {\n \
    \     return parseResponse(res);\n  }\n};\n\nvar getIndicators = function(qArgs,\
    \ qParams, auth) {\n    return doGetCSV(qArgs, qParams, auth, 'api/reports/indicators');\n\
    };\n\nvar getEntities = function(qArgs, qParams, auth) {\n    return doGetCSV(qArgs,\
    \ qParams, auth, 'api/reports/entities');\n};\n\nvar getIndicatorsByHostId = function(qArgs,\
    \ qParams, auth, filterIds) {\n    if (!filterIds || filterIds.length === 0){\n\
    \        return {};\n    } else {\n        var indicators = getIndicators(qArgs,\
    \ qParams, auth);\n        var indByHostId = {};\n        var hostId;\n      \
    \  for(var i = 0; i < indicators.length; i++) {\n            hostId = indicators[i].HostId;\n\
    \            // Only include hostIds that appear in filterIds\n            if\
    \ (filterIds.indexOf(hostId) >= 0) {\n                if (indByHostId[hostId])\
    \ {\n                    indByHostId[hostId].push(indicators[i]);\n          \
    \      } else {\n                    indByHostId[hostId] = [indicators[i]];\n\
    \                }\n            }\n        }\n        return indByHostId;\n  \
    \  }\n};\n\n\nvar createIncidentFromEntity = function(entity) {\n        var keys\
    \ = Object.keys(entity);\n        var labels = [];\n        for (var i = 0; i<keys.length;\
    \ i++) {\n            labels.push({'type': keys[i], 'value': entity[keys[i]]});\n\
    \        }\n\n        var eid = 'Unknown';\n        if (entity['Entity Type']\
    \ === 'host') {\n            if (entity.Hostname) {\n                eid = entity.Hostname;\n\
    \            } else if (entity.IP) {\n                eid = entity.IP;\n     \
    \       } else {\n                eid = entity['Entity ID'];\n            }\n\
    \        } else {\n            if (entity.Username) {\n                eid = entity.Username;\n\
    \            } else {\n                eid = entity['Entity ID'];\n          \
    \  }\n        }\n\n        return {\n            \"name\": 'LightCyber: ' + entity['Entity\
    \ Type'] + ' {' + eid + '} - ' + entity['Final Status'],\n            \"labels\"\
    : labels,\n            \"details\": JSON.stringify(entity),\n            \"rawJSON\"\
    : JSON.stringify(entity)\n        };\n    };\n\nvar getIncidents = function(qArgs,\
    \ qParams, auth) {\n    var inc = [];\n    var last = getLastRun().highestLastDetected;\n\
    \    if (!last) {\n        last = '';\n    }\n    var data = getEntities(qArgs,\
    \ qParams, auth);\n    if (data && data.results) {\n        var entities = data.results;\n\
    \        var highest = last;\n        var hostIds = {};\n        for (var i =\
    \ 0; i < entities.length; i++) {\n            if ( entities[i].Status === 'Confirmed'\
    \ || (qParams.fetchsuspicious && entities[i].Status === 'Suspicious') ) {\n  \
    \              if (entities[i]['Last Detected'] > last) {\n                  \
    \  hostIds[entities[i]['Entity Id']] = '';\n                    inc.push(createIncidentFromEntity(entities[i]));\n\
    \                }\n                if (entities[i]['Last Detected'] > highest)\
    \ {\n                    highest = entities[i]['Last Detected'];\n           \
    \     }\n            }\n        }\n        if (highest > last) {\n           \
    \ setLastRun({'highestLastDetected': highest});\n        }\n\n        return JSON.stringify(inc);\n\
    \    } else {\n        return '';\n    }\n};\n\ndelete args.using\ndelete args['using-brand']\n\
    // Currently API only supports Basic auth.\nu = params.authentication.identifier;\n\
    p = params.authentication.password;\nauth = 'Basic ' + Base64.encode(u + ':' +\
    \ p);\n\n// The command input arg holds the command sent from the user.\nswitch\
    \ (command) {\n  // This is the call made when pressing the integration test button.\n\
    \  case 'test-module':\n      resp = doGet(args, params, auth, true, 'api/version');\n\
    \      if (resp.StatusCode === 200) {\n          return 'ok';\n      } else if\
    \ (resp.Status) {\n          return resp.Status;\n      } else {\n          return\
    \ resp;\n      }\n      break;\n  case 'fetch-incidents':\n      return getIncidents(args,\
    \ params, auth);\n\n    case \"lcm-host-opened-ports\":\n        return doGetCSV(args,\
    \ params, auth, \"api/precompute/v1/open_ports_preset\");\n    case \"lcm-host-suspicious-artifacts\"\
    :\n        return doGetCSV(args, params, auth, \"api/precompute/v1/host_suspicious_artifacts\"\
    );\n    case \"lcm-host-processes\":\n        return doGetCSV(args, params, auth,\
    \ \"api/precompute/v1/host_process_list\");\n    case \"lcm-host-loaded-modules\"\
    :\n        return doGetCSV(args, params, auth, \"api/precompute/v1/host_loaded_dlls\"\
    );\n    case \"lcm-host-processes-internet-connections\":\n        return doGetCSV(args,\
    \ params, auth, \"api/precompute/v1/external_flows_with_md5\");\n    case \"lcm-host-autoruns\"\
    :\n        return doGetCSV(args, params, auth, \"api/precompute/v1/host_autoruns_preset\"\
    );\n  case 'lcm-version':\n      return doGet(args, params, auth, false, 'api/version');\n\
    \  case 'lcm-indicators':\n      return getIndicators(args, params, auth);\n \
    \ case 'lcm-entities':\n      return getEntities(args, params, auth);\n  case\
    \ 'lcm-hosts':\n      var data = doGet(args, params, auth, false, 'api/hosts');\n\
    \      return {results: data};\n  case 'lcm-domain':\n      return doGet(args,\
    \ params, auth, false, 'api/domains/' + args.name);\n  case 'lcm-hostbyip':\n\
    \      var data = doGet(args, params, auth, false, 'api/hosts/by_ip/' + args.ip);\n\
    \      return {results: data};\n  case 'lcm-hostbyname':\n      var data = doGet(args,\
    \ params, auth, false, 'api/hosts/by_name/' + args.name);\n      return {results:\
    \ data};\n  case 'lcm-hostbyid':\n      var data = doGet(args, params, auth, false,\
    \ 'api/hosts/' + args.id);\n      return {results: data};\n  case 'lcm-pathfinder-scan':\n\
    \      return doPost('', params, auth, false, 'api/hosts/' + args.id + '/scan');\n\
    \  case 'lcm-executablebymd5':\n      return doGet(args, params, auth, false,\
    \ 'api/executables/' + args.md5);\n  case 'lcm-executablebyname':\n      return\
    \ doGet(args, params, auth, false, 'api/executables/by_name/' + args.name);\n\
    \  case 'lcm-sandbox-report':\n      return doGet(args, params, auth, false, 'api/executables/'\
    \ + args.md5 + '/report');\n  case 'lcm-host-artifacts':\n      return doGet(args,\
    \ params, auth, false, 'api/hosts/' + args.id + '/archive');\n  case 'lcm-resolve-host':\n\
    \      return doPost(args.reason ? args.reason : '', params, auth, false, 'api/hosts/'\
    \ + args.id + '/resolve');\n  case 'lcm-unresolve-host':\n      return doPost('',\
    \ params, auth, false, 'api/hosts/' + args.id + '/unresolve');\n  case 'lcm-set-host-comment':\n\
    \      return doPost(args.comment, params, auth, false, 'api/hosts/' + args.id\
    \ + '/comment');\n  case 'lcm-acknowledge-host':\n      return doPost('', params,\
    \ auth, false, 'api/hosts/' + args.id + '/acknowledge');\n  case 'lcm-resolve-user':\n\
    \      return doPost(args.reason ? args.reason : '', params, auth, false, 'api/users/'\
    \ + args.name + '/resolve');\n  case 'lcm-unresolve-user':\n      return doPost('',\
    \ params, auth, false, 'api/users/' + args.name + '/unresolve');\n  case 'lcm-set-user-comment':\n\
    \      return doPost(args.comment, params, auth, false, 'api/users/' + args.name\
    \ + '/comment');\n  case 'lcm-acknowledge-user':\n      return doPost('', params,\
    \ auth, false, 'api/users/' + args.name + '/acknowledge');\n  case 'lcm-daily-report':\n\
    \      return doGet(args, params, auth, false, 'api/daily_report');\n  case 'lcm-indicatorsforentity':\n\
    \      return getIndicatorsByHostId(args, params, auth, args.id);\n  default:\n\
    \      return 'Unrecognized command: ' + command;\n}"
  type: javascript
tests:
- No test
toversion: 4.1.9
