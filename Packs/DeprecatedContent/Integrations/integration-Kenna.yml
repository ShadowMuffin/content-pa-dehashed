category: Vulnerability Management
commonfields:
  id: Kenna
  version: -1
configuration:
- defaultvalue: https://api.kennasecurity.com
  display: Server URL (e.g. https://192.168.0.1)
  name: url
  required: false
  type: 0
- defaultvalue: ''
  display: Kenna API key
  name: key
  required: true
  type: 4
- defaultvalue: 'false'
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
- display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
deprecated: true
description: Deprecated. Use Kenna v2.
display: Kenna
fromversion: 4.1.0
image: data:image/png;base64,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
name: Kenna
script:
  commands:
  - arguments:
    - description: Vulnerability ID to search
      name: id
    - auto: PREDEFINED
      description: Filtering vulnerabilities by those that Kenna recommends should
        be a top priority to fix
      name: top-priority
      predefined:
      - 'true'
      - 'false'
    - description: Find all vulnerabilities with scores greater than this value
      name: min-score
    - auto: PREDEFINED
      description: Status of the vulnerability
      name: status
      predefined:
      - open
      - closed
      - risk_accepted
      - false_positive
    description: Filters vulnerabilities by a given set of parameters and returns
      the filtered vulnerabilities
    name: kenna-search-vulnerabilities
    outputs:
    - contextPath: Kenna.AssetID
      description: Asset ID related to vulnerability
    - contextPath: Kenna.Connectors.DefinitionName
      description: Connector definition name related to vulnerability
    - contextPath: Kenna.Connectors.ID
      description: Connector ID related to vulnerability
    - contextPath: Kenna.Connectors.Name
      description: Connector name related to vulnerability
    - contextPath: Kenna.Connectors.Vendor
      description: Connector vendor related to vulnerability
    - contextPath: Kenna.CveID
      description: CVE ID related to vulnerability
    - contextPath: Kenna.FixID
      description: Fix ID related to vulnerability
    - contextPath: Kenna.Patch
      description: There is patch related to vulnerability
    - contextPath: Kenna.RiskMeterScore
      description: Risk meter score of vulnerability
    - contextPath: Kenna.ScannerVulnerabilities.ExternalID
      description: Vulnerability scanner external ID
    - contextPath: Kenna.ScannerVulnerabilities.Open
      description: Vulnerability scanner is open
    - contextPath: Kenna.ScannerVulnerabilities.Port
      description: Vulnerability scanner port
    - contextPath: Kenna.Score
      description: Vulnerability score
    - contextPath: Kenna.ServiceTicket.DueDate
      description: 'Service ticket due date '
    - contextPath: Kenna.ServiceTicket.ExternalIdentifier
      description: Service ticket external identifier
    - contextPath: Kenna.ServiceTicket.Status
      description: Service ticket status
    - contextPath: Kenna.ServiceTicket.TicketType
      description: Service ticket type
    - contextPath: Kenna.Severity
      description: Vulnerability severity
    - contextPath: Kenna.Status
      description: Vulnerability status
    - contextPath: Kenna.Threat
      description: Vulnerability threat
    - contextPath: Kenna.TopPriority
      description: Vulnerability is top priority
  - arguments: []
    description: Returns all of your connectors
    name: kenna-get-connectors
    outputs:
    - contextPath: Kenna.ConnectorsList.ID
      description: Connector ID
  - arguments:
    - description: Connector ID to run
      name: id
      required: true
    description: Schedules a run of a connector. If file based, it will use most recently
      uploaded data file
    name: kenna-run-connector
  - arguments:
    - description: Vulnerability ID to search
      name: id
    - auto: PREDEFINED
      description: Filtering vulnerabilities by those that Kenna recommends should
        be a top priority to fix
      name: top-priority
      predefined:
      - 'true'
      - 'false'
    - description: Find all vulnerabilities with scores greater than this value
      name: min-score
    - auto: PREDEFINED
      description: Status of the vulnerability
      name: status
      predefined:
      - open
      - closed
      - risk_accepted
      - false_positive
    description: Filters fixes by a given set of vulnerability and asset parameters
      and returns the filtered fixes
    name: kenna-search-fixes
  - arguments:
    - description: The id of an Asset to be updated
      name: id
      required: true
    - description: Notes about an asset
      name: notes
      required: true
    description: Update a single asset's attributes by ID
    name: kenna-update-asset
  - arguments:
    - description: The id of an vulnerability to be updated
      name: id
      required: true
    - auto: PREDEFINED
      description: The status of a vulnerability
      name: status
      predefined:
      - open
      - closed
      - risk_accepted
      - false_positive
    - description: Notes about a vulnerability
      name: notes
    description: Update a single vulnerability's attributes by ID
    name: kenna-update-vulnerability
  script: "var API_KEY = params.key;\nvar URL = params.url.replace(/[\\/]+$/, '');\n\
    \nfunction searchVulnerabilities(args) {\n    var urlQuery = {};\n        argKeys\
    \ = Object.keys(args);\n        for (var i = 0; i < argKeys.length; i++) {\n \
    \           if (argKeys[i] === 'min-score') {\n                urlQuery['min_risk_meter_score']\
    \ = args[argKeys[i]];\n            } else {\n                urlQuery[argKeys[i].replace('-','_')\
    \ + '[]'] = args[argKeys[i]];\n            }\n        }\n    var res = searchVulnerabilitiesRequest(urlQuery);\n\
    \n    var hr = [];\n    var context = {};\n    context.Kenna = [];\n    for (var\
    \ i = 0; i < res.length; i++) {\n\n        hr[i] = {\n            'ID' : res[i].id,\n\
    \            'Score' : res[i].risk_meter_score,\n            'Name' : res[i].cve_id\n\
    \        };\n\n        context.Kenna[i]={};\n        context.Kenna[i].AssetID\
    \ = res[i].asset_id;\n        context.Kenna[i].Connectors = [];\n        for (var\
    \ j = 0; j < res[i].connectors.length; j++) {\n            context.Kenna[i].Connectors[j]\
    \ = {};\n            context.Kenna[i].Connectors[j].DefinitionName = res[i].connectors[j].connector_definition_name;\n\
    \            context.Kenna[i].Connectors[j].ID = res[i].connectors[j].id;\n  \
    \          context.Kenna[i].Connectors[j].Name = res[i].connectors[j].name;\n\
    \            context.Kenna[i].Connectors[j].Vendor = res[i].connectors[j].vendor;\n\
    \        }\n        context.Kenna[i].CveID = res[i].cve_id;\n        context.Kenna[i].FixID\
    \ = res[i].fix_id;\n        context.Kenna[i].ID = res[i].id;\n        context.Kenna[i].Patch\
    \ = res[i].patch;\n        context.Kenna[i].RiskMeterScore = res[i].risk_meter_score;\n\
    \        context.Kenna[i].ScannerVulnerabilities = [];\n        for (var j = 0;\
    \ j < res[i].scanner_vulnerabilities.length; j++) {\n            context.Kenna[i].ScannerVulnerabilities[j]\
    \ = {};\n            context.Kenna[i].ScannerVulnerabilities[j].ExternalID = res[i].scanner_vulnerabilities[j].external_unique_id;\n\
    \            context.Kenna[i].ScannerVulnerabilities[j].Open = res[i].scanner_vulnerabilities[j].open;\n\
    \            context.Kenna[i].ScannerVulnerabilities[j].Port = res[i].scanner_vulnerabilities[j].port;\n\
    \        }\n        context.Kenna[i].Score = res[i].score;\n        if (res[i].service_ticket)\
    \ {\n            context.Kenna[i].ServiceTicket = {};\n            context.Kenna[i].ServiceTicket.DueDate\
    \ = res[i].service_ticket.due_date;\n            context.Kenna[i].ServiceTicket.ExternalIdentifier\
    \ = res[i].service_ticket.external_identifier;\n            context.Kenna[i].ServiceTicket.Status\
    \ = res[i].service_ticket.status;\n            context.Kenna[i].ServiceTicket.TicketType\
    \ = res[i].service_ticket.ticket_type;\n        }\n        context.Kenna[i].Severity\
    \ = res[i].severity;\n        context.Kenna[i].Status = res[i].status;\n     \
    \   context.Kenna[i].Threat = res[i].threat;\n        context.Kenna[i].TopPriority\
    \ = res[i].top_priority;\n    }\n\n    return {\n        Type: entryTypes.note,\n\
    \        Contents: res,\n        ContentsFormat: formats.json,\n        ReadableContentsFormat\
    \ : formats.markdown,\n        EntryContext : context,\n        HumanReadable:\
    \ tableToMarkdown('Kenna Vulnerabilities', hr)\n    };\n}\n\nfunction searchVulnerabilitiesRequest(urlQuery)\
    \ {\n    var requestUrl = URL + '/vulnerabilities/search' + encodeToURLQuery(urlQuery);\n\
    \    var res = http(\n        requestUrl,\n        {\n            Method: 'GET',\n\
    \            Headers: {\n                'X-Risk-Token': [API_KEY],\n        \
    \        'Content-Type': ['application/json'],\n                'Accept': ['application/json']\n\
    \            }\n        },\n        params.insecure,\n        params.proxy\n \
    \   );\n    if (res.StatusCode < 200 || res.StatusCode >= 300) {\n        throw\
    \ 'Request Failed.\\nStatus code: ' + res.StatusCode + '.\\nBody: ' + JSON.stringify(res)\
    \ + '.';\n    }\n    var response = JSON.parse(res.Body);\n    return response.vulnerabilities;\n\
    }\n\n\nfunction getConnectors() {\n    var connectors = getConnectorsRequest();\n\
    \    var hr = [];\n    var context = {\n        Kenna: {}\n    };\n    context.Kenna.ConnectorsList\
    \ = []\n    for (var i = 0; i < connectors.length; i++) {\n        var connector\
    \ = connectors[i];\n        hr[i] = {\n            'Host' : connector.host,\n\
    \            'Name' : connector.name,\n            'Running' : connector.running,\n\
    \            'ID' : connector.id\n        };\n        context.Kenna.ConnectorsList[i]\
    \ = {};\n        context.Kenna.ConnectorsList[i].ID = connector.id;\n    }\n \
    \   return {\n        Type: entryTypes.note,\n        Contents: connectors,\n\
    \        ContentsFormat: formats.json,\n        ReadableContentsFormat : formats.markdown,\n\
    \        EntryContext : context,\n        HumanReadable: tableToMarkdown('Kenna\
    \ Connectors', hr)\n    };\n}\n\nfunction getConnectorsRequest() {\n    var requestUrl\
    \ = URL + '/connectors';\n    var res = http(\n        requestUrl,\n        {\n\
    \            Method: 'GET',\n            Headers: {\n                'X-Risk-Token':\
    \ [API_KEY],\n                'Content-Type': ['application/json'],\n        \
    \        'Accept': ['application/json']\n            }\n        },\n        params.insecure,\n\
    \        params.proxy\n    );\n    if (res.StatusCode < 200 || res.StatusCode\
    \ >= 300) {\n        throw 'Request Failed.\\nStatus code: ' + res.StatusCode\
    \ + '.\\nBody: ' + JSON.stringify(res) + '.';\n    }\n    var response = JSON.parse(res.Body);\n\
    \    return response.connectors;\n}\n\nfunction runConnector(id) {\n    var response\
    \ = runConnectorRequest(id);\n    if (response.success === 'true') {\n       \
    \ return 'Connector ran successfully!';\n    } else {\n        return 'Could not\
    \ run connector.';\n    }\n}\n\nfunction runConnectorRequest(id) {\n    var requestUrl\
    \ = URL + '/connectors/' + id + '/run';\n    var res = http(\n        requestUrl,\n\
    \        {\n            Method: 'GET',\n            Headers: {\n             \
    \   'X-Risk-Token': [API_KEY],\n                'Content-Type': ['application/json'],\n\
    \                'Accept': ['application/json']\n            }\n        },\n \
    \       params.insecure,\n        params.proxy\n    );\n    if (res.StatusCode\
    \ < 200 || res.StatusCode >= 300) {\n        throw 'Request Failed.\\nStatus code:\
    \ ' + res.StatusCode + '.\\nBody: ' + JSON.stringify(res) + '.';\n    }\n    return\
    \ JSON.parse(res.Body);\n}\n\nfunction searchFixes(args) {\n    var urlSuffix;\n\
    \    if (args.id) {\n        urlSuffix = '/' + args.id;\n    } else {\n      \
    \  var urlQuery = {};\n            argKeys = Object.keys(args);\n            for\
    \ (var i = 0; i < argKeys.length; i++) {\n                if (argKeys[i] === 'min-score')\
    \ {\n                    urlQuery['min_risk_meter_score'] = args[argKeys[i]];\n\
    \                } else {\n                    urlQuery[argKeys[i].replace('-','_')\
    \ + '[]'] = args[argKeys[i]];\n                }\n            }\n        urlSuffix\
    \ = encodeToURLQuery(urlQuery);\n    }\n    var res = searchFixesRequest(urlSuffix);\n\
    \n    var rex = /(<([^>]+)>)/ig; //Removes HTML tags (i.e. <p>, </p>, <br>)\n\
    \    var hr = '';\n    for (var i = 0; i < res.length; i++) {\n        hr += res[i].title\
    \ + '\\n';\n        hr += '#### ID: ' + res[i].id + '\\n';\n        hr += res[i].vuln_count\
    \ + ' vulnerabilities affected\\n';\n        hr += '#### Diagnosis:\\n';\n   \
    \     hr += res[i].diagnosis.replace(rex,' ') + '\\n' + '&nbsp;' + '\\n';\n  \
    \  }\n    return {\n        Type: entryTypes.note,\n        Contents: res,\n \
    \       ContentsFormat: formats.json,\n        ReadableContentsFormat : formats.markdown,\n\
    \        HumanReadable: hr\n    };\n}\n\nfunction searchFixesRequest(urlSuffix)\
    \ {\n    var requestUrl = URL + '/fixes' + urlSuffix;\n    var res = http(\n \
    \       requestUrl,\n        {\n            Method: 'GET',\n            Headers:\
    \ {\n                'X-Risk-Token': [API_KEY],\n                'Content-Type':\
    \ ['application/json'],\n                'Accept': ['application/json']\n    \
    \        }\n        },\n        params.insecure,\n        params.proxy\n    );\n\
    \    if (res.StatusCode < 200 || res.StatusCode >= 300) {\n        throw 'Request\
    \ Failed.\\nStatus code: ' + res.StatusCode + '.\\nBody: ' + JSON.stringify(res)\
    \ + '.';\n    }\n    var response = JSON.parse(res.Body);\n    var fixes;\n  \
    \  if (response.fixes) {\n        fixes = response.fixes;\n    } else if (response.fix)\
    \ {\n        fixes = [response.fix];\n    }\n    return fixes;\n}\n\nfunction\
    \ updateAsset(id, notes) {\n    var body = {\n        'asset': {\n           \
    \ 'notes': notes\n        }\n    };\n    var statusCode = updateAssetRequest(id,\
    \ body);\n    if (statusCode === 204) {\n        return 'Asset ' + id +' was updated.';\n\
    \    } else {\n        return 'Could not update asset.';\n    }\n}\n\nfunction\
    \ updateAssetRequest(id, body) {\n    var requestUrl = URL + '/assets/' + id;\n\
    \    var res = http(\n        requestUrl,\n        {\n            Method: 'PUT',\n\
    \            Headers: {\n                'X-Risk-Token': [API_KEY],\n        \
    \        'Content-Type': ['application/json'],\n                'Accept': ['application/json']\n\
    \            },\n            Body: JSON.stringify(body)\n        },\n        params.insecure,\n\
    \        params.proxy\n    );\n    if (res.StatusCode < 200 || res.StatusCode\
    \ >= 300) {\n        throw 'Request Failed.\\nStatus code: ' + res.StatusCode\
    \ + '.\\nBody: ' + JSON.stringify(res) + '.';\n    }\n    return res.StatusCode;\n\
    }\n\nfunction updateVulnerability(id, notes, status) {\n    if (!status && !notes)\
    \ {\n        throw 'Please insert arguments to update.'\n    }\n    var body =\
    \ {};\n    body['vulnerability'] = {};\n    if (status) {\n        body['vulnerability']['status']\
    \ = status;\n    }\n    if (notes) {\n        body['vulnerability']['notes'] =\
    \ notes;\n    }\n    var statusCode = updateVulnerabilityRequest(id, body);\n\
    \    if (statusCode === 204) {\n        return 'Vulnerability ' + id +' was updated.';\n\
    \    } else {\n        return 'Could not update vulnerability.';\n    }\n}\n\n\
    function updateVulnerabilityRequest(id, body) {\n    var requestUrl = URL + '/vulnerabilities/'\
    \ + id;\n    var res = http(\n        requestUrl,\n        {\n            Method:\
    \ 'PUT',\n            Headers: {\n                'X-Risk-Token': [API_KEY],\n\
    \                'Content-Type': ['application/json'],\n                'Accept':\
    \ ['application/json']\n            },\n            Body: JSON.stringify(body)\n\
    \        },\n        params.insecure,\n        params.proxy\n    );\n    if (res.StatusCode\
    \ < 200 || res.StatusCode >= 300) {\n        throw 'Request Failed.\\nStatus code:\
    \ ' + res.StatusCode + '.\\nBody: ' + JSON.stringify(res) + '.';\n    }\n    return\
    \ res.StatusCode;\n}\n\nfunction testRequest() {\n    var requestUrl = URL + '/assets';\n\
    \    var res = http(\n        requestUrl,\n        {\n            Method: 'GET',\n\
    \            Headers: {\n                'X-Risk-Token': [API_KEY],\n        \
    \        'Content-Type': ['application/json'],\n                'Accept': ['application/json']\n\
    \            }\n        },\n        params.insecure,\n        params.proxy\n \
    \   );\n    if (res.StatusCode < 200 || res.StatusCode >= 300) {\n        throw\
    \ 'Request Failed.\\nStatus code: ' + res.StatusCode + '.\\nBody: ' + JSON.stringify(res)\
    \ + '.';\n    }\n}\n\nswitch (command) {\n    case 'test-module':\n        //\
    \ Tests Authentication\n        testRequest();\n        return 'ok';\n    case\
    \ 'kenna-search-vulnerabilities':\n        return searchVulnerabilities(args);\n\
    \    case 'kenna-get-connectors':\n        return getConnectors();\n    case 'kenna-run-connector':\n\
    \        return runConnector(args.id);\n    case 'kenna-search-fixes':\n     \
    \   return searchFixes(args);\n    case 'kenna-update-asset':\n        return\
    \ updateAsset(args.id, args.notes);\n    case 'kenna-update-vulnerability':\n\
    \        return updateVulnerability(args.id, args.notes, args.status);\n    default:\n\
    }\n"
  type: javascript
tests:
- No tests
toversion: 4.1.9
