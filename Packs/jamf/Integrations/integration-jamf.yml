category: Endpoint
commonfields:
  id: jamf
  version: -1
configuration:
- defaultvalue: ''
  display: Server URL (e.g. https://192.168.0.1)
  name: server
  required: true
  type: 0
- defaultvalue: ''
  display: Username
  name: credentials
  required: false
  type: 9
- defaultvalue: ''
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  type: 8
- defaultvalue: ''
  display: Use system proxy settings
  name: proxy
  required: false
  type: 8
description: Jamf device management
display: jamf
hidden: false
image: data:image/png;base64,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
name: jamf
script:
  commands:
  - arguments: []
    description: Get a list of managed computers
    name: jamf-get-computers
    outputs:
    - contextPath: Jamf.Computers.ID
      description: Computer ID
    - contextPath: Jamf.Computers.Name
      description: Computer name
  - arguments:
    - description: Match criteria. e.g. to retrieve all computers associated with
        a user use $UserID
      name: match
      required: true
    description: Get a list of managed computers that matches inputs query
    name: jamf-get-computers-match
    outputs:
    - contextPath: Jamf.Computers.ID
      description: Computer ID
    - contextPath: Jamf.Computers.Name
      description: Computer name
    - contextPath: Jamf.Computers.AltMAC
      description: Computer alternative MAC
    - contextPath: Jamf.Computers.MAC
      description: Computer MAC
    - contextPath: Jamf.Computers.Serial
      description: Computer serial
    - contextPath: Jamf.Computers.UDID
      description: Computer UDID
    - contextPath: Jamf.Computers.AssetTag
      description: Computer asset tag
    - contextPath: Jamf.Computers.BarCode.1
      description: Computer barcode 1
    - contextPath: Jamf.Computers.BarCode.2
      description: Computer barcode 2
    - contextPath: Jamf.Computers.Building
      description: Computer building
    - contextPath: Jamf.Computers.BuildingName
      description: Computer building name
    - contextPath: Jamf.Computers.Department
      description: Computer department
    - contextPath: Jamf.Computers.DepartmentName
      description: Computer department name
    - contextPath: Jamf.Computers.Email
      description: Computer email
    - contextPath: Jamf.Computers.EmailAddress
      description: Computer email address
    - contextPath: Jamf.Computers.Position
      description: Computer position
    - contextPath: Jamf.Computers.Username
      description: Computer username
    - contextPath: Jamf.Computers.Realname
      description: Computer real name
    - contextPath: Jamf.Computers.Room
      description: Computer room
  script: "baseUrl = params.server.replace(/[\\/]+$/, '') + '/JSSResource/';\ncommandDictionary\
    \ = {\n    'jamf-get-computers': {\n        url: 'computers',\n        method:\
    \ 'GET',\n        extended: true,\n        translator: [\n            {\n    \
    \            contextPath: 'Jamf.Computers(val.ID==obj.ID)',\n                title:\
    \ 'Jamf get computers result',\n                innerPath: 'computers',\n    \
    \            data: [\n                    {to: 'ID', from: 'id'},\n          \
    \          {to: 'Name', from: 'name'},\n                ]\n            }\n   \
    \     ],\n    },\n    'jamf-get-computers-match': {\n        url: 'computers/match/%match%',\n\
    \        method: 'GET',\n        extended: true,\n        argsToURLEncode: ['match'],\n\
    \        translator: [\n            {\n                contextPath: 'Jamf.Computers(val.ID==obj.ID)',\n\
    \                title: 'Jamf get computer match result',\n                innerPath:\
    \ 'computers',\n                data: [\n                    {to: 'ID', from:\
    \ 'id'},\n                    {to: 'Name', from: 'name'},\n                  \
    \  {to: 'AltMAC', from: 'alt_mac_address'},\n                    {to: 'MAC', from:\
    \ 'mac_address'},\n                    {to: 'Serial', from: 'serial_number'},\n\
    \                    {to: 'UDID', from: 'udid'},\n                    {to: 'AssetTag',\
    \ from: 'asset_tag'},\n                    {to: 'BarCode-1', from: 'bar_code_1'},\n\
    \                    {to: 'BarCode-2', from: 'bar_code_2'},\n                \
    \    {to: 'Building', from: 'building'},\n                    {to: 'BuildingName',\
    \ from: 'building_name'},\n                    {to: 'Department', from: 'department'},\n\
    \                    {to: 'DepartmentName', from: 'department_name'},\n      \
    \              {to: 'Email', from: 'email'},\n                    {to: 'EmailAddress',\
    \ from: 'email_address'},\n                    {to: 'Position', from: 'position'},\n\
    \                    {to: 'Username', from: 'username'},\n                   \
    \ {to: 'Realname', from: 'realname'},\n                    {to: 'Room', from:\
    \ 'room'},\n                ]\n            }\n        ],\n    },\n    'test-module':\
    \ {\n        url: 'computers',\n        method: 'GET',\n    },\n};\n\nfunction\
    \ createContext(data, id) {\n    var createContextSingle = function(obj) {\n \
    \       var res = {};\n        var keys = Object.keys(obj);\n        keys.forEach(function(k)\
    \ {\n            var values = k.split('-');\n            var current = res;\n\
    \            for (var j = 0; j<values.length - 1; j++) {\n                if (!current[values[j]])\
    \ {\n                    current[values[j]] = {};\n                }\n       \
    \         current = current[values[j]];\n            }\n            current[values[j]]\
    \ = obj[k];\n        });\n        if (!res.ID && id) {\n            res.ID = id;\n\
    \        }\n        return res;\n    };\n    if (data instanceof Array) {\n  \
    \      var res = [];\n        for (var j=0; j < data.length; j++) {\n        \
    \    res.push(createContextSingle(data[j]));\n        }\n        return res;\n\
    \    }\n    return createContextSingle(data);\n}\n\nfunction mapObjFunction(mapFields,\
    \ filter) {\n    var transformSingleObj= function(obj) {\n        var res = {};\n\
    \        mapFields.forEach(function(f) {\n            result = dq(obj, f.from);\n\
    \            if (result || result === false) {\n                res[f.to] = result;\n\
    \            }\n        });\n        if (filter && !filter(res)) {\n         \
    \   return undefined;\n        }\n        return res;\n    };\n    return function(obj)\
    \ {\n        if (obj instanceof Array) {\n            var res = [];\n        \
    \    for (var j=0; j < obj.length; j++) {\n                var current = transformSingleObj(obj[j]);\n\
    \                if (current) {\n                    res.push(current);\n    \
    \            }\n            }\n            return res;\n        }\n        return\
    \ transformSingleObj(obj);\n    };\n}\n\n\nvar sendRequest = function(url, method,\
    \ args) {\n    var httpParams = {\n       Method: method,\n       Headers: {\n\
    \            'Content-Type': ['application/json'],\n            'Accept': ['application/json']\n\
    \       },\n       Username: params.credentials.identifier,\n       Password:\
    \ params.credentials.password,\n       Body: method !== 'GET' ? JSON.stringify(args)\
    \ : undefined\n    };\n    var res = http(\n            baseUrl + url + (method\
    \ === 'GET' && method ? encodeToURLQuery(args) : ''),\n            httpParams,\n\
    \            params.insecure,\n            params.proxy\n        );\n\n    if\
    \ (res.StatusCode < 200 || res.StatusCode >= 300) {\n        throw 'Request '\
    \ + url + ' failed, request status code: ' + res.StatusCode + ' and Body: ' +\
    \ res.Body + '.';\n    }\n    if (!res.Body) {\n        return 'Done';\n    }\n\
    \    try {\n        return JSON.parse(res.Body);\n    }\n    catch (ex) {\n  \
    \      throw 'Failed to create JSON from response ' + res.Body + ', exception\
    \ is ' + ex;\n    }\n}\n\ncurrentCommand = commandDictionary[command];\nif (currentCommand.defaultArgs)\
    \ {\n    keys = Object.keys(currentCommand.defaultArgs);\n    for (var k in keys)\
    \ {\n        if (!args[keys[k]] && args[keys[k]] !== false) {\n            args[keys[k]]\
    \ = currentCommand.defaultArgs[keys[k]];\n        }\n    }\n}\nif (currentCommand.argsToURLEncode)\
    \ {\n    for (var k in currentCommand.argsToURLEncode) {\n        args[currentCommand.argsToURLEncode[k]]\
    \ = encodeURIComponent(args[currentCommand.argsToURLEncode[k]]);\n    }\n}\nvar\
    \ result = sendRequest(replaceInTemplatesAndRemove(currentCommand.url, args),\
    \ currentCommand.method, args);\nif (command === 'test-module') {\n    return\
    \ 'ok';\n}\nvar entries = [];\nif (currentCommand.extended) {\n    for (var j\
    \ in currentCommand.translator) {\n        var current = currentCommand.translator[j];\n\
    \        var entry = {\n            Type: entryTypes.note,\n            Contents:\
    \ result,\n            ContentsFormat: formats.json,\n        };\n        var\
    \ currentContent = current.innerPath ? dq(result, current.innerPath) : result;\n\
    \        var translated = mapObjFunction(current.data) (current.countingDict ?\
    \ toArray(currentContent) : currentContent);\n        entry.ReadableContentsFormat\
    \ = formats.markdown;\n        entry.HumanReadable = tableToMarkdown(current.title,translated);\n\
    \        entry.EntryContext = {};\n        var context = createContext(translated);\n\
    \        entry.EntryContext[current.contextPath] = context;\n        entries.push(entry);\n\
    \    }\n} else {\n    return result;\n}\nreturn entries;"
  type: javascript
tests:
- No test
toversion: 4.1.9
versionedfields: {}
